var __extends=this&&this.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();var __assign=this&&this.__assign||function(){__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i))e[i]=t[i]}return e};return __assign.apply(this,arguments)};var __awaiter=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):i(e.value).then(o,u)}s((r=r.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(e){return function(t){return s([e,t])}}function s(o){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(a=o[0]&2?i["return"]:o[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;if(i=0,a)o=[o[0]&2,a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;i=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(a=n.trys,a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){n.label=o[1];break}if(o[0]===6&&n.label<a[1]){n.label=a[1];a=o;break}if(a&&n.label<a[2]){n.label=a[2];n.ops.push(o);break}if(a[2])n.ops.pop();n.trys.pop();continue}o=t.call(e,n)}catch(u){o=[6,u];i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,i++)r[i]=a[o];return r};System.register(["./p-ee075e7c.system.js"],(function(e){"use strict";var t,n,r,i,a;return{setters:[function(e){t=e.r;n=e.g;r=e.h;i=e.H;a=e.c}],execute:function(){
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation. All rights reserved.
            Licensed under the Apache License, Version 2.0 (the "License"); you may not use
            this file except in compliance with the License. You may obtain a copy of the
            License at http://www.apache.org/licenses/LICENSE-2.0

            THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
            KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
            WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
            MERCHANTABLITY OR NON-INFRINGEMENT.

            See the Apache Version 2.0 License for specific language governing permissions
            and limitations under the License.
            ***************************************************************************** */
var o,u,s,l,f,c,d;function h(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,i++)r[i]=a[o];return r}var p="antisymmetric";function v(e,t,n){if(n===void 0){n=false}var r=Math.floor(t/e.length);var i=r%2===0?-1:1;return i*O(e,t,n)}var g="constant";function m(e,t){if(t===void 0){t=false}if(e.length===0){throw new Error("Cannot determine constant padding for data of zero length.")}return!t?e[e.length-1]:e[0]}var y="periodic";function b(e,t,n){if(n===void 0){n=false}if(e.length===0){throw new Error("Cannot determine periodic padding for data of zero length.")}return!n?e[t%e.length]:e[e.length-1-t%e.length]}var x="reflect";function _(e,t,n){if(n===void 0){n=false}if(e.length===0){throw new Error("Cannot determine reflect padding for data of zero length.")}if(e.length===1)return e[0];var r=Math.floor(t/(e.length-1));var i=n?r:r+1;return i%2===0?e[t%(e.length-1)+1]:e[e.length-2-t%(e.length-1)]}var w="smooth";function k(e,t,n){if(n===void 0){n=false}if(e.length===0){throw new Error("Cannot determine smooth padding for data of zero length.")}var r=e.length-1;var i=n?e[0]:e[r];var a=n?e.length===1?e[0]:e[0]-e[1]:e.length===1?-e[0]:e[r]-e[r-1];return i+(t+1)*a}var E="symmetric";function O(e,t,n){if(n===void 0){n=false}if(e.length===0){throw new Error("Cannot determine symmetric padding for data of zero length.")}var r=Math.floor(t/e.length);var i=n?r:r+1;return i%2===0?e[t%e.length]:e[e.length-1-t%e.length]}var A="zero";function S(){return 0}var D={antisymmetric:p,constant:g,periodic:y,reflect:x,smooth:w,symmetric:E,zero:A,modes:[A,g,E,y,w,x,p]};var C=[1/Math.SQRT2,1/Math.SQRT2];var M=[(1+Math.sqrt(3))/(4*Math.SQRT2),(3+Math.sqrt(3))/(4*Math.SQRT2),(3-Math.sqrt(3))/(4*Math.SQRT2),(1-Math.sqrt(3))/(4*Math.SQRT2)];var j=[.33267055295008263,.8068915093110925,.45987750211849154,-.13501102001025458,-.08544127388202666,.03522629188570953];var F=[.2303778133088965,.7148465705529157,.6308807679298589,-.027983769416859854,-.18703481171909309,.030841381835560764,.0328830116668852,-.010597401785069032];var N=[.16010239797419293,.6038292697971896,.7243085284377729,.13842814590132074,-.24229488706638203,-.032244869584638375,.07757149384004572,-.006241490212798274,-.012580751999081999,.0033357252854737712];var T=[.11154074335010947,.49462389039845306,.7511339080210954,.31525035170919763,-.22626469396543983,-.12976686756726194,.09750160558732304,.027522865530305727,-.03158203931748603,.0005538422011614961,.004777257510945511,-.0010773010853084796];var z=[.07785205408500918,.3965393194819173,.7291320908462351,.4697822874051931,-.14390600392856498,-.22403618499387498,.07130921926683026,.08061260915108308,-.03802993693501441,-.01657454163066688,.01255099855609984,.0004295779729213665,-.0018016407040474908,.00035371379997452024];var R=[.05441584224310401,.31287159091429995,.6756307362972898,.5853546836542067,-.015829105256349306,-.2840155429615469,.0004724845739132828,.12874742662047847,-.017369301001807547,-.044088253930794755,.013981027917398282,.008746094047405777,-.004870352993451574,-.00039174037337694705,.0006754494064505693,-.00011747678412476953];var P=[.038077947363878345,.24383467461259034,.6048231236901112,.6572880780513005,.13319738582500756,-.2932737832791749,-.09684078322297646,.14854074933810638,.03072568147933338,-.06763282906132997,.00025094711483145197,.022361662123679096,-.004723204757751397,-.00428150368246343,.0018476468830562265,.00023038576352319597,-.0002519631889427101,393473203162716e-19];var L=[.026670057900555554,.1881768000776915,.5272011889317256,.6884590394536035,.2811723436605775,-.24984642432731538,-.19594627437737705,.12736934033579325,.09305736460357235,-.07139414716639708,-.029457536821875813,.033212674059341,.0036065535669561697,-.010733175483330575,.001395351747052901,.001992405295185056,-.0006858566949597116,-.00011646685512928545,9358867032006959e-20,-13264202894521244e-21];var I={db1:C,db2:M,db3:j,db4:F,db5:N,db6:T,db7:z,db8:R,db9:P,db10:L,D2:C,D4:M,D6:j,D8:F,D10:N,D12:T,D14:z,D16:R,D18:P,D20:L,haar:C};function B(e,t){if(e.length!==t.length){throw new Error("Both arrays have to have the same length.")}return e.map((function(e,n){return e+t[n]}))}function U(e,t){if(e.length!==t.length){throw new Error("Approximation and detail coefficients must have equal length.")}if(e.length===0){throw new Error("Approximation and detail coefficients must not have zero length.")}return true}function q(e){if(e.length<1){throw new Error("Invalid coefficients. Array length must not be zero.")}return true}function W(e){if(e.high.length!==e.low.length){throw new Error("High-pass and low-pass filters have to have equal length.")}if(e.low.length<2){throw new Error("Wavelet filter length has to be larger than or equal to two.")}return true}function H(e){return typeof e!=="string"?e:J(I[e])}function $(e,t){if(t===void 0){t=0}if(!Number.isInteger(e)){throw new Error("Length has to be an integer.")}if(e<0){throw new Error("Length must not be smaller than zero.")}return Array.apply(null,Array(e)).map((function(e,n){return typeof t==="function"?t(n):t}))}function G(e,t){if(e.length!==t.length){throw new Error("Both arrays have to have the same length.")}return e.reduce((function(e,n,r){return e+n*t[r]}),0)}function V(e,t){return t.map((function(t){return e*t}))}function Y(e,t,n,r){switch(r){case D.antisymmetric:return v(e,t,n);case D.constant:return m(e,n);case D.periodic:return b(e,t,n);case D.reflect:return _(e,t,n);case D.smooth:return k(e,t,n);case D.symmetric:return O(e,t,n);case D.zero:return S();default:throw new Error('Unknown signal extension mode: "'+r+'"')}}function X(e,t){if(e<=0){throw new Error("Cannot determine padding widths for data of length less than or equal to zero.")}if(t<2){throw new Error("Cannot determine padding widths for filter of length less than two.")}return[t-2,(e+t)%2===0?t-2:t-1]}function J(e){if(e.length<2){throw new Error("Scaling numbers length has to be larger than or equal to two.")}var t=e.slice().reverse().map((function(e,t){return t%2===0?e:-e}));return{dec:{low:e.slice(),high:t},rec:{low:e.slice(),high:t.slice()}}}var Z=D.symmetric;var Q=function(){function e(){}e.dwt=function(e,t,n){if(n===void 0){n=Z}var r=H(t);var i=r.dec;W(i);var a=i.low.length;e=this.pad(e,X(e.length,a),n);var o=[];var u=[];for(var s=0;s+a<=e.length;s+=2){var l=e.slice(s,s+a);o.push(G(l,i.low));u.push(G(l,i.high))}return[o,u]};e.energy=function(e){var t=0;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(!Array.isArray(i))t+=Math.pow(i,2);else t+=this.energy(i)}return t};e.idwt=function(e,t,n){if(e===undefined&&t!==undefined){e=$(t.length,0)}if(t===undefined&&e!==undefined){t=$(e.length,0)}if(e===undefined||t===undefined){throw new Error("Coefficients must not be undefined.")}U(e,t);var r=H(n);var i=r.rec;W(i);var a=i.low.length;var o=e.length;var u=$(a+(o-1)*2,0);for(var s=0;s<o;s++){var l=2*s;var f=u.slice(l,l+a);f=B(f,V(e[s],i.low));f=B(f,V(t[s],i.high));u.splice.apply(u,h([l,a],f))}return u.slice(a-2,u.length-(a-2))};e.maxLevel=function(e,t){if(!Number.isInteger(e)){throw new Error("Length of data is not an integer. This is not allowed.")}if(e<0){throw new Error("Data length cannot be less than zero.")}if(e===0)return 0;var n=H(t);var r=n.dec.low.length;return Math.max(0,Math.floor(Math.log2(e/(r-1))))};e.pad=function(e,t,n){if(!e){throw new Error("Cannot add padding to empty data.")}var r=t[0];var i=t[1];return $(r,(function(t){return Y(e,r-1-t,true,n)})).concat(e).concat($(i,(function(t){return Y(e,t,false,n)})))};e.wavedec=function(e,t,n,r){if(n===void 0){n=Z}if(r===undefined)r=this.maxLevel(e.length,t);if(r<0){throw new Error("Decomposition level must not be less than zero")}var i=[];var a=e;for(var o=1;o<=r;o++){var u=this.dwt(a,t,n);a=u[0];var s=u[1];i.unshift(s)}i.unshift(a);return i};e.waverec=function(e,t){q(e);t=H(t);var n=e[0];for(var r=1;r<e.length;r++){var i=e[r];if(n.length===i.length+1){n=n.slice(0,n.length-1)}n=this.idwt(n,i,t)}return n};e.Modes=D;return e}();var K=function(){function e(){}e.energy=function(e){return Q.energy(e)};e.wavedec=function(e,t,n){return Q.wavedec(e,t,n)};return e}();var ee="./assets/data/data.json";var te=function(){function e(){}e.getData=function(){return fetch(ee).then((function(e){return e.json()}))};return e}();var ne=function(e){return function(t){return t({type:"SET_COEFFS",payload:e})}};var re=function(e){return function(t){return t({type:"SET_TIME_SERIES",payload:e})}};function ie(e){var t;var n=e.Symbol;if(typeof n==="function"){if(n.observable){t=n.observable}else{t=n("observable");n.observable=t}}else{t="@@observable"}return t}var ae;if(typeof self!=="undefined"){ae=self}else if(typeof window!=="undefined"){ae=window}else if(typeof global!=="undefined"){ae=global}else if(typeof module!=="undefined"){ae=module}else{ae=Function("return this")()}var oe=ie(ae);var ue=function e(){return Math.random().toString(36).substring(7).split("").join(".")};var se={INIT:"@@redux/INIT"+ue(),REPLACE:"@@redux/REPLACE"+ue(),PROBE_UNKNOWN_ACTION:function e(){return"@@redux/PROBE_UNKNOWN_ACTION"+ue()}};function le(e){if(typeof e!=="object"||e===null)return false;var t=e;while(Object.getPrototypeOf(t)!==null){t=Object.getPrototypeOf(t)}return Object.getPrototypeOf(e)===t}function fe(e,t,n){var r;if(typeof t==="function"&&typeof n==="function"||typeof n==="function"&&typeof arguments[3]==="function"){throw new Error("It looks like you are passing several store enhancers to "+"createStore(). This is not supported. Instead, compose them "+"together to a single function.")}if(typeof t==="function"&&typeof n==="undefined"){n=t;t=undefined}if(typeof n!=="undefined"){if(typeof n!=="function"){throw new Error("Expected the enhancer to be a function.")}return n(fe)(e,t)}if(typeof e!=="function"){throw new Error("Expected the reducer to be a function.")}var i=e;var a=t;var o=[];var u=o;var s=false;function l(){if(u===o){u=o.slice()}}function f(){if(s){throw new Error("You may not call store.getState() while the reducer is executing. "+"The reducer has already received the state as an argument. "+"Pass it down from the top reducer instead of reading it from the store.")}return a}function c(e){if(typeof e!=="function"){throw new Error("Expected the listener to be a function.")}if(s){throw new Error("You may not call store.subscribe() while the reducer is executing. "+"If you would like to be notified after the store has been updated, subscribe from a "+"component and invoke store.getState() in the callback to access the latest state. "+"See https://redux.js.org/api-reference/store#subscribelistener for more details.")}var t=true;l();u.push(e);return function n(){if(!t){return}if(s){throw new Error("You may not unsubscribe from a store listener while the reducer is executing. "+"See https://redux.js.org/api-reference/store#subscribelistener for more details.")}t=false;l();var r=u.indexOf(e);u.splice(r,1);o=null}}function d(e){if(!le(e)){throw new Error("Actions must be plain objects. "+"Use custom middleware for async actions.")}if(typeof e.type==="undefined"){throw new Error('Actions may not have an undefined "type" property. '+"Have you misspelled a constant?")}if(s){throw new Error("Reducers may not dispatch actions.")}try{s=true;a=i(a,e)}finally{s=false}var t=o=u;for(var n=0;n<t.length;n++){var r=t[n];r()}return e}function h(e){if(typeof e!=="function"){throw new Error("Expected the nextReducer to be a function.")}i=e;d({type:se.REPLACE})}function p(){var e;var t=c;return e={subscribe:function e(n){if(typeof n!=="object"||n===null){throw new TypeError("Expected the observer to be an object.")}function r(){if(n.next){n.next(f())}}r();var i=t(r);return{unsubscribe:i}}},e[oe]=function(){return this},e}d({type:se.INIT});return r={dispatch:d,subscribe:c,getState:f,replaceReducer:h},r[oe]=p,r}function ce(e,t){var n=t&&t.type;var r=n&&'action "'+String(n)+'"'||"an action";return"Given "+r+', reducer "'+e+'" returned undefined. '+"To ignore an action, you must explicitly return the previous state. "+"If you want this reducer to hold no value, you can return null instead of undefined."}function de(e){Object.keys(e).forEach((function(t){var n=e[t];var r=n(undefined,{type:se.INIT});if(typeof r==="undefined"){throw new Error('Reducer "'+t+'" returned undefined during initialization. '+"If the state passed to the reducer is undefined, you must "+"explicitly return the initial state. The initial state may "+"not be undefined. If you don't want to set a value for this reducer, "+"you can use null instead of undefined.")}if(typeof n(undefined,{type:se.PROBE_UNKNOWN_ACTION()})==="undefined"){throw new Error('Reducer "'+t+'" returned undefined when probed with a random type. '+("Don't try to handle "+se.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the "+"current state for any unknown actions, unless it is undefined, "+"in which case you must return the initial state, regardless of the "+"action type. The initial state may not be undefined, but can be null.")}}))}function he(e){var t=Object.keys(e);var n={};for(var r=0;r<t.length;r++){var i=t[r];if(typeof e[i]==="function"){n[i]=e[i]}}var a=Object.keys(n);var o;try{de(n)}catch(u){o=u}return function e(t,r){if(t===void 0){t={}}if(o){throw o}var i=false;var u={};for(var s=0;s<a.length;s++){var l=a[s];var f=n[l];var c=t[l];var d=f(c,r);if(typeof d==="undefined"){var h=ce(l,r);throw new Error(h)}u[l]=d;i=i||d!==c}i=i||a.length!==Object.keys(t).length;return i?u:t}}function pe(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){n.push.apply(n,Object.getOwnPropertySymbols(e))}if(t)n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};if(t%2){ve(n,true).forEach((function(t){pe(e,t,n[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(n))}else{ve(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}}return e}function me(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}if(t.length===0){return function(e){return e}}if(t.length===1){return t[0]}return t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function ye(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}return function(e){return function(){var n=e.apply(void 0,arguments);var r=function e(){throw new Error("Dispatching while constructing your middleware is not allowed. "+"Other middleware would not be applied to this dispatch.")};var i={getState:n.getState,dispatch:function e(){return r.apply(void 0,arguments)}};var a=t.map((function(e){return e(i)}));r=me.apply(void 0,a)(n.dispatch);return ge({},n,{dispatch:r})}}}var be=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function xe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function _e(e,t){return t={exports:{}},e(t,t.exports),t.exports}var we=_e((function(e,t){!function(e,n){n(t)}(be,(function(e){function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function n(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function r(e,t,n){r.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function i(e,t){i.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function a(e,t){a.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function o(e,t,n){o.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function u(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function s(e){var t="undefined"==typeof e?"undefined":C(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function l(e,t,n,f,c,d,h){c=c||[],h=h||[];var p=c.slice(0);if("undefined"!=typeof d){if(f){if("function"==typeof f&&f(p,d))return;if("object"===("undefined"==typeof f?"undefined":C(f))){if(f.prefilter&&f.prefilter(p,d))return;if(f.normalize){var v=f.normalize(p,d,e,t);v&&(e=v[0],t=v[1])}}}p.push(d)}"regexp"===s(e)&&"regexp"===s(t)&&(e=e.toString(),t=t.toString());var g="undefined"==typeof e?"undefined":C(e),m="undefined"==typeof t?"undefined":C(t),y="undefined"!==g||h&&h[h.length-1].lhs&&h[h.length-1].lhs.hasOwnProperty(d),b="undefined"!==m||h&&h[h.length-1].rhs&&h[h.length-1].rhs.hasOwnProperty(d);if(!y&&b)n(new i(p,t));else if(!b&&y)n(new a(p,e));else if(s(e)!==s(t))n(new r(p,e,t));else if("date"===s(e)&&e-t!==0)n(new r(p,e,t));else if("object"===g&&null!==e&&null!==t)if(h.filter((function(t){return t.lhs===e})).length)e!==t&&n(new r(p,e,t));else{if(h.push({lhs:e,rhs:t}),Array.isArray(e)){var x;for(x=0;x<e.length;x++)x>=t.length?n(new o(p,x,new a(void 0,e[x]))):l(e[x],t[x],n,f,p,x,h);for(;x<t.length;)n(new o(p,x,new i(void 0,t[x++])))}else{var _=Object.keys(e),w=Object.keys(t);_.forEach((function(r,i){var a=w.indexOf(r);a>=0?(l(e[r],t[r],n,f,p,r,h),w=u(w,a)):l(e[r],void 0,n,f,p,r,h)})),w.forEach((function(e){l(void 0,t[e],n,f,p,e,h)}))}h.length=h.length-1}else e!==t&&("number"===g&&isNaN(e)&&isNaN(t)||n(new r(p,e,t)))}function f(e,t,n,r){return r=r||[],l(e,t,(function(e){e&&r.push(e)}),n),r.length?r:void 0}function c(e,t,n){if(n.path&&n.path.length){var r,i=e[t],a=n.path.length-1;for(r=0;r<a;r++)i=i[n.path[r]];switch(n.kind){case"A":c(i[n.path[r]],n.index,n.item);break;case"D":delete i[n.path[r]];break;case"E":case"N":i[n.path[r]]=n.rhs}}else switch(n.kind){case"A":c(e[t],n.index,n.item);break;case"D":e=u(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function d(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,i=-1,a=n.path?n.path.length-1:0;++i<a;)"undefined"==typeof r[n.path[i]]&&(r[n.path[i]]="number"==typeof n.path[i]?[]:{}),r=r[n.path[i]];switch(n.kind){case"A":c(n.path?r[n.path[i]]:r,n.index,n.item);break;case"D":delete r[n.path[i]];break;case"E":case"N":r[n.path[i]]=n.rhs}}}function h(e,t,n){if(n.path&&n.path.length){var r,i=e[t],a=n.path.length-1;for(r=0;r<a;r++)i=i[n.path[r]];switch(n.kind){case"A":h(i[n.path[r]],n.index,n.item);break;case"D":i[n.path[r]]=n.lhs;break;case"E":i[n.path[r]]=n.lhs;break;case"N":delete i[n.path[r]]}}else switch(n.kind){case"A":h(e[t],n.index,n.item);break;case"D":e[t]=n.lhs;break;case"E":e[t]=n.lhs;break;case"N":e=u(e,t)}return e}function p(e,t,n){if(e&&t&&n&&n.kind){var r,i,a=e;for(i=n.path.length-1,r=0;r<i;r++)"undefined"==typeof a[n.path[r]]&&(a[n.path[r]]={}),a=a[n.path[r]];switch(n.kind){case"A":h(a[n.path[r]],n.index,n.item);break;case"D":a[n.path[r]]=n.lhs;break;case"E":a[n.path[r]]=n.lhs;break;case"N":delete a[n.path[r]]}}}function v(e,t,n){if(e&&t){var r=function(r){n&&!n(e,t,r)||d(e,t,r)};l(e,t,r)}}function g(e){return"color: "+F[e].color+"; font-weight: bold"}function m(e){var t=e.kind,n=e.path,r=e.lhs,i=e.rhs,a=e.index,o=e.item;switch(t){case"E":return[n.join("."),r,"→",i];case"N":return[n.join("."),i];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+a+"]",o];default:return[]}}function y(e,t,n,r){var i=f(e,t);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}i?i.forEach((function(e){var t=e.kind,r=m(e);n.log.apply(n,["%c "+F[t].text,g(t)].concat(M(r)))})):n.log("—— no diff ——");try{n.groupEnd()}catch(e){n.log("—— diff end —— ")}}function b(e,t,n,r){switch("undefined"==typeof e?"undefined":C(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,M(n)):e[r];case"function":return e(t);default:return e}}function x(e){var t=e.timestamp,n=e.duration;return function(e,r,i){var a=["action"];return a.push("%c"+String(e.type)),t&&a.push("%c@ "+r),n&&a.push("%c(in "+i.toFixed(2)+" ms)"),a.join(" ")}}function _(e,t){var n=t.logger,r=t.actionTransformer,i=t.titleFormatter,a=void 0===i?x(t):i,o=t.collapsed,u=t.colors,s=t.level,l=t.diff,f="undefined"==typeof t.titleFormatter;e.forEach((function(i,c){var d=i.started,h=i.startedTime,p=i.action,v=i.prevState,g=i.error,m=i.took,x=i.nextState,_=e[c+1];_&&(x=_.prevState,m=_.started-d);var w=r(p),k="function"==typeof o?o((function(){return x}),p,i):o,E=S(h),O=u.title?"color: "+u.title(w)+";":"",A=["color: gray; font-weight: lighter;"];A.push(O),t.timestamp&&A.push("color: gray; font-weight: lighter;"),t.duration&&A.push("color: gray; font-weight: lighter;");var D=a(w,E,m);try{k?u.title&&f?n.groupCollapsed.apply(n,["%c "+D].concat(A)):n.groupCollapsed(D):u.title&&f?n.group.apply(n,["%c "+D].concat(A)):n.group(D)}catch(e){n.log(D)}var C=b(s,w,[v],"prevState"),M=b(s,w,[w],"action"),j=b(s,w,[g,v],"error"),F=b(s,w,[x],"nextState");if(C)if(u.prevState){var N="color: "+u.prevState(v)+"; font-weight: bold";n[C]("%c prev state",N,v)}else n[C]("prev state",v);if(M)if(u.action){var T="color: "+u.action(w)+"; font-weight: bold";n[M]("%c action    ",T,w)}else n[M]("action    ",w);if(g&&j)if(u.error){var z="color: "+u.error(g,v)+"; font-weight: bold;";n[j]("%c error     ",z,g)}else n[j]("error     ",g);if(F)if(u.nextState){var R="color: "+u.nextState(x)+"; font-weight: bold";n[F]("%c next state",R,x)}else n[F]("next state",x);l&&y(v,x,n,k);try{n.groupEnd()}catch(e){n.log("—— log end ——")}}))}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},N,e),n=t.logger,r=t.stateTransformer,i=t.errorTransformer,a=t.predicate,o=t.logErrors,u=t.diffPredicate;if("undefined"==typeof n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var s=[];return function(e){var n=e.getState;return function(e){return function(l){if("function"==typeof a&&!a(n,l))return e(l);var f={};s.push(f),f.started=D.now(),f.startedTime=new Date,f.prevState=r(n()),f.action=l;var c=void 0;if(o)try{c=e(l)}catch(e){f.error=i(e)}else c=e(l);f.took=D.now()-f.started,f.nextState=r(n());var d=t.diff&&"function"==typeof u?u(n,l):t.diff;if(_(s,Object.assign({},t,{diff:d})),s.length=0,f.error)throw f.error;return c}}}}var k,E,O=function(e,t){return new Array(t+1).join(e)},A=function(e,t){return O("0",t-e.toString().length)+e},S=function(e){return A(e.getHours(),2)+":"+A(e.getMinutes(),2)+":"+A(e.getSeconds(),2)+"."+A(e.getMilliseconds(),3)},D="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},j=[];k="object"===("undefined"==typeof be?"undefined":C(be))&&be?be:"undefined"!=typeof window?window:{},E=k.DeepDiff,E&&j.push((function(){"undefined"!=typeof E&&k.DeepDiff===f&&(k.DeepDiff=E,E=void 0)})),t(r,n),t(i,n),t(a,n),t(o,n),Object.defineProperties(f,{diff:{value:f,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:v,enumerable:!0},applyChange:{value:d,enumerable:!0},revertChange:{value:p,enumerable:!0},isConflict:{value:function(){return"undefined"!=typeof E},enumerable:!0},noConflict:{value:function(){return j&&(j.forEach((function(e){e()})),j=null),f},enumerable:!0}});var F={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},N={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;return"function"==typeof t||"function"==typeof n?w()({dispatch:t,getState:n}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=N,e.createLogger=w,e.logger=T,e.default=T,Object.defineProperty(e,"__esModule",{value:!0})}))}));xe(we);function ke(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(i){if(typeof i==="function"){return i(n,r,e)}return t(i)}}}}var Ee=ke();Ee.withExtraArgument=ke;var Oe=function(e,t){if(e===void 0){e={coeffs:null,timeSeries:null}}switch(t.type){case"SET_COEFFS":{var n=t.payload;return Object.assign(Object.assign({},e),{coeffs:n})}case"SET_TIME_SERIES":{var r=t.payload;return Object.assign(Object.assign({},e),{timeSeries:r})}default:{return e}}};var Ae=he({data:Oe});var Se=[Ee];var De=fe(Ae,ye.apply(void 0,Se));var Ce="app-root strc-progress-bar{left:0;position:fixed;top:0;z-index:6}app-root .content{margin-top:1rem}";var Me=e("app_root",function(){function e(e){t(this,e);this.setCoeffs=function(){};this.setTimeSeries=function(){};this.store=n(this,"store")}e.prototype.handleTimeSeries=function(e){this.updateCoeffs(e)};e.prototype.componentWillLoad=function(){this.initStore()};e.prototype.componentDidLoad=function(){this.loadData()};e.prototype.initStore=function(){this.store.setStore(De);this.store.mapStateToProps(this,(function(e){var t=e.data.coeffs;var n=e.data.timeSeries;return{coeffs:t,timeSeries:n}}));this.store.mapDispatchToProps(this,{setCoeffs:ne,setTimeSeries:re})};e.prototype.loadData=function(){return Je(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,te.getData().then((function(t){return e.setTimeSeries(t)}))]}))}))};e.prototype.progress=function(){var e=this;var t=1;var n=["coeffs","timeSeries"];var r=n.reduce((function(t,n){return e[n]===null||e[n]===undefined?t:t+1}),0);return(r+t)/(n.length+t)};e.prototype.updateCoeffs=function(e){var t=null;if(e){var n=e.map((function(e){return e[1]}));t=K.wavedec(n,"haar","constant")}this.setCoeffs(t)};e.prototype.render=function(){var e=this.progress();return r("div",null,r("github-corner",{href:"https://github.com/Symmetronic/covid-19-dwt-analysis/"}),r("strc-progress-bar",{class:e<1?null:"fade-out",progress:e}),r("div",{class:"content"},r("page-dashboard",null)))};Object.defineProperty(e,"watchers",{get:function(){return{timeSeries:["handleTimeSeries"]}},enumerable:true,configurable:true});return e}());Me.style=Ce;var je=":host{position:absolute;right:0;top:0}@-webkit-keyframes octocat-wave{0%,100%{-webkit-transform:rotate(0);transform:rotate(0)}20%,60%{-webkit-transform:rotate(-25deg);transform:rotate(-25deg)}40%,80%{-webkit-transform:rotate(10deg);transform:rotate(10deg)}}@keyframes octocat-wave{0%,100%{-webkit-transform:rotate(0);transform:rotate(0)}20%,60%{-webkit-transform:rotate(-25deg);transform:rotate(-25deg)}40%,80%{-webkit-transform:rotate(10deg);transform:rotate(10deg)}}:host .github-corner:hover .octo-arm{-webkit-animation:octocat-wave 560ms ease-in-out;animation:octocat-wave 560ms ease-in-out}@media (max-width: 500px){:host .github-corner:hover .octo-arm{-webkit-animation:none;animation:none}:host .github-corner .octo-arm{-webkit-animation:octocat-wave 560ms ease-in-out;animation:octocat-wave 560ms ease-in-out}}";var Fe=e("github_corner",function(){function e(e){t(this,e);this.href=""}e.prototype.render=function(){return r("a",{"aria-label":"View source on GitHub",class:"github-corner",href:this.href,title:"View source on GitHub"},r("svg",{"aria-hidden":"true",height:"80",style:{fill:"#151513",color:"#fff",border:"0"},viewBox:"0 0 250 250",width:"80"},r("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),r("path",{class:"octo-arm",d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{transformOrigin:"130px 106px"}}),r("path",{class:"octo-body",d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"})))};return e}());Fe.style=je;var Ne=_e((function(e,t){(function(){var n;var r="4.17.19";var i=200;var a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function";var u="__lodash_hash_undefined__";var s=500;var l="__lodash_placeholder__";var f=1,c=2,d=4;var h=1,p=2;var v=1,g=2,m=4,y=8,b=16,x=32,_=64,w=128,k=256,E=512;var O=30,A="...";var S=800,D=16;var C=1,M=2,j=3;var F=1/0,N=9007199254740991,T=17976931348623157e292,z=0/0;var R=4294967295,P=R-1,L=R>>>1;var I=[["ary",w],["bind",v],["bindKey",g],["curry",y],["curryRight",b],["flip",E],["partial",x],["partialRight",_],["rearg",k]];var B="[object Arguments]",U="[object Array]",q="[object AsyncFunction]",W="[object Boolean]",H="[object Date]",$="[object DOMException]",G="[object Error]",V="[object Function]",Y="[object GeneratorFunction]",X="[object Map]",J="[object Number]",Z="[object Null]",Q="[object Object]",K="[object Promise]",ee="[object Proxy]",te="[object RegExp]",ne="[object Set]",re="[object String]",ie="[object Symbol]",ae="[object Undefined]",oe="[object WeakMap]",ue="[object WeakSet]";var se="[object ArrayBuffer]",le="[object DataView]",fe="[object Float32Array]",ce="[object Float64Array]",de="[object Int8Array]",he="[object Int16Array]",pe="[object Int32Array]",ve="[object Uint8Array]",ge="[object Uint8ClampedArray]",me="[object Uint16Array]",ye="[object Uint32Array]";var xe=/\b__p \+= '';/g,_e=/\b(__p \+=) '' \+/g,we=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var ke=/&(?:amp|lt|gt|quot|#39);/g,Ee=/[&<>"']/g,Oe=RegExp(ke.source),Ae=RegExp(Ee.source);var Se=/<%-([\s\S]+?)%>/g,De=/<%([\s\S]+?)%>/g,Ce=/<%=([\s\S]+?)%>/g;var Me=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,je=/^\w*$/,Fe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var Ne=/[\\^$.*+?()[\]{}|]/g,Te=RegExp(Ne.source);var ze=/^\s+|\s+$/g,Re=/^\s+/,Pe=/\s+$/;var Le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ie=/\{\n\/\* \[wrapped with (.+)\] \*/,Be=/,? & /;var Ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var qe=/\\(\\)?/g;var We=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var He=/\w*$/;var $e=/^[-+]0x[0-9a-f]+$/i;var Ge=/^0b[01]+$/i;var Ve=/^\[object .+?Constructor\]$/;var Ye=/^0o[0-7]+$/i;var Xe=/^(?:0|[1-9]\d*)$/;var Je=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;var Ze=/($^)/;var Qe=/['\n\r\u2028\u2029\\]/g;var Ke="\\ud800-\\udfff",et="\\u0300-\\u036f",tt="\\ufe20-\\ufe2f",nt="\\u20d0-\\u20ff",rt=et+tt+nt,it="\\u2700-\\u27bf",at="a-z\\xdf-\\xf6\\xf8-\\xff",ot="\\xac\\xb1\\xd7\\xf7",ut="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",st="\\u2000-\\u206f",lt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ft="A-Z\\xc0-\\xd6\\xd8-\\xde",ct="\\ufe0e\\ufe0f",dt=ot+ut+st+lt;var ht="['’]",pt="["+Ke+"]",vt="["+dt+"]",gt="["+rt+"]",mt="\\d+",yt="["+it+"]",bt="["+at+"]",xt="[^"+Ke+dt+mt+it+at+ft+"]",_t="\\ud83c[\\udffb-\\udfff]",wt="(?:"+gt+"|"+_t+")",kt="[^"+Ke+"]",Et="(?:\\ud83c[\\udde6-\\uddff]){2}",Ot="[\\ud800-\\udbff][\\udc00-\\udfff]",At="["+ft+"]",St="\\u200d";var Dt="(?:"+bt+"|"+xt+")",Ct="(?:"+At+"|"+xt+")",Mt="(?:"+ht+"(?:d|ll|m|re|s|t|ve))?",jt="(?:"+ht+"(?:D|LL|M|RE|S|T|VE))?",Ft=wt+"?",Nt="["+ct+"]?",Tt="(?:"+St+"(?:"+[kt,Et,Ot].join("|")+")"+Nt+Ft+")*",zt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Pt=Nt+Ft+Tt,Lt="(?:"+[yt,Et,Ot].join("|")+")"+Pt,It="(?:"+[kt+gt+"?",gt,Et,Ot,pt].join("|")+")";var Bt=RegExp(ht,"g");var Ut=RegExp(gt,"g");var qt=RegExp(_t+"(?="+_t+")|"+It+Pt,"g");var Wt=RegExp([At+"?"+bt+"+"+Mt+"(?="+[vt,At,"$"].join("|")+")",Ct+"+"+jt+"(?="+[vt,At+Dt,"$"].join("|")+")",At+"?"+Dt+"+"+Mt,At+"+"+jt,Rt,zt,mt,Lt].join("|"),"g");var Ht=RegExp("["+St+Ke+rt+ct+"]");var $t=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Gt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"];var Vt=-1;var Yt={};Yt[fe]=Yt[ce]=Yt[de]=Yt[he]=Yt[pe]=Yt[ve]=Yt[ge]=Yt[me]=Yt[ye]=true;Yt[B]=Yt[U]=Yt[se]=Yt[W]=Yt[le]=Yt[H]=Yt[G]=Yt[V]=Yt[X]=Yt[J]=Yt[Q]=Yt[te]=Yt[ne]=Yt[re]=Yt[oe]=false;var Xt={};Xt[B]=Xt[U]=Xt[se]=Xt[le]=Xt[W]=Xt[H]=Xt[fe]=Xt[ce]=Xt[de]=Xt[he]=Xt[pe]=Xt[X]=Xt[J]=Xt[Q]=Xt[te]=Xt[ne]=Xt[re]=Xt[ie]=Xt[ve]=Xt[ge]=Xt[me]=Xt[ye]=true;Xt[G]=Xt[V]=Xt[oe]=false;var Jt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"};var Zt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var Qt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};var Kt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var en=parseFloat,tn=parseInt;var nn=typeof be=="object"&&be&&be.Object===Object&&be;var rn=typeof self=="object"&&self&&self.Object===Object&&self;var an=nn||rn||Function("return this")();var on=t&&!t.nodeType&&t;var un=on&&"object"=="object"&&e&&!e.nodeType&&e;var sn=un&&un.exports===on;var ln=sn&&nn.process;var fn=function(){try{var e=un&&un.require&&un.require("util").types;if(e){return e}return ln&&ln.binding&&ln.binding("util")}catch(t){}}();var cn=fn&&fn.isArrayBuffer,dn=fn&&fn.isDate,hn=fn&&fn.isMap,pn=fn&&fn.isRegExp,vn=fn&&fn.isSet,gn=fn&&fn.isTypedArray;function mn(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function yn(e,t,n,r){var i=-1,a=e==null?0:e.length;while(++i<a){var o=e[i];t(r,o,n(o),e)}return r}function bn(e,t){var n=-1,r=e==null?0:e.length;while(++n<r){if(t(e[n],n,e)===false){break}}return e}function xn(e,t){var n=e==null?0:e.length;while(n--){if(t(e[n],n,e)===false){break}}return e}function _n(e,t){var n=-1,r=e==null?0:e.length;while(++n<r){if(!t(e[n],n,e)){return false}}return true}function wn(e,t){var n=-1,r=e==null?0:e.length,i=0,a=[];while(++n<r){var o=e[n];if(t(o,n,e)){a[i++]=o}}return a}function kn(e,t){var n=e==null?0:e.length;return!!n&&zn(e,t,0)>-1}function En(e,t,n){var r=-1,i=e==null?0:e.length;while(++r<i){if(n(t,e[r])){return true}}return false}function On(e,t){var n=-1,r=e==null?0:e.length,i=Array(r);while(++n<r){i[n]=t(e[n],n,e)}return i}function An(e,t){var n=-1,r=t.length,i=e.length;while(++n<r){e[i+n]=t[n]}return e}function Sn(e,t,n,r){var i=-1,a=e==null?0:e.length;if(r&&a){n=e[++i]}while(++i<a){n=t(n,e[i],i,e)}return n}function Dn(e,t,n,r){var i=e==null?0:e.length;if(r&&i){n=e[--i]}while(i--){n=t(n,e[i],i,e)}return n}function Cn(e,t){var n=-1,r=e==null?0:e.length;while(++n<r){if(t(e[n],n,e)){return true}}return false}var Mn=In("length");function jn(e){return e.split("")}function Fn(e){return e.match(Ue)||[]}function Nn(e,t,n){var r;n(e,(function(e,n,i){if(t(e,n,i)){r=n;return false}}));return r}function Tn(e,t,n,r){var i=e.length,a=n+(r?1:-1);while(r?a--:++a<i){if(t(e[a],a,e)){return a}}return-1}function zn(e,t,n){return t===t?fr(e,t,n):Tn(e,Pn,n)}function Rn(e,t,n,r){var i=n-1,a=e.length;while(++i<a){if(r(e[i],t)){return i}}return-1}function Pn(e){return e!==e}function Ln(e,t){var n=e==null?0:e.length;return n?Wn(e,t)/n:z}function In(e){return function(t){return t==null?n:t[e]}}function Bn(e){return function(t){return e==null?n:e[t]}}function Un(e,t,n,r,i){i(e,(function(e,i,a){n=r?(r=false,e):t(n,e,i,a)}));return n}function qn(e,t){var n=e.length;e.sort(t);while(n--){e[n]=e[n].value}return e}function Wn(e,t){var r,i=-1,a=e.length;while(++i<a){var o=t(e[i]);if(o!==n){r=r===n?o:r+o}}return r}function Hn(e,t){var n=-1,r=Array(e);while(++n<e){r[n]=t(n)}return r}function $n(e,t){return On(t,(function(t){return[t,e[t]]}))}function Gn(e){return function(t){return e(t)}}function Vn(e,t){return On(t,(function(t){return e[t]}))}function Yn(e,t){return e.has(t)}function Xn(e,t){var n=-1,r=e.length;while(++n<r&&zn(t,e[n],0)>-1){}return n}function Jn(e,t){var n=e.length;while(n--&&zn(t,e[n],0)>-1){}return n}function Zn(e,t){var n=e.length,r=0;while(n--){if(e[n]===t){++r}}return r}var Qn=Bn(Jt);var Kn=Bn(Zt);function er(e){return"\\"+Kt[e]}function tr(e,t){return e==null?n:e[t]}function nr(e){return Ht.test(e)}function rr(e){return $t.test(e)}function ir(e){var t,n=[];while(!(t=e.next()).done){n.push(t.value)}return n}function ar(e){var t=-1,n=Array(e.size);e.forEach((function(e,r){n[++t]=[r,e]}));return n}function or(e,t){return function(n){return e(t(n))}}function ur(e,t){var n=-1,r=e.length,i=0,a=[];while(++n<r){var o=e[n];if(o===t||o===l){e[n]=l;a[i++]=n}}return a}function sr(e){var t=-1,n=Array(e.size);e.forEach((function(e){n[++t]=e}));return n}function lr(e){var t=-1,n=Array(e.size);e.forEach((function(e){n[++t]=[e,e]}));return n}function fr(e,t,n){var r=n-1,i=e.length;while(++r<i){if(e[r]===t){return r}}return-1}function cr(e,t,n){var r=n+1;while(r--){if(e[r]===t){return r}}return r}function dr(e){return nr(e)?vr(e):Mn(e)}function hr(e){return nr(e)?gr(e):jn(e)}var pr=Bn(Qt);function vr(e){var t=qt.lastIndex=0;while(qt.test(e)){++t}return t}function gr(e){return e.match(qt)||[]}function mr(e){return e.match(Wt)||[]}var yr=function e(t){t=t==null?an:br.defaults(an.Object(),t,br.pick(an,Gt));var be=t.Array,Ue=t.Date,Ke=t.Error,et=t.Function,tt=t.Math,nt=t.Object,rt=t.RegExp,it=t.String,at=t.TypeError;var ot=be.prototype,ut=et.prototype,st=nt.prototype;var lt=t["__core-js_shared__"];var ft=ut.toString;var ct=st.hasOwnProperty;var dt=0;var ht=function(){var e=/[^.]+$/.exec(lt&&lt.keys&&lt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var pt=st.toString;var vt=ft.call(nt);var gt=an._;var mt=rt("^"+ft.call(ct).replace(Ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var yt=sn?t.Buffer:n,bt=t.Symbol,xt=t.Uint8Array,_t=yt?yt.allocUnsafe:n,wt=or(nt.getPrototypeOf,nt),kt=nt.create,Et=st.propertyIsEnumerable,Ot=ot.splice,At=bt?bt.isConcatSpreadable:n,St=bt?bt.iterator:n,Dt=bt?bt.toStringTag:n;var Ct=function(){try{var e=$o(nt,"defineProperty");e({},"",{});return e}catch(t){}}();var Mt=t.clearTimeout!==an.clearTimeout&&t.clearTimeout,jt=Ue&&Ue.now!==an.Date.now&&Ue.now,Ft=t.setTimeout!==an.setTimeout&&t.setTimeout;var Nt=tt.ceil,Tt=tt.floor,zt=nt.getOwnPropertySymbols,Rt=yt?yt.isBuffer:n,Pt=t.isFinite,Lt=ot.join,It=or(nt.keys,nt),qt=tt.max,Wt=tt.min,Ht=Ue.now,$t=t.parseInt,Jt=tt.random,Zt=ot.reverse;var Qt=$o(t,"DataView"),Kt=$o(t,"Map"),nn=$o(t,"Promise"),rn=$o(t,"Set"),on=$o(t,"WeakMap"),un=$o(nt,"create");var ln=on&&new on;var fn={};var Mn=Mu(Qt),jn=Mu(Kt),Bn=Mu(nn),fr=Mu(rn),vr=Mu(on);var gr=bt?bt.prototype:n,yr=gr?gr.valueOf:n,xr=gr?gr.toString:n;function _r(e){if(Ef(e)&&!uf(e)&&!(e instanceof Or)){if(e instanceof Er){return e}if(ct.call(e,"__wrapped__")){return Fu(e)}}return new Er(e)}var wr=function(){function e(){}return function(t){if(!kf(t)){return{}}if(kt){return kt(t)}e.prototype=t;var r=new e;e.prototype=n;return r}}();function kr(){}function Er(e,t){this.__wrapped__=e;this.__actions__=[];this.__chain__=!!t;this.__index__=0;this.__values__=n}_r.templateSettings={escape:Se,evaluate:De,interpolate:Ce,variable:"",imports:{_:_r}};_r.prototype=kr.prototype;_r.prototype.constructor=_r;Er.prototype=wr(kr.prototype);Er.prototype.constructor=Er;function Or(e){this.__wrapped__=e;this.__actions__=[];this.__dir__=1;this.__filtered__=false;this.__iteratees__=[];this.__takeCount__=R;this.__views__=[]}function Ar(){var e=new Or(this.__wrapped__);e.__actions__=to(this.__actions__);e.__dir__=this.__dir__;e.__filtered__=this.__filtered__;e.__iteratees__=to(this.__iteratees__);e.__takeCount__=this.__takeCount__;e.__views__=to(this.__views__);return e}function Sr(){if(this.__filtered__){var e=new Or(this);e.__dir__=-1;e.__filtered__=true}else{e=this.clone();e.__dir__*=-1}return e}function Dr(){var e=this.__wrapped__.value(),t=this.__dir__,n=uf(e),r=t<0,i=n?e.length:0,a=Jo(0,i,this.__views__),o=a.start,u=a.end,s=u-o,l=r?u:o-1,f=this.__iteratees__,c=f.length,d=0,h=Wt(s,this.__takeCount__);if(!n||!r&&i==s&&h==s){return Ra(e,this.__actions__)}var p=[];e:while(s--&&d<h){l+=t;var v=-1,g=e[l];while(++v<c){var m=f[v],y=m.iteratee,b=m.type,x=y(g);if(b==M){g=x}else if(!x){if(b==C){continue e}else{break e}}}p[d++]=g}return p}Or.prototype=wr(kr.prototype);Or.prototype.constructor=Or;function Cr(e){var t=-1,n=e==null?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function Mr(){this.__data__=un?un(null):{};this.size=0}function jr(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}function Fr(e){var t=this.__data__;if(un){var r=t[e];return r===u?n:r}return ct.call(t,e)?t[e]:n}function Nr(e){var t=this.__data__;return un?t[e]!==n:ct.call(t,e)}function Tr(e,t){var r=this.__data__;this.size+=this.has(e)?0:1;r[e]=un&&t===n?u:t;return this}Cr.prototype.clear=Mr;Cr.prototype["delete"]=jr;Cr.prototype.get=Fr;Cr.prototype.has=Nr;Cr.prototype.set=Tr;function zr(e){var t=-1,n=e==null?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function Rr(){this.__data__=[];this.size=0}function Pr(e){var t=this.__data__,n=si(t,e);if(n<0){return false}var r=t.length-1;if(n==r){t.pop()}else{Ot.call(t,n,1)}--this.size;return true}function Lr(e){var t=this.__data__,r=si(t,e);return r<0?n:t[r][1]}function Ir(e){return si(this.__data__,e)>-1}function Br(e,t){var n=this.__data__,r=si(n,e);if(r<0){++this.size;n.push([e,t])}else{n[r][1]=t}return this}zr.prototype.clear=Rr;zr.prototype["delete"]=Pr;zr.prototype.get=Lr;zr.prototype.has=Ir;zr.prototype.set=Br;function Ur(e){var t=-1,n=e==null?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function qr(){this.size=0;this.__data__={hash:new Cr,map:new(Kt||zr),string:new Cr}}function Wr(e){var t=Wo(this,e)["delete"](e);this.size-=t?1:0;return t}function Hr(e){return Wo(this,e).get(e)}function $r(e){return Wo(this,e).has(e)}function Gr(e,t){var n=Wo(this,e),r=n.size;n.set(e,t);this.size+=n.size==r?0:1;return this}Ur.prototype.clear=qr;Ur.prototype["delete"]=Wr;Ur.prototype.get=Hr;Ur.prototype.has=$r;Ur.prototype.set=Gr;function Vr(e){var t=-1,n=e==null?0:e.length;this.__data__=new Ur;while(++t<n){this.add(e[t])}}function Yr(e){this.__data__.set(e,u);return this}function Xr(e){return this.__data__.has(e)}Vr.prototype.add=Vr.prototype.push=Yr;Vr.prototype.has=Xr;function Jr(e){var t=this.__data__=new zr(e);this.size=t.size}function Zr(){this.__data__=new zr;this.size=0}function Qr(e){var t=this.__data__,n=t["delete"](e);this.size=t.size;return n}function Kr(e){return this.__data__.get(e)}function ei(e){return this.__data__.has(e)}function ti(e,t){var n=this.__data__;if(n instanceof zr){var r=n.__data__;if(!Kt||r.length<i-1){r.push([e,t]);this.size=++n.size;return this}n=this.__data__=new Ur(r)}n.set(e,t);this.size=n.size;return this}Jr.prototype.clear=Zr;Jr.prototype["delete"]=Qr;Jr.prototype.get=Kr;Jr.prototype.has=ei;Jr.prototype.set=ti;function ni(e,t){var n=uf(e),r=!n&&of(e),i=!n&&!r&&df(e),a=!n&&!r&&!i&&If(e),o=n||r||i||a,u=o?Hn(e.length,it):[],s=u.length;for(var l in e){if((t||ct.call(e,l))&&!(o&&(l=="length"||i&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||iu(l,s)))){u.push(l)}}return u}function ri(e){var t=e.length;return t?e[va(0,t-1)]:n}function ii(e,t){return Su(to(e),pi(t,0,e.length))}function ai(e){return Su(to(e))}function oi(e,t,r){if(r!==n&&!nf(e[t],r)||r===n&&!(t in e)){di(e,t,r)}}function ui(e,t,r){var i=e[t];if(!(ct.call(e,t)&&nf(i,r))||r===n&&!(t in e)){di(e,t,r)}}function si(e,t){var n=e.length;while(n--){if(nf(e[n][0],t)){return n}}return-1}function li(e,t,n,r){xi(e,(function(e,i,a){t(r,e,n(e),a)}));return r}function fi(e,t){return e&&no(t,_c(t),e)}function ci(e,t){return e&&no(t,wc(t),e)}function di(e,t,n){if(t=="__proto__"&&Ct){Ct(e,t,{configurable:true,enumerable:true,value:n,writable:true})}else{e[t]=n}}function hi(e,t){var r=-1,i=t.length,a=be(i),o=e==null;while(++r<i){a[r]=o?n:vc(e,t[r])}return a}function pi(e,t,r){if(e===e){if(r!==n){e=e<=r?e:r}if(t!==n){e=e>=t?e:t}}return e}function vi(e,t,r,i,a,o){var u,s=t&f,l=t&c,h=t&d;if(r){u=a?r(e,i,a,o):r(e)}if(u!==n){return u}if(!kf(e)){return e}var p=uf(e);if(p){u=Ko(e);if(!s){return to(e,u)}}else{var v=Xo(e),g=v==V||v==Y;if(df(e)){return $a(e,s)}if(v==Q||v==B||g&&!a){u=l||g?{}:eu(e);if(!s){return l?io(e,ci(u,e)):ro(e,fi(u,e))}}else{if(!Xt[v]){return a?e:{}}u=tu(e,v,s)}}o||(o=new Jr);var m=o.get(e);if(m){return m}o.set(e,u);if(Rf(e)){e.forEach((function(n){u.add(vi(n,t,r,n,e,o))}))}else if(Of(e)){e.forEach((function(n,i){u.set(i,vi(n,t,r,i,e,o))}))}var y=h?l?Lo:Po:l?wc:_c;var b=p?n:y(e);bn(b||e,(function(n,i){if(b){i=n;n=e[i]}ui(u,i,vi(n,t,r,i,e,o))}));return u}function gi(e){var t=_c(e);return function(n){return mi(n,e,t)}}function mi(e,t,r){var i=r.length;if(e==null){return!i}e=nt(e);while(i--){var a=r[i],o=t[a],u=e[a];if(u===n&&!(a in e)||!o(u)){return false}}return true}function yi(e,t,r){if(typeof e!="function"){throw new at(o)}return ku((function(){e.apply(n,r)}),t)}function bi(e,t,n,r){var a=-1,o=kn,u=true,s=e.length,l=[],f=t.length;if(!s){return l}if(n){t=On(t,Gn(n))}if(r){o=En;u=false}else if(t.length>=i){o=Yn;u=false;t=new Vr(t)}e:while(++a<s){var c=e[a],d=n==null?c:n(c);c=r||c!==0?c:0;if(u&&d===d){var h=f;while(h--){if(t[h]===d){continue e}}l.push(c)}else if(!o(t,d,r)){l.push(c)}}return l}var xi=uo(Ci);var _i=uo(Mi,true);function wi(e,t){var n=true;xi(e,(function(e,r,i){n=!!t(e,r,i);return n}));return n}function ki(e,t,r){var i=-1,a=e.length;while(++i<a){var o=e[i],u=t(o);if(u!=null&&(s===n?u===u&&!Lf(u):r(u,s))){var s=u,l=o}}return l}function Ei(e,t,r,i){var a=e.length;r=Vf(r);if(r<0){r=-r>a?0:a+r}i=i===n||i>a?a:Vf(i);if(i<0){i+=a}i=r>i?0:Yf(i);while(r<i){e[r++]=t}return e}function Oi(e,t){var n=[];xi(e,(function(e,r,i){if(t(e,r,i)){n.push(e)}}));return n}function Ai(e,t,n,r,i){var a=-1,o=e.length;n||(n=ru);i||(i=[]);while(++a<o){var u=e[a];if(t>0&&n(u)){if(t>1){Ai(u,t-1,n,r,i)}else{An(i,u)}}else if(!r){i[i.length]=u}}return i}var Si=so();var Di=so(true);function Ci(e,t){return e&&Si(e,t,_c)}function Mi(e,t){return e&&Di(e,t,_c)}function ji(e,t){return wn(t,(function(t){return xf(e[t])}))}function Fi(e,t){t=Ua(t,e);var r=0,i=t.length;while(e!=null&&r<i){e=e[Cu(t[r++])]}return r&&r==i?e:n}function Ni(e,t,n){var r=t(e);return uf(e)?r:An(r,n(e))}function Ti(e){if(e==null){return e===n?ae:Z}return Dt&&Dt in nt(e)?Go(e):mu(e)}function zi(e,t){return e>t}function Ri(e,t){return e!=null&&ct.call(e,t)}function Pi(e,t){return e!=null&&t in nt(e)}function Li(e,t,n){return e>=Wt(t,n)&&e<qt(t,n)}function Ii(e,t,r){var i=r?En:kn,a=e[0].length,o=e.length,u=o,s=be(o),l=Infinity,f=[];while(u--){var c=e[u];if(u&&t){c=On(c,Gn(t))}l=Wt(c.length,l);s[u]=!r&&(t||a>=120&&c.length>=120)?new Vr(u&&c):n}c=e[0];var d=-1,h=s[0];e:while(++d<a&&f.length<l){var p=c[d],v=t?t(p):p;p=r||p!==0?p:0;if(!(h?Yn(h,v):i(f,v,r))){u=o;while(--u){var g=s[u];if(!(g?Yn(g,v):i(e[u],v,r))){continue e}}if(h){h.push(v)}f.push(p)}}return f}function Bi(e,t,n,r){Ci(e,(function(e,i,a){t(r,n(e),i,a)}));return r}function Ui(e,t,r){t=Ua(t,e);e=bu(e,t);var i=e==null?e:e[Cu(rs(t))];return i==null?n:mn(i,e,r)}function qi(e){return Ef(e)&&Ti(e)==B}function Wi(e){return Ef(e)&&Ti(e)==se}function Hi(e){return Ef(e)&&Ti(e)==H}function $i(e,t,n,r,i){if(e===t){return true}if(e==null||t==null||!Ef(e)&&!Ef(t)){return e!==e&&t!==t}return Gi(e,t,n,r,$i,i)}function Gi(e,t,n,r,i,a){var o=uf(e),u=uf(t),s=o?U:Xo(e),l=u?U:Xo(t);s=s==B?Q:s;l=l==B?Q:l;var f=s==Q,c=l==Q,d=s==l;if(d&&df(e)){if(!df(t)){return false}o=true;f=false}if(d&&!f){a||(a=new Jr);return o||If(e)?No(e,t,n,r,i,a):To(e,t,s,n,r,i,a)}if(!(n&h)){var p=f&&ct.call(e,"__wrapped__"),v=c&&ct.call(t,"__wrapped__");if(p||v){var g=p?e.value():e,m=v?t.value():t;a||(a=new Jr);return i(g,m,n,r,a)}}if(!d){return false}a||(a=new Jr);return zo(e,t,n,r,i,a)}function Vi(e){return Ef(e)&&Xo(e)==X}function Yi(e,t,r,i){var a=r.length,o=a,u=!i;if(e==null){return!o}e=nt(e);while(a--){var s=r[a];if(u&&s[2]?s[1]!==e[s[0]]:!(s[0]in e)){return false}}while(++a<o){s=r[a];var l=s[0],f=e[l],c=s[1];if(u&&s[2]){if(f===n&&!(l in e)){return false}}else{var d=new Jr;if(i){var v=i(f,c,l,e,t,d)}if(!(v===n?$i(c,f,h|p,i,d):v)){return false}}}return true}function Xi(e){if(!kf(e)||lu(e)){return false}var t=xf(e)?mt:Ve;return t.test(Mu(e))}function Ji(e){return Ef(e)&&Ti(e)==te}function Zi(e){return Ef(e)&&Xo(e)==ne}function Qi(e){return Ef(e)&&wf(e.length)&&!!Yt[Ti(e)]}function Ki(e){if(typeof e=="function"){return e}if(e==null){return Cd}if(typeof e=="object"){return uf(e)?aa(e[0],e[1]):ia(e)}return qd(e)}function ea(e){if(!cu(e)){return It(e)}var t=[];for(var n in nt(e)){if(ct.call(e,n)&&n!="constructor"){t.push(n)}}return t}function ta(e){if(!kf(e)){return gu(e)}var t=cu(e),n=[];for(var r in e){if(!(r=="constructor"&&(t||!ct.call(e,r)))){n.push(r)}}return n}function na(e,t){return e<t}function ra(e,t){var n=-1,r=lf(e)?be(e.length):[];xi(e,(function(e,i,a){r[++n]=t(e,i,a)}));return r}function ia(e){var t=Ho(e);if(t.length==1&&t[0][2]){return hu(t[0][0],t[0][1])}return function(n){return n===e||Yi(n,e,t)}}function aa(e,t){if(ou(e)&&du(t)){return hu(Cu(e),t)}return function(r){var i=vc(r,e);return i===n&&i===t?mc(r,e):$i(t,i,h|p)}}function oa(e,t,r,i,a){if(e===t){return}Si(t,(function(o,u){a||(a=new Jr);if(kf(o)){ua(e,t,u,r,oa,i,a)}else{var s=i?i(_u(e,u),o,u+"",e,t,a):n;if(s===n){s=o}oi(e,u,s)}}),wc)}function ua(e,t,r,i,a,o,u){var s=_u(e,r),l=_u(t,r),f=u.get(l);if(f){oi(e,r,f);return}var c=o?o(s,l,r+"",e,t,u):n;var d=c===n;if(d){var h=uf(l),p=!h&&df(l),v=!h&&!p&&If(l);c=l;if(h||p||v){if(uf(s)){c=s}else if(ff(s)){c=to(s)}else if(p){d=false;c=$a(l,true)}else if(v){d=false;c=Ja(l,true)}else{c=[]}}else if(Nf(l)||of(l)){c=s;if(of(s)){c=Jf(s)}else if(!kf(s)||xf(s)){c=eu(l)}}else{d=false}}if(d){u.set(l,c);a(c,l,i,o,u);u["delete"](l)}oi(e,r,c)}function sa(e,t){var r=e.length;if(!r){return}t+=t<0?r:0;return iu(t,r)?e[t]:n}function la(e,t,n){if(t.length){t=On(t,(function(e){if(uf(e)){return function(t){return Fi(t,e.length===1?e[0]:e)}}return e}))}else{t=[Cd]}var r=-1;t=On(t,Gn(qo()));var i=ra(e,(function(e,n,i){var a=On(t,(function(t){return t(e)}));return{criteria:a,index:++r,value:e}}));return qn(i,(function(e,t){return Qa(e,t,n)}))}function fa(e,t){return ca(e,t,(function(t,n){return mc(e,n)}))}function ca(e,t,n){var r=-1,i=t.length,a={};while(++r<i){var o=t[r],u=Fi(e,o);if(n(u,o)){_a(a,Ua(o,e),u)}}return a}function da(e){return function(t){return Fi(t,e)}}function ha(e,t,n,r){var i=r?Rn:zn,a=-1,o=t.length,u=e;if(e===t){t=to(t)}if(n){u=On(e,Gn(n))}while(++a<o){var s=0,l=t[a],f=n?n(l):l;while((s=i(u,f,s,r))>-1){if(u!==e){Ot.call(u,s,1)}Ot.call(e,s,1)}}return e}function pa(e,t){var n=e?t.length:0,r=n-1;while(n--){var i=t[n];if(n==r||i!==a){var a=i;if(iu(i)){Ot.call(e,i,1)}else{Na(e,i)}}}return e}function va(e,t){return e+Tt(Jt()*(t-e+1))}function ga(e,t,n,r){var i=-1,a=qt(Nt((t-e)/(n||1)),0),o=be(a);while(a--){o[r?a:++i]=e;e+=n}return o}function ma(e,t){var n="";if(!e||t<1||t>N){return n}do{if(t%2){n+=e}t=Tt(t/2);if(t){e+=e}}while(t);return n}function ya(e,t){return Eu(yu(e,t,Cd),e+"")}function ba(e){return ri(Bc(e))}function xa(e,t){var n=Bc(e);return Su(n,pi(t,0,n.length))}function _a(e,t,r,i){if(!kf(e)){return e}t=Ua(t,e);var a=-1,o=t.length,u=o-1,s=e;while(s!=null&&++a<o){var l=Cu(t[a]),f=r;if(l==="__proto__"||l==="constructor"||l==="prototype"){return e}if(a!=u){var c=s[l];f=i?i(c,l,s):n;if(f===n){f=kf(c)?c:iu(t[a+1])?[]:{}}}ui(s,l,f);s=s[l]}return e}var wa=!ln?Cd:function(e,t){ln.set(e,t);return e};var ka=!Ct?Cd:function(e,t){return Ct(e,"toString",{configurable:true,enumerable:false,value:Od(t),writable:true})};function Ea(e){return Su(Bc(e))}function Oa(e,t,n){var r=-1,i=e.length;if(t<0){t=-t>i?0:i+t}n=n>i?i:n;if(n<0){n+=i}i=t>n?0:n-t>>>0;t>>>=0;var a=be(i);while(++r<i){a[r]=e[r+t]}return a}function Aa(e,t){var n;xi(e,(function(e,r,i){n=t(e,r,i);return!n}));return!!n}function Sa(e,t,n){var r=0,i=e==null?r:e.length;if(typeof t=="number"&&t===t&&i<=L){while(r<i){var a=r+i>>>1,o=e[a];if(o!==null&&!Lf(o)&&(n?o<=t:o<t)){r=a+1}else{i=a}}return i}return Da(e,t,Cd,n)}function Da(e,t,r,i){var a=0,o=e==null?0:e.length;if(o===0){return 0}t=r(t);var u=t!==t,s=t===null,l=Lf(t),f=t===n;while(a<o){var c=Tt((a+o)/2),d=r(e[c]),h=d!==n,p=d===null,v=d===d,g=Lf(d);if(u){var m=i||v}else if(f){m=v&&(i||h)}else if(s){m=v&&h&&(i||!p)}else if(l){m=v&&h&&!p&&(i||!g)}else if(p||g){m=false}else{m=i?d<=t:d<t}if(m){a=c+1}else{o=c}}return Wt(o,P)}function Ca(e,t){var n=-1,r=e.length,i=0,a=[];while(++n<r){var o=e[n],u=t?t(o):o;if(!n||!nf(u,s)){var s=u;a[i++]=o===0?0:o}}return a}function Ma(e){if(typeof e=="number"){return e}if(Lf(e)){return z}return+e}function ja(e){if(typeof e=="string"){return e}if(uf(e)){return On(e,ja)+""}if(Lf(e)){return xr?xr.call(e):""}var t=e+"";return t=="0"&&1/e==-F?"-0":t}function Fa(e,t,n){var r=-1,a=kn,o=e.length,u=true,s=[],l=s;if(n){u=false;a=En}else if(o>=i){var f=t?null:So(e);if(f){return sr(f)}u=false;a=Yn;l=new Vr}else{l=t?[]:s}e:while(++r<o){var c=e[r],d=t?t(c):c;c=n||c!==0?c:0;if(u&&d===d){var h=l.length;while(h--){if(l[h]===d){continue e}}if(t){l.push(d)}s.push(c)}else if(!a(l,d,n)){if(l!==s){l.push(d)}s.push(c)}}return s}function Na(e,t){t=Ua(t,e);e=bu(e,t);return e==null||delete e[Cu(rs(t))]}function Ta(e,t,n,r){return _a(e,t,n(Fi(e,t)),r)}function za(e,t,n,r){var i=e.length,a=r?i:-1;while((r?a--:++a<i)&&t(e[a],a,e)){}return n?Oa(e,r?0:a,r?a+1:i):Oa(e,r?a+1:0,r?i:a)}function Ra(e,t){var n=e;if(n instanceof Or){n=n.value()}return Sn(t,(function(e,t){return t.func.apply(t.thisArg,An([e],t.args))}),n)}function Pa(e,t,n){var r=e.length;if(r<2){return r?Fa(e[0]):[]}var i=-1,a=be(r);while(++i<r){var o=e[i],u=-1;while(++u<r){if(u!=i){a[i]=bi(a[i]||o,e[u],t,n)}}}return Fa(Ai(a,1),t,n)}function La(e,t,r){var i=-1,a=e.length,o=t.length,u={};while(++i<a){var s=i<o?t[i]:n;r(u,e[i],s)}return u}function Ia(e){return ff(e)?e:[]}function Ba(e){return typeof e=="function"?e:Cd}function Ua(e,t){if(uf(e)){return e}return ou(e,t)?[e]:Du(Qf(e))}var qa=ya;function Wa(e,t,r){var i=e.length;r=r===n?i:r;return!t&&r>=i?e:Oa(e,t,r)}var Ha=Mt||function(e){return an.clearTimeout(e)};function $a(e,t){if(t){return e.slice()}var n=e.length,r=_t?_t(n):new e.constructor(n);e.copy(r);return r}function Ga(e){var t=new e.constructor(e.byteLength);new xt(t).set(new xt(e));return t}function Va(e,t){var n=t?Ga(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Ya(e){var t=new e.constructor(e.source,He.exec(e));t.lastIndex=e.lastIndex;return t}function Xa(e){return yr?nt(yr.call(e)):{}}function Ja(e,t){var n=t?Ga(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Za(e,t){if(e!==t){var r=e!==n,i=e===null,a=e===e,o=Lf(e);var u=t!==n,s=t===null,l=t===t,f=Lf(t);if(!s&&!f&&!o&&e>t||o&&u&&l&&!s&&!f||i&&u&&l||!r&&l||!a){return 1}if(!i&&!o&&!f&&e<t||f&&r&&a&&!i&&!o||s&&r&&a||!u&&a||!l){return-1}}return 0}function Qa(e,t,n){var r=-1,i=e.criteria,a=t.criteria,o=i.length,u=n.length;while(++r<o){var s=Za(i[r],a[r]);if(s){if(r>=u){return s}var l=n[r];return s*(l=="desc"?-1:1)}}return e.index-t.index}function Ka(e,t,n,r){var i=-1,a=e.length,o=n.length,u=-1,s=t.length,l=qt(a-o,0),f=be(s+l),c=!r;while(++u<s){f[u]=t[u]}while(++i<o){if(c||i<a){f[n[i]]=e[i]}}while(l--){f[u++]=e[i++]}return f}function eo(e,t,n,r){var i=-1,a=e.length,o=-1,u=n.length,s=-1,l=t.length,f=qt(a-u,0),c=be(f+l),d=!r;while(++i<f){c[i]=e[i]}var h=i;while(++s<l){c[h+s]=t[s]}while(++o<u){if(d||i<a){c[h+n[o]]=e[i++]}}return c}function to(e,t){var n=-1,r=e.length;t||(t=be(r));while(++n<r){t[n]=e[n]}return t}function no(e,t,r,i){var a=!r;r||(r={});var o=-1,u=t.length;while(++o<u){var s=t[o];var l=i?i(r[s],e[s],s,r,e):n;if(l===n){l=e[s]}if(a){di(r,s,l)}else{ui(r,s,l)}}return r}function ro(e,t){return no(e,Vo(e),t)}function io(e,t){return no(e,Yo(e),t)}function ao(e,t){return function(n,r){var i=uf(n)?yn:li,a=t?t():{};return i(n,e,qo(r,2),a)}}function oo(e){return ya((function(t,r){var i=-1,a=r.length,o=a>1?r[a-1]:n,u=a>2?r[2]:n;o=e.length>3&&typeof o=="function"?(a--,o):n;if(u&&au(r[0],r[1],u)){o=a<3?n:o;a=1}t=nt(t);while(++i<a){var s=r[i];if(s){e(t,s,i,o)}}return t}))}function uo(e,t){return function(n,r){if(n==null){return n}if(!lf(n)){return e(n,r)}var i=n.length,a=t?i:-1,o=nt(n);while(t?a--:++a<i){if(r(o[a],a,o)===false){break}}return n}}function so(e){return function(t,n,r){var i=-1,a=nt(t),o=r(t),u=o.length;while(u--){var s=o[e?u:++i];if(n(a[s],s,a)===false){break}}return t}}function lo(e,t,n){var r=t&v,i=ho(e);function a(){var t=this&&this!==an&&this instanceof a?i:e;return t.apply(r?n:this,arguments)}return a}function fo(e){return function(t){t=Qf(t);var r=nr(t)?hr(t):n;var i=r?r[0]:t.charAt(0);var a=r?Wa(r,1).join(""):t.slice(1);return i[e]()+a}}function co(e){return function(t){return Sn(xd(Vc(t).replace(Bt,"")),e,"")}}function ho(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=wr(e.prototype),r=e.apply(n,t);return kf(r)?r:n}}function po(e,t,r){var i=ho(e);function a(){var o=arguments.length,u=be(o),s=o,l=Uo(a);while(s--){u[s]=arguments[s]}var f=o<3&&u[0]!==l&&u[o-1]!==l?[]:ur(u,l);o-=f.length;if(o<r){return Oo(e,t,mo,a.placeholder,n,u,f,n,n,r-o)}var c=this&&this!==an&&this instanceof a?i:e;return mn(c,this,u)}return a}function vo(e){return function(t,r,i){var a=nt(t);if(!lf(t)){var o=qo(r,3);t=_c(t);r=function(e){return o(a[e],e,a)}}var u=e(t,r,i);return u>-1?a[o?t[u]:u]:n}}function go(e){return Ro((function(t){var r=t.length,i=r,a=Er.prototype.thru;if(e){t.reverse()}while(i--){var u=t[i];if(typeof u!="function"){throw new at(o)}if(a&&!s&&Bo(u)=="wrapper"){var s=new Er([],true)}}i=s?i:r;while(++i<r){u=t[i];var l=Bo(u),f=l=="wrapper"?Io(u):n;if(f&&su(f[0])&&f[1]==(w|y|x|k)&&!f[4].length&&f[9]==1){s=s[Bo(f[0])].apply(s,f[3])}else{s=u.length==1&&su(u)?s[l]():s.thru(u)}}return function(){var e=arguments,n=e[0];if(s&&e.length==1&&uf(n)){return s.plant(n).value()}var i=0,a=r?t[i].apply(this,e):n;while(++i<r){a=t[i].call(this,a)}return a}}))}function mo(e,t,r,i,a,o,u,s,l,f){var c=t&w,d=t&v,h=t&g,p=t&(y|b),m=t&E,x=h?n:ho(e);function _(){var n=arguments.length,v=be(n),g=n;while(g--){v[g]=arguments[g]}if(p){var y=Uo(_),b=Zn(v,y)}if(i){v=Ka(v,i,a,p)}if(o){v=eo(v,o,u,p)}n-=b;if(p&&n<f){var w=ur(v,y);return Oo(e,t,mo,_.placeholder,r,v,w,s,l,f-n)}var k=d?r:this,E=h?k[e]:e;n=v.length;if(s){v=xu(v,s)}else if(m&&n>1){v.reverse()}if(c&&l<n){v.length=l}if(this&&this!==an&&this instanceof _){E=x||ho(E)}return E.apply(k,v)}return _}function yo(e,t){return function(n,r){return Bi(n,e,t(r),{})}}function bo(e,t){return function(r,i){var a;if(r===n&&i===n){return t}if(r!==n){a=r}if(i!==n){if(a===n){return i}if(typeof r=="string"||typeof i=="string"){r=ja(r);i=ja(i)}else{r=Ma(r);i=Ma(i)}a=e(r,i)}return a}}function xo(e){return Ro((function(t){t=On(t,Gn(qo()));return ya((function(n){var r=this;return e(t,(function(e){return mn(e,r,n)}))}))}))}function _o(e,t){t=t===n?" ":ja(t);var r=t.length;if(r<2){return r?ma(t,e):t}var i=ma(t,Nt(e/dr(t)));return nr(t)?Wa(hr(i),0,e).join(""):i.slice(0,e)}function wo(e,t,n,r){var i=t&v,a=ho(e);function o(){var t=-1,u=arguments.length,s=-1,l=r.length,f=be(l+u),c=this&&this!==an&&this instanceof o?a:e;while(++s<l){f[s]=r[s]}while(u--){f[s++]=arguments[++t]}return mn(c,i?n:this,f)}return o}function ko(e){return function(t,r,i){if(i&&typeof i!="number"&&au(t,r,i)){r=i=n}t=Gf(t);if(r===n){r=t;t=0}else{r=Gf(r)}i=i===n?t<r?1:-1:Gf(i);return ga(t,r,i,e)}}function Eo(e){return function(t,n){if(!(typeof t=="string"&&typeof n=="string")){t=Xf(t);n=Xf(n)}return e(t,n)}}function Oo(e,t,r,i,a,o,u,s,l,f){var c=t&y,d=c?u:n,h=c?n:u,p=c?o:n,b=c?n:o;t|=c?x:_;t&=~(c?_:x);if(!(t&m)){t&=~(v|g)}var w=[e,t,a,p,d,b,h,s,l,f];var k=r.apply(n,w);if(su(e)){wu(k,w)}k.placeholder=i;return Ou(k,e,t)}function Ao(e){var t=tt[e];return function(e,n){e=Xf(e);n=n==null?0:Wt(Vf(n),292);if(n&&Pt(e)){var r=(Qf(e)+"e").split("e"),i=t(r[0]+"e"+(+r[1]+n));r=(Qf(i)+"e").split("e");return+(r[0]+"e"+(+r[1]-n))}return t(e)}}var So=!(rn&&1/sr(new rn([,-0]))[1]==F)?Pd:function(e){return new rn(e)};function Do(e){return function(t){var n=Xo(t);if(n==X){return ar(t)}if(n==ne){return lr(t)}return $n(t,e(t))}}function Co(e,t,r,i,a,u,s,l){var f=t&g;if(!f&&typeof e!="function"){throw new at(o)}var c=i?i.length:0;if(!c){t&=~(x|_);i=a=n}s=s===n?s:qt(Vf(s),0);l=l===n?l:Vf(l);c-=a?a.length:0;if(t&_){var d=i,h=a;i=a=n}var p=f?n:Io(e);var m=[e,t,r,i,a,d,h,u,s,l];if(p){vu(m,p)}e=m[0];t=m[1];r=m[2];i=m[3];a=m[4];l=m[9]=m[9]===n?f?0:e.length:qt(m[9]-c,0);if(!l&&t&(y|b)){t&=~(y|b)}if(!t||t==v){var w=lo(e,t,r)}else if(t==y||t==b){w=po(e,t,l)}else if((t==x||t==(v|x))&&!a.length){w=wo(e,t,r,i)}else{w=mo.apply(n,m)}var k=p?wa:wu;return Ou(k(w,m),e,t)}function Mo(e,t,r,i){if(e===n||nf(e,st[r])&&!ct.call(i,r)){return t}return e}function jo(e,t,r,i,a,o){if(kf(e)&&kf(t)){o.set(t,e);oa(e,t,n,jo,o);o["delete"](t)}return e}function Fo(e){return Nf(e)?n:e}function No(e,t,r,i,a,o){var u=r&h,s=e.length,l=t.length;if(s!=l&&!(u&&l>s)){return false}var f=o.get(e);var c=o.get(t);if(f&&c){return f==t&&c==e}var d=-1,v=true,g=r&p?new Vr:n;o.set(e,t);o.set(t,e);while(++d<s){var m=e[d],y=t[d];if(i){var b=u?i(y,m,d,t,e,o):i(m,y,d,e,t,o)}if(b!==n){if(b){continue}v=false;break}if(g){if(!Cn(t,(function(e,t){if(!Yn(g,t)&&(m===e||a(m,e,r,i,o))){return g.push(t)}}))){v=false;break}}else if(!(m===y||a(m,y,r,i,o))){v=false;break}}o["delete"](e);o["delete"](t);return v}function To(e,t,n,r,i,a,o){switch(n){case le:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case se:if(e.byteLength!=t.byteLength||!a(new xt(e),new xt(t))){return false}return true;case W:case H:case J:return nf(+e,+t);case G:return e.name==t.name&&e.message==t.message;case te:case re:return e==t+"";case X:var u=ar;case ne:var s=r&h;u||(u=sr);if(e.size!=t.size&&!s){return false}var l=o.get(e);if(l){return l==t}r|=p;o.set(e,t);var f=No(u(e),u(t),r,i,a,o);o["delete"](e);return f;case ie:if(yr){return yr.call(e)==yr.call(t)}}return false}function zo(e,t,r,i,a,o){var u=r&h,s=Po(e),l=s.length,f=Po(t),c=f.length;if(l!=c&&!u){return false}var d=l;while(d--){var p=s[d];if(!(u?p in t:ct.call(t,p))){return false}}var v=o.get(e);var g=o.get(t);if(v&&g){return v==t&&g==e}var m=true;o.set(e,t);o.set(t,e);var y=u;while(++d<l){p=s[d];var b=e[p],x=t[p];if(i){var _=u?i(x,b,p,t,e,o):i(b,x,p,e,t,o)}if(!(_===n?b===x||a(b,x,r,i,o):_)){m=false;break}y||(y=p=="constructor")}if(m&&!y){var w=e.constructor,k=t.constructor;if(w!=k&&("constructor"in e&&"constructor"in t)&&!(typeof w=="function"&&w instanceof w&&typeof k=="function"&&k instanceof k)){m=false}}o["delete"](e);o["delete"](t);return m}function Ro(e){return Eu(yu(e,n,Gu),e+"")}function Po(e){return Ni(e,_c,Vo)}function Lo(e){return Ni(e,wc,Yo)}var Io=!ln?Pd:function(e){return ln.get(e)};function Bo(e){var t=e.name+"",n=fn[t],r=ct.call(fn,t)?n.length:0;while(r--){var i=n[r],a=i.func;if(a==null||a==e){return i.name}}return t}function Uo(e){var t=ct.call(_r,"placeholder")?_r:e;return t.placeholder}function qo(){var e=_r.iteratee||Md;e=e===Md?Ki:e;return arguments.length?e(arguments[0],arguments[1]):e}function Wo(e,t){var n=e.__data__;return uu(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Ho(e){var t=_c(e),n=t.length;while(n--){var r=t[n],i=e[r];t[n]=[r,i,du(i)]}return t}function $o(e,t){var r=tr(e,t);return Xi(r)?r:n}function Go(e){var t=ct.call(e,Dt),r=e[Dt];try{e[Dt]=n;var i=true}catch(o){}var a=pt.call(e);if(i){if(t){e[Dt]=r}else{delete e[Dt]}}return a}var Vo=!zt?Gd:function(e){if(e==null){return[]}e=nt(e);return wn(zt(e),(function(t){return Et.call(e,t)}))};var Yo=!zt?Gd:function(e){var t=[];while(e){An(t,Vo(e));e=wt(e)}return t};var Xo=Ti;if(Qt&&Xo(new Qt(new ArrayBuffer(1)))!=le||Kt&&Xo(new Kt)!=X||nn&&Xo(nn.resolve())!=K||rn&&Xo(new rn)!=ne||on&&Xo(new on)!=oe){Xo=function(e){var t=Ti(e),r=t==Q?e.constructor:n,i=r?Mu(r):"";if(i){switch(i){case Mn:return le;case jn:return X;case Bn:return K;case fr:return ne;case vr:return oe}}return t}}function Jo(e,t,n){var r=-1,i=n.length;while(++r<i){var a=n[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=Wt(t,e+o);break;case"takeRight":e=qt(e,t-o);break}}return{start:e,end:t}}function Zo(e){var t=e.match(Ie);return t?t[1].split(Be):[]}function Qo(e,t,n){t=Ua(t,e);var r=-1,i=t.length,a=false;while(++r<i){var o=Cu(t[r]);if(!(a=e!=null&&n(e,o))){break}e=e[o]}if(a||++r!=i){return a}i=e==null?0:e.length;return!!i&&wf(i)&&iu(o,i)&&(uf(e)||of(e))}function Ko(e){var t=e.length,n=new e.constructor(t);if(t&&typeof e[0]=="string"&&ct.call(e,"index")){n.index=e.index;n.input=e.input}return n}function eu(e){return typeof e.constructor=="function"&&!cu(e)?wr(wt(e)):{}}function tu(e,t,n){var r=e.constructor;switch(t){case se:return Ga(e);case W:case H:return new r(+e);case le:return Va(e,n);case fe:case ce:case de:case he:case pe:case ve:case ge:case me:case ye:return Ja(e,n);case X:return new r;case J:case re:return new r(e);case te:return Ya(e);case ne:return new r;case ie:return Xa(e)}}function nu(e,t){var n=t.length;if(!n){return e}var r=n-1;t[r]=(n>1?"& ":"")+t[r];t=t.join(n>2?", ":" ");return e.replace(Le,"{\n/* [wrapped with "+t+"] */\n")}function ru(e){return uf(e)||of(e)||!!(At&&e&&e[At])}function iu(e,t){var n=typeof e;t=t==null?N:t;return!!t&&(n=="number"||n!="symbol"&&Xe.test(e))&&(e>-1&&e%1==0&&e<t)}function au(e,t,n){if(!kf(n)){return false}var r=typeof t;if(r=="number"?lf(n)&&iu(t,n.length):r=="string"&&t in n){return nf(n[t],e)}return false}function ou(e,t){if(uf(e)){return false}var n=typeof e;if(n=="number"||n=="symbol"||n=="boolean"||e==null||Lf(e)){return true}return je.test(e)||!Me.test(e)||t!=null&&e in nt(t)}function uu(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function su(e){var t=Bo(e),n=_r[t];if(typeof n!="function"||!(t in Or.prototype)){return false}if(e===n){return true}var r=Io(n);return!!r&&e===r[0]}function lu(e){return!!ht&&ht in e}var fu=lt?xf:Vd;function cu(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||st;return e===n}function du(e){return e===e&&!kf(e)}function hu(e,t){return function(r){if(r==null){return false}return r[e]===t&&(t!==n||e in nt(r))}}function pu(e){var t=Ll(e,(function(e){if(n.size===s){n.clear()}return e}));var n=t.cache;return t}function vu(e,t){var n=e[1],r=t[1],i=n|r,a=i<(v|g|w);var o=r==w&&n==y||r==w&&n==k&&e[7].length<=t[8]||r==(w|k)&&t[7].length<=t[8]&&n==y;if(!(a||o)){return e}if(r&v){e[2]=t[2];i|=n&v?0:m}var u=t[3];if(u){var s=e[3];e[3]=s?Ka(s,u,t[4]):u;e[4]=s?ur(e[3],l):t[4]}u=t[5];if(u){s=e[5];e[5]=s?eo(s,u,t[6]):u;e[6]=s?ur(e[5],l):t[6]}u=t[7];if(u){e[7]=u}if(r&w){e[8]=e[8]==null?t[8]:Wt(e[8],t[8])}if(e[9]==null){e[9]=t[9]}e[0]=t[0];e[1]=i;return e}function gu(e){var t=[];if(e!=null){for(var n in nt(e)){t.push(n)}}return t}function mu(e){return pt.call(e)}function yu(e,t,r){t=qt(t===n?e.length-1:t,0);return function(){var n=arguments,i=-1,a=qt(n.length-t,0),o=be(a);while(++i<a){o[i]=n[t+i]}i=-1;var u=be(t+1);while(++i<t){u[i]=n[i]}u[t]=r(o);return mn(e,this,u)}}function bu(e,t){return t.length<2?e:Fi(e,Oa(t,0,-1))}function xu(e,t){var r=e.length,i=Wt(t.length,r),a=to(e);while(i--){var o=t[i];e[i]=iu(o,r)?a[o]:n}return e}function _u(e,t){if(t==="constructor"&&typeof e[t]==="function"){return}if(t=="__proto__"){return}return e[t]}var wu=Au(wa);var ku=Ft||function(e,t){return an.setTimeout(e,t)};var Eu=Au(ka);function Ou(e,t,n){var r=t+"";return Eu(e,nu(r,ju(Zo(r),n)))}function Au(e){var t=0,r=0;return function(){var i=Ht(),a=D-(i-r);r=i;if(a>0){if(++t>=S){return arguments[0]}}else{t=0}return e.apply(n,arguments)}}function Su(e,t){var r=-1,i=e.length,a=i-1;t=t===n?i:t;while(++r<t){var o=va(r,a),u=e[o];e[o]=e[r];e[r]=u}e.length=t;return e}var Du=pu((function(e){var t=[];if(e.charCodeAt(0)===46){t.push("")}e.replace(Fe,(function(e,n,r,i){t.push(r?i.replace(qe,"$1"):n||e)}));return t}));function Cu(e){if(typeof e=="string"||Lf(e)){return e}var t=e+"";return t=="0"&&1/e==-F?"-0":t}function Mu(e){if(e!=null){try{return ft.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function ju(e,t){bn(I,(function(n){var r="_."+n[0];if(t&n[1]&&!kn(e,r)){e.push(r)}}));return e.sort()}function Fu(e){if(e instanceof Or){return e.clone()}var t=new Er(e.__wrapped__,e.__chain__);t.__actions__=to(e.__actions__);t.__index__=e.__index__;t.__values__=e.__values__;return t}function Nu(e,t,r){if(r?au(e,t,r):t===n){t=1}else{t=qt(Vf(t),0)}var i=e==null?0:e.length;if(!i||t<1){return[]}var a=0,o=0,u=be(Nt(i/t));while(a<i){u[o++]=Oa(e,a,a+=t)}return u}function Tu(e){var t=-1,n=e==null?0:e.length,r=0,i=[];while(++t<n){var a=e[t];if(a){i[r++]=a}}return i}function zu(){var e=arguments.length;if(!e){return[]}var t=be(e-1),n=arguments[0],r=e;while(r--){t[r-1]=arguments[r]}return An(uf(n)?to(n):[n],Ai(t,1))}var Ru=ya((function(e,t){return ff(e)?bi(e,Ai(t,1,ff,true)):[]}));var Pu=ya((function(e,t){var r=rs(t);if(ff(r)){r=n}return ff(e)?bi(e,Ai(t,1,ff,true),qo(r,2)):[]}));var Lu=ya((function(e,t){var r=rs(t);if(ff(r)){r=n}return ff(e)?bi(e,Ai(t,1,ff,true),n,r):[]}));function Iu(e,t,r){var i=e==null?0:e.length;if(!i){return[]}t=r||t===n?1:Vf(t);return Oa(e,t<0?0:t,i)}function Bu(e,t,r){var i=e==null?0:e.length;if(!i){return[]}t=r||t===n?1:Vf(t);t=i-t;return Oa(e,0,t<0?0:t)}function Uu(e,t){return e&&e.length?za(e,qo(t,3),true,true):[]}function qu(e,t){return e&&e.length?za(e,qo(t,3),true):[]}function Wu(e,t,n,r){var i=e==null?0:e.length;if(!i){return[]}if(n&&typeof n!="number"&&au(e,t,n)){n=0;r=i}return Ei(e,t,n,r)}function Hu(e,t,n){var r=e==null?0:e.length;if(!r){return-1}var i=n==null?0:Vf(n);if(i<0){i=qt(r+i,0)}return Tn(e,qo(t,3),i)}function $u(e,t,r){var i=e==null?0:e.length;if(!i){return-1}var a=i-1;if(r!==n){a=Vf(r);a=r<0?qt(i+a,0):Wt(a,i-1)}return Tn(e,qo(t,3),a,true)}function Gu(e){var t=e==null?0:e.length;return t?Ai(e,1):[]}function Vu(e){var t=e==null?0:e.length;return t?Ai(e,F):[]}function Yu(e,t){var r=e==null?0:e.length;if(!r){return[]}t=t===n?1:Vf(t);return Ai(e,t)}function Xu(e){var t=-1,n=e==null?0:e.length,r={};while(++t<n){var i=e[t];r[i[0]]=i[1]}return r}function Ju(e){return e&&e.length?e[0]:n}function Zu(e,t,n){var r=e==null?0:e.length;if(!r){return-1}var i=n==null?0:Vf(n);if(i<0){i=qt(r+i,0)}return zn(e,t,i)}function Qu(e){var t=e==null?0:e.length;return t?Oa(e,0,-1):[]}var Ku=ya((function(e){var t=On(e,Ia);return t.length&&t[0]===e[0]?Ii(t):[]}));var es=ya((function(e){var t=rs(e),r=On(e,Ia);if(t===rs(r)){t=n}else{r.pop()}return r.length&&r[0]===e[0]?Ii(r,qo(t,2)):[]}));var ts=ya((function(e){var t=rs(e),r=On(e,Ia);t=typeof t=="function"?t:n;if(t){r.pop()}return r.length&&r[0]===e[0]?Ii(r,n,t):[]}));function ns(e,t){return e==null?"":Lt.call(e,t)}function rs(e){var t=e==null?0:e.length;return t?e[t-1]:n}function is(e,t,r){var i=e==null?0:e.length;if(!i){return-1}var a=i;if(r!==n){a=Vf(r);a=a<0?qt(i+a,0):Wt(a,i-1)}return t===t?cr(e,t,a):Tn(e,Pn,a,true)}function as(e,t){return e&&e.length?sa(e,Vf(t)):n}var os=ya(us);function us(e,t){return e&&e.length&&t&&t.length?ha(e,t):e}function ss(e,t,n){return e&&e.length&&t&&t.length?ha(e,t,qo(n,2)):e}function ls(e,t,r){return e&&e.length&&t&&t.length?ha(e,t,n,r):e}var fs=Ro((function(e,t){var n=e==null?0:e.length,r=hi(e,t);pa(e,On(t,(function(e){return iu(e,n)?+e:e})).sort(Za));return r}));function cs(e,t){var n=[];if(!(e&&e.length)){return n}var r=-1,i=[],a=e.length;t=qo(t,3);while(++r<a){var o=e[r];if(t(o,r,e)){n.push(o);i.push(r)}}pa(e,i);return n}function ds(e){return e==null?e:Zt.call(e)}function hs(e,t,r){var i=e==null?0:e.length;if(!i){return[]}if(r&&typeof r!="number"&&au(e,t,r)){t=0;r=i}else{t=t==null?0:Vf(t);r=r===n?i:Vf(r)}return Oa(e,t,r)}function ps(e,t){return Sa(e,t)}function vs(e,t,n){return Da(e,t,qo(n,2))}function gs(e,t){var n=e==null?0:e.length;if(n){var r=Sa(e,t);if(r<n&&nf(e[r],t)){return r}}return-1}function ms(e,t){return Sa(e,t,true)}function ys(e,t,n){return Da(e,t,qo(n,2),true)}function bs(e,t){var n=e==null?0:e.length;if(n){var r=Sa(e,t,true)-1;if(nf(e[r],t)){return r}}return-1}function xs(e){return e&&e.length?Ca(e):[]}function _s(e,t){return e&&e.length?Ca(e,qo(t,2)):[]}function ws(e){var t=e==null?0:e.length;return t?Oa(e,1,t):[]}function ks(e,t,r){if(!(e&&e.length)){return[]}t=r||t===n?1:Vf(t);return Oa(e,0,t<0?0:t)}function Es(e,t,r){var i=e==null?0:e.length;if(!i){return[]}t=r||t===n?1:Vf(t);t=i-t;return Oa(e,t<0?0:t,i)}function Os(e,t){return e&&e.length?za(e,qo(t,3),false,true):[]}function As(e,t){return e&&e.length?za(e,qo(t,3)):[]}var Ss=ya((function(e){return Fa(Ai(e,1,ff,true))}));var Ds=ya((function(e){var t=rs(e);if(ff(t)){t=n}return Fa(Ai(e,1,ff,true),qo(t,2))}));var Cs=ya((function(e){var t=rs(e);t=typeof t=="function"?t:n;return Fa(Ai(e,1,ff,true),n,t)}));function Ms(e){return e&&e.length?Fa(e):[]}function js(e,t){return e&&e.length?Fa(e,qo(t,2)):[]}function Fs(e,t){t=typeof t=="function"?t:n;return e&&e.length?Fa(e,n,t):[]}function Ns(e){if(!(e&&e.length)){return[]}var t=0;e=wn(e,(function(e){if(ff(e)){t=qt(e.length,t);return true}}));return Hn(t,(function(t){return On(e,In(t))}))}function Ts(e,t){if(!(e&&e.length)){return[]}var r=Ns(e);if(t==null){return r}return On(r,(function(e){return mn(t,n,e)}))}var zs=ya((function(e,t){return ff(e)?bi(e,t):[]}));var Rs=ya((function(e){return Pa(wn(e,ff))}));var Ps=ya((function(e){var t=rs(e);if(ff(t)){t=n}return Pa(wn(e,ff),qo(t,2))}));var Ls=ya((function(e){var t=rs(e);t=typeof t=="function"?t:n;return Pa(wn(e,ff),n,t)}));var Is=ya(Ns);function Bs(e,t){return La(e||[],t||[],ui)}function Us(e,t){return La(e||[],t||[],_a)}var qs=ya((function(e){var t=e.length,r=t>1?e[t-1]:n;r=typeof r=="function"?(e.pop(),r):n;return Ts(e,r)}));function Ws(e){var t=_r(e);t.__chain__=true;return t}function Hs(e,t){t(e);return e}function $s(e,t){return t(e)}var Gs=Ro((function(e){var t=e.length,r=t?e[0]:0,i=this.__wrapped__,a=function(t){return hi(t,e)};if(t>1||this.__actions__.length||!(i instanceof Or)||!iu(r)){return this.thru(a)}i=i.slice(r,+r+(t?1:0));i.__actions__.push({func:$s,args:[a],thisArg:n});return new Er(i,this.__chain__).thru((function(e){if(t&&!e.length){e.push(n)}return e}))}));function Vs(){return Ws(this)}function Ys(){return new Er(this.value(),this.__chain__)}function Xs(){if(this.__values__===n){this.__values__=$f(this.value())}var e=this.__index__>=this.__values__.length,t=e?n:this.__values__[this.__index__++];return{done:e,value:t}}function Js(){return this}function Zs(e){var t,r=this;while(r instanceof kr){var i=Fu(r);i.__index__=0;i.__values__=n;if(t){a.__wrapped__=i}else{t=i}var a=i;r=r.__wrapped__}a.__wrapped__=e;return t}function Qs(){var e=this.__wrapped__;if(e instanceof Or){var t=e;if(this.__actions__.length){t=new Or(this)}t=t.reverse();t.__actions__.push({func:$s,args:[ds],thisArg:n});return new Er(t,this.__chain__)}return this.thru(ds)}function Ks(){return Ra(this.__wrapped__,this.__actions__)}var el=ao((function(e,t,n){if(ct.call(e,n)){++e[n]}else{di(e,n,1)}}));function tl(e,t,r){var i=uf(e)?_n:wi;if(r&&au(e,t,r)){t=n}return i(e,qo(t,3))}function nl(e,t){var n=uf(e)?wn:Oi;return n(e,qo(t,3))}var rl=vo(Hu);var il=vo($u);function al(e,t){return Ai(pl(e,t),1)}function ol(e,t){return Ai(pl(e,t),F)}function ul(e,t,r){r=r===n?1:Vf(r);return Ai(pl(e,t),r)}function sl(e,t){var n=uf(e)?bn:xi;return n(e,qo(t,3))}function ll(e,t){var n=uf(e)?xn:_i;return n(e,qo(t,3))}var fl=ao((function(e,t,n){if(ct.call(e,n)){e[n].push(t)}else{di(e,n,[t])}}));function cl(e,t,n,r){e=lf(e)?e:Bc(e);n=n&&!r?Vf(n):0;var i=e.length;if(n<0){n=qt(i+n,0)}return Pf(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&zn(e,t,n)>-1}var dl=ya((function(e,t,n){var r=-1,i=typeof t=="function",a=lf(e)?be(e.length):[];xi(e,(function(e){a[++r]=i?mn(t,e,n):Ui(e,t,n)}));return a}));var hl=ao((function(e,t,n){di(e,n,t)}));function pl(e,t){var n=uf(e)?On:ra;return n(e,qo(t,3))}function vl(e,t,r,i){if(e==null){return[]}if(!uf(t)){t=t==null?[]:[t]}r=i?n:r;if(!uf(r)){r=r==null?[]:[r]}return la(e,t,r)}var gl=ao((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));function ml(e,t,n){var r=uf(e)?Sn:Un,i=arguments.length<3;return r(e,qo(t,4),n,i,xi)}function yl(e,t,n){var r=uf(e)?Dn:Un,i=arguments.length<3;return r(e,qo(t,4),n,i,_i)}function bl(e,t){var n=uf(e)?wn:Oi;return n(e,Il(qo(t,3)))}function xl(e){var t=uf(e)?ri:ba;return t(e)}function _l(e,t,r){if(r?au(e,t,r):t===n){t=1}else{t=Vf(t)}var i=uf(e)?ii:xa;return i(e,t)}function wl(e){var t=uf(e)?ai:Ea;return t(e)}function kl(e){if(e==null){return 0}if(lf(e)){return Pf(e)?dr(e):e.length}var t=Xo(e);if(t==X||t==ne){return e.size}return ea(e).length}function El(e,t,r){var i=uf(e)?Cn:Aa;if(r&&au(e,t,r)){t=n}return i(e,qo(t,3))}var Ol=ya((function(e,t){if(e==null){return[]}var n=t.length;if(n>1&&au(e,t[0],t[1])){t=[]}else if(n>2&&au(t[0],t[1],t[2])){t=[t[0]]}return la(e,Ai(t,1),[])}));var Al=jt||function(){return an.Date.now()};function Sl(e,t){if(typeof t!="function"){throw new at(o)}e=Vf(e);return function(){if(--e<1){return t.apply(this,arguments)}}}function Dl(e,t,r){t=r?n:t;t=e&&t==null?e.length:t;return Co(e,w,n,n,n,n,t)}function Cl(e,t){var r;if(typeof t!="function"){throw new at(o)}e=Vf(e);return function(){if(--e>0){r=t.apply(this,arguments)}if(e<=1){t=n}return r}}var Ml=ya((function(e,t,n){var r=v;if(n.length){var i=ur(n,Uo(Ml));r|=x}return Co(e,r,t,n,i)}));var jl=ya((function(e,t,n){var r=v|g;if(n.length){var i=ur(n,Uo(jl));r|=x}return Co(t,r,e,n,i)}));function Fl(e,t,r){t=r?n:t;var i=Co(e,y,n,n,n,n,n,t);i.placeholder=Fl.placeholder;return i}function Nl(e,t,r){t=r?n:t;var i=Co(e,b,n,n,n,n,n,t);i.placeholder=Nl.placeholder;return i}function Tl(e,t,r){var i,a,u,s,l,f,c=0,d=false,h=false,p=true;if(typeof e!="function"){throw new at(o)}t=Xf(t)||0;if(kf(r)){d=!!r.leading;h="maxWait"in r;u=h?qt(Xf(r.maxWait)||0,t):u;p="trailing"in r?!!r.trailing:p}function v(t){var r=i,o=a;i=a=n;c=t;s=e.apply(o,r);return s}function g(e){c=e;l=ku(b,t);return d?v(e):s}function m(e){var n=e-f,r=e-c,i=t-n;return h?Wt(i,u-r):i}function y(e){var r=e-f,i=e-c;return f===n||r>=t||r<0||h&&i>=u}function b(){var e=Al();if(y(e)){return x(e)}l=ku(b,m(e))}function x(e){l=n;if(p&&i){return v(e)}i=a=n;return s}function _(){if(l!==n){Ha(l)}c=0;i=f=a=l=n}function w(){return l===n?s:x(Al())}function k(){var e=Al(),r=y(e);i=arguments;a=this;f=e;if(r){if(l===n){return g(f)}if(h){Ha(l);l=ku(b,t);return v(f)}}if(l===n){l=ku(b,t)}return s}k.cancel=_;k.flush=w;return k}var zl=ya((function(e,t){return yi(e,1,t)}));var Rl=ya((function(e,t,n){return yi(e,Xf(t)||0,n)}));function Pl(e){return Co(e,E)}function Ll(e,t){if(typeof e!="function"||t!=null&&typeof t!="function"){throw new at(o)}var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i)){return a.get(i)}var o=e.apply(this,r);n.cache=a.set(i,o)||a;return o};n.cache=new(Ll.Cache||Ur);return n}Ll.Cache=Ur;function Il(e){if(typeof e!="function"){throw new at(o)}return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Bl(e){return Cl(2,e)}var Ul=qa((function(e,t){t=t.length==1&&uf(t[0])?On(t[0],Gn(qo())):On(Ai(t,1),Gn(qo()));var n=t.length;return ya((function(r){var i=-1,a=Wt(r.length,n);while(++i<a){r[i]=t[i].call(this,r[i])}return mn(e,this,r)}))}));var ql=ya((function(e,t){var r=ur(t,Uo(ql));return Co(e,x,n,t,r)}));var Wl=ya((function(e,t){var r=ur(t,Uo(Wl));return Co(e,_,n,t,r)}));var Hl=Ro((function(e,t){return Co(e,k,n,n,n,t)}));function $l(e,t){if(typeof e!="function"){throw new at(o)}t=t===n?t:Vf(t);return ya(e,t)}function Gl(e,t){if(typeof e!="function"){throw new at(o)}t=t==null?0:qt(Vf(t),0);return ya((function(n){var r=n[t],i=Wa(n,0,t);if(r){An(i,r)}return mn(e,this,i)}))}function Vl(e,t,n){var r=true,i=true;if(typeof e!="function"){throw new at(o)}if(kf(n)){r="leading"in n?!!n.leading:r;i="trailing"in n?!!n.trailing:i}return Tl(e,t,{leading:r,maxWait:t,trailing:i})}function Yl(e){return Dl(e,1)}function Xl(e,t){return ql(Ba(t),e)}function Jl(){if(!arguments.length){return[]}var e=arguments[0];return uf(e)?e:[e]}function Zl(e){return vi(e,d)}function Ql(e,t){t=typeof t=="function"?t:n;return vi(e,d,t)}function Kl(e){return vi(e,f|d)}function ef(e,t){t=typeof t=="function"?t:n;return vi(e,f|d,t)}function tf(e,t){return t==null||mi(e,t,_c(t))}function nf(e,t){return e===t||e!==e&&t!==t}var rf=Eo(zi);var af=Eo((function(e,t){return e>=t}));var of=qi(function(){return arguments}())?qi:function(e){return Ef(e)&&ct.call(e,"callee")&&!Et.call(e,"callee")};var uf=be.isArray;var sf=cn?Gn(cn):Wi;function lf(e){return e!=null&&wf(e.length)&&!xf(e)}function ff(e){return Ef(e)&&lf(e)}function cf(e){return e===true||e===false||Ef(e)&&Ti(e)==W}var df=Rt||Vd;var hf=dn?Gn(dn):Hi;function pf(e){return Ef(e)&&e.nodeType===1&&!Nf(e)}function vf(e){if(e==null){return true}if(lf(e)&&(uf(e)||typeof e=="string"||typeof e.splice=="function"||df(e)||If(e)||of(e))){return!e.length}var t=Xo(e);if(t==X||t==ne){return!e.size}if(cu(e)){return!ea(e).length}for(var n in e){if(ct.call(e,n)){return false}}return true}function gf(e,t){return $i(e,t)}function mf(e,t,r){r=typeof r=="function"?r:n;var i=r?r(e,t):n;return i===n?$i(e,t,n,r):!!i}function yf(e){if(!Ef(e)){return false}var t=Ti(e);return t==G||t==$||typeof e.message=="string"&&typeof e.name=="string"&&!Nf(e)}function bf(e){return typeof e=="number"&&Pt(e)}function xf(e){if(!kf(e)){return false}var t=Ti(e);return t==V||t==Y||t==q||t==ee}function _f(e){return typeof e=="number"&&e==Vf(e)}function wf(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=N}function kf(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function Ef(e){return e!=null&&typeof e=="object"}var Of=hn?Gn(hn):Vi;function Af(e,t){return e===t||Yi(e,t,Ho(t))}function Sf(e,t,r){r=typeof r=="function"?r:n;return Yi(e,t,Ho(t),r)}function Df(e){return Ff(e)&&e!=+e}function Cf(e){if(fu(e)){throw new Ke(a)}return Xi(e)}function Mf(e){return e===null}function jf(e){return e==null}function Ff(e){return typeof e=="number"||Ef(e)&&Ti(e)==J}function Nf(e){if(!Ef(e)||Ti(e)!=Q){return false}var t=wt(e);if(t===null){return true}var n=ct.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&ft.call(n)==vt}var Tf=pn?Gn(pn):Ji;function zf(e){return _f(e)&&e>=-N&&e<=N}var Rf=vn?Gn(vn):Zi;function Pf(e){return typeof e=="string"||!uf(e)&&Ef(e)&&Ti(e)==re}function Lf(e){return typeof e=="symbol"||Ef(e)&&Ti(e)==ie}var If=gn?Gn(gn):Qi;function Bf(e){return e===n}function Uf(e){return Ef(e)&&Xo(e)==oe}function qf(e){return Ef(e)&&Ti(e)==ue}var Wf=Eo(na);var Hf=Eo((function(e,t){return e<=t}));function $f(e){if(!e){return[]}if(lf(e)){return Pf(e)?hr(e):to(e)}if(St&&e[St]){return ir(e[St]())}var t=Xo(e),n=t==X?ar:t==ne?sr:Bc;return n(e)}function Gf(e){if(!e){return e===0?e:0}e=Xf(e);if(e===F||e===-F){var t=e<0?-1:1;return t*T}return e===e?e:0}function Vf(e){var t=Gf(e),n=t%1;return t===t?n?t-n:t:0}function Yf(e){return e?pi(Vf(e),0,R):0}function Xf(e){if(typeof e=="number"){return e}if(Lf(e)){return z}if(kf(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=kf(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=e.replace(ze,"");var n=Ge.test(e);return n||Ye.test(e)?tn(e.slice(2),n?2:8):$e.test(e)?z:+e}function Jf(e){return no(e,wc(e))}function Zf(e){return e?pi(Vf(e),-N,N):e===0?e:0}function Qf(e){return e==null?"":ja(e)}var Kf=oo((function(e,t){if(cu(t)||lf(t)){no(t,_c(t),e);return}for(var n in t){if(ct.call(t,n)){ui(e,n,t[n])}}}));var ec=oo((function(e,t){no(t,wc(t),e)}));var tc=oo((function(e,t,n,r){no(t,wc(t),e,r)}));var nc=oo((function(e,t,n,r){no(t,_c(t),e,r)}));var rc=Ro(hi);function ic(e,t){var n=wr(e);return t==null?n:fi(n,t)}var ac=ya((function(e,t){e=nt(e);var r=-1;var i=t.length;var a=i>2?t[2]:n;if(a&&au(t[0],t[1],a)){i=1}while(++r<i){var o=t[r];var u=wc(o);var s=-1;var l=u.length;while(++s<l){var f=u[s];var c=e[f];if(c===n||nf(c,st[f])&&!ct.call(e,f)){e[f]=o[f]}}}return e}));var oc=ya((function(e){e.push(n,jo);return mn(Ac,n,e)}));function uc(e,t){return Nn(e,qo(t,3),Ci)}function sc(e,t){return Nn(e,qo(t,3),Mi)}function lc(e,t){return e==null?e:Si(e,qo(t,3),wc)}function fc(e,t){return e==null?e:Di(e,qo(t,3),wc)}function cc(e,t){return e&&Ci(e,qo(t,3))}function dc(e,t){return e&&Mi(e,qo(t,3))}function hc(e){return e==null?[]:ji(e,_c(e))}function pc(e){return e==null?[]:ji(e,wc(e))}function vc(e,t,r){var i=e==null?n:Fi(e,t);return i===n?r:i}function gc(e,t){return e!=null&&Qo(e,t,Ri)}function mc(e,t){return e!=null&&Qo(e,t,Pi)}var yc=yo((function(e,t,n){if(t!=null&&typeof t.toString!="function"){t=pt.call(t)}e[t]=n}),Od(Cd));var bc=yo((function(e,t,n){if(t!=null&&typeof t.toString!="function"){t=pt.call(t)}if(ct.call(e,t)){e[t].push(n)}else{e[t]=[n]}}),qo);var xc=ya(Ui);function _c(e){return lf(e)?ni(e):ea(e)}function wc(e){return lf(e)?ni(e,true):ta(e)}function kc(e,t){var n={};t=qo(t,3);Ci(e,(function(e,r,i){di(n,t(e,r,i),e)}));return n}function Ec(e,t){var n={};t=qo(t,3);Ci(e,(function(e,r,i){di(n,r,t(e,r,i))}));return n}var Oc=oo((function(e,t,n){oa(e,t,n)}));var Ac=oo((function(e,t,n,r){oa(e,t,n,r)}));var Sc=Ro((function(e,t){var n={};if(e==null){return n}var r=false;t=On(t,(function(t){t=Ua(t,e);r||(r=t.length>1);return t}));no(e,Lo(e),n);if(r){n=vi(n,f|c|d,Fo)}var i=t.length;while(i--){Na(n,t[i])}return n}));function Dc(e,t){return Mc(e,Il(qo(t)))}var Cc=Ro((function(e,t){return e==null?{}:fa(e,t)}));function Mc(e,t){if(e==null){return{}}var n=On(Lo(e),(function(e){return[e]}));t=qo(t);return ca(e,n,(function(e,n){return t(e,n[0])}))}function jc(e,t,r){t=Ua(t,e);var i=-1,a=t.length;if(!a){a=1;e=n}while(++i<a){var o=e==null?n:e[Cu(t[i])];if(o===n){i=a;o=r}e=xf(o)?o.call(e):o}return e}function Fc(e,t,n){return e==null?e:_a(e,t,n)}function Nc(e,t,r,i){i=typeof i=="function"?i:n;return e==null?e:_a(e,t,r,i)}var Tc=Do(_c);var zc=Do(wc);function Rc(e,t,n){var r=uf(e),i=r||df(e)||If(e);t=qo(t,4);if(n==null){var a=e&&e.constructor;if(i){n=r?new a:[]}else if(kf(e)){n=xf(a)?wr(wt(e)):{}}else{n={}}}(i?bn:Ci)(e,(function(e,r,i){return t(n,e,r,i)}));return n}function Pc(e,t){return e==null?true:Na(e,t)}function Lc(e,t,n){return e==null?e:Ta(e,t,Ba(n))}function Ic(e,t,r,i){i=typeof i=="function"?i:n;return e==null?e:Ta(e,t,Ba(r),i)}function Bc(e){return e==null?[]:Vn(e,_c(e))}function Uc(e){return e==null?[]:Vn(e,wc(e))}function qc(e,t,r){if(r===n){r=t;t=n}if(r!==n){r=Xf(r);r=r===r?r:0}if(t!==n){t=Xf(t);t=t===t?t:0}return pi(Xf(e),t,r)}function Wc(e,t,r){t=Gf(t);if(r===n){r=t;t=0}else{r=Gf(r)}e=Xf(e);return Li(e,t,r)}function Hc(e,t,r){if(r&&typeof r!="boolean"&&au(e,t,r)){t=r=n}if(r===n){if(typeof t=="boolean"){r=t;t=n}else if(typeof e=="boolean"){r=e;e=n}}if(e===n&&t===n){e=0;t=1}else{e=Gf(e);if(t===n){t=e;e=0}else{t=Gf(t)}}if(e>t){var i=e;e=t;t=i}if(r||e%1||t%1){var a=Jt();return Wt(e+a*(t-e+en("1e-"+((a+"").length-1))),t)}return va(e,t)}var $c=co((function(e,t,n){t=t.toLowerCase();return e+(n?Gc(t):t)}));function Gc(e){return bd(Qf(e).toLowerCase())}function Vc(e){e=Qf(e);return e&&e.replace(Je,Qn).replace(Ut,"")}function Yc(e,t,r){e=Qf(e);t=ja(t);var i=e.length;r=r===n?i:pi(Vf(r),0,i);var a=r;r-=t.length;return r>=0&&e.slice(r,a)==t}function Xc(e){e=Qf(e);return e&&Ae.test(e)?e.replace(Ee,Kn):e}function Jc(e){e=Qf(e);return e&&Te.test(e)?e.replace(Ne,"\\$&"):e}var Zc=co((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}));var Qc=co((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}));var Kc=fo("toLowerCase");function ed(e,t,n){e=Qf(e);t=Vf(t);var r=t?dr(e):0;if(!t||r>=t){return e}var i=(t-r)/2;return _o(Tt(i),n)+e+_o(Nt(i),n)}function td(e,t,n){e=Qf(e);t=Vf(t);var r=t?dr(e):0;return t&&r<t?e+_o(t-r,n):e}function nd(e,t,n){e=Qf(e);t=Vf(t);var r=t?dr(e):0;return t&&r<t?_o(t-r,n)+e:e}function rd(e,t,n){if(n||t==null){t=0}else if(t){t=+t}return $t(Qf(e).replace(Re,""),t||0)}function id(e,t,r){if(r?au(e,t,r):t===n){t=1}else{t=Vf(t)}return ma(Qf(e),t)}function ad(){var e=arguments,t=Qf(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var od=co((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));function ud(e,t,r){if(r&&typeof r!="number"&&au(e,t,r)){t=r=n}r=r===n?R:r>>>0;if(!r){return[]}e=Qf(e);if(e&&(typeof t=="string"||t!=null&&!Tf(t))){t=ja(t);if(!t&&nr(e)){return Wa(hr(e),0,r)}}return e.split(t,r)}var sd=co((function(e,t,n){return e+(n?" ":"")+bd(t)}));function ld(e,t,n){e=Qf(e);n=n==null?0:pi(Vf(n),0,e.length);t=ja(t);return e.slice(n,n+t.length)==t}function fd(e,t,r){var i=_r.templateSettings;if(r&&au(e,t,r)){t=n}e=Qf(e);t=tc({},t,i,Mo);var a=tc({},t.imports,i.imports,Mo),o=_c(a),u=Vn(a,o);var s,l,f=0,c=t.interpolate||Ze,d="__p += '";var h=rt((t.escape||Ze).source+"|"+c.source+"|"+(c===Ce?We:Ze).source+"|"+(t.evaluate||Ze).source+"|$","g");var p="//# sourceURL="+(ct.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Vt+"]")+"\n";e.replace(h,(function(t,n,r,i,a,o){r||(r=i);d+=e.slice(f,o).replace(Qe,er);if(n){s=true;d+="' +\n__e("+n+") +\n'"}if(a){l=true;d+="';\n"+a+";\n__p += '"}if(r){d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"}f=o+t.length;return t}));d+="';\n";var v=ct.call(t,"variable")&&t.variable;if(!v){d="with (obj) {\n"+d+"\n}\n"}d=(l?d.replace(xe,""):d).replace(_e,"$1").replace(we,"$1;");d="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=_d((function(){return et(o,p+"return "+d).apply(n,u)}));g.source=d;if(yf(g)){throw g}return g}function cd(e){return Qf(e).toLowerCase()}function dd(e){return Qf(e).toUpperCase()}function hd(e,t,r){e=Qf(e);if(e&&(r||t===n)){return e.replace(ze,"")}if(!e||!(t=ja(t))){return e}var i=hr(e),a=hr(t),o=Xn(i,a),u=Jn(i,a)+1;return Wa(i,o,u).join("")}function pd(e,t,r){e=Qf(e);if(e&&(r||t===n)){return e.replace(Pe,"")}if(!e||!(t=ja(t))){return e}var i=hr(e),a=Jn(i,hr(t))+1;return Wa(i,0,a).join("")}function vd(e,t,r){e=Qf(e);if(e&&(r||t===n)){return e.replace(Re,"")}if(!e||!(t=ja(t))){return e}var i=hr(e),a=Xn(i,hr(t));return Wa(i,a).join("")}function gd(e,t){var r=O,i=A;if(kf(t)){var a="separator"in t?t.separator:a;r="length"in t?Vf(t.length):r;i="omission"in t?ja(t.omission):i}e=Qf(e);var o=e.length;if(nr(e)){var u=hr(e);o=u.length}if(r>=o){return e}var s=r-dr(i);if(s<1){return i}var l=u?Wa(u,0,s).join(""):e.slice(0,s);if(a===n){return l+i}if(u){s+=l.length-s}if(Tf(a)){if(e.slice(s).search(a)){var f,c=l;if(!a.global){a=rt(a.source,Qf(He.exec(a))+"g")}a.lastIndex=0;while(f=a.exec(c)){var d=f.index}l=l.slice(0,d===n?s:d)}}else if(e.indexOf(ja(a),s)!=s){var h=l.lastIndexOf(a);if(h>-1){l=l.slice(0,h)}}return l+i}function md(e){e=Qf(e);return e&&Oe.test(e)?e.replace(ke,pr):e}var yd=co((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}));var bd=fo("toUpperCase");function xd(e,t,r){e=Qf(e);t=r?n:t;if(t===n){return rr(e)?mr(e):Fn(e)}return e.match(t)||[]}var _d=ya((function(e,t){try{return mn(e,n,t)}catch(r){return yf(r)?r:new Ke(r)}}));var wd=Ro((function(e,t){bn(t,(function(t){t=Cu(t);di(e,t,Ml(e[t],e))}));return e}));function kd(e){var t=e==null?0:e.length,n=qo();e=!t?[]:On(e,(function(e){if(typeof e[1]!="function"){throw new at(o)}return[n(e[0]),e[1]]}));return ya((function(n){var r=-1;while(++r<t){var i=e[r];if(mn(i[0],this,n)){return mn(i[1],this,n)}}}))}function Ed(e){return gi(vi(e,f))}function Od(e){return function(){return e}}function Ad(e,t){return e==null||e!==e?t:e}var Sd=go();var Dd=go(true);function Cd(e){return e}function Md(e){return Ki(typeof e=="function"?e:vi(e,f))}function jd(e){return ia(vi(e,f))}function Fd(e,t){return aa(e,vi(t,f))}var Nd=ya((function(e,t){return function(n){return Ui(n,e,t)}}));var Td=ya((function(e,t){return function(n){return Ui(e,n,t)}}));function zd(e,t,n){var r=_c(t),i=ji(t,r);if(n==null&&!(kf(t)&&(i.length||!r.length))){n=t;t=e;e=this;i=ji(t,_c(t))}var a=!(kf(n)&&"chain"in n)||!!n.chain,o=xf(e);bn(i,(function(n){var r=t[n];e[n]=r;if(o){e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__),i=n.__actions__=to(this.__actions__);i.push({func:r,args:arguments,thisArg:e});n.__chain__=t;return n}return r.apply(e,An([this.value()],arguments))}}}));return e}function Rd(){if(an._===this){an._=gt}return this}function Pd(){}function Ld(e){e=Vf(e);return ya((function(t){return sa(t,e)}))}var Id=xo(On);var Bd=xo(_n);var Ud=xo(Cn);function qd(e){return ou(e)?In(Cu(e)):da(e)}function Wd(e){return function(t){return e==null?n:Fi(e,t)}}var Hd=ko();var $d=ko(true);function Gd(){return[]}function Vd(){return false}function Yd(){return{}}function Xd(){return""}function Jd(){return true}function Zd(e,t){e=Vf(e);if(e<1||e>N){return[]}var n=R,r=Wt(e,R);t=qo(t);e-=R;var i=Hn(r,t);while(++n<e){t(n)}return i}function Qd(e){if(uf(e)){return On(e,Cu)}return Lf(e)?[e]:to(Du(Qf(e)))}function Kd(e){var t=++dt;return Qf(e)+t}var eh=bo((function(e,t){return e+t}),0);var th=Ao("ceil");var nh=bo((function(e,t){return e/t}),1);var rh=Ao("floor");function ih(e){return e&&e.length?ki(e,Cd,zi):n}function ah(e,t){return e&&e.length?ki(e,qo(t,2),zi):n}function oh(e){return Ln(e,Cd)}function uh(e,t){return Ln(e,qo(t,2))}function sh(e){return e&&e.length?ki(e,Cd,na):n}function lh(e,t){return e&&e.length?ki(e,qo(t,2),na):n}var fh=bo((function(e,t){return e*t}),1);var ch=Ao("round");var dh=bo((function(e,t){return e-t}),0);function hh(e){return e&&e.length?Wn(e,Cd):0}function ph(e,t){return e&&e.length?Wn(e,qo(t,2)):0}_r.after=Sl;_r.ary=Dl;_r.assign=Kf;_r.assignIn=ec;_r.assignInWith=tc;_r.assignWith=nc;_r.at=rc;_r.before=Cl;_r.bind=Ml;_r.bindAll=wd;_r.bindKey=jl;_r.castArray=Jl;_r.chain=Ws;_r.chunk=Nu;_r.compact=Tu;_r.concat=zu;_r.cond=kd;_r.conforms=Ed;_r.constant=Od;_r.countBy=el;_r.create=ic;_r.curry=Fl;_r.curryRight=Nl;_r.debounce=Tl;_r.defaults=ac;_r.defaultsDeep=oc;_r.defer=zl;_r.delay=Rl;_r.difference=Ru;_r.differenceBy=Pu;_r.differenceWith=Lu;_r.drop=Iu;_r.dropRight=Bu;_r.dropRightWhile=Uu;_r.dropWhile=qu;_r.fill=Wu;_r.filter=nl;_r.flatMap=al;_r.flatMapDeep=ol;_r.flatMapDepth=ul;_r.flatten=Gu;_r.flattenDeep=Vu;_r.flattenDepth=Yu;_r.flip=Pl;_r.flow=Sd;_r.flowRight=Dd;_r.fromPairs=Xu;_r.functions=hc;_r.functionsIn=pc;_r.groupBy=fl;_r.initial=Qu;_r.intersection=Ku;_r.intersectionBy=es;_r.intersectionWith=ts;_r.invert=yc;_r.invertBy=bc;_r.invokeMap=dl;_r.iteratee=Md;_r.keyBy=hl;_r.keys=_c;_r.keysIn=wc;_r.map=pl;_r.mapKeys=kc;_r.mapValues=Ec;_r.matches=jd;_r.matchesProperty=Fd;_r.memoize=Ll;_r.merge=Oc;_r.mergeWith=Ac;_r.method=Nd;_r.methodOf=Td;_r.mixin=zd;_r.negate=Il;_r.nthArg=Ld;_r.omit=Sc;_r.omitBy=Dc;_r.once=Bl;_r.orderBy=vl;_r.over=Id;_r.overArgs=Ul;_r.overEvery=Bd;_r.overSome=Ud;_r.partial=ql;_r.partialRight=Wl;_r.partition=gl;_r.pick=Cc;_r.pickBy=Mc;_r.property=qd;_r.propertyOf=Wd;_r.pull=os;_r.pullAll=us;_r.pullAllBy=ss;_r.pullAllWith=ls;_r.pullAt=fs;_r.range=Hd;_r.rangeRight=$d;_r.rearg=Hl;_r.reject=bl;_r.remove=cs;_r.rest=$l;_r.reverse=ds;_r.sampleSize=_l;_r.set=Fc;_r.setWith=Nc;_r.shuffle=wl;_r.slice=hs;_r.sortBy=Ol;_r.sortedUniq=xs;_r.sortedUniqBy=_s;_r.split=ud;_r.spread=Gl;_r.tail=ws;_r.take=ks;_r.takeRight=Es;_r.takeRightWhile=Os;_r.takeWhile=As;_r.tap=Hs;_r.throttle=Vl;_r.thru=$s;_r.toArray=$f;_r.toPairs=Tc;_r.toPairsIn=zc;_r.toPath=Qd;_r.toPlainObject=Jf;_r.transform=Rc;_r.unary=Yl;_r.union=Ss;_r.unionBy=Ds;_r.unionWith=Cs;_r.uniq=Ms;_r.uniqBy=js;_r.uniqWith=Fs;_r.unset=Pc;_r.unzip=Ns;_r.unzipWith=Ts;_r.update=Lc;_r.updateWith=Ic;_r.values=Bc;_r.valuesIn=Uc;_r.without=zs;_r.words=xd;_r.wrap=Xl;_r.xor=Rs;_r.xorBy=Ps;_r.xorWith=Ls;_r.zip=Is;_r.zipObject=Bs;_r.zipObjectDeep=Us;_r.zipWith=qs;_r.entries=Tc;_r.entriesIn=zc;_r.extend=ec;_r.extendWith=tc;zd(_r,_r);_r.add=eh;_r.attempt=_d;_r.camelCase=$c;_r.capitalize=Gc;_r.ceil=th;_r.clamp=qc;_r.clone=Zl;_r.cloneDeep=Kl;_r.cloneDeepWith=ef;_r.cloneWith=Ql;_r.conformsTo=tf;_r.deburr=Vc;_r.defaultTo=Ad;_r.divide=nh;_r.endsWith=Yc;_r.eq=nf;_r.escape=Xc;_r.escapeRegExp=Jc;_r.every=tl;_r.find=rl;_r.findIndex=Hu;_r.findKey=uc;_r.findLast=il;_r.findLastIndex=$u;_r.findLastKey=sc;_r.floor=rh;_r.forEach=sl;_r.forEachRight=ll;_r.forIn=lc;_r.forInRight=fc;_r.forOwn=cc;_r.forOwnRight=dc;_r.get=vc;_r.gt=rf;_r.gte=af;_r.has=gc;_r.hasIn=mc;_r.head=Ju;_r.identity=Cd;_r.includes=cl;_r.indexOf=Zu;_r.inRange=Wc;_r.invoke=xc;_r.isArguments=of;_r.isArray=uf;_r.isArrayBuffer=sf;_r.isArrayLike=lf;_r.isArrayLikeObject=ff;_r.isBoolean=cf;_r.isBuffer=df;_r.isDate=hf;_r.isElement=pf;_r.isEmpty=vf;_r.isEqual=gf;_r.isEqualWith=mf;_r.isError=yf;_r.isFinite=bf;_r.isFunction=xf;_r.isInteger=_f;_r.isLength=wf;_r.isMap=Of;_r.isMatch=Af;_r.isMatchWith=Sf;_r.isNaN=Df;_r.isNative=Cf;_r.isNil=jf;_r.isNull=Mf;_r.isNumber=Ff;_r.isObject=kf;_r.isObjectLike=Ef;_r.isPlainObject=Nf;_r.isRegExp=Tf;_r.isSafeInteger=zf;_r.isSet=Rf;_r.isString=Pf;_r.isSymbol=Lf;_r.isTypedArray=If;_r.isUndefined=Bf;_r.isWeakMap=Uf;_r.isWeakSet=qf;_r.join=ns;_r.kebabCase=Zc;_r.last=rs;_r.lastIndexOf=is;_r.lowerCase=Qc;_r.lowerFirst=Kc;_r.lt=Wf;_r.lte=Hf;_r.max=ih;_r.maxBy=ah;_r.mean=oh;_r.meanBy=uh;_r.min=sh;_r.minBy=lh;_r.stubArray=Gd;_r.stubFalse=Vd;_r.stubObject=Yd;_r.stubString=Xd;_r.stubTrue=Jd;_r.multiply=fh;_r.nth=as;_r.noConflict=Rd;_r.noop=Pd;_r.now=Al;_r.pad=ed;_r.padEnd=td;_r.padStart=nd;_r.parseInt=rd;_r.random=Hc;_r.reduce=ml;_r.reduceRight=yl;_r.repeat=id;_r.replace=ad;_r.result=jc;_r.round=ch;_r.runInContext=e;_r.sample=xl;_r.size=kl;_r.snakeCase=od;_r.some=El;_r.sortedIndex=ps;_r.sortedIndexBy=vs;_r.sortedIndexOf=gs;_r.sortedLastIndex=ms;_r.sortedLastIndexBy=ys;_r.sortedLastIndexOf=bs;_r.startCase=sd;_r.startsWith=ld;_r.subtract=dh;_r.sum=hh;_r.sumBy=ph;_r.template=fd;_r.times=Zd;_r.toFinite=Gf;_r.toInteger=Vf;_r.toLength=Yf;_r.toLower=cd;_r.toNumber=Xf;_r.toSafeInteger=Zf;_r.toString=Qf;_r.toUpper=dd;_r.trim=hd;_r.trimEnd=pd;_r.trimStart=vd;_r.truncate=gd;_r.unescape=md;_r.uniqueId=Kd;_r.upperCase=yd;_r.upperFirst=bd;_r.each=sl;_r.eachRight=ll;_r.first=Ju;zd(_r,function(){var e={};Ci(_r,(function(t,n){if(!ct.call(_r.prototype,n)){e[n]=t}}));return e}(),{chain:false});_r.VERSION=r;bn(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){_r[e].placeholder=_r}));bn(["drop","take"],(function(e,t){Or.prototype[e]=function(r){r=r===n?1:qt(Vf(r),0);var i=this.__filtered__&&!t?new Or(this):this.clone();if(i.__filtered__){i.__takeCount__=Wt(r,i.__takeCount__)}else{i.__views__.push({size:Wt(r,R),type:e+(i.__dir__<0?"Right":"")})}return i};Or.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}));bn(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=n==C||n==j;Or.prototype[e]=function(e){var t=this.clone();t.__iteratees__.push({iteratee:qo(e,3),type:n});t.__filtered__=t.__filtered__||r;return t}}));bn(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Or.prototype[e]=function(){return this[n](1).value()[0]}}));bn(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Or.prototype[e]=function(){return this.__filtered__?new Or(this):this[n](1)}}));Or.prototype.compact=function(){return this.filter(Cd)};Or.prototype.find=function(e){return this.filter(e).head()};Or.prototype.findLast=function(e){return this.reverse().find(e)};Or.prototype.invokeMap=ya((function(e,t){if(typeof e=="function"){return new Or(this)}return this.map((function(n){return Ui(n,e,t)}))}));Or.prototype.reject=function(e){return this.filter(Il(qo(e)))};Or.prototype.slice=function(e,t){e=Vf(e);var r=this;if(r.__filtered__&&(e>0||t<0)){return new Or(r)}if(e<0){r=r.takeRight(-e)}else if(e){r=r.drop(e)}if(t!==n){t=Vf(t);r=t<0?r.dropRight(-t):r.take(t-e)}return r};Or.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()};Or.prototype.toArray=function(){return this.take(R)};Ci(Or.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),a=_r[i?"take"+(t=="last"?"Right":""):t],o=i||/^find/.test(t);if(!a){return}_r.prototype[t]=function(){var t=this.__wrapped__,u=i?[1]:arguments,s=t instanceof Or,l=u[0],f=s||uf(t);var c=function(e){var t=a.apply(_r,An([e],u));return i&&d?t[0]:t};if(f&&r&&typeof l=="function"&&l.length!=1){s=f=false}var d=this.__chain__,h=!!this.__actions__.length,p=o&&!d,v=s&&!h;if(!o&&f){t=v?t:new Or(this);var g=e.apply(t,u);g.__actions__.push({func:$s,args:[c],thisArg:n});return new Er(g,d)}if(p&&v){return e.apply(this,u)}g=this.thru(c);return p?i?g.value()[0]:g.value():g}}));bn(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ot[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);_r.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(uf(i)?i:[],e)}return this[n]((function(n){return t.apply(uf(n)?n:[],e)}))}}));Ci(Or.prototype,(function(e,t){var n=_r[t];if(n){var r=n.name+"";if(!ct.call(fn,r)){fn[r]=[]}fn[r].push({name:t,func:n})}}));fn[mo(n,g).name]=[{name:"wrapper",func:n}];Or.prototype.clone=Ar;Or.prototype.reverse=Sr;Or.prototype.value=Dr;_r.prototype.at=Gs;_r.prototype.chain=Vs;_r.prototype.commit=Ys;_r.prototype.next=Xs;_r.prototype.plant=Zs;_r.prototype.reverse=Qs;_r.prototype.toJSON=_r.prototype.valueOf=_r.prototype.value=Ks;_r.prototype.first=_r.prototype.head;if(St){_r.prototype[St]=Js}return _r};var br=yr();if(un){(un.exports=br)._=br;on._=br}else{an._=br}}).call(be)}));var Te="Coefficient Number";var ze="Value";var Re="Relative Cumulative Energy";function Pe(e){if(!e)return null;var t=Ne.flatten(e);var n=K.energy(e);var r=[];for(var i=0;i<t.length;i++){var a=t[i];var o=K.energy([a])/n;var u=i===0?o:r[i-1][Re]+o;var s={};s[Te]=i;s[ze]=a;s[Re]=u;r.push(s)}return{$schema:"https://vega.github.io/schema/vega-lite/v4.json",data:{values:r},vconcat:[{width:"container",mark:{type:"bar"},selection:{grid:{type:"interval",bind:"scales",encodings:["x"]}},encoding:{x:{axis:{title:""},field:Te,type:"quantitative"},y:{axis:{title:"Coefficient Value"},field:ze,type:"quantitative"},color:{value:"#333"},tooltip:{field:ze,type:"quantitative"}}},{width:"container",mark:"area",encoding:{x:{field:Te,type:"quantitative",scale:{domain:{selection:"grid"}}},y:{field:Re,type:"quantitative"},color:{value:"#333"}}}]}}var Le="xEnd";var Ie="xStart";var Be="Level of Transform";var Ue="Time";var qe="Value";var We="Energy";function He(e,t){if(!e||!t)return null;var n=Math.min.apply(Math,e.map((function(e){return e[0]})));var r=Math.max.apply(Math,e.map((function(e){return e[0]})));var i=r-n;var a=i/(e.length-1);var o=i+a;var u=n-a/2;var s=t.slice(1).reverse();return{$schema:"https://vega.github.io/schema/vega-lite/v4.json",vconcat:[{autosize:{type:"fit",contains:"padding"},width:"container",layer:[{data:{values:e.map((function(e){var t={};t[Ue]=new Date(1e3*e[0]);t[qe]=e[1];return t}))},mark:{type:"line"},selection:{grid:{type:"interval",bind:"scales",encodings:["x"]}},encoding:{x:{axis:{title:""},field:Ue,scale:{domain:[1e3*e[0][0],Date.now()]},type:"temporal"},y:{axis:{title:"New Infections"},field:qe,scale:{domain:[0,4/3*Math.max.apply(Math,e.map((function(e){return e[1]})))]},type:"quantitative"},color:{value:"#333"}}},{data:{values:[{event:"curfew laws",when:new Date(2020,2,23,0,0,0,0)},{event:"1st deregulations",when:new Date(2020,3,20,0,0,0,0)},{event:"2nd deregulations",when:new Date(2020,4,4,0,0,0,0)},{event:"3rd deregulations",when:new Date(2020,5,5,0,0,0,0)},{event:"Corona app",when:new Date(2020,5,15,0,0,0,0)}]},encoding:{color:{legend:null,field:"event",type:"nominal"},x:{field:"when",type:"temporal"}},layer:[{mark:{type:"rule",opacity:1}},{mark:{align:"left",dx:5,fontWeight:100,type:"text"},encoding:{angle:{value:-25},text:{field:"event",type:"nominal"},y:{value:50}}}]}]},{width:"container",mark:"rect",data:{values:s.reduce((function(e,t,n){var r=o/t.length;for(var i=0;i<t.length;i++){var a=t[i];var s={};s[Ie]=new Date(1e3*(i*r+u));s[Le]=new Date(1e3*((i+1)*r+u));s[Be]=n+1;s[qe]=a;e.push(s)}return e}),[])},encoding:{x:{axis:{title:""},field:Ie,type:"temporal",scale:{domain:{selection:"grid"}}},x2:{field:Le},y:{axis:{title:"Level of Transform"},field:Be,type:"ordinal"},color:{field:qe,type:"quantitative",legend:{title:null},scale:{scheme:"purplegreen",domainMid:0}}}},{width:"container",mark:"line",data:{values:e.map((function(e,t){var n=0;var r=s.length;for(var i=0;i<r;i++){var a=i+1;var o=s[i];n+=K.energy([o[Math.floor(t/Math.pow(2,a))]])}var u={};u[Ue]=new Date(1e3*e[0]);u[We]=n/Math.pow(2,r);return u}))},encoding:{x:{axis:{title:"Date"},field:Ue,type:"temporal",scale:{domain:{selection:"grid"}}},y:{axis:{title:"Cumulative Energy"},field:We,type:"quantitative"},color:{value:"#333"}}}]}}var $e="page-dashboard>div{padding:0.5rem}@media screen and (min-width: 30em) and (max-width: 60em){page-dashboard>div{padding:1rem}}@media screen and (min-width: 60em){page-dashboard>div .grid{-webkit-column-gap:1rem;-moz-column-gap:1rem;column-gap:1rem;display:grid;grid-template-columns:minmax(0, 1fr) minmax(0, 1fr);margin:0 auto;max-width:96rem;row-gap:1rem}}page-dashboard>div .grid visualization-container{margin-bottom:1rem}@media screen and (min-width: 60em){page-dashboard>div .grid visualization-container{margin:0}}";var Ge=e("page_dashboard",function(){function e(e){t(this,e);this.store=n(this,"store")}e.prototype.componentWillLoad=function(){try{this.initStore()}catch(e){}};e.prototype.initStore=function(){this.store.mapStateToProps(this,(function(e){var t=e.data.coeffs;var n=e.data.timeSeries;return{coeffs:t,timeSeries:n}}))};e.prototype.updateCoeffsSpec=function(){this.coeffsSpec=Pe(this.coeffs)};e.prototype.updateTimeSeriesSpec=function(){this.timeSeriesSpec=He(this.timeSeries,this.coeffs)};e.prototype.render=function(){return r("div",null,r("h1",null,"COVID-19 Discrete Wavelet Transform Analysis (Germany)"),!this.timeSeriesSpec||!this.coeffsSpec?null:r("div",{class:"grid"},r("visualization-container",null,r("vega-visualization",{spacing:200,spec:this.timeSeriesSpec})),r("visualization-container",null,r("vega-visualization",{spacing:100,spec:this.coeffsSpec}))))};Object.defineProperty(e,"watchers",{get:function(){return{coeffs:["updateCoeffsSpec"],timeSeries:["updateTimeSeriesSpec"]}},enumerable:true,configurable:true});return e}());Ge.style=$e;var Ve=":host{background-color:#cccccc;background-color:var(--strc-progress-bar-background-color, #cccccc);display:block;height:2px;height:var(--strc-progress-bar-height, 2px);width:100%}div{background-color:#000000;background-color:var(--strc-progress-bar-color, #000000);height:100%;-webkit-transition-duration:0.2s;transition-duration:0.2s;-webkit-transition-duration:var(--strc-progress-bar-transition-duration, 0.2s);transition-duration:var(--strc-progress-bar-transition-duration, 0.2s);-webkit-transition-property:width;transition-property:width;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out}";var Ye=e("strc_progress_bar",function(){function e(e){t(this,e);this.progress=0}e.prototype.handleProgress=function(e){this.progress=Math.max(0,Math.min(1,e))};e.prototype.componentWillLoad=function(){this.handleProgress(this.progress)};e.prototype.render=function(){return r("div",{style:{width:this.progress*100+"%"}})};Object.defineProperty(e,"watchers",{get:function(){return{progress:["handleProgress"]}},enumerable:true,configurable:true});return e}());Ye.style=Ve;
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation. All rights reserved.
            Licensed under the Apache License, Version 2.0 (the "License"); you may not use
            this file except in compliance with the License. You may obtain a copy of the
            License at http://www.apache.org/licenses/LICENSE-2.0

            THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
            KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
            WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
            MERCHANTABLITY OR NON-INFRINGEMENT.

            See the Apache Version 2.0 License for specific language governing permissions
            and limitations under the License.
            ***************************************************************************** */function Xe(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n}function Je(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):i(e.value).then(o,u)}s((r=r.apply(e,t||[])).next())}))}
/*!
             * https://github.com/Starcounter-Jack/JSON-Patch
             * (c) 2017 Joachim Wester
             * MIT license
             */var Ze=undefined&&undefined.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();var Qe=Object.prototype.hasOwnProperty;function Ke(e,t){return Qe.call(e,t)}function et(e){if(Array.isArray(e)){var t=new Array(e.length);for(var n=0;n<t.length;n++){t[n]=""+n}return t}if(Object.keys){return Object.keys(e)}var t=[];for(var r in e){if(Ke(e,r)){t.push(r)}}return t}function tt(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function nt(e){var t=0;var n=e.length;var r;while(t<n){r=e.charCodeAt(t);if(r>=48&&r<=57){t++;continue}return false}return true}function rt(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function it(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function at(e){if(e===undefined){return true}if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++){if(at(e[t])){return true}}}else if(typeof e==="object"){var r=et(e);var i=r.length;for(var t=0;t<i;t++){if(at(e[r[t]])){return true}}}}return false}function ot(e,t){var n=[e];for(var r in t){var i=typeof t[r]==="object"?JSON.stringify(t[r],null,2):t[r];if(typeof i!=="undefined"){n.push(r+": "+i)}}return n.join("\n")}var ut=function(e){Ze(t,e);function t(t,n,r,i,a){var o=this.constructor;var u=e.call(this,ot(t,{name:n,index:r,operation:i,tree:a}))||this;u.name=n;u.index=r;u.operation=i;u.tree=a;Object.setPrototypeOf(u,o.prototype);u.message=ot(t,{name:n,index:r,operation:i,tree:a});return u}return t}(Error);var st=ut;var lt=tt;var ft={add:function(e,t,n){e[t]=this.value;return{newDocument:n}},remove:function(e,t,n){var r=e[t];delete e[t];return{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];e[t]=this.value;return{newDocument:n,removed:r}},move:function(e,t,n){var r=dt(n,this.path);if(r){r=tt(r)}var i=ht(n,{op:"remove",path:this.from}).removed;ht(n,{op:"add",path:this.path,value:i});return{newDocument:n,removed:r}},copy:function(e,t,n){var r=dt(n,this.from);ht(n,{op:"add",path:this.path,value:tt(r)});return{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:yt(e[t],this.value)}},_get:function(e,t,n){this.value=e[t];return{newDocument:n}}};var ct={add:function(e,t,n){if(nt(t)){e.splice(t,0,this.value)}else{e[t]=this.value}return{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];e[t]=this.value;return{newDocument:n,removed:r}},move:ft.move,copy:ft.copy,test:ft.test,_get:ft._get};function dt(e,t){if(t==""){return e}var n={op:"_get",path:t};ht(e,n);return n.value}function ht(e,t,n,r,i,a){if(n===void 0){n=false}if(r===void 0){r=true}if(i===void 0){i=true}if(a===void 0){a=0}if(n){if(typeof n=="function"){n(t,0,e,t.path)}else{gt(t,0)}}if(t.path===""){var o={newDocument:e};if(t.op==="add"){o.newDocument=t.value;return o}else if(t.op==="replace"){o.newDocument=t.value;o.removed=e;return o}else if(t.op==="move"||t.op==="copy"){o.newDocument=dt(e,t.from);if(t.op==="move"){o.removed=e}return o}else if(t.op==="test"){o.test=yt(e,t.value);if(o.test===false){throw new st("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}o.newDocument=e;return o}else if(t.op==="remove"){o.removed=e;o.newDocument=null;return o}else if(t.op==="_get"){t.value=e;return o}else{if(n){throw new st("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e)}else{return o}}}else{if(!r){e=tt(e)}var u=t.path||"";var s=u.split("/");var l=e;var f=1;var c=s.length;var d=undefined;var h=void 0;var p=void 0;if(typeof n=="function"){p=n}else{p=gt}while(true){h=s[f];if(i&&h=="__proto__"){throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README")}if(n){if(d===undefined){if(l[h]===undefined){d=s.slice(0,f).join("/")}else if(f==c-1){d=t.path}if(d!==undefined){p(t,0,e,d)}}}f++;if(Array.isArray(l)){if(h==="-"){h=l.length}else{if(n&&!nt(h)){throw new st("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e)}else if(nt(h)){h=~~h}}if(f>=c){if(n&&t.op==="add"&&h>l.length){throw new st("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e)}var o=ct[t.op].call(t,l,h,e);if(o.test===false){throw new st("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}return o}}else{if(h&&h.indexOf("~")!=-1){h=it(h)}if(f>=c){var o=ft[t.op].call(t,l,h,e);if(o.test===false){throw new st("Test operation failed","TEST_OPERATION_FAILED",a,t,e)}return o}}l=l[h]}}}function pt(e,t,n,r,i){if(r===void 0){r=true}if(i===void 0){i=true}if(n){if(!Array.isArray(t)){throw new st("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}}if(!r){e=tt(e)}var a=new Array(t.length);for(var o=0,u=t.length;o<u;o++){a[o]=ht(e,t[o],n,true,i,o);e=a[o].newDocument}a.newDocument=e;return a}function vt(e,t,n){var r=ht(e,t);if(r.test===false){throw new st("Test operation failed","TEST_OPERATION_FAILED",n,t,e)}return r.newDocument}function gt(e,t,n,r){if(typeof e!=="object"||e===null||Array.isArray(e)){throw new st("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n)}else if(!ft[e.op]){throw new st("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}else if(typeof e.path!=="string"){throw new st("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n)}else if(e.path.indexOf("/")!==0&&e.path.length>0){throw new st('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n)}else if((e.op==="move"||e.op==="copy")&&typeof e.from!=="string"){throw new st("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===undefined){throw new st("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n)}else if((e.op==="add"||e.op==="replace"||e.op==="test")&&at(e.value)){throw new st("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n)}else if(n){if(e.op=="add"){var i=e.path.split("/").length;var a=r.split("/").length;if(i!==a+1&&i!==a){throw new st("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r){throw new st("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:undefined};var u=mt([o],n);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE"){throw new st("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}}function mt(e,t,n){try{if(!Array.isArray(e)){throw new st("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}if(t){pt(tt(t),tt(e),n||true)}else{n=n||gt;for(var r=0;r<e.length;r++){n(e[r],r,t,undefined)}}}catch(i){if(i instanceof st){return i}else{throw i}}}function yt(e,t){if(e===t)return true;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){a=e.length;if(a!=t.length)return false;for(i=a;i--!==0;)if(!yt(e[i],t[i]))return false;return true}if(n!=r)return false;var u=Object.keys(e);a=u.length;if(a!==Object.keys(t).length)return false;for(i=a;i--!==0;)if(!t.hasOwnProperty(u[i]))return false;for(i=a;i--!==0;){o=u[i];if(!yt(e[o],t[o]))return false}return true}return e!==e&&t!==t}var bt=Object.freeze({__proto__:null,JsonPatchError:st,deepClone:lt,getValueByPointer:dt,applyOperation:ht,applyPatch:pt,applyReducer:vt,validator:gt,validate:mt,_areEquals:yt});
/*!
             * https://github.com/Starcounter-Jack/JSON-Patch
             * (c) 2017 Joachim Wester
             * MIT license
             */var xt=new WeakMap;var _t=function(){function e(e){this.observers=new Map;this.obj=e}return e}();var wt=function(){function e(e,t){this.callback=e;this.observer=t}return e}();function kt(e){return xt.get(e)}function Et(e,t){return e.observers.get(t)}function Ot(e,t){e.observers.delete(t.callback)}function At(e,t){t.unobserve()}function St(e,t){var n=[];var r;var i=kt(e);if(!i){i=new _t(e);xt.set(e,i)}else{var a=Et(i,t);r=a&&a.observer}if(r){return r}r={};i.value=tt(e);if(t){r.callback=t;r.next=null;var o=function(){Dt(r)};var u=function(){clearTimeout(r.next);r.next=setTimeout(o)};if(typeof window!=="undefined"){window.addEventListener("mouseup",u);window.addEventListener("keyup",u);window.addEventListener("mousedown",u);window.addEventListener("keydown",u);window.addEventListener("change",u)}}r.patches=n;r.object=e;r.unobserve=function(){Dt(r);clearTimeout(r.next);Ot(i,r);if(typeof window!=="undefined"){window.removeEventListener("mouseup",u);window.removeEventListener("keyup",u);window.removeEventListener("mousedown",u);window.removeEventListener("keydown",u);window.removeEventListener("change",u)}};i.observers.set(t,new wt(t,r));return r}function Dt(e,t){if(t===void 0){t=false}var n=xt.get(e.object);Ct(n.value,e.object,e.patches,"",t);if(e.patches.length){pt(n.value,e.patches)}var r=e.patches;if(r.length>0){e.patches=[];if(e.callback){e.callback(r)}}return r}function Ct(e,t,n,r,i){if(t===e){return}if(typeof t.toJSON==="function"){t=t.toJSON()}var a=et(t);var o=et(e);var u=false;for(var s=o.length-1;s>=0;s--){var l=o[s];var f=e[l];if(Ke(t,l)&&!(t[l]===undefined&&f!==undefined&&Array.isArray(t)===false)){var c=t[l];if(typeof f=="object"&&f!=null&&typeof c=="object"&&c!=null){Ct(f,c,n,r+"/"+rt(l),i)}else{if(f!==c){if(i){n.push({op:"test",path:r+"/"+rt(l),value:tt(f)})}n.push({op:"replace",path:r+"/"+rt(l),value:tt(c)})}}}else if(Array.isArray(e)===Array.isArray(t)){if(i){n.push({op:"test",path:r+"/"+rt(l),value:tt(f)})}n.push({op:"remove",path:r+"/"+rt(l)});u=true}else{if(i){n.push({op:"test",path:r,value:e})}n.push({op:"replace",path:r,value:t})}}if(!u&&a.length==o.length){return}for(var s=0;s<a.length;s++){var l=a[s];if(!Ke(e,l)&&t[l]!==undefined){n.push({op:"add",path:r+"/"+rt(l),value:tt(t[l])})}}}function Mt(e,t,n){if(n===void 0){n=false}var r=[];Ct(e,t,r,"",n);return r}var jt=Object.freeze({__proto__:null,unobserve:At,observe:St,generate:Dt,compare:Mt});Object.assign({},bt,jt,{JsonPatchError:ut,deepClone:tt,escapePathComponent:rt,unescapePathComponent:it});var Ft=/("(?:[^\\"]|\\.)*")|[:,]/g;var Nt=function e(t,n){var r,i,a;n=n||{};r=JSON.stringify([1],undefined,n.indent===undefined?2:n.indent).slice(2,-3);i=r===""?Infinity:n.maxLength===undefined?80:n.maxLength;a=n.replacer;return function e(t,n,o){var u,s,l,f,c,d,h,p,v,g,m,y;if(t&&typeof t.toJSON==="function"){t=t.toJSON()}m=JSON.stringify(t,a);if(m===undefined){return m}h=i-n.length-o;if(m.length<=h){v=m.replace(Ft,(function(e,t){return t||e+" "}));if(v.length<=h){return v}}if(a!=null){t=JSON.parse(m);a=undefined}if(typeof t==="object"&&t!==null){p=n+r;l=[];s=0;if(Array.isArray(t)){g="[";u="]";h=t.length;for(;s<h;s++){l.push(e(t[s],p,s===h-1?0:1)||"null")}}else{g="{";u="}";d=Object.keys(t);h=d.length;for(;s<h;s++){f=d[s];c=JSON.stringify(f)+": ";y=e(t[f],p,c.length+(s===h-1?0:1));if(y!==undefined){l.push(c+y)}}}if(l.length>0){return[g,r+l.join(",\n"+p),u].join("\n"+n)}}return m}(t,"",0)};var Tt="2.0.0";var zt=256;var Rt=Number.MAX_SAFE_INTEGER||9007199254740991;var Pt=16;var Lt={SEMVER_SPEC_VERSION:Tt,MAX_LENGTH:zt,MAX_SAFE_INTEGER:Rt,MAX_SAFE_COMPONENT_LENGTH:Pt};var It=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return console.error.apply(console,h(["SEMVER"],e))}:function(){};var Bt=It;var Ut=_e((function(e,t){var n=Lt.MAX_SAFE_COMPONENT_LENGTH;t=e.exports={};var r=t.re=[];var i=t.src=[];var a=t.t={};var o=0;var u=function(e,t,n){var u=o++;Bt(u,t);a[e]=u;i[u]=t;r[u]=new RegExp(t,n?"g":undefined)};u("NUMERICIDENTIFIER","0|[1-9]\\d*");u("NUMERICIDENTIFIERLOOSE","[0-9]+");u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");u("MAINVERSION","("+i[a.NUMERICIDENTIFIER]+")\\."+("("+i[a.NUMERICIDENTIFIER]+")\\.")+("("+i[a.NUMERICIDENTIFIER]+")"));u("MAINVERSIONLOOSE","("+i[a.NUMERICIDENTIFIERLOOSE]+")\\."+("("+i[a.NUMERICIDENTIFIERLOOSE]+")\\.")+("("+i[a.NUMERICIDENTIFIERLOOSE]+")"));u("PRERELEASEIDENTIFIER","(?:"+i[a.NUMERICIDENTIFIER]+"|"+i[a.NONNUMERICIDENTIFIER]+")");u("PRERELEASEIDENTIFIERLOOSE","(?:"+i[a.NUMERICIDENTIFIERLOOSE]+"|"+i[a.NONNUMERICIDENTIFIER]+")");u("PRERELEASE","(?:-("+i[a.PRERELEASEIDENTIFIER]+"(?:\\."+i[a.PRERELEASEIDENTIFIER]+")*))");u("PRERELEASELOOSE","(?:-?("+i[a.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+i[a.PRERELEASEIDENTIFIERLOOSE]+")*))");u("BUILDIDENTIFIER","[0-9A-Za-z-]+");u("BUILD","(?:\\+("+i[a.BUILDIDENTIFIER]+"(?:\\."+i[a.BUILDIDENTIFIER]+")*))");u("FULLPLAIN","v?"+i[a.MAINVERSION]+i[a.PRERELEASE]+"?"+i[a.BUILD]+"?");u("FULL","^"+i[a.FULLPLAIN]+"$");u("LOOSEPLAIN","[v=\\s]*"+i[a.MAINVERSIONLOOSE]+i[a.PRERELEASELOOSE]+"?"+i[a.BUILD]+"?");u("LOOSE","^"+i[a.LOOSEPLAIN]+"$");u("GTLT","((?:<|>)?=?)");u("XRANGEIDENTIFIERLOOSE",i[a.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*");u("XRANGEIDENTIFIER",i[a.NUMERICIDENTIFIER]+"|x|X|\\*");u("XRANGEPLAIN","[v=\\s]*("+i[a.XRANGEIDENTIFIER]+")"+("(?:\\.("+i[a.XRANGEIDENTIFIER]+")")+("(?:\\.("+i[a.XRANGEIDENTIFIER]+")")+("(?:"+i[a.PRERELEASE]+")?"+i[a.BUILD]+"?")+")?)?");u("XRANGEPLAINLOOSE","[v=\\s]*("+i[a.XRANGEIDENTIFIERLOOSE]+")"+("(?:\\.("+i[a.XRANGEIDENTIFIERLOOSE]+")")+("(?:\\.("+i[a.XRANGEIDENTIFIERLOOSE]+")")+("(?:"+i[a.PRERELEASELOOSE]+")?"+i[a.BUILD]+"?")+")?)?");u("XRANGE","^"+i[a.GTLT]+"\\s*"+i[a.XRANGEPLAIN]+"$");u("XRANGELOOSE","^"+i[a.GTLT]+"\\s*"+i[a.XRANGEPLAINLOOSE]+"$");u("COERCE",""+"(^|[^\\d])"+"(\\d{1,"+n+"})"+("(?:\\.(\\d{1,"+n+"}))?")+("(?:\\.(\\d{1,"+n+"}))?")+"(?:$|[^\\d])");u("COERCERTL",i[a.COERCE],true);u("LONETILDE","(?:~>?)");u("TILDETRIM","(\\s*)"+i[a.LONETILDE]+"\\s+",true);t.tildeTrimReplace="$1~";u("TILDE","^"+i[a.LONETILDE]+i[a.XRANGEPLAIN]+"$");u("TILDELOOSE","^"+i[a.LONETILDE]+i[a.XRANGEPLAINLOOSE]+"$");u("LONECARET","(?:\\^)");u("CARETTRIM","(\\s*)"+i[a.LONECARET]+"\\s+",true);t.caretTrimReplace="$1^";u("CARET","^"+i[a.LONECARET]+i[a.XRANGEPLAIN]+"$");u("CARETLOOSE","^"+i[a.LONECARET]+i[a.XRANGEPLAINLOOSE]+"$");u("COMPARATORLOOSE","^"+i[a.GTLT]+"\\s*("+i[a.LOOSEPLAIN]+")$|^$");u("COMPARATOR","^"+i[a.GTLT]+"\\s*("+i[a.FULLPLAIN]+")$|^$");u("COMPARATORTRIM","(\\s*)"+i[a.GTLT]+"\\s*("+i[a.LOOSEPLAIN]+"|"+i[a.XRANGEPLAIN]+")",true);t.comparatorTrimReplace="$1$2$3";u("HYPHENRANGE","^\\s*("+i[a.XRANGEPLAIN]+")"+"\\s+-\\s+"+("("+i[a.XRANGEPLAIN]+")")+"\\s*$");u("HYPHENRANGELOOSE","^\\s*("+i[a.XRANGEPLAINLOOSE]+")"+"\\s+-\\s+"+("("+i[a.XRANGEPLAINLOOSE]+")")+"\\s*$");u("STAR","(<|>)?=?\\s*\\*");u("GTE0","^\\s*>=\\s*0.0.0\\s*$");u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}));var qt=/^[0-9]+$/;var Wt=function(e,t){var n=qt.test(e);var r=qt.test(t);if(n&&r){e=+e;t=+t}return e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1};var Ht=function(e,t){return Wt(t,e)};var $t={compareIdentifiers:Wt,rcompareIdentifiers:Ht};var Gt=Lt.MAX_LENGTH,Vt=Lt.MAX_SAFE_INTEGER;var Yt=Ut.re,Xt=Ut.t;var Jt=$t.compareIdentifiers;var Zt=function(){function e(t,n){if(!n||typeof n!=="object"){n={loose:!!n,includePrerelease:false}}if(t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease){return t}else{t=t.version}}else if(typeof t!=="string"){throw new TypeError("Invalid Version: "+t)}if(t.length>Gt){throw new TypeError("version is longer than "+Gt+" characters")}Bt("SemVer",t,n);this.options=n;this.loose=!!n.loose;this.includePrerelease=!!n.includePrerelease;var r=t.trim().match(n.loose?Yt[Xt.LOOSE]:Yt[Xt.FULL]);if(!r){throw new TypeError("Invalid Version: "+t)}this.raw=t;this.major=+r[1];this.minor=+r[2];this.patch=+r[3];if(this.major>Vt||this.major<0){throw new TypeError("Invalid major version")}if(this.minor>Vt||this.minor<0){throw new TypeError("Invalid minor version")}if(this.patch>Vt||this.patch<0){throw new TypeError("Invalid patch version")}if(!r[4]){this.prerelease=[]}else{this.prerelease=r[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<Vt){return t}}return e}))}this.build=r[5]?r[5].split("."):[];this.format()}e.prototype.format=function(){this.version=this.major+"."+this.minor+"."+this.patch;if(this.prerelease.length){this.version+="-"+this.prerelease.join(".")}return this.version};e.prototype.toString=function(){return this.version};e.prototype.compare=function(t){Bt("SemVer.compare",this.version,this.options,t);if(!(t instanceof e)){if(typeof t==="string"&&t===this.version){return 0}t=new e(t,this.options)}if(t.version===this.version){return 0}return this.compareMain(t)||this.comparePre(t)};e.prototype.compareMain=function(t){if(!(t instanceof e)){t=new e(t,this.options)}return Jt(this.major,t.major)||Jt(this.minor,t.minor)||Jt(this.patch,t.patch)};e.prototype.comparePre=function(t){if(!(t instanceof e)){t=new e(t,this.options)}if(this.prerelease.length&&!t.prerelease.length){return-1}else if(!this.prerelease.length&&t.prerelease.length){return 1}else if(!this.prerelease.length&&!t.prerelease.length){return 0}var n=0;do{var r=this.prerelease[n];var i=t.prerelease[n];Bt("prerelease compare",n,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return Jt(r,i)}}while(++n)};e.prototype.compareBuild=function(t){if(!(t instanceof e)){t=new e(t,this.options)}var n=0;do{var r=this.build[n];var i=t.build[n];Bt("prerelease compare",n,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return Jt(r,i)}}while(++n)};e.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",t);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",t);break;case"prepatch":this.prerelease.length=0;this.inc("patch",t);this.inc("pre",t);break;case"prerelease":if(this.prerelease.length===0){this.inc("patch",t)}this.inc("pre",t);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0){this.minor++}this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0){this.patch++}this.prerelease=[];break;case"pre":if(this.prerelease.length===0){this.prerelease=[0]}else{var n=this.prerelease.length;while(--n>=0){if(typeof this.prerelease[n]==="number"){this.prerelease[n]++;n=-2}}if(n===-1){this.prerelease.push(0)}}if(t){if(this.prerelease[0]===t){if(isNaN(this.prerelease[1])){this.prerelease=[t,0]}}else{this.prerelease=[t,0]}}break;default:throw new Error("invalid increment argument: "+e)}this.format();this.raw=this.version;return this};return e}();var Qt=Zt;var Kt=Lt.MAX_LENGTH;var en=Ut.re,tn=Ut.t;var nn=function(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof Qt){return e}if(typeof e!=="string"){return null}if(e.length>Kt){return null}var n=t.loose?en[tn.LOOSE]:en[tn.FULL];if(!n.test(e)){return null}try{return new Qt(e,t)}catch(r){return null}};var rn=nn;var an=function(e,t){var n=rn(e,t);return n?n.version:null};var on=an;var un=function(e,t){var n=rn(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var sn=un;var ln=function(e,t,n,r){if(typeof n==="string"){r=n;n=undefined}try{return new Qt(e,n).inc(t,r).version}catch(i){return null}};var fn=ln;var cn=function(e,t,n){return new Qt(e,n).compare(new Qt(t,n))};var dn=cn;var hn=function(e,t,n){return dn(e,t,n)===0};var pn=hn;var vn=function(e,t){if(pn(e,t)){return null}else{var n=rn(e);var r=rn(t);var i=n.prerelease.length||r.prerelease.length;var a=i?"pre":"";var o=i?"prerelease":"";for(var u in n){if(u==="major"||u==="minor"||u==="patch"){if(n[u]!==r[u]){return a+u}}}return o}};var gn=vn;var mn=function(e,t){return new Qt(e,t).major};var yn=mn;var bn=function(e,t){return new Qt(e,t).minor};var xn=bn;var _n=function(e,t){return new Qt(e,t).patch};var wn=_n;var kn=function(e,t){var n=rn(e,t);return n&&n.prerelease.length?n.prerelease:null};var En=kn;var On=function(e,t,n){return dn(t,e,n)};var An=On;var Sn=function(e,t){return dn(e,t,true)};var Dn=Sn;var Cn=function(e,t,n){var r=new Qt(e,n);var i=new Qt(t,n);return r.compare(i)||r.compareBuild(i)};var Mn=Cn;var jn=function(e,t){return e.sort((function(e,n){return Mn(e,n,t)}))};var Fn=jn;var Nn=function(e,t){return e.sort((function(e,n){return Mn(n,e,t)}))};var Tn=Nn;var zn=function(e,t,n){return dn(e,t,n)>0};var Rn=zn;var Pn=function(e,t,n){return dn(e,t,n)<0};var Ln=Pn;var In=function(e,t,n){return dn(e,t,n)!==0};var Bn=In;var Un=function(e,t,n){return dn(e,t,n)>=0};var qn=Un;var Wn=function(e,t,n){return dn(e,t,n)<=0};var Hn=Wn;var $n=function(e,t,n,r){switch(t){case"===":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e===n;case"!==":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e!==n;case"":case"=":case"==":return pn(e,n,r);case"!=":return Bn(e,n,r);case">":return Rn(e,n,r);case">=":return qn(e,n,r);case"<":return Ln(e,n,r);case"<=":return Hn(e,n,r);default:throw new TypeError("Invalid operator: "+t)}};var Gn=$n;var Vn=Ut.re,Yn=Ut.t;var Xn=function(e,t){if(e instanceof Qt){return e}if(typeof e==="number"){e=String(e)}if(typeof e!=="string"){return null}t=t||{};var n=null;if(!t.rtl){n=e.match(Vn[Yn.COERCE])}else{var r=void 0;while((r=Vn[Yn.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length)){if(!n||r.index+r[0].length!==n.index+n[0].length){n=r}Vn[Yn.COERCERTL].lastIndex=r.index+r[1].length+r[2].length}Vn[Yn.COERCERTL].lastIndex=-1}if(n===null)return null;return rn(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)};var Jn=Xn;var Zn=function(){function e(t,n){var r=this;if(!n||typeof n!=="object"){n={loose:!!n,includePrerelease:false}}if(t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease){return t}else{return new e(t.raw,n)}}if(t instanceof br){this.raw=t.value;this.set=[[t]];this.format();return this}this.options=n;this.loose=!!n.loose;this.includePrerelease=!!n.includePrerelease;this.raw=t;this.set=t.split(/\s*\|\|\s*/).map((function(e){return r.parseRange(e.trim())})).filter((function(e){return e.length}));if(!this.set.length){throw new TypeError("Invalid SemVer Range: "+t)}this.format()}e.prototype.format=function(){this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim();return this.range};e.prototype.toString=function(){return this.range};e.prototype.parseRange=function(e){var t=this;var n=this.options.loose;e=e.trim();var r=n?Kn[er.HYPHENRANGELOOSE]:Kn[er.HYPHENRANGE];e=e.replace(r,vr(this.options.includePrerelease));Bt("hyphen replace",e);e=e.replace(Kn[er.COMPARATORTRIM],tr);Bt("comparator trim",e,Kn[er.COMPARATORTRIM]);e=e.replace(Kn[er.TILDETRIM],nr);e=e.replace(Kn[er.CARETTRIM],rr);e=e.split(/\s+/).join(" ");var i=n?Kn[er.COMPARATORLOOSE]:Kn[er.COMPARATOR];return e.split(" ").map((function(e){return ar(e,t.options)})).join(" ").split(/\s+/).map((function(e){return pr(e,t.options)})).filter(this.options.loose?function(e){return!!e.match(i)}:function(){return true}).map((function(e){return new br(e,t.options)}))};e.prototype.intersects=function(t,n){if(!(t instanceof e)){throw new TypeError("a Range is required")}return this.set.some((function(e){return ir(e,n)&&t.set.some((function(t){return ir(t,n)&&e.every((function(e){return t.every((function(t){return e.intersects(t,n)}))}))}))}))};e.prototype.test=function(e){if(!e){return false}if(typeof e==="string"){try{e=new Qt(e,this.options)}catch(n){return false}}for(var t=0;t<this.set.length;t++){if(gr(this.set[t],e,this.options)){return true}}return false};return e}();var Qn=Zn;var Kn=Ut.re,er=Ut.t,tr=Ut.comparatorTrimReplace,nr=Ut.tildeTrimReplace,rr=Ut.caretTrimReplace;var ir=function(e,t){var n=true;var r=e.slice();var i=r.pop();while(n&&r.length){n=r.every((function(e){return i.intersects(e,t)}));i=r.pop()}return n};var ar=function(e,t){Bt("comp",e,t);e=lr(e,t);Bt("caret",e);e=ur(e,t);Bt("tildes",e);e=cr(e,t);Bt("xrange",e);e=hr(e,t);Bt("stars",e);return e};var or=function(e){return!e||e.toLowerCase()==="x"||e==="*"};var ur=function(e,t){return e.trim().split(/\s+/).map((function(e){return sr(e,t)})).join(" ")};var sr=function(e,t){var n=t.loose?Kn[er.TILDELOOSE]:Kn[er.TILDE];return e.replace(n,(function(t,n,r,i,a){Bt("tilde",e,t,n,r,i,a);var o;if(or(n)){o=""}else if(or(r)){o=">="+n+".0.0 <"+(+n+1)+".0.0-0"}else if(or(i)){o=">="+n+"."+r+".0 <"+n+"."+(+r+1)+".0-0"}else if(a){Bt("replaceTilde pr",a);o=">="+n+"."+r+"."+i+"-"+a+" <"+n+"."+(+r+1)+".0-0"}else{o=">="+n+"."+r+"."+i+" <"+n+"."+(+r+1)+".0-0"}Bt("tilde return",o);return o}))};var lr=function(e,t){return e.trim().split(/\s+/).map((function(e){return fr(e,t)})).join(" ")};var fr=function(e,t){Bt("caret",e,t);var n=t.loose?Kn[er.CARETLOOSE]:Kn[er.CARET];var r=t.includePrerelease?"-0":"";return e.replace(n,(function(t,n,i,a,o){Bt("caret",e,t,n,i,a,o);var u;if(or(n)){u=""}else if(or(i)){u=">="+n+".0.0"+r+" <"+(+n+1)+".0.0-0"}else if(or(a)){if(n==="0"){u=">="+n+"."+i+".0"+r+" <"+n+"."+(+i+1)+".0-0"}else{u=">="+n+"."+i+".0"+r+" <"+(+n+1)+".0.0-0"}}else if(o){Bt("replaceCaret pr",o);if(n==="0"){if(i==="0"){u=">="+n+"."+i+"."+a+"-"+o+" <"+n+"."+i+"."+(+a+1)+"-0"}else{u=">="+n+"."+i+"."+a+"-"+o+" <"+n+"."+(+i+1)+".0-0"}}else{u=">="+n+"."+i+"."+a+"-"+o+" <"+(+n+1)+".0.0-0"}}else{Bt("no pr");if(n==="0"){if(i==="0"){u=">="+n+"."+i+"."+a+r+" <"+n+"."+i+"."+(+a+1)+"-0"}else{u=">="+n+"."+i+"."+a+r+" <"+n+"."+(+i+1)+".0-0"}}else{u=">="+n+"."+i+"."+a+" <"+(+n+1)+".0.0-0"}}Bt("caret return",u);return u}))};var cr=function(e,t){Bt("replaceXRanges",e,t);return e.split(/\s+/).map((function(e){return dr(e,t)})).join(" ")};var dr=function(e,t){e=e.trim();var n=t.loose?Kn[er.XRANGELOOSE]:Kn[er.XRANGE];return e.replace(n,(function(n,r,i,a,o,u){Bt("xRange",e,n,r,i,a,o,u);var s=or(i);var l=s||or(a);var f=l||or(o);var c=f;if(r==="="&&c){r=""}u=t.includePrerelease?"-0":"";if(s){if(r===">"||r==="<"){n="<0.0.0-0"}else{n="*"}}else if(r&&c){if(l){a=0}o=0;if(r===">"){r=">=";if(l){i=+i+1;a=0;o=0}else{a=+a+1;o=0}}else if(r==="<="){r="<";if(l){i=+i+1}else{a=+a+1}}if(r==="<")u="-0";n=r+i+"."+a+"."+o+u}else if(l){n=">="+i+".0.0"+u+" <"+(+i+1)+".0.0-0"}else if(f){n=">="+i+"."+a+".0"+u+" <"+i+"."+(+a+1)+".0-0"}Bt("xRange return",n);return n}))};var hr=function(e,t){Bt("replaceStars",e,t);return e.trim().replace(Kn[er.STAR],"")};var pr=function(e,t){Bt("replaceGTE0",e,t);return e.trim().replace(Kn[t.includePrerelease?er.GTE0PRE:er.GTE0],"")};var vr=function(e){return function(t,n,r,i,a,o,u,s,l,f,c,d,h){if(or(r)){n=""}else if(or(i)){n=">="+r+".0.0"+(e?"-0":"")}else if(or(a)){n=">="+r+"."+i+".0"+(e?"-0":"")}else if(o){n=">="+n}else{n=">="+n+(e?"-0":"")}if(or(l)){s=""}else if(or(f)){s="<"+(+l+1)+".0.0-0"}else if(or(c)){s="<"+l+"."+(+f+1)+".0-0"}else if(d){s="<="+l+"."+f+"."+c+"-"+d}else if(e){s="<"+l+"."+f+"."+(+c+1)+"-0"}else{s="<="+s}return(n+" "+s).trim()}};var gr=function(e,t,n){for(var r=0;r<e.length;r++){if(!e[r].test(t)){return false}}if(t.prerelease.length&&!n.includePrerelease){for(var r=0;r<e.length;r++){Bt(e[r].semver);if(e[r].semver===br.ANY){continue}if(e[r].semver.prerelease.length>0){var i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch){return true}}}return false}return true};var mr=Symbol("SemVer ANY");var yr=function(){function e(t,n){if(!n||typeof n!=="object"){n={loose:!!n,includePrerelease:false}}if(t instanceof e){if(t.loose===!!n.loose){return t}else{t=t.value}}Bt("comparator",t,n);this.options=n;this.loose=!!n.loose;this.parse(t);if(this.semver===mr){this.value=""}else{this.value=this.operator+this.semver.version}Bt("comp",this)}Object.defineProperty(e,"ANY",{get:function(){return mr},enumerable:true,configurable:true});e.prototype.parse=function(e){var t=this.options.loose?xr[_r.COMPARATORLOOSE]:xr[_r.COMPARATOR];var n=e.match(t);if(!n){throw new TypeError("Invalid comparator: "+e)}this.operator=n[1]!==undefined?n[1]:"";if(this.operator==="="){this.operator=""}if(!n[2]){this.semver=mr}else{this.semver=new Qt(n[2],this.options.loose)}};e.prototype.toString=function(){return this.value};e.prototype.test=function(e){Bt("Comparator.test",e,this.options.loose);if(this.semver===mr||e===mr){return true}if(typeof e==="string"){try{e=new Qt(e,this.options)}catch(t){return false}}return Gn(e,this.operator,this.semver,this.options)};e.prototype.intersects=function(t,n){if(!(t instanceof e)){throw new TypeError("a Comparator is required")}if(!n||typeof n!=="object"){n={loose:!!n,includePrerelease:false}}if(this.operator===""){if(this.value===""){return true}return new Qn(t.value,n).test(this.value)}else if(t.operator===""){if(t.value===""){return true}return new Qn(this.value,n).test(t.semver)}var r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">");var i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<");var a=this.semver.version===t.semver.version;var o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<=");var u=Gn(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<");var s=Gn(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||a&&o||u||s};return e}();var br=yr;var xr=Ut.re,_r=Ut.t;var wr=function(e,t,n){try{t=new Qn(t,n)}catch(r){return false}return t.test(e)};var kr=wr;var Er=function(e,t){return new Qn(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))};var Or=Er;var Ar=function(e,t,n){var r=null;var i=null;var a=null;try{a=new Qn(t,n)}catch(o){return null}e.forEach((function(e){if(a.test(e)){if(!r||i.compare(e)===-1){r=e;i=new Qt(r,n)}}}));return r};var Sr=Ar;var Dr=function(e,t,n){var r=null;var i=null;var a=null;try{a=new Qn(t,n)}catch(o){return null}e.forEach((function(e){if(a.test(e)){if(!r||i.compare(e)===1){r=e;i=new Qt(r,n)}}}));return r};var Cr=Dr;var Mr=function(e,t){e=new Qn(e,t);var n=new Qt("0.0.0");if(e.test(n)){return n}n=new Qt("0.0.0-0");if(e.test(n)){return n}n=null;for(var r=0;r<e.set.length;++r){var i=e.set[r];i.forEach((function(e){var t=new Qt(e.semver.version);switch(e.operator){case">":if(t.prerelease.length===0){t.patch++}else{t.prerelease.push(0)}t.raw=t.format();case"":case">=":if(!n||Rn(n,t)){n=t}break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(n&&e.test(n)){return n}return null};var jr=Mr;var Fr=function(e,t){try{return new Qn(e,t).range||"*"}catch(n){return null}};var Nr=Fr;var Tr=br.ANY;var zr=function(e,t,n,r){e=new Qt(e,r);t=new Qn(t,r);var i,a,o,u,s;switch(n){case">":i=Rn;a=Hn;o=Ln;u=">";s=">=";break;case"<":i=Ln;a=qn;o=Rn;u="<";s="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(kr(e,t,r)){return false}var l=function(n){var l=t.set[n];var f=null;var c=null;l.forEach((function(e){if(e.semver===Tr){e=new br(">=0.0.0")}f=f||e;c=c||e;if(i(e.semver,f.semver,r)){f=e}else if(o(e.semver,c.semver,r)){c=e}}));if(f.operator===u||f.operator===s){return{value:false}}if((!c.operator||c.operator===u)&&a(e,c.semver)){return{value:false}}else if(c.operator===s&&o(e,c.semver)){return{value:false}}};for(var f=0;f<t.set.length;++f){var c=l(f);if(typeof c==="object")return c.value}return true};var Rr=zr;var Pr=function(e,t,n){return Rr(e,t,">",n)};var Lr=Pr;var Ir=function(e,t,n){return Rr(e,t,"<",n)};var Br=Ir;var Ur=function(e,t,n){e=new Qn(e,n);t=new Qn(t,n);return e.intersects(t)};var qr=Ur;var Wr=function(e,t,n){var r=[];var i=null;var a=null;var o=e.sort((function(e,t){return dn(e,t,n)}));for(var u=0,s=o;u<s.length;u++){var l=s[u];var f=kr(l,t,n);if(f){a=l;if(!i)i=l}else{if(a){r.push([i,a])}a=null;i=null}}if(i)r.push([i,null]);var c=[];for(var d=0,h=r;d<h.length;d++){var p=h[d],v=p[0],g=p[1];if(v===g)c.push(v);else if(!g&&v===o[0])c.push("*");else if(!g)c.push(">="+v);else if(v===o[0])c.push("<="+g);else c.push(v+" - "+g)}var m=c.join(" || ");var y=typeof t.raw==="string"?t.raw:String(t);return m.length<y.length?m:t};var Hr=br.ANY;var $r=function(e,t,n){e=new Qn(e,n);t=new Qn(t,n);var r=false;e:for(var i=0,a=e.set;i<a.length;i++){var o=a[i];for(var u=0,s=t.set;u<s.length;u++){var l=s[u];var f=Gr(o,l,n);r=r||f!==null;if(f)continue e}if(r)return false}return true};var Gr=function(e,t,n){if(e.length===1&&e[0].semver===Hr)return t.length===1&&t[0].semver===Hr;var r=new Set;var i,a;for(var o=0,u=e;o<u.length;o++){var s=u[o];if(s.operator===">"||s.operator===">=")i=Vr(i,s,n);else if(s.operator==="<"||s.operator==="<=")a=Yr(a,s,n);else r.add(s.semver)}if(r.size>1)return null;var l;if(i&&a){l=dn(i.semver,a.semver,n);if(l>0)return null;else if(l===0&&(i.operator!==">="||a.operator!=="<="))return null}for(var f=0,c=r;f<c.length;f++){var d=c[f];if(i&&!kr(d,String(i),n))return null;if(a&&!kr(d,String(a),n))return null;for(var h=0,p=t;h<p.length;h++){var s=p[h];if(!kr(d,String(s),n))return false}return true}var v,g;var m,y;for(var b=0,x=t;b<x.length;b++){var s=x[b];y=y||s.operator===">"||s.operator===">=";m=m||s.operator==="<"||s.operator==="<=";if(i){if(s.operator===">"||s.operator===">="){v=Vr(i,s,n);if(v===s)return false}else if(i.operator===">="&&!kr(i.semver,String(s),n))return false}if(a){if(s.operator==="<"||s.operator==="<="){g=Yr(a,s,n);if(g===s)return false}else if(a.operator==="<="&&!kr(a.semver,String(s),n))return false}if(!s.operator&&(a||i)&&l!==0)return false}if(i&&m&&!a&&l!==0)return false;if(a&&y&&!i&&l!==0)return false;return true};var Vr=function(e,t,n){if(!e)return t;var r=dn(e.semver,t.semver,n);return r>0?e:r<0?t:t.operator===">"&&e.operator===">="?t:e};var Yr=function(e,t,n){if(!e)return t;var r=dn(e.semver,t.semver,n);return r<0?e:r>0?t:t.operator==="<"&&e.operator==="<="?t:e};var Xr=$r;var Jr={re:Ut.re,src:Ut.src,tokens:Ut.t,SEMVER_SPEC_VERSION:Lt.SEMVER_SPEC_VERSION,SemVer:Qt,compareIdentifiers:$t.compareIdentifiers,rcompareIdentifiers:$t.rcompareIdentifiers,parse:rn,valid:on,clean:sn,inc:fn,diff:gn,major:yn,minor:xn,patch:wn,prerelease:En,compare:dn,rcompare:An,compareLoose:Dn,compareBuild:Mn,sort:Fn,rsort:Tn,gt:Rn,lt:Ln,eq:pn,neq:Bn,gte:qn,lte:Hn,cmp:Gn,coerce:Jn,Comparator:br,Range:Qn,satisfies:kr,toComparators:Or,maxSatisfying:Sr,minSatisfying:Cr,minVersion:jr,validRange:Nr,outside:Rr,gtr:Lr,ltr:Br,intersects:qr,simplifyRange:Wr,subset:Xr};var Zr=Jr.satisfies;function Qr(e,t,n){e.fields=t||[];e.fname=n;return e}function Kr(e){return e==null?null:e.fname}function ei(e){return e==null?null:e.fields}function ti(e){throw Error(e)}function ni(e){var t=[],n=null,r=0,i=e.length,a="",o,u,s;e=e+"";function l(){t.push(a+e.substring(o,u));a="";o=u+1}for(o=u=0;u<i;++u){s=e[u];if(s==="\\"){a+=e.substring(o,u);a+=e.substring(++u,++u);o=u}else if(s===n){l();n=null;r=-1}else if(n){continue}else if(o===r&&s==='"'){o=u+1;n=s}else if(o===r&&s==="'"){o=u+1;n=s}else if(s==="."&&!r){if(u>o){l()}else{o=u+1}}else if(s==="["){if(u>o)l();r=o=u+1}else if(s==="]"){if(!r)ti("Access path missing open bracket: "+e);if(r>0)l();r=0;o=u+1}}if(r)ti("Access path missing closing bracket: "+e);if(n)ti("Access path missing closing quote: "+e);if(u>o){u++;l()}return t}var ri=Array.isArray;function ii(e){return e===Object(e)}function ai(e){return typeof e==="string"}function oi(e){return ri(e)?"["+e.map(oi)+"]":ii(e)||ai(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function ui(e,t){var n=ni(e),r="return _["+n.map(oi).join("][")+"];";return Qr(Function("_",r),[e=n.length===1?n[0]:e],t||e)}var si=[];var li=ui("id");var fi=Qr((function(e){return e}),si,"identity");var ci=Qr((function(){return 0}),si,"zero");var di=Qr((function(){return 1}),si,"one");var hi=Qr((function(){return true}),si,"true");var pi=Qr((function(){return false}),si,"false");function vi(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var gi=0;var mi=1;var yi=2;var bi=3;var xi=4;function _i(e,t){var n=e||gi;return{level:function(e){if(arguments.length){n=+e;return this}else{return n}},error:function(){if(n>=mi)vi(t||"error","ERROR",arguments);return this},warn:function(){if(n>=yi)vi(t||"warn","WARN",arguments);return this},info:function(){if(n>=bi)vi(t||"log","INFO",arguments);return this},debug:function(){if(n>=xi)vi(t||"log","DEBUG",arguments);return this}}}var wi=function(e){return e!=="__proto__"};function ki(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return e.reduce((function(e,t){for(var n in t){if(n==="signals"){e.signals=Oi(e.signals,t.signals)}else{var r=n==="legend"?{layout:1}:n==="style"?true:null;Ei(e,n,t[n],r)}}return e}),{})}function Ei(e,t,n,r){if(!wi(t))return;var i,a;if(ii(n)&&!ri(n)){a=ii(e[t])?e[t]:e[t]={};for(i in n){if(r&&(r===true||r[i])){Ei(a,i,n[i])}else if(wi(i)){a[i]=n[i]}}}else{e[t]=n}}function Oi(e,t){if(e==null)return t;var n={},r=[];function i(e){if(!n[e.name]){n[e.name]=1;r.push(e)}}t.forEach(i);e.forEach(i);return r}function Ai(e){return e[e.length-1]}function Si(e){return e==null||e===""?null:+e}function Di(e){return function(t){return e*Math.exp(t)}}function Ci(e){return function(t){return Math.log(e*t)}}function Mi(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function ji(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Fi(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Ni(e,t,n,r){var i=n(e[0]),a=n(Ai(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function Ti(e,t){return Ni(e,t,Si,fi)}function zi(e,t){var n=Math.sign(e[0]);return Ni(e,t,Ci(n),Di(n))}function Ri(e,t,n){return Ni(e,t,Fi(n),Fi(1/n))}function Pi(e,t,n){return Ni(e,t,Mi(n),ji(n))}function Li(e,t,n,r,i){var a=r(e[0]),o=r(Ai(e)),u=t!=null?r(t):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function Ii(e,t,n){return Li(e,t,n,Si,fi)}function Bi(e,t,n){var r=Math.sign(e[0]);return Li(e,t,n,Ci(r),Di(r))}function Ui(e,t,n,r){return Li(e,t,n,Fi(r),Fi(1/r))}function qi(e,t,n,r){return Li(e,t,n,Mi(r),ji(r))}function Wi(e){return 1+~~(new Date(e).getMonth()/3)}function Hi(e){return 1+~~(new Date(e).getUTCMonth()/3)}function $i(e){return e!=null?ri(e)?e:[e]:[]}function Gi(e,t,n){var r=e[0],i=e[1],a;if(i<r){a=i;i=r;r=a}a=i-r;return a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function Vi(e){return typeof e==="function"}function Yi(e,t){var n=[],r=(e=$i(e)).map((function(e,t){if(e==null){return null}else{n.push(t);return Vi(e)?e:ni(e).map(oi).join("][")}})),i=n.length-1,a=$i(t),o="var u,v;return ",u,s,l,f,c,d,h,p,v;if(i<0)return null;for(s=0;s<=i;++s){u=n[s];l=r[u];if(Vi(l)){d="f"+u;f="(u=this."+d+"(a))";c="(v=this."+d+"(b))";(h=h||{})[d]=l}else{f="(u=a["+l+"])";c="(v=b["+l+"])"}d="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))";if(a[u]!=="descending"){v=1;p=-1}else{v=-1;p=1}o+="("+f+"<"+c+"||u==null)&&v!=null?"+p+":(u>v||v==null)&&u!=null?"+v+":"+d+"!==u&&v===v?"+p+":v!==v&&u===u?"+v+(u<i?":":":0")}l=Function("a","b",o+";");if(h)l=l.bind(h);e=e.reduce((function(e,t){if(Vi(t)){(ei(t)||[]).forEach((function(t){e[t]=1}))}else if(t!=null){e[t+""]=1}return e}),{});return Qr(l,Object.keys(e))}function Xi(e){return Vi(e)?e:function(){return e}}function Ji(e,t){var n,r;function i(){t(r);n=r=null}return function(t){r=t;if(n)clearTimeout(n);n=setTimeout(i,e)}}function Zi(e){for(var t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t){e[n]=t[n]}}return e}function Qi(e,t){var n=0,r,i,a,o;if(e&&(r=e.length)){if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);a=o=i;for(;n<r;++n){i=e[n];if(i!=null){if(i<a)a=i;if(i>o)o=i}}}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));a=o=i;for(;n<r;++n){i=t(e[n]);if(i!=null){if(i<a)a=i;if(i>o)o=i}}}}return[a,o]}function Ki(e,t){var n=-1,r=e.length,i,a,o,u,s;if(t==null){while(++n<r){a=e[n];if(a!=null&&a>=a){i=o=a;break}}if(n===r)return[-1,-1];u=s=n;while(++n<r){a=e[n];if(a!=null){if(i>a){i=a;u=n}if(o<a){o=a;s=n}}}}else{while(++n<r){a=t(e[n],n,e);if(a!=null&&a>=a){i=o=a;break}}if(n===r)return[-1,-1];u=s=n;while(++n<r){a=t(e[n],n,e);if(a!=null){if(i>a){i=a;u=n}if(o<a){o=a;s=n}}}}return[u,s]}var ea=Object.prototype.hasOwnProperty;function ta(e,t){return ea.call(e,t)}var na={};function ra(e){var t={},n,r;function i(e){return ta(t,e)&&t[e]!==na}n={size:0,empty:0,object:t,has:i,get:function(e){return i(e)?t[e]:undefined},set:function(e,r){if(!i(e)){++n.size;if(t[e]===na)--n.empty}t[e]=r;return this},delete:function(e){if(i(e)){--n.size;++n.empty;t[e]=na}return this},clear:function(){n.size=n.empty=0;n.object=t={}},test:function(e){if(arguments.length){r=e;return n}else{return r}},clean:function(){var e={},i=0,a,o;for(a in t){o=t[a];if(o!==na&&(!r||!r(o))){e[a]=o;++i}}n.size=i;n.empty=0;n.object=t=e}};if(e)Object.keys(e).forEach((function(t){n.set(t,e[t])}));return n}function ia(e,t,n,r,i,a){if(!n&&n!==0)return a;var o=e[0],u=Ai(e),s=+n,l,f;if(u<o){l=o;o=u;u=l}l=Math.abs(t-o);f=Math.abs(u-t);return l<f&&l<=s?r:f<=s?i:a}function aa(e,t){var n=e.prototype=Object.create(t.prototype);n.constructor=e;return n}function oa(e,t,n,r){var i=t[0],a=t[t.length-1],o;if(i>a){o=i;i=a;a=o}n=n===undefined||n;r=r===undefined||r;return(n?i<=e:i<e)&&(r?e<=a:e<a)}function ua(e){return typeof e==="boolean"}function sa(e){return Object.prototype.toString.call(e)==="[object Date]"}function la(e){return typeof e==="number"}function fa(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function ca(e,t){if(e){e=t?$i(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):$i(e)}var n=!(e&&e.length)?function(){return""}:Function("_","return ''+"+e.map((function(e){return"_["+(t?oi(e):ni(e).map(oi).join("]["))+"]"})).join("+'|'+")+";");return Qr(n,e,"key")}function da(e,t){var n=e[0],r=Ai(e),i=+t;return!i?n:i===1?r:n+i*(r-n)}var ha=1e4;function pa(e){e=+e||ha;var t,n,r;var i=function(){t={};n={};r=0};var a=function(i,a){if(++r>e){n=t;t={};r=1}return t[i]=a};i();return{clear:i,has:function(e){return ta(t,e)||ta(n,e)},get:function(e){return ta(t,e)?t[e]:ta(n,e)?a(e,n[e]):undefined},set:function(e,n){return ta(t,e)?t[e]=n:a(e,n)}}}function va(e,t,n,r){var i=t.length,a=n.length;if(!a)return t;if(!i)return n;var o=r||new t.constructor(i+a),u=0,s=0,l=0;for(;u<i&&s<a;++l){o[l]=e(t[u],n[s])>0?n[s++]:t[u++]}for(;u<i;++u,++l){o[l]=t[u]}for(;s<a;++s,++l){o[l]=n[s]}return o}function ga(e,t){var n="";while(--t>=0)n+=e;return n}function ma(e,t,n,r){var i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?ga(i,o)+a:r==="center"?ga(i,~~(o/2))+a+ga(i,Math.ceil(o/2)):a+ga(i,o)}function ya(e){return e&&Ai(e)-e[0]||0}function ba(e){return e==null||e===""?null:!e||e==="false"||e==="0"?false:!!e}function xa(e){return la(e)?e:sa(e)?e:Date.parse(e)}function _a(e,t){t=t||xa;return e==null||e===""?null:t(e)}function wa(e){return e==null||e===""?null:e+""}function ka(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=true;return t}function Ea(e,t,n,r){var i=r!=null?r:"…",a=e+"",o=a.length,u=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i}function Oa(e,t,n){if(e){var r=0,i=e.length,a;if(t){for(;r<i;++r){if(a=t(e[r]))n(a,r,e)}}else{e.forEach(n)}}}function Aa(e){var t=e||fi,n=[],r={};n.add=function(e){var i=t(e);if(!r[i]){r[i]=1;n.push(e)}return n};n.remove=function(e){var i=t(e),a;if(r[i]){r[i]=0;if((a=n.indexOf(e))>=0){n.splice(a,1)}}return n};return n}function Sa(e,t){return Je(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,t(e)];case 1:r.sent();return[3,3];case 2:n=r.sent();e.error(n);return[3,3];case 3:return[2]}}))}))}var Da=Symbol("vega_id"),Ca=1;function Ma(e){return!!(e&&ja(e))}function ja(e){return e[Da]}function Fa(e,t){e[Da]=t;return e}function Na(e){var t=e===Object(e)?e:{data:e};return ja(t)?t:Fa(t,Ca++)}function Ta(e){return za(e,Na({}))}function za(e,t){for(var n in e)t[n]=e[n];return t}function Ra(e,t){return Fa(t,ja(e))}function Pa(e,t){return!e?null:t?function(n,r){return e(n,r)||ja(t(n))-ja(t(r))}:function(t,n){return e(t,n)||ja(t)-ja(n)}}function La(e){return e&&e.constructor===Ia}function Ia(){var e=[],t=[],n=[],r=[],i=[],a=false;return{constructor:Ia,insert:function(t){var n=$i(t),r=0,i=n.length;for(;r<i;++r)e.push(n[r]);return this},remove:function(e){var n=Vi(e)?r:t,i=$i(e),a=0,o=i.length;for(;a<o;++a)n.push(i[a]);return this},modify:function(e,t,r){var a={field:t,value:Xi(r)};if(Vi(e)){a.filter=e;i.push(a)}else{a.tuple=e;n.push(a)}return this},encode:function(e,t){if(Vi(e))i.push({filter:e,field:t});else n.push({tuple:e,field:t});return this},reflow:function(){a=true;return this},pulse:function(o,u){var s={},l={},f,c,d,h,p,v;for(f=0,c=u.length;f<c;++f){s[ja(u[f])]=1}for(f=0,c=t.length;f<c;++f){p=t[f];s[ja(p)]=-1}for(f=0,c=r.length;f<c;++f){h=r[f];u.forEach((function(e){if(h(e))s[ja(e)]=-1}))}for(f=0,c=e.length;f<c;++f){p=e[f];v=ja(p);if(s[v]){s[v]=1}else{o.add.push(Na(e[f]))}}for(f=0,c=u.length;f<c;++f){p=u[f];if(s[ja(p)]<0)o.rem.push(p)}function g(e,t,n){if(n){e[t]=n(e)}else{o.encode=t}if(!a)l[ja(e)]=e}for(f=0,c=n.length;f<c;++f){d=n[f];p=d.tuple;h=d.field;v=s[ja(p)];if(v>0){g(p,h,d.value);o.modifies(h)}}for(f=0,c=i.length;f<c;++f){d=i[f];h=d.filter;u.forEach((function(e){if(h(e)&&s[ja(e)]>0){g(e,d.field,d.value)}}));o.modifies(d.field)}if(a){o.mod=t.length||r.length?u.filter((function(e){return s[ja(e)]>0})):u.slice()}else{for(v in l)o.mod.push(l[v])}return o}}}var Ba="_:mod:_";function Ua(){Object.defineProperty(this,Ba,{writable:true,value:{}})}var qa=Ua.prototype;qa.set=function(e,t,n,r){var i=this,a=i[e],o=i[Ba];if(t!=null&&t>=0){if(a[t]!==n||r){a[t]=n;o[t+":"+e]=-1;o[e]=-1}}else if(a!==n||r){i[e]=n;o[e]=ri(n)?1+n.length:-1}return i};qa.modified=function(e,t){var n=this[Ba],r;if(!arguments.length){for(r in n){if(n[r])return true}return false}else if(ri(e)){for(r=0;r<e.length;++r){if(n[e[r]])return true}return false}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};qa.clear=function(){this[Ba]={};return this};var Wa=0;var Ha="pulse";var $a=new Ua;var Ga=1,Va=2;function Ya(e,t,n,r){this.id=++Wa;this.value=e;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(t){this._update=t}if(n)this.parameters(n,r)}var Xa=Ya.prototype;Xa.targets=function(){return this._targets||(this._targets=Aa(li))};Xa.set=function(e){if(this.value!==e){this.value=e;return 1}else{return 0}};function Ja(e){return function(t){var n=this.flags;if(arguments.length===0)return!!(n&e);this.flags=t?n|e:n&~e;return this}}Xa.skip=Ja(Ga);Xa.modified=Ja(Va);Xa.parameters=function(e,t,n){t=t!==false;var r=this,i=r._argval=r._argval||new Ua,a=r._argops=r._argops||[],o=[],u,s,l,f;function c(e,n,u){if(u instanceof Ya){if(u!==r){if(t)u.targets().add(r);o.push(u)}a.push({op:u,name:e,index:n})}else{i.set(e,n,u)}}for(u in e){s=e[u];if(u===Ha){$i(s).forEach((function(e){if(!(e instanceof Ya)){ti("Pulse parameters must be operator instances.")}else if(e!==r){e.targets().add(r);o.push(e)}}));r.source=s}else if(ri(s)){i.set(u,-1,Array(l=s.length));for(f=0;f<l;++f)c(u,f,s[f])}else{c(u,-1,s)}}this.marshall().clear();if(n)a.initonly=true;return o};Xa.marshall=function(e){var t=this._argval||$a,n=this._argops,r,i,a,o,u;if(n){for(i=0,a=n.length;i<a;++i){r=n[i];o=r.op;u=o.modified()&&o.stamp===e;t.set(r.name,r.index,o.value,u)}if(n.initonly){for(i=0;i<a;++i){r=n[i];r.op.targets().remove(this)}this._argops=null;this._update=null}}return t};Xa.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);n.clear();if(r!==this.value){this.value=r}else if(!this.modified()){return e.StopPropagation}}};Xa.run=function(e){if(e.stamp<this.stamp)return e.StopPropagation;var t;if(this.skip()){this.skip(false);t=0}else{t=this.evaluate(e)}return this.pulse=t||e};function Za(e,t,n,r){var i=1,a;if(e instanceof Ya){a=e}else if(e&&e.prototype instanceof Ya){a=new e}else if(Vi(e)){a=new Ya(null,e)}else{i=0;a=new Ya(e,t)}this.rank(a);if(i){r=n;n=t}if(n)this.connect(a,a.parameters(n,r));this.touch(a);return a}function Qa(e,t){var n=e.rank,r,i;for(r=0,i=t.length;r<i;++r){if(n<t[r].rank){this.rerank(e);return}}}var Ka=0;function eo(e,t,n){this.id=++Ka;this.value=null;if(n)this.receive=n;if(e)this._filter=e;if(t)this._apply=t}function to(e,t,n){return new eo(e,t,n)}var no=eo.prototype;no._filter=hi;no._apply=fi;no.targets=function(){return this._targets||(this._targets=Aa(li))};no.consume=function(e){if(!arguments.length)return!!this._consume;this._consume=!!e;return this};no.receive=function(e){if(this._filter(e)){var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,i=0;for(;i<r;++i)n[i].receive(t);if(this._consume){e.preventDefault();e.stopPropagation()}}};no.filter=function(e){var t=to(e);this.targets().add(t);return t};no.apply=function(e){var t=to(null,e);this.targets().add(t);return t};no.merge=function(){var e=to();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t){arguments[t].targets().add(e)}return e};no.throttle=function(e){var t=-1;return this.filter((function(){var n=Date.now();if(n-t>e){t=n;return 1}else{return 0}}))};no.debounce=function(e){var t=to();this.targets().add(to(null,null,Ji(e,(function(e){var n=e.dataflow;t.receive(e);if(n&&n.run)n.run()}))));return t};no.between=function(e,t){var n=false;e.targets().add(to(null,null,(function(){n=true})));t.targets().add(to(null,null,(function(){n=false})));return this.filter((function(){return n}))};function ro(e,t,n,r){var i=this,a=to(n,r),o=function(e){e.dataflow=i;try{a.receive(e)}catch(ti){i.error(ti)}finally{i.run()}},u;if(typeof e==="string"&&typeof document!=="undefined"){u=document.querySelectorAll(e)}else{u=$i(e)}for(var s=0,l=u.length;s<l;++s){u[s].addEventListener(t,o)}return a}var io=/^([A-Za-z]+:)?\/\//;var ao=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i;var oo=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;var uo="file://";function so(e,t){return function(n){return{options:n||{},sanitize:fo,load:lo,fileAccess:!!t,file:co(t),http:po(e)}}}function lo(e,t){return Je(this,void 0,void 0,(function(){var n,r;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.sanitize(e,t)];case 1:n=i.sent(),r=n.href;return[2,n.localFile?this.file(r):this.http(r,t)]}}))}))}function fo(e,t){return Je(this,void 0,void 0,(function(){var n,r,i,a,o,u,s;return __generator(this,(function(l){t=Zi({},this.options,t);n=this.fileAccess,r={href:null};u=ao.test(e.replace(oo,""));if(e==null||typeof e!=="string"||!u){ti("Sanitize failure, invalid URI: "+oi(e))}s=io.test(e);if((o=t.baseURL)&&!s){if(!e.startsWith("/")&&o[o.length-1]!=="/"){e="/"+e}e=o+e}a=(i=e.startsWith(uo))||t.mode==="file"||t.mode!=="http"&&!s&&n;if(i){e=e.slice(uo.length)}else if(e.startsWith("//")){if(t.defaultProtocol==="file"){e=e.slice(2);a=true}else{e=(t.defaultProtocol||"http")+":"+e}}Object.defineProperty(r,"localFile",{value:!!a});r.href=e;if(t.target){r.target=t.target+""}if(t.rel){r.rel=t.rel+""}if(t.context==="image"&&t.crossOrigin){r.crossOrigin=t.crossOrigin+""}return[2,r]}))}))}function co(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){if(e)r(e);else n(t)}))}))}:ho}function ho(){return Je(this,void 0,void 0,(function(){return __generator(this,(function(e){ti("No file system access.");return[2]}))}))}function po(e){return e?function(t,n){return Je(this,void 0,void 0,(function(){var r,i,a;return __generator(this,(function(o){switch(o.label){case 0:r=Zi({},this.options.http,n),i=n&&n.response;return[4,e(t,r)];case 1:a=o.sent();return[2,!a.ok?ti(a.status+""+a.statusText):Vi(a[i])?a[i]():a.text()]}}))}))}:vo}function vo(){return Je(this,void 0,void 0,(function(){return __generator(this,(function(e){ti("No HTTP fetch method available.");return[2]}))}))}var go={boolean:ba,integer:Si,number:Si,date:_a,string:wa,unknown:fi};var mo=[wo,Oo,Eo,ko];var yo=["boolean","integer","number","date"];function bo(e,t){if(!e||!e.length)return"unknown";var n,r,i,a=0,o=e.length,u=mo.length,s=mo.map((function(e,t){return t+1}));for(r=0,o=e.length;r<o;++r){n=t?e[r][t]:e[r];for(i=0;i<u;++i){if(s[i]&&_o(n)&&!mo[i](n)){s[i]=0;++a;if(a===mo.length)return"string"}}}a=s.reduce((function(e,t){return e===0?t:e}),0)-1;return yo[a]}function xo(e,t){return t.reduce((function(t,n){t[n]=bo(e,n);return t}),{})}function _o(e){return e!=null&&e===e}function wo(e){return e==="true"||e==="false"||e===true||e===false}function ko(e){return!Number.isNaN(Date.parse(e))}function Eo(e){return!Number.isNaN(+e)&&!(e instanceof Date)}function Oo(e){return Eo(e)&&Number.isInteger(+e)}var Ao={},So={},Do=34,Co=10,Mo=13;function jo(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Fo(e,t){var n=jo(e);return function(r,i){return t(n(r),i,e)}}function No(e){var t=Object.create(null),n=[];e.forEach((function(e){for(var r in e){if(!(r in t)){n.push(t[r]=r)}}}));return n}function To(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function zo(e){return e<0?"-"+To(-e,6):e>9999?"+"+To(e,6):To(e,4)}function Ro(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":zo(e.getUTCFullYear())+"-"+To(e.getUTCMonth()+1,2)+"-"+To(e.getUTCDate(),2)+(i?"T"+To(t,2)+":"+To(n,2)+":"+To(r,2)+"."+To(i,3)+"Z":r?"T"+To(t,2)+":"+To(n,2)+":"+To(r,2)+"Z":n||t?"T"+To(t,2)+":"+To(n,2)+"Z":"")}function Po(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var n,r,a=i(e,(function(e,i){if(n)return n(e,i-1);r=e,n=t?Fo(e,t):jo(e)}));a.columns=r||[];return a}function i(e,t){var r=[],i=e.length,a=0,o=0,u,s=i<=0,l=false;if(e.charCodeAt(i-1)===Co)--i;if(e.charCodeAt(i-1)===Mo)--i;function f(){if(s)return So;if(l)return l=false,Ao;var t,r=a,o;if(e.charCodeAt(r)===Do){while(a++<i&&e.charCodeAt(a)!==Do||e.charCodeAt(++a)===Do);if((t=a)>=i)s=true;else if((o=e.charCodeAt(a++))===Co)l=true;else if(o===Mo){l=true;if(e.charCodeAt(a)===Co)++a}return e.slice(r+1,t-1).replace(/""/g,'"')}while(a<i){if((o=e.charCodeAt(t=a++))===Co)l=true;else if(o===Mo){l=true;if(e.charCodeAt(a)===Co)++a}else if(o!==n)continue;return e.slice(r,t)}return s=true,e.slice(r,i)}while((u=f())!==So){var c=[];while(u!==Ao&&u!==So)c.push(u),u=f();if(t&&(c=t(c,o++))==null)continue;r.push(c)}return r}function a(t,n){return t.map((function(t){return n.map((function(e){return f(t[e])})).join(e)}))}function o(t,n){if(n==null)n=No(t);return[n.map(f).join(e)].concat(a(t,n)).join("\n")}function u(e,t){if(t==null)t=No(e);return a(e,t).join("\n")}function s(e){return e.map(l).join("\n")}function l(t){return t.map(f).join(e)}function f(e){return e==null?"":e instanceof Date?Ro(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:r,parseRows:i,format:o,formatBody:u,formatRows:s,formatRow:l,formatValue:f}}function Lo(e){var t=function(t,n){var r={delimiter:e};return Io(t,n?Zi(n,r):r)};t.responseType="text";return t}function Io(e,t){if(t.header){e=t.header.map(oi).join(t.delimiter)+"\n"+e}return Po(t.delimiter).parse(e+"")}Io.responseType="text";function Bo(e){return typeof Buffer==="function"&&Vi(Buffer.isBuffer)?Buffer.isBuffer(e):false}function Uo(e,t){var n=t&&t.property?ui(t.property):fi;return ii(e)&&!Bo(e)?qo(n(e)):n(JSON.parse(e))}Uo.responseType="json";function qo(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}function Wo(e){return e}function Ho(e){if(e==null)return Wo;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(e,u){if(!u)t=n=0;var s=2,l=e.length,f=new Array(l);f[0]=(t+=e[0])*r+a;f[1]=(n+=e[1])*i+o;while(s<l)f[s]=e[s],++s;return f}}function $o(e,t){var n,r=e.length,i=r-t;while(i<--r)n=e[i],e[i++]=e[r],e[r]=n}function Go(e,t){if(typeof t==="string")t=e.objects[t];return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map((function(t){return Vo(e,t)}))}:Vo(e,t)}function Vo(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=Yo(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function Yo(e,t){var n=Ho(e.transform),r=e.arcs;function i(e,t){if(t.length)t.pop();for(var i=r[e<0?~e:e],a=0,o=i.length;a<o;++a){t.push(n(i[a],a))}if(e<0)$o(t,o)}function a(e){return n(e)}function o(e){var t=[];for(var n=0,r=e.length;n<r;++n)i(e[n],t);if(t.length<2)t.push(t[0]);return t}function u(e){var t=o(e);while(t.length<4)t.push(t[0]);return t}function s(e){return e.map(u)}function l(e){var t=e.type,n;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(l)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=o(e.arcs);break;case"MultiLineString":n=e.arcs.map(o);break;case"Polygon":n=s(e.arcs);break;case"MultiPolygon":n=e.arcs.map(s);break;default:return null}return{type:t,coordinates:n}}return l(t)}function Xo(e,t){var n={},r={},i={},a=[],o=-1;t.forEach((function(n,r){var i=e.arcs[n<0?~n:n],a;if(i.length<3&&!i[1][0]&&!i[1][1]){a=t[++o],t[o]=n,t[r]=a}}));t.forEach((function(e){var t=u(e),n=t[0],a=t[1],o,s;if(o=i[n]){delete i[o.end];o.push(e);o.end=a;if(s=r[a]){delete r[s.start];var l=s===o?o:o.concat(s);r[l.start=o.start]=i[l.end=s.end]=l}else{r[o.start]=i[o.end]=o}}else if(o=r[a]){delete r[o.start];o.unshift(e);o.start=n;if(s=i[n]){delete i[s.end];var f=s===o?o:s.concat(o);r[f.start=s.start]=i[f.end=o.end]=f}else{r[o.start]=i[o.end]=o}}else{o=[e];r[o.start=n]=i[o.end=a]=o}}));function u(t){var n=e.arcs[t<0?~t:t],r=n[0],i;if(e.transform)i=[0,0],n.forEach((function(e){i[0]+=e[0],i[1]+=e[1]}));else i=n[n.length-1];return t<0?[i,r]:[r,i]}function s(e,t){for(var r in e){var i=e[r];delete t[i.start];delete i.start;delete i.end;i.forEach((function(e){n[e<0?~e:e]=1}));a.push(i)}}s(i,r);s(r,i);t.forEach((function(e){if(!n[e<0?~e:e])a.push([e])}));return a}function Jo(e){return Yo(e,Zo.apply(this,arguments))}function Zo(e,t,n){var r,i,a;if(arguments.length>1)r=Qo(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:Xo(e,r)}}function Qo(e,t,n){var r=[],i=[],a;function o(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:a})}function u(e){e.forEach(o)}function s(e){e.forEach(u)}function l(e){e.forEach(s)}function f(e){switch(a=e,e.type){case"GeometryCollection":e.geometries.forEach(f);break;case"LineString":u(e.arcs);break;case"MultiLineString":case"Polygon":s(e.arcs);break;case"MultiPolygon":l(e.arcs);break}}f(t);i.forEach(n==null?function(e){r.push(e[0].i)}:function(e){if(n(e[0].g,e[e.length-1].g))r.push(e[0].i)});return r}var Ko={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function eu(e,t){var n,r,i,a;e=Uo(e,t);if(t&&t.feature){n=Go;i=t.feature}else if(t&&t.mesh){n=Jo;i=t.mesh;a=Ko[t.filter]}else{ti("Missing TopoJSON feature or mesh parameter.")}r=(r=e.objects[i])?n(e,r,a):ti("Invalid TopoJSON object: "+i);return r&&r.features||[r]}eu.responseType="json";var tu={dsv:Io,csv:Lo(","),tsv:Lo("\t"),json:Uo,topojson:eu};function nu(e,t){if(arguments.length>1){tu[e]=t;return this}else{return ta(tu,e)?tu[e]:null}}function ru(e){var t=nu(e);return t&&t.responseType||"text"}var iu=new Date,au=new Date;function ou(e,t,n,r){function i(t){return e(t=arguments.length===0?new Date:new Date(+t)),t}i.floor=function(t){return e(t=new Date(+t)),t};i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n};i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n};i.offset=function(e,n){return t(e=new Date(+e),n==null?1:Math.floor(n)),e};i.range=function(n,r,a){var o=[],u;n=i.ceil(n);a=a==null?1:Math.floor(a);if(!(n<r)||!(a>0))return o;do{o.push(u=new Date(+n)),t(n,a),e(n)}while(u<n&&n<r);return o};i.filter=function(n){return ou((function(t){if(t>=t)while(e(t),!n(t))t.setTime(t-1)}),(function(e,r){if(e>=e){if(r<0)while(++r<=0){while(t(e,-1),!n(e)){}}else while(--r>=0){while(t(e,+1),!n(e)){}}}}))};if(n){i.count=function(t,r){iu.setTime(+t),au.setTime(+r);e(iu),e(au);return Math.floor(n(iu,au))};i.every=function(e){e=Math.floor(e);return!isFinite(e)||!(e>0)?null:!(e>1)?i:i.filter(r?function(t){return r(t)%e===0}:function(t){return i.count(0,t)%e===0})}}return i}var uu=ou((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));uu.every=function(e){e=Math.floor(e);if(!isFinite(e)||!(e>0))return null;if(!(e>1))return uu;return ou((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e}))};var su=1e3;var lu=6e4;var fu=36e5;var cu=864e5;var du=6048e5;var hu=ou((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*su)}),(function(e,t){return(t-e)/su}),(function(e){return e.getUTCSeconds()}));var pu=ou((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*su)}),(function(e,t){e.setTime(+e+t*lu)}),(function(e,t){return(t-e)/lu}),(function(e){return e.getMinutes()}));var vu=ou((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*su-e.getMinutes()*lu)}),(function(e,t){e.setTime(+e+t*fu)}),(function(e,t){return(t-e)/fu}),(function(e){return e.getHours()}));var gu=ou((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*lu)/cu}),(function(e){return e.getDate()-1}));function mu(e){return ou((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7);t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t*7)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*lu)/du}))}var yu=mu(0);var bu=mu(1);var xu=mu(2);var _u=mu(3);var wu=mu(4);var ku=mu(5);var Eu=mu(6);var Ou=ou((function(e){e.setDate(1);e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12}),(function(e){return e.getMonth()}));var Au=ou((function(e){e.setMonth(0,1);e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));Au.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ou((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e);t.setMonth(0,1);t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)}))};var Su=ou((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*lu)}),(function(e,t){return(t-e)/lu}),(function(e){return e.getUTCMinutes()}));var Du=ou((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*fu)}),(function(e,t){return(t-e)/fu}),(function(e){return e.getUTCHours()}));var Cu=ou((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/cu}),(function(e){return e.getUTCDate()-1}));function Mu(e){return ou((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7);t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t*7)}),(function(e,t){return(t-e)/du}))}var ju=Mu(0);var Fu=Mu(1);var Nu=Mu(2);var Tu=Mu(3);var zu=Mu(4);var Ru=Mu(5);var Pu=Mu(6);var Lu=ou((function(e){e.setUTCDate(1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12}),(function(e){return e.getUTCMonth()}));var Iu=ou((function(e){e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));Iu.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ou((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e);t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}))};function Bu(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);t.setFullYear(e.y);return t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Uu(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));t.setUTCFullYear(e.y);return t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function qu(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Wu(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,u=e.months,s=e.shortMonths;var l=Ju(i),f=Zu(i),c=Ju(a),d=Zu(a),h=Ju(o),p=Zu(o),v=Ju(u),g=Zu(u),m=Ju(s),y=Zu(s);var b={a:N,A:T,b:z,B:R,c:null,d:ys,e:ys,f:ks,H:bs,I:xs,j:_s,L:ws,m:Es,M:Os,p:P,q:L,Q:Ks,s:el,S:As,u:Ss,U:Ds,V:Cs,w:Ms,W:js,x:null,X:null,y:Fs,Y:Ns,Z:Ts,"%":Qs};var x={a:I,A:B,b:U,B:q,c:null,d:zs,e:zs,f:Bs,H:Rs,I:Ps,j:Ls,L:Is,m:Us,M:qs,p:W,q:H,Q:Ks,s:el,S:Ws,u:Hs,U:$s,V:Gs,w:Vs,W:Ys,x:null,X:null,y:Xs,Y:Js,Z:Zs,"%":Qs};var _={a:A,A:S,b:D,B:C,c:M,d:ss,e:ss,f:ps,H:fs,I:fs,j:ls,L:hs,m:us,M:cs,p:O,q:os,Q:gs,s:ms,S:ds,u:Ku,U:es,V:ts,w:Qu,W:ns,x:j,X:F,y:is,Y:rs,Z:as,"%":vs};b.x=w(n,b);b.X=w(r,b);b.c=w(t,b);x.x=w(n,x);x.X=w(r,x);x.c=w(t,x);function w(e,t){return function(n){var r=[],i=-1,a=0,o=e.length,u,s,l;if(!(n instanceof Date))n=new Date(+n);while(++i<o){if(e.charCodeAt(i)===37){r.push(e.slice(a,i));if((s=Hu[u=e.charAt(++i)])!=null)u=e.charAt(++i);else s=u==="e"?" ":"0";if(l=t[u])u=l(n,s);r.push(u);a=i+1}}r.push(e.slice(a,i));return r.join("")}}function k(e,t){return function(n){var r=qu(1900,undefined,1),i=E(r,e,n+="",0),a,o;if(i!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(r.s*1e3+("L"in r?r.L:0));if(t&&!("Z"in r))r.Z=0;if("p"in r)r.H=r.H%12+r.p*12;if(r.m===undefined)r.m="q"in r?r.q:0;if("V"in r){if(r.V<1||r.V>53)return null;if(!("w"in r))r.w=1;if("Z"in r){a=Uu(qu(r.y,0,1)),o=a.getUTCDay();a=o>4||o===0?Fu.ceil(a):Fu(a);a=Cu.offset(a,(r.V-1)*7);r.y=a.getUTCFullYear();r.m=a.getUTCMonth();r.d=a.getUTCDate()+(r.w+6)%7}else{a=Bu(qu(r.y,0,1)),o=a.getDay();a=o>4||o===0?bu.ceil(a):bu(a);a=gu.offset(a,(r.V-1)*7);r.y=a.getFullYear();r.m=a.getMonth();r.d=a.getDate()+(r.w+6)%7}}else if("W"in r||"U"in r){if(!("w"in r))r.w="u"in r?r.u%7:"W"in r?1:0;o="Z"in r?Uu(qu(r.y,0,1)).getUTCDay():Bu(qu(r.y,0,1)).getDay();r.m=0;r.d="W"in r?(r.w+6)%7+r.W*7-(o+5)%7:r.w+r.U*7-(o+6)%7}if("Z"in r){r.H+=r.Z/100|0;r.M+=r.Z%100;return Uu(r)}return Bu(r)}}function E(e,t,n,r){var i=0,a=t.length,o=n.length,u,s;while(i<a){if(r>=o)return-1;u=t.charCodeAt(i++);if(u===37){u=t.charAt(i++);s=_[u in Hu?t.charAt(i++):u];if(!s||(r=s(e,n,r))<0)return-1}else if(u!=n.charCodeAt(r++)){return-1}}return r}function O(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=f[r[0].toLowerCase()],n+r[0].length):-1}function A(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1}function S(e,t,n){var r=c.exec(t.slice(n));return r?(e.w=d[r[0].toLowerCase()],n+r[0].length):-1}function D(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1}function C(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1}function M(e,n,r){return E(e,t,n,r)}function j(e,t,r){return E(e,n,t,r)}function F(e,t,n){return E(e,r,t,n)}function N(e){return o[e.getDay()]}function T(e){return a[e.getDay()]}function z(e){return s[e.getMonth()]}function R(e){return u[e.getMonth()]}function P(e){return i[+(e.getHours()>=12)]}function L(e){return 1+~~(e.getMonth()/3)}function I(e){return o[e.getUTCDay()]}function B(e){return a[e.getUTCDay()]}function U(e){return s[e.getUTCMonth()]}function q(e){return u[e.getUTCMonth()]}function W(e){return i[+(e.getUTCHours()>=12)]}function H(e){return 1+~~(e.getUTCMonth()/3)}return{format:function(e){var t=w(e+="",b);t.toString=function(){return e};return t},parse:function(e){var t=k(e+="",false);t.toString=function(){return e};return t},utcFormat:function(e){var t=w(e+="",x);t.toString=function(){return e};return t},utcParse:function(e){var t=k(e+="",true);t.toString=function(){return e};return t}}}var Hu={"-":"",_:" ",0:"0"},$u=/^\s*\d+/,Gu=/^%/,Vu=/[\\^$*+?|[\]().{}]/g;function Yu(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function Xu(e){return e.replace(Vu,"\\$&")}function Ju(e){return new RegExp("^(?:"+e.map(Xu).join("|")+")","i")}function Zu(e){var t={},n=-1,r=e.length;while(++n<r)t[e[n].toLowerCase()]=n;return t}function Qu(e,t,n){var r=$u.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ku(e,t,n){var r=$u.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function es(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ts(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function ns(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function rs(e,t,n){var r=$u.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function is(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function as(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function os(e,t,n){var r=$u.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function us(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function ss(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function ls(e,t,n){var r=$u.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function fs(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function cs(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function ds(e,t,n){var r=$u.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function hs(e,t,n){var r=$u.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function ps(e,t,n){var r=$u.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function vs(e,t,n){var r=Gu.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function gs(e,t,n){var r=$u.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function ms(e,t,n){var r=$u.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function ys(e,t){return Yu(e.getDate(),t,2)}function bs(e,t){return Yu(e.getHours(),t,2)}function xs(e,t){return Yu(e.getHours()%12||12,t,2)}function _s(e,t){return Yu(1+gu.count(Au(e),e),t,3)}function ws(e,t){return Yu(e.getMilliseconds(),t,3)}function ks(e,t){return ws(e,t)+"000"}function Es(e,t){return Yu(e.getMonth()+1,t,2)}function Os(e,t){return Yu(e.getMinutes(),t,2)}function As(e,t){return Yu(e.getSeconds(),t,2)}function Ss(e){var t=e.getDay();return t===0?7:t}function Ds(e,t){return Yu(yu.count(Au(e)-1,e),t,2)}function Cs(e,t){var n=e.getDay();e=n>=4||n===0?wu(e):wu.ceil(e);return Yu(wu.count(Au(e),e)+(Au(e).getDay()===4),t,2)}function Ms(e){return e.getDay()}function js(e,t){return Yu(bu.count(Au(e)-1,e),t,2)}function Fs(e,t){return Yu(e.getFullYear()%100,t,2)}function Ns(e,t){return Yu(e.getFullYear()%1e4,t,4)}function Ts(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Yu(t/60|0,"0",2)+Yu(t%60,"0",2)}function zs(e,t){return Yu(e.getUTCDate(),t,2)}function Rs(e,t){return Yu(e.getUTCHours(),t,2)}function Ps(e,t){return Yu(e.getUTCHours()%12||12,t,2)}function Ls(e,t){return Yu(1+Cu.count(Iu(e),e),t,3)}function Is(e,t){return Yu(e.getUTCMilliseconds(),t,3)}function Bs(e,t){return Is(e,t)+"000"}function Us(e,t){return Yu(e.getUTCMonth()+1,t,2)}function qs(e,t){return Yu(e.getUTCMinutes(),t,2)}function Ws(e,t){return Yu(e.getUTCSeconds(),t,2)}function Hs(e){var t=e.getUTCDay();return t===0?7:t}function $s(e,t){return Yu(ju.count(Iu(e)-1,e),t,2)}function Gs(e,t){var n=e.getUTCDay();e=n>=4||n===0?zu(e):zu.ceil(e);return Yu(zu.count(Iu(e),e)+(Iu(e).getUTCDay()===4),t,2)}function Vs(e){return e.getUTCDay()}function Ys(e,t){return Yu(Fu.count(Iu(e)-1,e),t,2)}function Xs(e,t){return Yu(e.getUTCFullYear()%100,t,2)}function Js(e,t){return Yu(e.getUTCFullYear()%1e4,t,4)}function Zs(){return"+0000"}function Qs(){return"%"}function Ks(e){return+e}function el(e){return Math.floor(+e/1e3)}var tl;var nl;var rl;var il;var al;ol({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ol(e){tl=Wu(e);nl=tl.format;rl=tl.parse;il=tl.utcFormat;al=tl.utcParse;return tl}function ul(e,t,n){t=t||{};var r=nu(t.type||"json");if(!r)ti("Unknown data format type: "+t.type);e=r(e,t);if(t.parse)sl(e,t.parse,n);if(ta(e,"columns"))delete e.columns;return e}function sl(e,t,n){if(!e.length)return;n=n||rl;var r=e.columns||Object.keys(e[0]),i,a,o,u,s,l,f;if(t==="auto")t=xo(e,r);r=Object.keys(t);i=r.map((function(e){var r=t[e],i,a;if(r&&(r.startsWith("date:")||r.startsWith("utc:"))){i=r.split(/:(.+)?/,2);a=i[1];if(a[0]==="'"&&a[a.length-1]==="'"||a[0]==='"'&&a[a.length-1]==='"'){a=a.slice(1,-1)}return i[0]==="utc"?al(a):n(a)}if(!go[r]){throw Error("Illegal format pattern: "+e+":"+r)}return go[r]}));for(u=0,l=e.length,f=r.length;u<l;++u){a=e[u];for(s=0;s<f;++s){o=r[s];a[o]=i[s](a[o])}}}var ll=so(typeof fetch!=="undefined"&&fetch,null);var fl=ul;function cl(e,t,n){return this.pulse(e,this.changeset().insert(fl(t,n)))}function dl(e,t){return Je(this,void 0,void 0,(function(){var n,r,i,a;return __generator(this,(function(o){switch(o.label){case 0:n=this;r=0;o.label=1;case 1:o.trys.push([1,3,,4]);return[4,n.loader().load(e,{context:"dataflow",response:ru(t&&t.type)})];case 2:i=o.sent();try{i=fl(i,t)}catch(u){r=-2;n.warn("Data ingestion failed",e,u)}return[3,4];case 3:a=o.sent();r=-1;n.warn("Loading failed",e,a);return[3,4];case 4:return[2,{data:i,status:r}]}}))}))}function hl(e,t,n){return Je(this,void 0,void 0,(function(){var r,i,a;return __generator(this,(function(o){switch(o.label){case 0:r=this,i=r._pending||pl(r);i.requests+=1;return[4,r.request(t,n)];case 1:a=o.sent();r.pulse(e,r.changeset().remove(hi).insert(a.data||[]));i.done();return[2,a]}}))}))}function pl(e){var t=new Promise((function(e){n=e})),n;t.requests=0;t.done=function(){if(--t.requests===0){e._pending=null;n(e)}};return e._pending=t}var vl={skip:true};function gl(e,t,n,r,i){var a=e instanceof Ya?yl:ml;a(this,e,t,n,r,i);return this}function ml(e,t,n,r,i,a){var o=Zi({},a,vl),u,s;if(!Vi(n))n=Xi(n);if(r===undefined){u=function(t){return e.touch(n(t))}}else if(Vi(r)){s=new Ya(null,r,i,false);u=function(t){s.evaluate(t);var r=n(t),i=s.value;La(i)?e.pulse(r,i,a):e.update(r,i,o)}}else{u=function(t){return e.update(n(t),r,o)}}t.apply(u)}function yl(e,t,n,r,i,a){if(r===undefined){t.targets().add(n)}else{var o=a||{},u=new Ya(null,bl(n,r),i,false);u.modified(o.force);u.rank=t.rank;t.targets().add(u);if(n){u.skip(true);u.value=n.value;u.targets().add(n);e.connect(n,[u])}}}function bl(e,t){t=Vi(t)?t:Xi(t);return e?function(n,r){var i=t(n,r);if(!e.skip()){e.skip(i!==this.value).value=i}return i}:t}function xl(e){e.rank=++this._rank}function _l(e){var t=[e],n,r,i;while(t.length){this.rank(n=t.pop());if(r=n._targets){for(i=r.length;--i>=0;){t.push(n=r[i]);if(n===e)ti("Cycle detected in dataflow graph.")}}}}var wl={};var kl=1<<0,El=1<<1,Ol=1<<2,Al=kl|El,Sl=kl|Ol,Dl=kl|El|Ol,Cl=1<<3,Ml=1<<4,jl=1<<5,Fl=1<<6;function Nl(e,t,n){this.dataflow=e;this.stamp=t==null?-1:t;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}var Tl=Nl.prototype;Tl.StopPropagation=wl;Tl.ADD=kl;Tl.REM=El;Tl.MOD=Ol;Tl.ADD_REM=Al;Tl.ADD_MOD=Sl;Tl.ALL=Dl;Tl.REFLOW=Cl;Tl.SOURCE=Ml;Tl.NO_SOURCE=jl;Tl.NO_FIELDS=Fl;Tl.fork=function(e){return new Nl(this.dataflow).init(this,e)};Tl.clone=function(){var e=this.fork(Dl);e.add=e.add.slice();e.rem=e.rem.slice();e.mod=e.mod.slice();if(e.source)e.source=e.source.slice();return e.materialize(Dl|Ml)};Tl.addAll=function(){var e=this;if(!this.source||this.source.length===this.add.length){return e}else{e=new Nl(this.dataflow).init(this);e.add=e.source;return e}};Tl.init=function(e,t){var n=this;n.stamp=e.stamp;n.encode=e.encode;if(e.fields&&!(t&Fl)){n.fields=e.fields}if(t&kl){n.addF=e.addF;n.add=e.add}else{n.addF=null;n.add=[]}if(t&El){n.remF=e.remF;n.rem=e.rem}else{n.remF=null;n.rem=[]}if(t&Ol){n.modF=e.modF;n.mod=e.mod}else{n.modF=null;n.mod=[]}if(t&jl){n.srcF=null;n.source=null}else{n.srcF=e.srcF;n.source=e.source}return n};Tl.runAfter=function(e){this.dataflow.runAfter(e)};Tl.changed=function(e){var t=e||Dl;return t&kl&&this.add.length||t&El&&this.rem.length||t&Ol&&this.mod.length};Tl.reflow=function(e){if(e)return this.fork(Dl).reflow();var t=this.add.length,n=this.source&&this.source.length;if(n&&n!==t){this.mod=this.source;if(t)this.filter(Ol,Pl(this,kl))}return this};Tl.modifies=function(e){var t=this.fields||(this.fields={});if(ri(e)){e.forEach((function(e){return t[e]=true}))}else{t[e]=true}return this};Tl.modified=function(e,t){var n=this.fields;return!((t||this.mod.length)&&n)?false:!arguments.length?!!n:ri(e)?e.some((function(e){return n[e]})):n[e]};Tl.filter=function(e,t){var n=this;if(e&kl)n.addF=zl(n.addF,t);if(e&El)n.remF=zl(n.remF,t);if(e&Ol)n.modF=zl(n.modF,t);if(e&Ml)n.srcF=zl(n.srcF,t);return n};function zl(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}Tl.materialize=function(e){e=e||Dl;var t=this;if(e&kl&&t.addF){t.add=Rl(t.add,t.addF);t.addF=null}if(e&El&&t.remF){t.rem=Rl(t.rem,t.remF);t.remF=null}if(e&Ol&&t.modF){t.mod=Rl(t.mod,t.modF);t.modF=null}if(e&Ml&&t.srcF){t.source=t.source.filter(t.srcF);t.srcF=null}return t};function Rl(e,t){var n=[];Oa(e,t,(function(e){n.push(e)}));return n}function Pl(e,t){var n={};e.visit(t,(function(e){n[ja(e)]=1}));return function(e){return n[ja(e)]?null:e}}Tl.visit=function(e,t){var n=this,r=t,i,a;if(e&Ml){Oa(n.source,n.srcF,r);return n}if(e&kl)Oa(n.add,n.addF,r);if(e&El)Oa(n.rem,n.remF,r);if(e&Ol)Oa(n.mod,n.modF,r);if(e&Cl&&(i=n.source)){a=n.add.length+n.mod.length;if(a===i.length);else if(a){Oa(i,Pl(n,Sl),r)}else{Oa(i,n.srcF,r)}}return n};function Ll(e,t,n,r){var i=this,a=0,o,u,s,l,f;this.dataflow=e;this.stamp=t;this.fields=null;this.encode=r||null;this.pulses=n;for(s=0,l=n.length;s<l;++s){o=n[s];if(o.stamp!==t)continue;if(o.fields){u=i.fields||(i.fields={});for(f in o.fields){u[f]=1}}if(o.changed(i.ADD))a|=i.ADD;if(o.changed(i.REM))a|=i.REM;if(o.changed(i.MOD))a|=i.MOD}this.changes=a}var Il=aa(Ll,Nl);Il.fork=function(e){var t=new Nl(this.dataflow).init(this,e&this.NO_FIELDS);if(e!==undefined){if(e&t.ADD){this.visit(t.ADD,(function(e){return t.add.push(e)}))}if(e&t.REM){this.visit(t.REM,(function(e){return t.rem.push(e)}))}if(e&t.MOD){this.visit(t.MOD,(function(e){return t.mod.push(e)}))}}return t};Il.changed=function(e){return this.changes&e};Il.modified=function(e){var t=this,n=t.fields;return!(n&&t.changes&t.MOD)?0:ri(e)?e.some((function(e){return n[e]})):n[e]};Il.filter=function(){ti("MultiPulse does not support filtering.")};Il.materialize=function(){ti("MultiPulse does not support materialization.")};Il.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE){for(;a<i;++a){r[a].visit(e,t)}}else{for(;a<i;++a){if(r[a].stamp===n.stamp){r[a].visit(e,t)}}}return n};function Bl(e,t,n){return Je(this,void 0,void 0,(function(){var r,i,a,o,u,s,l,f,c,d,h,p;return __generator(this,(function(v){switch(v.label){case 0:r=this,i=r.logLevel(),a=[];if(r._pulse)return[2,Hl(r)];if(!r._pending)return[3,2];return[4,r._pending];case 1:v.sent();v.label=2;case 2:if(!t)return[3,4];return[4,Sa(r,t)];case 3:v.sent();v.label=4;case 4:if(!r._touched.length){r.info("Dataflow invoked, but nothing to do.");return[2,r]}o=++r._clock,u=0;r._pulse=new Nl(r,o,e);if(i>=bi){f=Date.now();r.debug("-- START PROPAGATION ("+o+") -----")}r._touched.forEach((function(e){return r._enqueue(e,true)}));r._touched=Aa(li);v.label=5;case 5:v.trys.push([5,11,,12]);v.label=6;case 6:if(!(r._heap.size()>0))return[3,10];s=r._heap.pop();if(s.rank!==s.qrank){r._enqueue(s,true);return[3,6]}l=s.run(r._getPulse(s,e));if(!l.then)return[3,8];return[4,l];case 7:l=v.sent();return[3,9];case 8:if(l.async){a.push(l.async);l=wl}v.label=9;case 9:if(i>=xi){r.debug(s.id,l===wl?"STOP":l,s)}if(l!==wl){if(s._targets)s._targets.forEach((function(e){return r._enqueue(e)}))}++u;return[3,6];case 10:return[3,12];case 11:d=v.sent();r._heap.clear();c=d;return[3,12];case 12:r._input={};r._pulse=null;if(i>=bi){f=Date.now()-f;r.info("> Pulse "+o+": "+u+" operators; "+f+"ms")}if(c){r._postrun=[];r.error(c)}if(!r._postrun.length)return[3,16];h=r._postrun.sort((function(e,t){return t.priority-e.priority}));r._postrun=[];p=0;v.label=13;case 13:if(!(p<h.length))return[3,16];return[4,Sa(r,h[p].callback)];case 14:v.sent();v.label=15;case 15:++p;return[3,13];case 16:if(!n)return[3,18];return[4,Sa(r,n)];case 17:v.sent();v.label=18;case 18:if(a.length){Promise.all(a).then((function(e){return r.runAsync(null,(function(){e.forEach((function(e){try{e(r)}catch(t){r.error(t)}}))}))}))}return[2,r]}}))}))}function Ul(e,t,n){return Je(this,void 0,void 0,(function(){var r;var i=this;return __generator(this,(function(a){switch(a.label){case 0:if(!this._running)return[3,2];return[4,this._running];case 1:a.sent();return[3,0];case 2:r=function(){return i._running=null};(this._running=this.evaluate(e,t,n)).then(r,r);return[2,this._running]}}))}))}function ql(e,t,n){return this._pulse?Hl(this):(this.evaluate(e,t,n),this)}function Wl(e,t,n){if(this._pulse||t){this._postrun.push({priority:n||0,callback:e})}else{try{e(this)}catch(r){this.error(r)}}}function Hl(e){e.error("Dataflow already running. Use runAsync() to chain invocations.");return e}function $l(e,t){var n=e.stamp<this._clock;if(n)e.stamp=this._clock;if(n||t){e.qrank=e.rank;this._heap.push(e)}}function Gl(e,t){var n=e.source,r=this._clock;return n&&ri(n)?new Ll(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||Vl(this._pulse,n&&n.pulse)}function Vl(e,t){if(t&&t.stamp===e.stamp){return t}e=e.fork();if(t&&t!==wl){e.source=t.source}return e}var Yl={skip:false,force:false};function Xl(e,t){var n=t||Yl;if(this._pulse){this._enqueue(e)}else{this._touched.add(e)}if(n.skip)e.skip(true);return this}function Jl(e,t,n){var r=n||Yl;if(e.set(t)||r.force){this.touch(e,r)}return this}function Zl(e,t,n){this.touch(e,n||Yl);var r=new Nl(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];r.target=e;this._input[e.id]=t.pulse(r,i);return this}function Ql(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){t.push(n);return Kl(t,0,t.length-1,e)},pop:function(){var n=t.pop(),r;if(t.length){r=t[0];t[0]=n;ef(t,0,e)}else{r=n}return r}}}function Kl(e,t,n,r){var i,a,o;i=e[n];while(n>t){o=n-1>>1;a=e[o];if(r(i,a)<0){e[n]=a;n=o;continue}break}return e[n]=i}function ef(e,t,n){var r=t,i=e.length,a=e[t],o=(t<<1)+1,u;while(o<i){u=o+1;if(u<i&&n(e[o],e[u])>=0){o=u}e[t]=e[o];t=o;o=(t<<1)+1}e[t]=a;return Kl(e,r,t,n)}function tf(){this.logger(_i());this.logLevel(mi);this._clock=0;this._rank=0;try{this._loader=ll()}catch(e){}this._touched=Aa(li);this._input={};this._pulse=null;this._heap=Ql((function(e,t){return e.qrank-t.qrank}));this._postrun=[]}var nf=tf.prototype;nf.stamp=function(){return this._clock};nf.loader=function(e){if(arguments.length){this._loader=e;return this}else{return this._loader}};nf.cleanThreshold=1e4;nf.add=Za;nf.connect=Qa;nf.rank=xl;nf.rerank=_l;nf.pulse=Zl;nf.touch=Xl;nf.update=Jl;nf.changeset=Ia;nf.ingest=cl;nf.parse=fl;nf.preload=hl;nf.request=dl;nf.events=ro;nf.on=gl;nf.evaluate=Bl;nf.run=ql;nf.runAsync=Ul;nf.runAfter=Wl;nf._enqueue=$l;nf._getPulse=Gl;function rf(e){return function(){return this._log[e].apply(this,arguments)}}nf.logger=function(e){if(arguments.length){this._log=e;return this}else{return this._log}};nf.error=rf("error");nf.warn=rf("warn");nf.info=rf("info");nf.debug=rf("debug");nf.logLevel=rf("level");function af(e,t){Ya.call(this,e,null,t)}var of=aa(af,Ya);of.run=function(e){var t=this;if(e.stamp<this.stamp)return e.StopPropagation;var n;if(this.skip()){this.skip(false)}else{n=this.evaluate(e)}n=n||e;if(n.then){n=n.then((function(e){return t.pulse=e}))}else if(n!==e.StopPropagation){this.pulse=n}return n};of.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);t.clear();return n};of.transform=function(){};var uf={};function sf(e){var t=lf(e);return t&&t.Definition||null}function lf(e){e=e&&e.toLowerCase();return ta(uf,e)?uf[e]:null}function ff(e){return function(t){var n=e.length,r=1,i=String(e[0](t));for(;r<n;++r){i+="|"+e[r](t)}return i}}function cf(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:ff(e)}function df(e,t,n){return n||e+(!t?"":"_"+t)}var hf={values:gf({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:gf({name:"count",set:"cell.num"}),__count__:gf({name:"count",set:"this.missing + this.valid"}),missing:gf({name:"missing",set:"this.missing"}),valid:gf({name:"valid",set:"this.valid"}),sum:gf({name:"sum",init:"this.sum = 0;",add:"this.sum += +v;",rem:"this.sum -= v;",set:"this.sum"}),product:gf({name:"product",init:"this.product = 1;",add:"this.product *= v;",rem:"this.product /= v;",set:"this.valid ? this.product : undefined"}),mean:gf({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.valid ? this.mean : undefined"}),average:gf({name:"average",set:"this.valid ? this.mean : undefined",req:["mean"],idx:1}),variance:gf({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : undefined",req:["mean"],idx:1}),variancep:gf({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : undefined",req:["variance"],idx:2}),stdev:gf({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined",req:["variance"],idx:2}),stdevp:gf({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined",req:["variance"],idx:2}),stderr:gf({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined",req:["variance"],idx:2}),distinct:gf({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:gf({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:gf({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:gf({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:gf({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:gf({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:gf({name:"argmin",init:"this.argmin = undefined;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = undefined;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:gf({name:"argmax",init:"this.argmax = undefined;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = undefined;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:gf({name:"min",init:"this.min = undefined;",add:"if (v < this.min || this.min === undefined) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (Number.isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:gf({name:"max",init:"this.max = undefined;",add:"if (v > this.max || this.max === undefined) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (Number.isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})};var pf=Object.keys(hf);function vf(e,t){return hf[e](t)}function gf(e){return function(t){var n=Zi({init:"",add:"",rem:"",idx:0},e);n.out=t||e.name;return n}}function mf(e,t){return e.idx-t.idx}function yf(e,t){function n(e,r){function i(t){if(!e[t])n(e,e[t]=hf[t]())}if(r.req)r.req.forEach(i);if(t&&r.str)r.str.forEach(i);return e}var r=e.reduce(n,e.reduce((function(e,t){e[t.name]=t;return e}),{}));var i=[],a;for(a in r)i.push(r[a]);return i.sort(mf)}function bf(e,t){var n=t||fi,r=yf(e,true),i="var cell = this.cell; this.valid = 0; this.missing = 0;",a="this.cell = cell; this.init();",o="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",u="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",s="var cell = this.cell;";r.forEach((function(e){i+=e.init;o+=e.add;u+=e.rem}));e.slice().sort(mf).forEach((function(e){s+="t["+oi(e.out)+"]="+e.set+";"}));s+="return t;";a=Function("cell",a);a.prototype.init=Function(i);a.prototype.add=Function("v","t",o);a.prototype.rem=Function("v","t",u);a.prototype.set=Function("t",s);a.prototype.get=n;a.fields=e.map((function(e){return e.out}));return a}function xf(e,t){var n,r,i,a,o,u,s;return __generator(this,(function(l){switch(l.label){case 0:if(!(t===undefined))return[3,5];n=0,r=e;l.label=1;case 1:if(!(n<r.length))return[3,4];i=r[n];if(!(i!=null&&(i=+i)>=i))return[3,3];return[4,i];case 2:l.sent();l.label=3;case 3:n++;return[3,1];case 4:return[3,9];case 5:a=-1;o=0,u=e;l.label=6;case 6:if(!(o<u.length))return[3,9];s=u[o];if(!((s=t(s,++a,e))!=null&&(s=+s)>=s))return[3,8];return[4,s];case 7:l.sent();l.label=8;case 8:o++;return[3,6];case 9:return[2]}}))}function _f(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function wf(e){if(e.length===1)e=kf(e);return{left:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)<0)r=a+1;else i=a}return r},right:function(t,n,r,i){if(r==null)r=0;if(i==null)i=t.length;while(r<i){var a=r+i>>>1;if(e(t[a],n)>0)i=a;else r=a+1}return r}}}function kf(e){return function(t,n){return _f(e(t),n)}}var Ef=wf(_f);var Of=Ef.right;var Af=Ef.left;function Sf(e,t){var n=0;var r;var i=0;var a=0;if(t===undefined){for(var o=0,u=e;o<u.length;o++){var s=u[o];if(s!=null&&(s=+s)>=s){r=s-i;i+=r/++n;a+=r*(s-i)}}}else{var l=-1;for(var f=0,c=e;f<c.length;f++){var d=c[f];if((d=t(d,++l,e))!=null&&(d=+d)>=d){r=d-i;i+=r/++n;a+=r*(d-i)}}}if(n>1)return a/(n-1)}function Df(e,t){var n=Sf(e,t);return n?Math.sqrt(n):n}function Cf(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a}var Mf=Math.sqrt(50),jf=Math.sqrt(10),Ff=Math.sqrt(2);function Nf(e,t,n){var r,i=-1,a,o,u;t=+t,e=+e,n=+n;if(e===t&&n>0)return[e];if(r=t<e)a=e,e=t,t=a;if((u=Tf(e,t,n))===0||!isFinite(u))return[];if(u>0){e=Math.ceil(e/u);t=Math.floor(t/u);o=new Array(a=Math.ceil(t-e+1));while(++i<a)o[i]=(e+i)*u}else{e=Math.floor(e*u);t=Math.ceil(t*u);o=new Array(a=Math.ceil(e-t+1));while(++i<a)o[i]=(e-i)/u}if(r)o.reverse();return o}function Tf(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Mf?10:a>=jf?5:a>=Ff?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Mf?10:a>=jf?5:a>=Ff?2:1)}function zf(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;if(a>=Mf)i*=10;else if(a>=jf)i*=5;else if(a>=Ff)i*=2;return t<e?-i:i}function Rf(e,t){var n;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a!=null&&(n<a||n===undefined&&a>=a)){n=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if((l=t(l,++o,e))!=null&&(n<l||n===undefined&&l>=l)){n=l}}}return n}function Pf(e,t){var n;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a!=null&&(n>a||n===undefined&&a>=a)){n=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if((l=t(l,++o,e))!=null&&(n>l||n===undefined&&l>=l)){n=l}}}return n}function Lf(e,t,n,r,i){if(n===void 0){n=0}if(r===void 0){r=e.length-1}if(i===void 0){i=_f}while(r>n){if(r-n>600){var a=r-n+1;var o=t-n+1;var u=Math.log(a);var s=.5*Math.exp(2*u/3);var l=.5*Math.sqrt(u*s*(a-s)/a)*(o-a/2<0?-1:1);var f=Math.max(n,Math.floor(t-o*s/a+l));var c=Math.min(r,Math.floor(t+(a-o)*s/a+l));Lf(e,t,f,c,i)}var d=e[t];var h=n;var p=r;If(e,n,t);if(i(e[r],d)>0)If(e,n,r);while(h<p){If(e,h,p),++h,--p;while(i(e[h],d)<0)++h;while(i(e[p],d)>0)--p}if(i(e[n],d)===0)If(e,n,p);else++p,If(e,p,r);if(p<=t)n=p+1;if(t<=p)r=p-1}return e}function If(e,t,n){var r=e[t];e[t]=e[n];e[n]=r}function Bf(e){return e===null?NaN:+e}function Uf(e,t){var n,r,i,a,o,u,s;return __generator(this,(function(l){switch(l.label){case 0:if(!(t===undefined))return[3,5];n=0,r=e;l.label=1;case 1:if(!(n<r.length))return[3,4];i=r[n];if(!(i!=null&&(i=+i)>=i))return[3,3];return[4,i];case 2:l.sent();l.label=3;case 3:n++;return[3,1];case 4:return[3,9];case 5:a=-1;o=0,u=e;l.label=6;case 6:if(!(o<u.length))return[3,9];s=u[o];if(!((s=t(s,++a,e))!=null&&(s=+s)>=s))return[3,8];return[4,s];case 7:l.sent();l.label=8;case 8:o++;return[3,6];case 9:return[2]}}))}function qf(e,t,n){e=Float64Array.from(Uf(e,n));if(!(r=e.length))return;if((t=+t)<=0||r<2)return Pf(e);if(t>=1)return Rf(e);var r,i=(r-1)*t,a=Math.floor(i),o=Rf(Lf(e,a).subarray(0,a+1)),u=Pf(e.subarray(a+1));return o+(u-o)*(i-a)}function Wf(e,t,n){if(n===void 0){n=Bf}if(!(r=e.length))return;if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),u=+n(e[a+1],a+1,e);return o+(u-o)*(i-a)}function Hf(e,t){var n=0;var r=0;if(t===undefined){for(var i=0,a=e;i<a.length;i++){var o=a[i];if(o!=null&&(o=+o)>=o){++n,r+=o}}}else{var u=-1;for(var s=0,l=e;s<l.length;s++){var f=l[s];if((f=t(f,++u,e))!=null&&(f=+f)>=f){++n,r+=f}}}if(n)return r/n}function $f(e,t){return qf(e,.5,t)}function Gf(e,t){return Array.from(t,(function(t){return e[t]}))}function Vf(e,t){var n=0;if(t===undefined){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a=+a){n+=a}}}else{var o=-1;for(var u=0,s=e;u<s.length;u++){var l=s[u];if(l=+t(l,++o,e)){n+=l}}}return n}function Yf(e,t,n){var r=Float64Array.from(xf(e,n));r.sort(_f);return t.map((function(e){return Wf(r,e)}))}function Xf(e,t){return Yf(e,[.25,.5,.75],t)}function Jf(e,t){var n=e.length,r=Df(e,t),i=Xf(e,t),a=(i[2]-i[0])/1.34;r=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*r*Math.pow(n,-.2)}function Zf(e){var t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2],a=e.extent[0],o=e.extent[1],u=e.span||o-a||Math.abs(a)||1,s,l,f,c,d,h,p,v;if(e.step){s=e.step}else if(e.steps){d=u/t;for(h=0,p=e.steps.length;h<p&&e.steps[h]<d;++h);s=e.steps[Math.max(0,h-1)]}else{l=Math.ceil(Math.log(t)/r);f=e.minstep||0;s=Math.max(f,Math.pow(n,Math.round(Math.log(u)/r)-l));while(Math.ceil(u/s)>t){s*=n}for(h=0,p=i.length;h<p;++h){d=s/i[h];if(d>=f&&u/d<=t)s=d}}d=Math.log(s);c=d>=0?0:~~(-d/r)+1;v=Math.pow(n,-c-1);if(e.nice||e.nice===undefined){d=Math.floor(a/s+v)*s;a=a<d?d-s:d;o=Math.ceil(o/s)*s}return{start:a,stop:o===a?a+s:o,step:s}}var Qf=Math.random;function Kf(e){Qf=e}function ec(e,t,n,r){if(!e.length)return[undefined,undefined];var i=Float64Array.from(xf(e,r)),a=i.length,o=t,u,s,l,f;for(l=0,f=Array(o);l<o;++l){for(u=0,s=0;s<a;++s){u+=i[~~(Qf()*a)]}f[l]=u/a}f.sort(_f);return[qf(f,n/2),qf(f,1-n/2)]}function tc(e,t,n,r){r=r||function(e){return e};var i=0,a=1,o=e.length,u=new Float64Array(o),s=r(e[0]),l=s,f=s+t,c;for(;a<o;++a){c=r(e[a]);if(c>=f){l=(s+l)/2;for(;i<a;++i)u[i]=l;f=c+t;s=c}l=c}l=(s+l)/2;for(;i<a;++i)u[i]=l;return n?nc(u,t+t/4):u}function nc(e,t){var n=e.length,r=0,i=1,a,o;while(e[r]===e[i])++i;while(i<n){a=i+1;while(e[i]===e[a])++a;if(e[i]-e[i-1]<t){o=i+(r+a-i-i>>1);while(o<i)e[o++]=e[i];while(o>i)e[o--]=e[r]}r=i;i=a}return e}function rc(e){return function(){e=(1103515245*e+12345)%2147483647;return e/2147483647}}function ic(e,t){if(t==null){t=e;e=0}var n={},r,i,a;n.min=function(e){if(arguments.length){r=e||0;a=i-r;return n}else{return r}};n.max=function(e){if(arguments.length){i=e||0;a=i-r;return n}else{return i}};n.sample=function(){return r+Math.floor(a*Qf())};n.pdf=function(e){return e===Math.floor(e)&&e>=r&&e<i?1/a:0};n.cdf=function(e){var t=Math.floor(e);return t<r?0:t>=i?1:(t-r+1)/a};n.icdf=function(e){return e>=0&&e<=1?r-1+Math.floor(e*a):NaN};return n.min(e).max(t)}var ac=Math.sqrt(2*Math.PI);var oc=Math.SQRT2;var uc=NaN;function sc(e,t){e=e||0;t=t==null?1:t;var n=0,r=0,i,a;if(uc===uc){n=uc;uc=NaN}else{do{n=Qf()*2-1;r=Qf()*2-1;i=n*n+r*r}while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i);n*=a;uc=r*a}return e+n*t}function lc(e,t,n){n=n==null?1:n;var r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*ac)}function fc(e,t,n){t=t||0;n=n==null?1:n;var r,i=(e-t)/n,a=Math.abs(i);if(a>37){r=0}else{var o,u=Math.exp(-a*a/2);if(a<7.07106781186547){o=.0352624965998911*a+.700383064443688;o=o*a+6.37396220353165;o=o*a+33.912866078383;o=o*a+112.079291497871;o=o*a+221.213596169931;o=o*a+220.206867912376;r=u*o;o=.0883883476483184*a+1.75566716318264;o=o*a+16.064177579207;o=o*a+86.7807322029461;o=o*a+296.564248779674;o=o*a+637.333633378831;o=o*a+793.826512519948;o=o*a+440.413735824752;r=r/o}else{o=a+.65;o=a+4/o;o=a+3/o;o=a+2/o;o=a+1/o;r=u/o/2.506628274631}}return i>0?1-r:r}function cc(e,t,n){if(e<0||e>1)return NaN;return(t||0)+(n==null?1:n)*oc*dc(2*e-1)}function dc(e){var t=-Math.log((1-e)*(1+e)),n;if(t<6.25){t-=3.125;n=-364441206401782e-35;n=-16850591381820166e-35+n*t;n=128584807152564e-32+n*t;n=11157877678025181e-33+n*t;n=-1333171662854621e-31+n*t;n=20972767875968562e-33+n*t;n=6637638134358324e-30+n*t;n=-4054566272975207e-29+n*t;n=-8151934197605472e-29+n*t;n=26335093153082323e-28+n*t;n=-12975133253453532e-27+n*t;n=-5415412054294628e-26+n*t;n=1.0512122733215323e-9+n*t;n=-4.112633980346984e-9+n*t;n=-2.9070369957882005e-8+n*t;n=4.2347877827932404e-7+n*t;n=-13654692000834679e-22+n*t;n=-13882523362786469e-21+n*t;n=.00018673420803405714+n*t;n=-.000740702534166267+n*t;n=-.006033670871430149+n*t;n=.24015818242558962+n*t;n=1.6536545626831027+n*t}else if(t<16){t=Math.sqrt(t)-3.25;n=2.2137376921775787e-9;n=9.075656193888539e-8+n*t;n=-2.7517406297064545e-7+n*t;n=1.8239629214389228e-8+n*t;n=15027403968909828e-22+n*t;n=-4013867526981546e-21+n*t;n=29234449089955446e-22+n*t;n=12475304481671779e-21+n*t;n=-47318229009055734e-21+n*t;n=6828485145957318e-20+n*t;n=24031110387097894e-21+n*t;n=-.0003550375203628475+n*t;n=.0009532893797373805+n*t;n=-.0016882755560235047+n*t;n=.002491442096107851+n*t;n=-.003751208507569241+n*t;n=.005370914553590064+n*t;n=1.0052589676941592+n*t;n=3.0838856104922208+n*t}else if(Number.isFinite(t)){t=Math.sqrt(t)-5;n=-27109920616438573e-27;n=-2.555641816996525e-10+n*t;n=1.5076572693500548e-9+n*t;n=-3.789465440126737e-9+n*t;n=7.61570120807834e-9+n*t;n=-1.496002662714924e-8+n*t;n=2.914795345090108e-8+n*t;n=-6.771199775845234e-8+n*t;n=2.2900482228026655e-7+n*t;n=-9.9298272942317e-7+n*t;n=4526062597223154e-21+n*t;n=-1968177810553167e-20+n*t;n=7599527703001776e-20+n*t;n=-.00021503011930044477+n*t;n=-.00013871931833623122+n*t;n=1.0103004648645344+n*t;n=4.849906401408584+n*t}else{n=Infinity}return n*e}function hc(e,t){var n,r,i={mean:function(e){if(arguments.length){n=e||0;return i}else{return n}},stdev:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return sc(n,r)},pdf:function(e){return lc(e,n,r)},cdf:function(e){return fc(e,n,r)},icdf:function(e){return cc(e,n,r)}};return i.mean(e).stdev(t)}function pc(e,t){var n=hc(),r={},i=0;r.data=function(n){if(arguments.length){e=n;i=n?n.length:0;return r.bandwidth(t)}else{return e}};r.bandwidth=function(n){if(!arguments.length)return t;t=n;if(!t&&e)t=Jf(e);return r};r.sample=function(){return e[~~(Qf()*i)]+t*n.sample()};r.pdf=function(r){for(var a=0,o=0;o<i;++o){a+=n.pdf((r-e[o])/t)}return a/t/i};r.cdf=function(r){for(var a=0,o=0;o<i;++o){a+=n.cdf((r-e[o])/t)}return a/i};r.icdf=function(){throw Error("KDE icdf not supported.")};return r.data(e)}function vc(e,t){e=e||0;t=t==null?1:t;return Math.exp(e+sc()*t)}function gc(e,t,n){if(e<=0)return 0;t=t||0;n=n==null?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*ac*e)}function mc(e,t,n){return fc(Math.log(e),t,n)}function yc(e,t,n){return Math.exp(cc(e,t,n))}function bc(e,t){var n,r,i={mean:function(e){if(arguments.length){n=e||0;return i}else{return n}},stdev:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return vc(n,r)},pdf:function(e){return gc(e,n,r)},cdf:function(e){return mc(e,n,r)},icdf:function(e){return yc(e,n,r)}};return i.mean(e).stdev(t)}function xc(e,t){var n={},r=0,i;function a(e){var t=[],n=0,i;for(i=0;i<r;++i){n+=t[i]=e[i]==null?1:+e[i]}for(i=0;i<r;++i){t[i]/=n}return t}n.weights=function(e){if(arguments.length){i=a(t=e||[]);return n}return t};n.distributions=function(i){if(arguments.length){if(i){r=i.length;e=i}else{r=0;e=[]}return n.weights(t)}return e};n.sample=function(){var t=Qf(),n=e[r-1],a=i[0],o=0;for(;o<r-1;a+=i[++o]){if(t<a){n=e[o];break}}return n.sample()};n.pdf=function(t){for(var n=0,a=0;a<r;++a){n+=i[a]*e[a].pdf(t)}return n};n.cdf=function(t){for(var n=0,a=0;a<r;++a){n+=i[a]*e[a].cdf(t)}return n};n.icdf=function(){throw Error("Mixture icdf not supported.")};return n.distributions(e).weights(t)}function _c(e,t){if(t==null){t=e==null?1:e;e=0}return e+(t-e)*Qf()}function wc(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=t&&e<=n?1/(n-t):0}function kc(e,t,n){if(n==null){n=t==null?1:t;t=0}return e<t?0:e>n?1:(e-t)/(n-t)}function Ec(e,t,n){if(n==null){n=t==null?1:t;t=0}return e>=0&&e<=1?t+e*(n-t):NaN}function Oc(e,t){var n,r,i={min:function(e){if(arguments.length){n=e||0;return i}else{return n}},max:function(e){if(arguments.length){r=e==null?1:e;return i}else{return r}},sample:function(){return _c(n,r)},pdf:function(e){return wc(e,n,r)},cdf:function(e){return kc(e,n,r)},icdf:function(e){return Ec(e,n,r)}};if(t==null){t=e==null?1:e;e=0}return i.min(e).max(t)}function Ac(e,t,n,r){var i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i,o=t-a*e;return[o,a]}function Sc(e,t,n,r){e=e.filter((function(e){var r=t(e),i=n(e);return r!=null&&(r=+r)>=r&&i!=null&&(i=+i)>=i}));if(r){e.sort((function(e,n){return t(e)-t(n)}))}var i=e.length,a=new Float64Array(i),o=new Float64Array(i);var u=0,s=0,l=0,f,c,d;for(var h=0,p=e;h<p.length;h++){d=p[h];a[u]=f=+t(d);o[u]=c=+n(d);++u;s+=(f-s)/u;l+=(c-l)/u}for(u=0;u<i;++u){a[u]-=s;o[u]-=l}return[a,o,s,l]}function Dc(e,t,n,r){var i=-1,a,o;for(var u=0,s=e;u<s.length;u++){var l=s[u];a=t(l);o=n(l);if(a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o){r(a,o,++i)}}}function Cc(e,t,n,r,i){var a=0,o=0;Dc(e,t,n,(function(e,t){var n=t-i(e),u=t-r;a+=n*n;o+=u*u}));return 1-a/o}function Mc(e,t,n){var r=0,i=0,a=0,o=0,u=0;Dc(e,t,n,(function(e,t){++u;r+=(e-r)/u;i+=(t-i)/u;a+=(e*t-a)/u;o+=(e*e-o)/u}));var s=Ac(r,i,a,o),l=function(e){return s[0]+s[1]*e};return{coef:s,predict:l,rSquared:Cc(e,t,n,i,l)}}function jc(e,t,n){var r=0,i=0,a=0,o=0,u=0;Dc(e,t,n,(function(e,t){++u;e=Math.log(e);r+=(e-r)/u;i+=(t-i)/u;a+=(e*t-a)/u;o+=(e*e-o)/u}));var s=Ac(r,i,a,o),l=function(e){return s[0]+s[1]*Math.log(e)};return{coef:s,predict:l,rSquared:Cc(e,t,n,i,l)}}function Fc(e,t,n){var r=Sc(e,t,n),i=r[0],a=r[1],o=r[2],u=r[3];var s=0,l=0,f=0,c=0,d=0,h,p,v;Dc(e,t,n,(function(e,t){h=i[d++];p=Math.log(t);v=h*t;s+=(t*p-s)/d;l+=(v-l)/d;f+=(v*p-f)/d;c+=(h*v-c)/d}));var g=Ac(l/u,s/u,f/u,c/u),m=g[0],y=g[1],b=function(e){return Math.exp(m+y*(e-o))};return{coef:[Math.exp(m-y*o),y],predict:b,rSquared:Cc(e,t,n,u,b)}}function Nc(e,t,n){var r=0,i=0,a=0,o=0,u=0,s=0;Dc(e,t,n,(function(e,t){var n=Math.log(e),l=Math.log(t);++s;r+=(n-r)/s;i+=(l-i)/s;a+=(n*l-a)/s;o+=(n*n-o)/s;u+=(t-u)/s}));var l=Ac(r,i,a,o),f=function(e){return l[0]*Math.pow(e,l[1])};l[0]=Math.exp(l[0]);return{coef:l,predict:f,rSquared:Cc(e,t,n,u,f)}}function Tc(e,t,n){var r=Sc(e,t,n),i=r[0],a=r[1],o=r[2],u=r[3],s=i.length;var l=0,f=0,c=0,d=0,h=0,p,v,g,m;for(p=0;p<s;){v=i[p];g=a[p++];m=v*v;l+=(m-l)/p;f+=(m*v-f)/p;c+=(m*m-c)/p;d+=(v*g-d)/p;h+=(m*g-h)/p}var y=c-l*l,b=l*y-f*f,x=(h*l-d*f)/b,_=(d*y-h*f)/b,w=-x*l,k=function(e){e=e-o;return x*e*e+_*e+w+u};return{coef:[w-_*o+x*o*o+u,_-2*x*o,x],predict:k,rSquared:Cc(e,t,n,u,k)}}function zc(e,t,n,r){if(r===1)return Mc(e,t,n);if(r===2)return Tc(e,t,n);var i=Sc(e,t,n),a=i[0],o=i[1],u=i[2],s=i[3],l=a.length,f=[],c=[],d=r+1;var h,p,v,g,m;for(h=0;h<d;++h){for(v=0,g=0;v<l;++v){g+=Math.pow(a[v],h)*o[v]}f.push(g);m=new Float64Array(d);for(p=0;p<d;++p){for(v=0,g=0;v<l;++v){g+=Math.pow(a[v],h+p)}m[p]=g}c.push(m)}c.push(f);var y=Pc(c),b=function(e){e-=u;var t=s+y[0]+y[1]*e+y[2]*e*e;for(h=3;h<d;++h)t+=y[h]*Math.pow(e,h);return t};return{coef:Rc(d,y,-u,s),predict:b,rSquared:Cc(e,t,n,s,b)}}function Rc(e,t,n,r){var i=Array(e);var a,o,u,s;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a){u=t[a];s=1;i[a]+=u;for(o=1;o<=a;++o){s*=(a+1-o)/o;i[a-o]+=u*Math.pow(n,o)*s}}i[0]+=r;return i}function Pc(e){var t=e.length-1,n=[];var r,i,a,o,u;for(r=0;r<t;++r){o=r;for(i=r+1;i<t;++i){if(Math.abs(e[r][i])>Math.abs(e[r][o])){o=i}}for(a=r;a<t+1;++a){u=e[a][r];e[a][r]=e[a][o];e[a][o]=u}for(i=r+1;i<t;++i){for(a=t;a>=r;a--){e[a][i]-=e[a][r]*e[r][i]/e[r][r]}}}for(i=t-1;i>=0;--i){u=0;for(a=i+1;a<t;++a){u+=e[a][i]*n[a]}n[i]=(e[t][i]-u)/e[i][i]}return n}var Lc=2,Ic=1e-12;function Bc(e,t,n,r){var i=Sc(e,t,n,true),a=i[0],o=i[1],u=i[2],s=i[3],l=a.length,f=Math.max(2,~~(r*l)),c=new Float64Array(l),d=new Float64Array(l),h=new Float64Array(l).fill(1);for(var p=-1;++p<=Lc;){var v=[0,f-1];for(var g=0;g<l;++g){var m=a[g],y=v[0],b=v[1],x=m-a[y]>a[b]-m?y:b;var _=0,w=0,k=0,E=0,O=0,A=1/Math.abs(a[x]-m||1);for(var S=y;S<=b;++S){var D=a[S],C=o[S],M=Uc(Math.abs(m-D)*A)*h[S],j=D*M;_+=M;w+=j;k+=C*M;E+=C*j;O+=D*j}var F=Ac(w/_,k/_,E/_,O/_),N=F[0],T=F[1];c[g]=N+T*m;d[g]=Math.abs(o[g]-c[g]);qc(a,g+1,v)}if(p===Lc){break}var z=$f(d);if(Math.abs(z)<Ic)break;for(var g=0,R=void 0,P;g<l;++g){R=d[g]/(6*z);h[g]=R>=1?Ic:(P=1-R*R)*P}}return Wc(a,c,u,s)}function Uc(e){return(e=1-e*e*e)*e*e}function qc(e,t,n){var r=e[t],i=n[0],a=n[1]+1;if(a>=e.length)return;while(t>i&&e[a]-r<=r-e[i]){n[0]=++i;n[1]=a;++a}}function Wc(e,t,n,r){var i=e.length,a=[];var o=0,u=0,s=[],l;for(;o<i;++o){l=e[o]+n;if(s[0]===l){s[1]+=(t[o]-s[1])/++u}else{u=0;s[1]+=r;s=[l,t[o]];a.push(s)}}s[1]+=r;return a}var Hc=.1*Math.PI/180;function $c(e,t,n,r){n=n||25;r=Math.max(n,r||200);var i=function(t){return[t,e(t)]},a=t[0],o=t[1],u=o-a,s=u/r,l=[i(a)],f=[];if(n===r){for(var c=1;c<r;++c){l.push(i(a+c/n*u))}l.push(i(o));return l}else{f.push(i(o));for(var c=n;--c>0;){f.push(i(a+c/n*u))}}var d=l[0],h=f[f.length-1];while(h){var p=i((d[0]+h[0])/2);if(p[0]-d[0]>=s&&Gc(d,p,h)>Hc){f.push(p)}else{d=h;l.push(h);f.pop()}h=f[f.length-1]}return l}function Gc(e,t,n){var r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function Vc(e){this._key=e?ui(e):ja;this.reset()}var Yc=Vc.prototype;Yc.reset=function(){this._add=[];this._rem=[];this._ext=null;this._get=null;this._q=null};Yc.add=function(e){this._add.push(e)};Yc.rem=function(e){this._rem.push(e)};Yc.values=function(){this._get=null;if(this._rem.length===0)return this._add;var e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={},u,s,l;for(u=0;u<i;++u){o[n(t[u])]=1}for(u=0,s=0;u<r;++u){if(o[n(l=e[u])]){o[n(l)]=0}else{a[s++]=l}}this._rem=[];return this._add=a};Yc.distinct=function(e){var t=this.values(),n=t.length,r={},i=0,a;while(--n>=0){a=e(t[n])+"";if(!ta(r,a)){r[a]=1;++i}}return i};Yc.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=Ki(t,e);this._ext=[t[n[0]],t[n[1]]];this._get=e}return this._ext};Yc.argmin=function(e){return this.extent(e)[0]||{}};Yc.argmax=function(e){return this.extent(e)[1]||{}};Yc.min=function(e){var t=this.extent(e)[0];return t!=null?e(t):undefined};Yc.max=function(e){var t=this.extent(e)[1];return t!=null?e(t):undefined};Yc.quartile=function(e){if(this._get!==e||!this._q){this._q=Xf(this.values(),e);this._get=e}return this._q};Yc.q1=function(e){return this.quartile(e)[0]};Yc.q2=function(e){return this.quartile(e)[1]};Yc.q3=function(e){return this.quartile(e)[2]};Yc.ci=function(e){if(this._get!==e||!this._ci){this._ci=ec(this.values(),1e3,.05,e);this._get=e}return this._ci};Yc.ci0=function(e){return this.ci(e)[0]};Yc.ci1=function(e){return this.ci(e)[1]};function Xc(e){af.call(this,null,e);this._adds=[];this._mods=[];this._alen=0;this._mlen=0;this._drop=true;this._cross=false;this._dims=[];this._dnames=[];this._measures=[];this._countOnly=false;this._counts=null;this._prev=null;this._inputs=null;this._outputs=null}Xc.Definition={type:"Aggregate",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:pf},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"drop",type:"boolean",default:true},{name:"cross",type:"boolean",default:false},{name:"key",type:"field"}]};var Jc=aa(Xc,af);Jc.transform=function(e,t){var n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();n.stamp=r.stamp;if(n.value&&(i||t.modified(n._inputs,true))){n._prev=n.value;n.value=i?n.init(e):{};t.visit(t.SOURCE,(function(e){return n.add(e)}))}else{n.value=n.value||n.init(e);t.visit(t.REM,(function(e){return n.rem(e)}));t.visit(t.ADD,(function(e){return n.add(e)}))}r.modifies(n._outputs);n._drop=e.drop!==false;if(e.cross&&n._dims.length>1){n._drop=false;n.cross()}return n.changes(r)};Jc.cross=function(){var e=this,t=e.value,n=e._dnames,r=n.map((function(){return{}})),i=n.length;function a(e){var t,a,o,u;for(t in e){o=e[t].tuple;for(a=0;a<i;++a){r[a][u=o[n[a]]]=u}}}a(e._prev);a(t);function o(a,u,s){var l=n[s],f=r[s++],c,d;for(c in f){u[l]=f[c];d=a?a+"|"+c:c;if(s<i)o(d,u,s);else if(!t[d])e.cell(d,u)}}o("",{},0)};Jc.init=function(e){var t=this._inputs=[],n=this._outputs=[],r={};function i(e){var n=$i(ei(e)),i=0,a=n.length,o;for(;i<a;++i){if(!r[o=n[i]]){r[o]=1;t.push(o)}}}this._dims=$i(e.groupby);this._dnames=this._dims.map((function(e){var t=Kr(e);i(e);n.push(t);return t}));this.cellkey=e.key?e.key:cf(this._dims);this._countOnly=true;this._counts=[];this._measures=[];var a=e.fields||[null],o=e.ops||["count"],u=e.as||[],s=a.length,l={},f,c,d,h,p,v;if(s!==o.length){ti("Unmatched number of fields and aggregate ops.")}for(v=0;v<s;++v){f=a[v];c=o[v];if(f==null&&c!=="count"){ti("Null aggregate field specified.")}h=Kr(f);p=df(c,h,u[v]);n.push(p);if(c==="count"){this._counts.push(p);continue}d=l[h];if(!d){i(f);d=l[h]=[];d.field=f;this._measures.push(d)}if(c!=="count")this._countOnly=false;d.push(vf(c,p))}this._measures=this._measures.map((function(e){return bf(e,e.field)}));return{}};Jc.cellkey=cf();Jc.cell=function(e,t){var n=this.value[e];if(!n){n=this.value[e]=this.newcell(e,t);this._adds[this._alen++]=n}else if(n.num===0&&this._drop&&n.stamp<this.stamp){n.stamp=this.stamp;this._adds[this._alen++]=n}else if(n.stamp<this.stamp){n.stamp=this.stamp;this._mods[this._mlen++]=n}return n};Jc.newcell=function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:false};if(!this._countOnly){var r=this._measures,i=r.length,a;n.agg=Array(i);for(a=0;a<i;++a){n.agg[a]=new r[a](n)}}if(n.store){n.data=new Vc}return n};Jc.newtuple=function(e,t){var n=this._dnames,r=this._dims,i={},a,o;for(a=0,o=r.length;a<o;++a){i[n[a]]=r[a](e)}return t?Ra(t.tuple,i):Na(i)};Jc.add=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,a;n.num+=1;if(this._countOnly)return;if(n.store)n.data.add(e);r=n.agg;for(i=0,a=r.length;i<a;++i){r[i].add(r[i].get(e),e)}};Jc.rem=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,a;n.num-=1;if(this._countOnly)return;if(n.store)n.data.rem(e);r=n.agg;for(i=0,a=r.length;i<a;++i){r[i].rem(r[i].get(e),e)}};Jc.celltuple=function(e){var t=e.tuple,n=this._counts,r,i,a;if(e.store){e.data.values()}for(i=0,a=n.length;i<a;++i){t[n[i]]=e.num}if(!this._countOnly){r=e.agg;for(i=0,a=r.length;i<a;++i){r[i].set(t)}}return t};Jc.changes=function(e){var t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,u=e.mod,s,l,f,c;if(r)for(l in r){s=r[l];if(!i||s.num)o.push(s.tuple)}for(f=0,c=this._alen;f<c;++f){a.push(this.celltuple(t[f]));t[f]=null}for(f=0,c=this._mlen;f<c;++f){s=n[f];(s.num===0&&i?o:u).push(this.celltuple(s));n[f]=null}this._alen=this._mlen=0;this._prev=null;return e};var Zc=1e-14;function Qc(e){af.call(this,null,e)}Qc.Definition={type:"Bin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:true,default:[5,2]},{name:"extent",type:"number",array:true,length:2,required:true},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:true},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:true},{name:"name",type:"string"},{name:"as",type:"string",array:true,length:2,default:["bin0","bin1"]}]};var Kc=aa(Qc,af);Kc.transform=function(e,t){var n=e.interval!==false,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],u=o[0],s=o[1],l;if(e.modified()){t=t.reflow(true);l=t.SOURCE}else{l=t.modified(ei(e.field))?t.ADD_MOD:t.ADD}t.visit(l,n?function(e){var t=r(e);e[u]=t;e[s]=t==null?null:i+a*(1+(t-i)/a)}:function(e){e[u]=r(e)});return t.modifies(n?o:u)};Kc._bins=function(e){if(this.value&&!e.modified()){return this.value}var t=e.field,n=Zf(e),r=n.step,i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,u;if((o=e.anchor)!=null){u=o-(i+r*Math.floor((o-i)/r));i+=u;a+=u}var s=function(e){var n=t(e);return n==null?null:n<i?-Infinity:n>a?+Infinity:(n=Math.max(i,Math.min(+n,a-r)),i+r*Math.floor(Zc+(n-i)/r))};s.start=i;s.stop=n.stop;s.step=r;return this.value=Qr(s,ei(t),e.name||"bin_"+Kr(t))};function ed(e,t,n){var r=e,i=t||[],a=n||[],o={},u=0;return{add:function(e){a.push(e)},remove:function(e){o[r(e)]=++u},size:function(){return i.length},data:function(e,t){if(u){i=i.filter((function(e){return!o[r(e)]}));o={};u=0}if(t&&e){i.sort(e)}if(a.length){i=e?va(e,i,a.sort(e)):i.concat(a);a=[]}return i}}}function td(e){af.call(this,[],e)}td.Definition={type:"Collect",metadata:{source:true},params:[{name:"sort",type:"compare"}]};var nd=aa(td,af);nd.transform=function(e,t){var n=t.fork(t.ALL),r=ed(ja,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));n.visit(n.REM,r.remove);this.modified(a);this.value=n.source=r.data(Pa(i),a);if(t.source&&t.source.root){this.value.root=t.source.root}return n};function rd(e){Ya.call(this,null,id,e)}aa(rd,Ya);function id(e){return this.value&&!e.modified()?this.value:Yi(e.fields,e.orders)}function ad(e){af.call(this,null,e)}ad.Definition={type:"CountPattern",metadata:{generates:true,changes:true},params:[{name:"field",type:"field",required:true},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:true,length:2,default:["text","count"]}]};function od(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}var ud=aa(ad,af);ud.transform=function(e,t){function n(t){return function(n){var r=od(u(n),e.case,a)||[],i;for(var s=0,l=r.length;s<l;++s){if(!o.test(i=r[s]))t(i)}}}var r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,u=e.field,s=e.as||["text","count"],l=n((function(e){i[e]=1+(i[e]||0)})),f=n((function(e){i[e]-=1}));if(r){t.visit(t.SOURCE,l)}else{t.visit(t.ADD,l);t.visit(t.REM,f)}return this._finish(t,s)};ud._parameterCheck=function(e,t){var n=false;if(e.modified("stopwords")||!this._stop){this._stop=new RegExp("^"+(e.stopwords||"")+"$","i");n=true}if(e.modified("pattern")||!this._match){this._match=new RegExp(e.pattern||"[\\w']+","g");n=true}if(e.modified("field")||t.modified(e.field.fields)){n=true}if(n)this._counts={};return n};ud._finish=function(e,t){var n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS),u,s,l;for(u in n){s=r[u];l=n[u]||0;if(!s&&l){r[u]=s=Na({});s[i]=u;s[a]=l;o.add.push(s)}else if(l===0){if(s)o.rem.push(s);n[u]=null;r[u]=null}else if(s[a]!==l){s[a]=l;o.mod.push(s)}}return o.modifies(t)};function sd(e){af.call(this,null,e)}sd.Definition={type:"Cross",metadata:{generates:true},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:true,length:2,default:["a","b"]}]};var ld=aa(sd,af);ld.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=this.value,i=e.as||["a","b"],a=i[0],o=i[1],u=!r||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");if(u){if(r)n.rem=r;r=t.materialize(t.SOURCE).source;n.add=this.value=fd(r,a,o,e.filter||hi)}else{n.mod=r}n.source=this.value;return n.modifies(i)};function fd(e,t,n,r){var i=[],a={},o=e.length,u=0,s,l;for(;u<o;++u){a[t]=l=e[u];for(s=0;s<o;++s){a[n]=e[s];if(r(a)){i.push(Na(a));a={};a[t]=l}}}return i}var cd={kde:pc,mixture:xc,normal:hc,lognormal:bc,uniform:Oc};var dd="distributions",hd="function",pd="field";function vd(e,t){var n=e[hd];if(!ta(cd,n)){ti("Unknown distribution function: "+n)}var r=cd[n]();for(var i in e){if(i===pd){r.data((e.from||t()).map(e[i]))}else if(i===dd){r[i](e[i].map((function(e){return vd(e,t)})))}else if(typeof r[i]===hd){r[i](e[i])}}return r}function gd(e){af.call(this,null,e)}var md=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:true},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];var yd={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:true,params:md},{name:"weights",type:"number",array:true}]};gd.Definition={type:"Density",metadata:{generates:true},params:[{name:"extent",type:"number",array:true,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:md.concat(yd)},{name:"as",type:"string",array:true,default:["value","density"]}]};var bd=aa(gd,af);bd.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=vd(e.distribution,xd(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200,o=e.method||"pdf";if(o!=="pdf"&&o!=="cdf"){ti("Invalid density method: "+o)}if(!e.extent&&!r.data){ti("Missing density extent parameter.")}o=r[o];var u=e.as||["value","density"],s=e.extent||Qi(r.data()),l=$c(o,s,i,a).map((function(e){var t={};t[u[0]]=e[0];t[u[1]]=e[1];return Na(t)}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n};function xd(e){return function(){return e.materialize(e.SOURCE).source}}function _d(e,t){if(!e)return null;return e.map((function(e,n){return t[n]||Kr(e)}))}function wd(e,t,n){var r=[],i=function(e){return e(s)},a,o,u,s,l,f;if(t==null){r.push(e.map(n))}else{for(a={},o=0,u=e.length;o<u;++o){s=e[o];l=t.map(i);f=a[l];if(!f){a[l]=f=[];f.dims=l;r.push(f)}f.push(n(s))}}return r}var kd="bin";function Ed(e){af.call(this,null,e)}Ed.Definition={type:"DotBin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:false},{name:"as",type:"string",default:kd}]};var Od=aa(Ed,af);Od.transform=function(e,t){if(this.value&&!(e.modified()||t.changed())){return t}var n=t.materialize(t.SOURCE).source,r=wd(t.source,e.groupby,fi),i=e.smooth||false,a=e.field,o=e.step||Ad(n,a),u=Pa((function(e,t){return a(e)-a(t)})),s=e.as||kd,l=r.length;var f=Infinity,c=-Infinity,d=0,h;for(;d<l;++d){var p=r[d].sort(u);h=-1;for(var v=0,g=tc(p,o,i,a);v<g.length;v++){var m=g[v];if(m<f)f=m;if(m>c)c=m;p[++h][s]=m}}this.value={start:f,stop:c,step:o};return t.reflow(true).modifies(s)};function Ad(e,t){return ya(Qi(e,t))/30}function Sd(e){Ya.call(this,null,Dd,e);this.modified(true)}aa(Sd,Ya);function Dd(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:Qr((function(n){return t(n,e)}),ei(t),Kr(t))}function Cd(e){af.call(this,[undefined,undefined],e)}Cd.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:true}]};var Md=aa(Cd,af);Md.transform=function(e,t){var n=this.value,r=e.field,i=n[0],a=n[1],o;o=t.changed()||t.modified(r.fields)||e.modified("field");if(o||i==null){i=+Infinity;a=-Infinity}t.visit(o?t.SOURCE:t.ADD,(function(e){var t=r(e);if(t!=null){t=+t;if(t<i)i=t;if(t>a)a=t}}));if(!Number.isFinite(i)||!Number.isFinite(a)){var u=Kr(r);if(u)u=' for field "'+u+'"';t.dataflow.warn("Infinite extent"+u+": ["+i+", "+a+"]");i=a=undefined}this.value=[i,a]};function jd(e,t){Ya.call(this,e);this.parent=t}var Fd=aa(jd,Ya);Fd.connect=function(e){this.targets().add(e);return e.source=this};Fd.add=function(e){this.value.add.push(e)};Fd.rem=function(e){this.value.rem.push(e)};Fd.mod=function(e){this.value.mod.push(e)};Fd.init=function(e){this.value.init(e,e.NO_SOURCE)};Fd.evaluate=function(){return this.value};function Nd(e){af.call(this,{},e);this._keys=ra();var t=this._targets=[];t.active=0;t.forEach=function(e){for(var n=0,r=t.active;n<r;++n)e(t[n],n,t)}}var Td=aa(Nd,af);Td.activate=function(e){this._targets[this._targets.active++]=e};Td.subflow=function(e,t,n,r){var i=this.value,a=ta(i,e)&&i[e],o,u;if(!a){u=r||(u=this._group[e])&&u.tuple;o=n.dataflow;a=o.add(new jd(n.fork(n.NO_SOURCE),this)).connect(t(o,e,u));i[e]=a;this.activate(a)}else if(a.value.stamp<n.stamp){a.init(n);this.activate(a)}return a};Td.transform=function(e,t){var n=t.dataflow,r=this,i=e.key,a=e.subflow,o=this._keys,u=e.modified("key");function s(e){return r.subflow(e,a,t)}this._group=e.group||{};this._targets.active=0;t.visit(t.REM,(function(e){var t=ja(e),n=o.get(t);if(n!==undefined){o.delete(t);s(n).rem(e)}}));t.visit(t.ADD,(function(e){var t=i(e);o.set(ja(e),t);s(t).add(e)}));if(u||t.modified(i.fields)){t.visit(t.MOD,(function(e){var t=ja(e),n=o.get(t),r=i(e);if(n===r){s(r).mod(e)}else{o.set(t,r);s(n).rem(e);s(r).add(e)}}))}else if(t.changed(t.MOD)){t.visit(t.MOD,(function(e){s(o.get(ja(e))).mod(e)}))}if(u){t.visit(t.REFLOW,(function(e){var t=ja(e),n=o.get(t),r=i(e);if(n!==r){o.set(t,r);s(n).rem(e);s(r).add(e)}}))}if(o.empty>n.cleanThreshold)n.runAfter(o.clean);return t};function zd(e){Ya.call(this,null,Rd,e)}aa(zd,Ya);function Rd(e){return this.value&&!e.modified()?this.value:ri(e.name)?$i(e.name).map((function(e){return ui(e)})):ui(e.name,e.as)}function Pd(e){af.call(this,ra(),e)}Pd.Definition={type:"Filter",metadata:{changes:true},params:[{name:"expr",type:"expr",required:true}]};var Ld=aa(Pd,af);Ld.transform=function(e,t){var n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,u=i.mod,s=e.expr,l=true;t.visit(t.REM,(function(e){var t=ja(e);if(!r.has(t))o.push(e);else r.delete(t)}));t.visit(t.ADD,(function(t){if(s(t,e))a.push(t);else r.set(ja(t),1)}));function f(t){var n=ja(t),i=s(t,e),f=r.get(n);if(i&&f){r.delete(n);a.push(t)}else if(!i&&!f){r.set(n,1);o.push(t)}else if(l&&i&&!f){u.push(t)}}t.visit(t.MOD,f);if(e.modified()){l=false;t.visit(t.REFLOW,f)}if(r.empty>n.cleanThreshold)n.runAfter(r.clean);return i};function Id(e){af.call(this,[],e)}Id.Definition={type:"Flatten",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"index",type:"string"},{name:"as",type:"string",array:true}]};var Bd=aa(Id,af);Bd.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=_d(r,e.as||[]),a=e.index||null,o=i.length;n.rem=this.value;t.visit(t.SOURCE,(function(e){var t=r.map((function(t){return t(e)})),u=t.reduce((function(e,t){return Math.max(e,t.length)}),0),s=0,l,f,c;for(;s<u;++s){f=Ta(e);for(l=0;l<o;++l){f[i[l]]=(c=t[l][s])==null?null:c}if(a){f[a]=s}n.add.push(f)}}));this.value=n.source=n.add;if(a)n.modifies(a);return n.modifies(i)};function Ud(e){af.call(this,[],e)}Ud.Definition={type:"Fold",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true,length:2,default:["key","value"]}]};var qd=aa(Ud,af);qd.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Kr),a=e.as||["key","value"],o=a[0],u=a[1],s=r.length;n.rem=this.value;t.visit(t.SOURCE,(function(e){for(var t=0,a;t<s;++t){a=Ta(e);a[o]=i[t];a[u]=r[t](e);n.add.push(a)}}));this.value=n.source=n.add;return n.modifies(a)};function Wd(e){af.call(this,null,e)}Wd.Definition={type:"Formula",metadata:{modifies:true},params:[{name:"expr",type:"expr",required:true},{name:"as",type:"string",required:true},{name:"initonly",type:"boolean"}]};var Hd=aa(Wd,af);Hd.transform=function(e,t){var n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;if(i){t=t.materialize().reflow(true)}if(!e.initonly){t.modifies(r)}return t.visit(a,(function(t){return t[r]=n(t,e)}))};function $d(e){af.call(this,[],e)}var Gd=aa($d,af);Gd.transform=function(e,t){var n=this.value,r=t.fork(t.ALL),i=e.size-n.length,a=e.generator,o,u,s;if(i>0){for(o=[];--i>=0;){o.push(s=Na(a(e)));n.push(s)}r.add=r.add.length?r.materialize(r.ADD).add.concat(o):o}else{u=n.slice(0,-i);r.rem=r.rem.length?r.materialize(r.REM).rem.concat(u):u;n=n.slice(-i)}r.source=this.value=n;return r};var Vd={value:"value",median:$f,mean:Hf,min:Pf,max:Rf};var Yd=[];function Xd(e){af.call(this,[],e)}Xd.Definition={type:"Impute",metadata:{changes:true},params:[{name:"field",type:"field",required:true},{name:"key",type:"field",required:true},{name:"keyvals",array:true},{name:"groupby",type:"field",array:true},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};var Jd=aa(Xd,af);function Zd(e){var t=e.method||Vd.value,n;if(Vd[t]==null){ti("Unrecognized imputation method: "+t)}else if(t===Vd.value){n=e.value!==undefined?e.value:0;return function(){return n}}else{return Vd[t]}}function Qd(e){var t=e.field;return function(e){return e?t(e):NaN}}Jd.transform=function(e,t){var n=t.fork(t.ALL),r=Zd(e),i=Qd(e),a=Kr(e.field),o=Kr(e.key),u=(e.groupby||[]).map(Kr),s=Kd(t.source,e.groupby,e.key,e.keyvals),l=[],f=this.value,c=s.domain.length,d,h,p,v,g,m,y,b,x,_;for(g=0,b=s.length;g<b;++g){d=s[g];p=d.values;h=NaN;for(y=0;y<c;++y){if(d[y]!=null)continue;v=s.domain[y];_={_impute:true};for(m=0,x=p.length;m<x;++m)_[u[m]]=p[m];_[o]=v;_[a]=Number.isNaN(h)?h=r(d,i):h;l.push(Na(_))}}if(l.length)n.add=n.materialize(n.ADD).add.concat(l);if(f.length)n.rem=n.materialize(n.REM).rem.concat(f);this.value=l;return n};function Kd(e,t,n,r){var i=function(e){return e(g)},a=[],o=r?r.slice():[],u={},s={},l,f,c,d,h,p,v,g;o.forEach((function(e,t){u[e]=t+1}));for(d=0,v=e.length;d<v;++d){g=e[d];p=n(g);h=u[p]||(u[p]=o.push(p));f=(l=t?t.map(i):Yd)+"";if(!(c=s[f])){c=s[f]=[];a.push(c);c.values=l}c[h-1]=g}a.domain=o;return a}function eh(e){Xc.call(this,e)}eh.Definition={type:"JoinAggregate",metadata:{modifies:true},params:[{name:"groupby",type:"field",array:true},{name:"fields",type:"field",null:true,array:true},{name:"ops",type:"enum",array:true,values:pf},{name:"as",type:"string",null:true,array:true},{name:"key",type:"field"}]};var th=aa(eh,Xc);th.transform=function(e,t){var n=this,r=e.modified(),i;if(n.value&&(r||t.modified(n._inputs,true))){i=n.value=r?n.init(e):{};t.visit(t.SOURCE,(function(e){n.add(e)}))}else{i=n.value=n.value||this.init(e);t.visit(t.REM,(function(e){n.rem(e)}));t.visit(t.ADD,(function(e){n.add(e)}))}n.changes();t.visit(t.SOURCE,(function(e){Zi(e,i[n.cellkey(e)].tuple)}));return t.reflow(r).modifies(this._outputs)};th.changes=function(){var e=this._adds,t=this._mods,n,r;for(n=0,r=this._alen;n<r;++n){this.celltuple(e[n]);e[n]=null}for(n=0,r=this._mlen;n<r;++n){this.celltuple(t[n]);t[n]=null}this._alen=this._mlen=0};function nh(e){af.call(this,null,e)}nh.Definition={type:"KDE",metadata:{generates:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"cumulative",type:"boolean",default:false},{name:"counts",type:"boolean",default:false},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:true,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:true,default:["value","density"]}]};var rh=aa(nh,af);rh.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=wd(r,e.groupby,e.field),a=(e.groupby||[]).map(Kr),o=e.bandwidth,u=e.cumulative?"cdf":"pdf",s=e.as||["value","density"],l=[];var f=e.extent,c=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;if(u!=="pdf"&&u!=="cdf"){ti("Invalid density method: "+u)}if(e.resolve==="shared"){if(!f)f=Qi(r,e.field);c=d=e.steps||d}i.forEach((function(t){var n=pc(t,o)[u],r=e.counts?t.length:1,i=f||Qi(t);$c(n,i,c,d).forEach((function(e){var n={};for(var i=0;i<a.length;++i){n[a[i]]=t.dims[i]}n[s[0]]=e[0];n[s[1]]=e[1]*r;l.push(Na(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n};function ih(e){Ya.call(this,null,ah,e)}aa(ih,Ya);function ah(e){return this.value&&!e.modified()?this.value:ca(e.fields,e.flat)}function oh(e){af.call(this,[],e);this._pending=null}var uh=aa(oh,af);uh.transform=function(e,t){var n=this;var r=t.dataflow;if(this._pending){return lh(this,t,this._pending)}if(sh(e))return t.StopPropagation;if(e.values){return lh(this,t,r.parse(e.values,e.format))}else if(e.async){var i=r.request(e.url,e.format).then((function(e){n._pending=$i(e.data);return function(e){return e.touch(n)}}));return{async:i}}else{return r.request(e.url,e.format).then((function(e){return lh(n,t,$i(e.data))}))}};function sh(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function lh(e,t,n){n.forEach(Na);var r=t.fork(t.NO_FIELDS&t.NO_SOURCE);r.rem=e.value;e.value=r.source=r.add=n;e._pending=null;return r}function fh(e){af.call(this,{},e)}fh.Definition={type:"Lookup",metadata:{modifies:true},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:true},{name:"key",type:"field",required:true}]},{name:"values",type:"field",array:true},{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true},{name:"default",default:null}]};var ch=aa(fh,af);ch.transform=function(e,t){var n=t,r=e.as,i=e.fields,a=e.index,o=e.values,u=e.default==null?null:e.default,s=e.modified(),l=s?t.SOURCE:t.ADD,f=i.length,c,d,h;if(o){d=o.length;if(f>1&&!r){ti('Multi-field lookup requires explicit "as" parameter.')}if(r&&r.length!==f*d){ti('The "as" parameter has too few output field names.')}r=r||o.map(Kr);c=function(e){for(var t=0,n=0,s,l;t<f;++t){l=a.get(i[t](e));if(l==null)for(s=0;s<d;++s,++n)e[r[n]]=u;else for(s=0;s<d;++s,++n)e[r[n]]=o[s](l)}}}else{if(!r){ti("Missing output field names.")}c=function(e){for(var t=0,n;t<f;++t){n=a.get(i[t](e));e[r[t]]=n==null?u:n}}}if(s){n=t.reflow(true)}else{h=i.some((function(e){return t.modified(e.fields)}));l|=h?t.MOD:0}t.visit(l,c);return n.modifies(r)};function dh(e){Ya.call(this,null,hh,e)}aa(dh,Ya);function hh(e){if(this.value&&!e.modified()){return this.value}var t=+Infinity,n=-Infinity,r=e.extents,i,a,o;for(i=0,a=r.length;i<a;++i){o=r[i];if(o[0]<t)t=o[0];if(o[1]>n)n=o[1]}return[t,n]}function ph(e){Ya.call(this,null,vh,e)}aa(ph,Ya);function vh(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function gh(e){af.call(this,null,e)}aa(gh,af);gh.prototype.transform=function(e,t){this.modified(e.modified());this.value=e;return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function mh(e){Xc.call(this,e)}mh.Definition={type:"Pivot",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"value",type:"field",required:true},{name:"op",type:"enum",values:pf,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var yh=aa(mh,Xc);yh._transform=yh.transform;yh.transform=function(e,t){return this._transform(bh(e,t),t)};function bh(e,t){var n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=ei(n).concat(ei(r)),o=_h(n,e.limit||0,t);if(t.changed())e.set("__pivot__",null,null,true);return{key:e.key,groupby:e.groupby,ops:o.map((function(){return i})),fields:o.map((function(e){return xh(e,n,r,a)})),as:o.map((function(e){return e+""})),modified:e.modified.bind(e)}}function xh(e,t,n,r){return Qr((function(r){return t(r)===e?n(r):NaN}),r,e+"")}function _h(e,t,n){var r={},i=[];n.visit(n.SOURCE,(function(t){var n=e(t);if(!r[n]){r[n]=1;i.push(n)}}));i.sort((function(e,t){return(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0}));return t?i.slice(0,t):i}function wh(e){Nd.call(this,e)}var kh=aa(wh,Nd);kh.transform=function(e,t){var n=this,r=e.subflow,i=e.field;if(e.modified("field")||i&&t.modified(ei(i))){ti("PreFacet does not support field modification.")}this._targets.active=0;t.visit(t.MOD,(function(e){var a=n.subflow(ja(e),r,t,e);i?i(e).forEach((function(e){a.mod(e)})):a.mod(e)}));t.visit(t.ADD,(function(e){var a=n.subflow(ja(e),r,t,e);i?i(e).forEach((function(e){a.add(Na(e))})):a.add(e)}));t.visit(t.REM,(function(e){var a=n.subflow(ja(e),r,t,e);i?i(e).forEach((function(e){a.rem(e)})):a.rem(e)}));return t};function Eh(e){af.call(this,null,e)}Eh.Definition={type:"Project",metadata:{generates:true,changes:true},params:[{name:"fields",type:"field",array:true},{name:"as",type:"string",null:true,array:true}]};var Oh=aa(Eh,af);Oh.transform=function(e,t){var n=e.fields,r=_d(e.fields,e.as||[]),i=n?function(e,t){return Ah(e,t,n,r)}:za,a,o;if(this.value){o=this.value}else{t=t.addAll();o=this.value={}}a=t.fork(t.NO_SOURCE);t.visit(t.REM,(function(e){var t=ja(e);a.rem.push(o[t]);o[t]=null}));t.visit(t.ADD,(function(e){var t=i(e,Na({}));o[ja(e)]=t;a.add.push(t)}));t.visit(t.MOD,(function(e){a.mod.push(i(e,o[ja(e)]))}));return a};function Ah(e,t,n,r){for(var i=0,a=n.length;i<a;++i){t[r[i]]=n[i](e)}return t}function Sh(e){af.call(this,null,e)}var Dh=aa(Sh,af);Dh.transform=function(e,t){this.value=e.value;return e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};function Ch(e){af.call(this,null,e)}Ch.Definition={type:"Quantile",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"probs",type:"number",array:true},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:true,default:["prob","value"]}]};var Mh=aa(Ch,af);var jh=1e-14;Mh.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed()){n.source=this.value;return n}var i=t.materialize(t.SOURCE).source,a=wd(i,e.groupby,e.field),o=(e.groupby||[]).map(Kr),u=[],s=e.step||.01,l=e.probs||Cf(s/2,1-jh,s),f=l.length;a.forEach((function(e){var t=Yf(e,l);for(var n=0;n<f;++n){var i={};for(var a=0;a<o.length;++a){i[o[a]]=e.dims[a]}i[r[0]]=l[n];i[r[1]]=t[n];u.push(Na(i))}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=u;return n};function Fh(e){af.call(this,null,e)}var Nh=aa(Fh,af);Nh.transform=function(e,t){var n,r;if(this.value){r=this.value}else{n=t=t.addAll();r=this.value={}}if(e.derive){n=t.fork(t.NO_SOURCE);t.visit(t.REM,(function(e){var t=ja(e);n.rem.push(r[t]);r[t]=null}));t.visit(t.ADD,(function(e){var t=Ta(e);r[ja(e)]=t;n.add.push(t)}));t.visit(t.MOD,(function(e){var t=r[ja(e)],i;for(i in e){t[i]=e[i];n.modifies(i)}n.mod.push(t)}))}return n};function Th(e){af.call(this,[],e);this.count=0}Th.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};var zh=aa(Th,af);zh.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value,o=this.count,u=0,s=a.reduce((function(e,t){e[ja(t)]=1;return e}),{});function l(e){var t,r;if(a.length<i){a.push(e)}else{r=~~((o+1)*Qf());if(r<a.length&&r>=u){t=a[r];if(s[ja(t)])n.rem.push(t);a[r]=e}}++o}if(t.rem.length){t.visit(t.REM,(function(e){var t=ja(e);if(s[t]){s[t]=-1;n.rem.push(e)}--o}));a=a.filter((function(e){return s[ja(e)]!==-1}))}if((t.rem.length||r)&&a.length<i&&t.source){u=o=a.length;t.visit(t.SOURCE,(function(e){if(!s[ja(e)])l(e)}));u=-1}if(r&&a.length>i){for(var f=0,c=a.length-i;f<c;++f){s[ja(a[f])]=-1;n.rem.push(a[f])}a=a.slice(c)}if(t.mod.length){t.visit(t.MOD,(function(e){if(s[ja(e)])n.mod.push(e)}))}if(t.add.length){t.visit(t.ADD,l)}if(t.add.length||u<0){n.add=a.filter((function(e){return!s[ja(e)]}))}this.count=o;this.value=n.source=a;return n};function Rh(e){af.call(this,null,e)}Rh.Definition={type:"Sequence",metadata:{generates:true,changes:true},params:[{name:"start",type:"number",required:true},{name:"stop",type:"number",required:true},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};var Ph=aa(Rh,af);Ph.transform=function(e,t){if(this.value&&!e.modified())return;var n=t.materialize().fork(t.MOD),r=e.as||"data";n.rem=this.value?t.rem.concat(this.value):t.rem;this.value=Cf(e.start,e.stop,e.step||1).map((function(e){var t={};t[r]=e;return Na(t)}));n.add=t.add.concat(this.value);return n};function Lh(e){af.call(this,null,e);this.modified(true)}var Ih=aa(Lh,af);Ih.transform=function(e,t){this.value=t.source;return t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};var Bh="year";var Uh="quarter";var qh="month";var Wh="week";var Hh="date";var $h="day";var Gh="hours";var Vh="minutes";var Yh="seconds";var Xh="milliseconds";var Jh=[Bh,Uh,qh,Wh,Hh,$h,Gh,Vh,Yh,Xh].reduce((function(e,t,n){return e[t]=1+n,e}),{});function Zh(e){var t=$i(e).slice(),n={};if(!t.length)ti("Missing time unit.");t.forEach((function(e){if(ta(Jh,e)){n[e]=1}else{ti("Invalid time unit: "+e+".")}}));if((n[Wh]||n[$h])&&(n[Uh]||n[qh]||n[Hh])){ti("Incompatible time units: "+e)}t.sort((function(e,t){return Jh[e]-Jh[t]}));return t}var Qh=new Date;function Kh(e,t,n,r){var i=t||1,a=Ai(e),o=function(e,t,r){return ep(n[r||e],e===a&&i,t)};var u=new Date,s=ka(e),l=s[Bh]?o(Bh):Xi(2012),f=s[qh]?o(qh):s[Uh]?o(Uh):ci,c=s[Wh]&&s[$h]?o($h,1,Wh+$h):s[Wh]?o(Wh,1):s[$h]?o($h,1):s[Hh]?o(Hh,1):di,d=s[Gh]?o(Gh):ci,h=s[Vh]?o(Vh):ci,p=s[Yh]?o(Yh):ci,v=s[Xh]?o(Xh):ci;return function(e){u.setTime(+e);var t=l(u);return r(t,f(u),c(u,t),d(u),h(u),p(u),v(u))}}function ep(e,t,n){return t<=1?e:n?function(r,i){return n+t*Math.floor((e(r,i)-n)/t)}:function(n,r){return t*Math.floor(e(n,r)/t)}}function tp(e,t,n){return t+e*7-(n+6)%7}var np=(o={},o[Bh]=function(e){return e.getFullYear()},o[Uh]=function(e){return 3*~~(e.getMonth()/3)},o[qh]=function(e){return e.getMonth()},o[Hh]=function(e){return e.getDate()},o[Gh]=function(e){return e.getHours()},o[Vh]=function(e){return e.getMinutes()},o[Yh]=function(e){return e.getSeconds()},o[Xh]=function(e){return e.getMilliseconds()},o[$h]=function(e,t){return tp(1,e.getDay(),ap(t))},o[Wh]=function(e,t){return tp(ip(e),0,ap(t))},o[Wh+$h]=function(e,t){return tp(ip(e),e.getDay(),ap(t))},o);function rp(e){Qh.setFullYear(e);Qh.setMonth(0);Qh.setDate(1);Qh.setHours(0,0,0,0);return Qh}function ip(e){return yu.count(rp(e.getFullYear())-1,e)}function ap(e){return rp(e).getDay()}function op(e,t,n,r,i,a,o){if(0<=e&&e<100){var u=new Date(-1,t,n,r,i,a,o);u.setFullYear(e);return u}return new Date(e,t,n,r,i,a,o)}function up(e,t){return Kh(e,t||1,np,op)}var sp=(u={},u[Bh]=function(e){return e.getUTCFullYear()},u[Uh]=function(e){return 3*~~(e.getUTCMonth()/3)},u[qh]=function(e){return e.getUTCMonth()},u[Hh]=function(e){return e.getUTCDate()},u[Gh]=function(e){return e.getUTCHours()},u[Vh]=function(e){return e.getUTCMinutes()},u[Yh]=function(e){return e.getUTCSeconds()},u[Xh]=function(e){return e.getUTCMilliseconds()},u[$h]=function(e,t){return tp(1,e.getUTCDay(),fp(t))},u[Wh]=function(e,t){return tp(lp(e),0,fp(t))},u[Wh+$h]=function(e,t){return tp(lp(e),e.getUTCDay(),fp(t))},u);function lp(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return ju.count(t-1,e)}function fp(e){Qh.setTime(Date.UTC(e,0,1));return Qh.getUTCDay()}function cp(e,t,n,r,i,a,o){if(0<=e&&e<100){var u=new Date(Date.UTC(-1,t,n,r,i,a,o));u.setUTCFullYear(n.y);return u}return new Date(Date.UTC(e,t,n,r,i,a,o))}function dp(e,t){return Kh(e,t||1,sp,cp)}var hp=(s={},s[Bh]=Au,s[Uh]=Ou.every(3),s[qh]=Ou,s[Wh]=yu,s[Hh]=gu,s[$h]=gu,s[Gh]=vu,s[Vh]=pu,s[Yh]=hu,s[Xh]=uu,s);var pp=(l={},l[Bh]=Iu,l[Uh]=Lu.every(3),l[qh]=Lu,l[Wh]=ju,l[Hh]=Cu,l[$h]=Cu,l[Gh]=Du,l[Vh]=Su,l[Yh]=hu,l[Xh]=uu,l);function vp(e){return hp[e]}function gp(e){return pp[e]}function mp(e,t,n){return e?e.offset(t,n):undefined}function yp(e,t,n){return mp(vp(e),t,n)}function bp(e,t,n){return mp(gp(e),t,n)}function xp(e,t,n,r){return e?e.range(t,n,r):undefined}function _p(e,t,n,r){return xp(vp(e),t,n,r)}function wp(e,t,n,r){return xp(gp(e),t,n,r)}var kp=(f={},f[Bh]="%Y ",f[Uh]="Q%q ",f[qh]="%b ",f[Hh]="%d ",f[Wh]="W%U ",f[$h]="%a ",f[Gh]="%H:00",f[Vh]="00:%M",f[Yh]=":%S",f[Xh]=".%L",f[Bh+"-"+qh]="%Y-%m ",f[Bh+"-"+qh+"-"+Hh]="%Y-%m-%d ",f[Gh+"-"+Vh]="%H:%M",f);function Ep(e,t){var n=Zi({},kp,t),r=Zh(e),i=r.length;var a="",o=0,u,s;for(o=0;o<i;){for(u=r.length;u>o;--u){s=r.slice(o,u).join("-");if(n[s]!=null){a+=n[s];o=u;break}}}return a.trim()}function Op(e){return Sp(nl,vp,e)}function Ap(e){return Sp(il,gp,e)}function Sp(e,t,n){return ai(n)?e(n):Dp(e,t,n)}function Dp(e,t,n){n=n||{};if(!ii(n)){ti("Invalid time multi-format specifier: "+n)}var r=t(Yh),i=t(Vh),a=t(Gh),o=t(Hh),u=t(Wh),s=t(qh),l=t(Uh),f=t(Bh),c=e(n[Xh]||".%L"),d=e(n[Yh]||":%S"),h=e(n[Vh]||"%I:%M"),p=e(n[Gh]||"%I %p"),v=e(n[Hh]||n[$h]||"%a %d"),g=e(n[Wh]||"%b %d"),m=e(n[qh]||"%B"),y=e(n[Uh]||"%B"),b=e(n[Bh]||"%Y");return function(e){return(r(e)<e?c:i(e)<e?d:a(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:g:f(e)<e?l(e)<e?m:y:b)(e)}}var Cp=1e3,Mp=Cp*60,jp=Mp*60,Fp=jp*24,Np=Fp*7,Tp=Fp*30,zp=Fp*365;var Rp=[Bh,qh,Hh,Gh,Vh,Yh,Xh],Pp=Rp.slice(0,-1),Lp=Pp.slice(0,-1),Ip=Lp.slice(0,-1),Bp=Ip.slice(0,-1),Up=[Bh,Wh],qp=[Bh,qh],Wp=[Bh];var Hp=[[Pp,1,Cp],[Pp,5,5*Cp],[Pp,15,15*Cp],[Pp,30,30*Cp],[Lp,1,Mp],[Lp,5,5*Mp],[Lp,15,15*Mp],[Lp,30,30*Mp],[Ip,1,jp],[Ip,3,3*jp],[Ip,6,6*jp],[Ip,12,12*jp],[Bp,1,Fp],[Up,1,Np],[qp,1,Tp],[qp,3,3*Tp],[Wp,1,zp]];function $p(e){var t=e.extent,n=e.maxbins||40,r=Math.abs(ya(t))/n;var i=wf((function(e){return e[2]})).right(Hp,r),a,o;if(i===Hp.length){a=Wp,o=zf(t[0]/zp,t[1]/zp,n)}else if(i){i=Hp[r/Hp[i-1][2]<Hp[i][2]/r?i-1:i];a=i[0];o=i[1]}else{a=Rp;o=Math.max(zf(t[0],t[1],n),1)}return{units:a,step:o}}function Gp(e){af.call(this,null,e)}var Vp=["unit0","unit1"];Gp.Definition={type:"TimeUnit",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"units",type:"string",array:true},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:true},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:true,length:2,default:Vp}]};var Yp=aa(Gp,af);Yp.transform=function(e,t){var n=e.field,r=e.interval!==false,i=e.timezone==="utc",a=this._floor(e,t),o=(i?gp:vp)(a.unit).offset,u=e.as||Vp,s=u[0],l=u[1],f=a.start||Infinity,c=a.stop||-Infinity,d=a.step,h=t.ADD;if(e.modified()||t.modified(ei(n))){t=t.reflow(true);h=t.SOURCE;f=Infinity;c=-Infinity}t.visit(h,(function(e){var t=n(e),i,u;if(t==null){e[s]=null;if(r)e[l]=null}else{e[s]=i=u=a(t);if(r)e[l]=u=o(i,d);if(i<f)f=i;if(u>c)c=u}}));a.start=f;a.stop=c;return t.modifies(r?u:s)};Yp._floor=function(e,t){var n=e.timezone==="utc";var r=e.units?{units:e.units,step:e.step||1}:$p({extent:e.extent||Qi(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),i=r.units,a=r.step;i=Zh(i);var o=this.value||{},u=(n?dp:up)(i,a);u.unit=Ai(i);u.units=i;u.step=a;u.start=o.start;u.stop=o.stop;return this.value=u};function Xp(e){af.call(this,ra(),e)}var Jp=aa(Xp,af);Jp.transform=function(e,t){var n=t.dataflow,r=e.field,i=this.value,a=true;function o(e){i.set(r(e),e)}if(e.modified("field")||t.modified(r.fields)){i.clear();t.visit(t.SOURCE,o)}else if(t.changed()){t.visit(t.REM,(function(e){i.delete(r(e))}));t.visit(t.ADD,o)}else{a=false}this.modified(a);if(i.empty>n.cleanThreshold)n.runAfter(i.clean);return t.fork()};function Zp(e){af.call(this,null,e)}var Qp=aa(Zp,af);Qp.transform=function(e,t){var n=!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields);if(n){this.value=(e.sort?t.source.slice().sort(Pa(e.sort)):t.source).map(e.field)}};function Kp(e,t,n,r){var i=ev[e](t,n);return{init:i.init||ci,update:function(e,t){t[r]=i.next(e)}}}var ev={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=ev.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.index,r=t.data,i=t.compare;if(e<n){while(n+1<r.length&&!i(r[n],r[n+1]))++n;e=n}return(1+e)/r.length}}},ntile:function(e,t){t=+t;if(!(t>0))ti("ntile num must be greater than zero.");var n=ev.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){t=+t||1;return{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){t=+t||1;return{next:function(n){var r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){t=+t;if(!(t>0))ti("nth_value nth must be greater than zero.");return{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){var t;return{init:function(){return t=null},next:function(n){var r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){var t,n;return{init:function(){return t=null,n=-1},next:function(r){var i=r.data;return r.index<=n?t:(n=tv(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function tv(e,t,n){for(var r=t.length;n<r;++n){var i=e(t[n]);if(i!=null)return n}return-1}var nv=Object.keys(ev);function rv(e){var t=this,n=$i(e.ops),r=$i(e.fields),i=$i(e.params),a=$i(e.as),o=t.outputs=[],u=t.windows=[],s={},l={},f=true,c=[],d=[];function h(e){$i(ei(e)).forEach((function(e){return s[e]=1}))}h(e.sort);n.forEach((function(e,t){var n=r[t],s=Kr(n),p=df(e,s,a[t]);h(n);o.push(p);if(ta(ev,e)){u.push(Kp(e,r[t],i[t],p))}else{if(n==null&&e!=="count"){ti("Null aggregate field specified.")}if(e==="count"){c.push(p);return}f=false;var v=l[s];if(!v){v=l[s]=[];v.field=n;d.push(v)}v.push(vf(e,p))}}));if(c.length||d.length){t.cell=av(d,c,f)}t.inputs=Object.keys(s)}var iv=rv.prototype;iv.init=function(){this.windows.forEach((function(e){return e.init()}));if(this.cell)this.cell.init()};iv.update=function(e,t){var n=this,r=n.cell,i=n.windows,a=e.data,o=i&&i.length,u;if(r){for(u=e.p0;u<e.i0;++u)r.rem(a[u]);for(u=e.p1;u<e.i1;++u)r.add(a[u]);r.set(t)}for(u=0;u<o;++u)i[u].update(e,t)};function av(e,t,n){e=e.map((function(e){return bf(e,e.field)}));var r={num:0,agg:null,store:false,count:t};if(!n){var i=e.length,a=r.agg=Array(i),o=0;for(;o<i;++o)a[o]=new e[o](r)}if(r.store){var u=r.data=new Vc}r.add=function(e){r.num+=1;if(n)return;if(u)u.add(e);for(var t=0;t<i;++t){a[t].add(a[t].get(e),e)}};r.rem=function(e){r.num-=1;if(n)return;if(u)u.rem(e);for(var t=0;t<i;++t){a[t].rem(a[t].get(e),e)}};r.set=function(e){var i,o;if(u)u.values();for(i=0,o=t.length;i<o;++i)e[t[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(e)};r.init=function(){r.num=0;if(u)u.reset();for(var e=0;e<i;++e)a[e].init()};return r}function ov(e){af.call(this,{},e);this._mlen=0;this._mods=[]}ov.Definition={type:"Window",metadata:{modifies:true},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:nv.concat(pf)},{name:"params",type:"number",null:true,array:true},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"frame",type:"number",null:true,array:true,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:false}]};var uv=aa(ov,af);uv.transform=function(e,t){var n=this,r=n.state,i=e.modified(),a=Pa(e.sort),o,u;this.stamp=t.stamp;if(!r||i){r=n.state=new rv(e)}var s=cf(e.groupby);function l(e){return n.group(s(e))}if(i||t.modified(r.inputs)){n.value={};t.visit(t.SOURCE,(function(e){l(e).add(e)}))}else{t.visit(t.REM,(function(e){l(e).remove(e)}));t.visit(t.ADD,(function(e){l(e).add(e)}))}for(o=0,u=n._mlen;o<u;++o){sv(n._mods[o],r,a,e)}n._mlen=0;n._mods=[];return t.reflow(i).modifies(r.outputs)};uv.group=function(e){var t=this,n=t.value[e];if(!n){n=t.value[e]=ed(ja);n.stamp=-1}if(n.stamp<t.stamp){n.stamp=t.stamp;t._mods[t._mlen++]=n}return n};function sv(e,t,n,r){var i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],u=e.data(n),s=u.length,l=0,f=a?wf(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:i||Xi(-1)};for(t.init();l<s;++l){lv(c,o,l,s);if(a)fv(c,f);t.update(c,u[l])}}function lv(e,t,n,r){e.p0=e.i0;e.p1=e.i1;e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0]));e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1);e.index=n}function fv(e,t){var n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;if(n>0&&!i(a[n],a[n-1]))e.i0=t.left(a,a[n]);if(r<o&&!i(a[r],a[r+1]))e.i1=t.right(a,a[r])}var cv=Object.freeze({__proto__:null,aggregate:Xc,bin:Qc,collect:td,compare:rd,countpattern:ad,cross:sd,density:gd,dotbin:Ed,expression:Sd,extent:Cd,facet:Nd,field:zd,filter:Pd,flatten:Id,fold:Ud,formula:Wd,generate:$d,impute:Xd,joinaggregate:eh,kde:nh,key:ih,load:oh,lookup:fh,multiextent:dh,multivalues:ph,params:gh,pivot:mh,prefacet:wh,project:Eh,proxy:Sh,quantile:Ch,relay:Fh,sample:Th,sequence:Rh,sieve:Lh,subflow:jd,timeunit:Gp,tupleindex:Xp,values:Zp,window:ov});var dv="top";var hv="left";var pv="right";var vv="bottom";var gv="top-left";var mv="top-right";var yv="bottom-left";var bv="bottom-right";var xv="start";var _v="middle";var wv="end";var kv="x";var Ev="y";var Ov="group";var Av="axis";var Sv="title";var Dv="frame";var Cv="scope";var Mv="legend";var jv="row-header";var Fv="row-footer";var Nv="row-title";var Tv="column-header";var zv="column-footer";var Rv="column-title";var Pv="padding";var Lv="symbol";var Iv="fit";var Bv="fit-x";var Uv="fit-y";var qv="pad";var Wv="none";var Hv="all";var $v="each";var Gv="flush";var Vv="column";var Yv="row";function Xv(e){this.clear();if(e)this.union(e)}var Jv=Xv.prototype;Jv.clone=function(){return new Xv(this)};Jv.clear=function(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this};Jv.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE};Jv.equals=function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2};Jv.set=function(e,t,n,r){if(n<e){this.x2=e;this.x1=n}else{this.x1=e;this.x2=n}if(r<t){this.y2=t;this.y1=r}else{this.y1=t;this.y2=r}return this};Jv.add=function(e,t){if(e<this.x1)this.x1=e;if(t<this.y1)this.y1=t;if(e>this.x2)this.x2=e;if(t>this.y2)this.y2=t;return this};Jv.expand=function(e){this.x1-=e;this.y1-=e;this.x2+=e;this.y2+=e;return this};Jv.round=function(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this};Jv.scale=function(e){this.x1*=e;this.y1*=e;this.x2*=e;this.y2*=e;return this};Jv.translate=function(e,t){this.x1+=e;this.x2+=e;this.y1+=t;this.y2+=t;return this};Jv.rotate=function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])};Jv.rotatedPoints=function(e,t,n){var r=this,i=r.x1,a=r.y1,o=r.x2,u=r.y2,s=Math.cos(e),l=Math.sin(e),f=t-t*s+n*l,c=n-t*l-n*s;return[s*i-l*a+f,l*i+s*a+c,s*i-l*u+f,l*i+s*u+c,s*o-l*a+f,l*o+s*a+c,s*o-l*u+f,l*o+s*u+c]};Jv.union=function(e){if(e.x1<this.x1)this.x1=e.x1;if(e.y1<this.y1)this.y1=e.y1;if(e.x2>this.x2)this.x2=e.x2;if(e.y2>this.y2)this.y2=e.y2;return this};Jv.intersect=function(e){if(e.x1>this.x1)this.x1=e.x1;if(e.y1>this.y1)this.y1=e.y1;if(e.x2<this.x2)this.x2=e.x2;if(e.y2<this.y2)this.y2=e.y2;return this};Jv.encloses=function(e){return e&&(this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2)};Jv.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)};Jv.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)};Jv.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)};Jv.width=function(){return this.x2-this.x1};Jv.height=function(){return this.y2-this.y1};var Zv=0;var Qv="p_";function Kv(e){return e&&e.gradient}function eg(e,t,n){var r=e.id,i=e.gradient,a=i==="radial"?Qv:"";if(!r){r=e.id="gradient_"+Zv++;if(i==="radial"){e.x1=tg(e.x1,.5);e.y1=tg(e.y1,.5);e.r1=tg(e.r1,0);e.x2=tg(e.x2,.5);e.y2=tg(e.y2,.5);e.r2=tg(e.r2,.5);a=Qv}else{e.x1=tg(e.x1,0);e.y1=tg(e.y1,0);e.x2=tg(e.x2,1);e.y2=tg(e.y2,0)}}t[r]=e;return"url("+(n||"")+"#"+a+r+")"}function tg(e,t){return e!=null?e:t}function ng(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){n.push({offset:e,color:t});return r}}}function rg(e){this.mark=e;this.bounds=this.bounds||new Xv}function ig(e){rg.call(this,e);this.items=this.items||[]}aa(ig,rg);function ag(e,t){if(typeof document!=="undefined"&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext){n.width=e;n.height=t;return n}}return null}function og(){return typeof Image!=="undefined"?Image:null}function ug(e){this._pending=0;this._loader=e||ll()}var sg=ug.prototype;sg.pending=function(){return this._pending};function lg(e){e._pending+=1}function fg(e){e._pending-=1}sg.sanitizeURL=function(e){var t=this;lg(t);return t._loader.sanitize(e,{context:"href"}).then((function(e){fg(t);return e})).catch((function(){fg(t);return null}))};sg.loadImage=function(e){var t=this,n=og();lg(t);return t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var i=new n;var a=ta(e,"crossOrigin")?e.crossOrigin:"anonymous";if(a!=null)i.crossOrigin=a;i.onload=function(){return fg(t)};i.onerror=function(){return fg(t)};i.src=r;return i})).catch((function(e){fg(t);return{complete:false,width:0,height:0,src:e&&e.url||""}}))};sg.ready=function(){var e=this;return new Promise((function(t){function n(r){if(!e.pending())t(r);else setTimeout((function(){n(true)}),10)}n(false)}))};var cg=Math.PI,dg=2*cg,hg=1e-6,pg=dg-hg;function vg(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function gg(){return new vg}vg.prototype=gg.prototype={constructor:vg,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,u=n-e,s=r-t,l=a-e,f=o-t,c=l*l+f*f;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null){this._+="M"+(this._x1=e)+","+(this._y1=t)}else if(!(c>hg));else if(!(Math.abs(f*u-s*l)>hg)||!i){this._+="L"+(this._x1=e)+","+(this._y1=t)}else{var d=n-a,h=r-o,p=u*u+s*s,v=d*d+h*h,g=Math.sqrt(p),m=Math.sqrt(c),y=i*Math.tan((cg-Math.acos((p+c-v)/(2*g*m)))/2),b=y/m,x=y/g;if(Math.abs(b-1)>hg){this._+="L"+(e+b*l)+","+(t+b*f)}this._+="A"+i+","+i+",0,0,"+ +(f*d>l*h)+","+(this._x1=e+x*u)+","+(this._y1=t+x*s)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),u=n*Math.sin(r),s=e+o,l=t+u,f=1^a,c=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null){this._+="M"+s+","+l}else if(Math.abs(this._x1-s)>hg||Math.abs(this._y1-l)>hg){this._+="L"+s+","+l}if(!n)return;if(c<0)c=c%dg+dg;if(c>pg){this._+="A"+n+","+n+",0,1,"+f+","+(e-o)+","+(t-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=s)+","+(this._y1=l)}else if(c>hg){this._+="A"+n+","+n+",0,"+ +(c>=cg)+","+f+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))}},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function mg(e){return function t(){return e}}var yg=Math.abs;var bg=Math.atan2;var xg=Math.cos;var _g=Math.max;var wg=Math.min;var kg=Math.sin;var Eg=Math.sqrt;var Og=1e-12;var Ag=Math.PI;var Sg=Ag/2;var Dg=2*Ag;function Cg(e){return e>1?0:e<-1?Ag:Math.acos(e)}function Mg(e){return e>=1?Sg:e<=-1?-Sg:Math.asin(e)}function jg(e){return e.innerRadius}function Fg(e){return e.outerRadius}function Ng(e){return e.startAngle}function Tg(e){return e.endAngle}function zg(e){return e&&e.padAngle}function Rg(e,t,n,r,i,a,o,u){var s=n-e,l=r-t,f=o-i,c=u-a,d=c*s-f*l;if(d*d<Og)return;d=(f*(t-a)-c*(e-i))/d;return[e+d*s,t+d*l]}function Pg(e,t,n,r,i,a,o){var u=e-n,s=t-r,l=(o?a:-a)/Eg(u*u+s*s),f=l*s,c=-l*u,d=e+f,h=t+c,p=n+f,v=r+c,g=(d+p)/2,m=(h+v)/2,y=p-d,b=v-h,x=y*y+b*b,_=i-a,w=d*v-p*h,k=(b<0?-1:1)*Eg(_g(0,_*_*x-w*w)),E=(w*b-y*k)/x,O=(-w*y-b*k)/x,A=(w*b+y*k)/x,S=(-w*y+b*k)/x,D=E-g,C=O-m,M=A-g,j=S-m;if(D*D+C*C>M*M+j*j)E=A,O=S;return{cx:E,cy:O,x01:-f,y01:-c,x11:E*(i/_-1),y11:O*(i/_-1)}}function Lg(){var e=jg,t=Fg,n=mg(0),r=null,i=Ng,a=Tg,o=zg,u=null;function s(){var s,l,f=+e.apply(this,arguments),c=+t.apply(this,arguments),d=i.apply(this,arguments)-Sg,h=a.apply(this,arguments)-Sg,p=yg(h-d),v=h>d;if(!u)u=s=gg();if(c<f)l=c,c=f,f=l;if(!(c>Og))u.moveTo(0,0);else if(p>Dg-Og){u.moveTo(c*xg(d),c*kg(d));u.arc(0,0,c,d,h,!v);if(f>Og){u.moveTo(f*xg(h),f*kg(h));u.arc(0,0,f,h,d,v)}}else{var g=d,m=h,y=d,b=h,x=p,_=p,w=o.apply(this,arguments)/2,k=w>Og&&(r?+r.apply(this,arguments):Eg(f*f+c*c)),E=wg(yg(c-f)/2,+n.apply(this,arguments)),O=E,A=E,S,D;if(k>Og){var C=Mg(k/f*kg(w)),M=Mg(k/c*kg(w));if((x-=C*2)>Og)C*=v?1:-1,y+=C,b-=C;else x=0,y=b=(d+h)/2;if((_-=M*2)>Og)M*=v?1:-1,g+=M,m-=M;else _=0,g=m=(d+h)/2}var j=c*xg(g),F=c*kg(g),N=f*xg(b),T=f*kg(b);if(E>Og){var z=c*xg(m),R=c*kg(m),P=f*xg(y),L=f*kg(y),I;if(p<Ag&&(I=Rg(j,F,P,L,z,R,N,T))){var B=j-I[0],U=F-I[1],q=z-I[0],W=R-I[1],H=1/kg(Cg((B*q+U*W)/(Eg(B*B+U*U)*Eg(q*q+W*W)))/2),$=Eg(I[0]*I[0]+I[1]*I[1]);O=wg(E,(f-$)/(H-1));A=wg(E,(c-$)/(H+1))}}if(!(_>Og))u.moveTo(j,F);else if(A>Og){S=Pg(P,L,j,F,c,A,v);D=Pg(z,R,N,T,c,A,v);u.moveTo(S.cx+S.x01,S.cy+S.y01);if(A<E)u.arc(S.cx,S.cy,A,bg(S.y01,S.x01),bg(D.y01,D.x01),!v);else{u.arc(S.cx,S.cy,A,bg(S.y01,S.x01),bg(S.y11,S.x11),!v);u.arc(0,0,c,bg(S.cy+S.y11,S.cx+S.x11),bg(D.cy+D.y11,D.cx+D.x11),!v);u.arc(D.cx,D.cy,A,bg(D.y11,D.x11),bg(D.y01,D.x01),!v)}}else u.moveTo(j,F),u.arc(0,0,c,g,m,!v);if(!(f>Og)||!(x>Og))u.lineTo(N,T);else if(O>Og){S=Pg(N,T,z,R,f,-O,v);D=Pg(j,F,P,L,f,-O,v);u.lineTo(S.cx+S.x01,S.cy+S.y01);if(O<E)u.arc(S.cx,S.cy,O,bg(S.y01,S.x01),bg(D.y01,D.x01),!v);else{u.arc(S.cx,S.cy,O,bg(S.y01,S.x01),bg(S.y11,S.x11),!v);u.arc(0,0,f,bg(S.cy+S.y11,S.cx+S.x11),bg(D.cy+D.y11,D.cx+D.x11),v);u.arc(D.cx,D.cy,O,bg(D.y11,D.x11),bg(D.y01,D.x01),!v)}}else u.arc(0,0,f,b,y,v)}u.closePath();if(s)return u=null,s+""||null}s.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Ag/2;return[xg(r)*n,kg(r)*n]};s.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:mg(+t),s):e};s.outerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:mg(+e),s):t};s.cornerRadius=function(e){return arguments.length?(n=typeof e==="function"?e:mg(+e),s):n};s.padRadius=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:mg(+e),s):r};s.startAngle=function(e){return arguments.length?(i=typeof e==="function"?e:mg(+e),s):i};s.endAngle=function(e){return arguments.length?(a=typeof e==="function"?e:mg(+e),s):a};s.padAngle=function(e){return arguments.length?(o=typeof e==="function"?e:mg(+e),s):o};s.context=function(e){return arguments.length?(u=e==null?null:e,s):u};return s}function Ig(e){this._context=e}Ig.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Bg(e){return new Ig(e)}function Ug(e){return e[0]}function qg(e){return e[1]}function Wg(){var e=Ug,t=qg,n=mg(true),r=null,i=Bg,a=null;function o(o){var u,s=o.length,l,f=false,c;if(r==null)a=i(c=gg());for(u=0;u<=s;++u){if(!(u<s&&n(l=o[u],u,o))===f){if(f=!f)a.lineStart();else a.lineEnd()}if(f)a.point(+e(l,u,o),+t(l,u,o))}if(c)return a=null,c+""||null}o.x=function(t){return arguments.length?(e=typeof t==="function"?t:mg(+t),o):e};o.y=function(e){return arguments.length?(t=typeof e==="function"?e:mg(+e),o):t};o.defined=function(e){return arguments.length?(n=typeof e==="function"?e:mg(!!e),o):n};o.curve=function(e){return arguments.length?(i=e,r!=null&&(a=i(r)),o):i};o.context=function(e){return arguments.length?(e==null?r=a=null:a=i(r=e),o):r};return o}function Hg(){var e=Ug,t=null,n=mg(0),r=qg,i=mg(true),a=null,o=Bg,u=null;function s(s){var l,f,c,d=s.length,h,p=false,v,g=new Array(d),m=new Array(d);if(a==null)u=o(v=gg());for(l=0;l<=d;++l){if(!(l<d&&i(h=s[l],l,s))===p){if(p=!p){f=l;u.areaStart();u.lineStart()}else{u.lineEnd();u.lineStart();for(c=l-1;c>=f;--c){u.point(g[c],m[c])}u.lineEnd();u.areaEnd()}}if(p){g[l]=+e(h,l,s),m[l]=+n(h,l,s);u.point(t?+t(h,l,s):g[l],r?+r(h,l,s):m[l])}}if(v)return u=null,v+""||null}function l(){return Wg().defined(i).curve(o).context(a)}s.x=function(n){return arguments.length?(e=typeof n==="function"?n:mg(+n),t=null,s):e};s.x0=function(t){return arguments.length?(e=typeof t==="function"?t:mg(+t),s):e};s.x1=function(e){return arguments.length?(t=e==null?null:typeof e==="function"?e:mg(+e),s):t};s.y=function(e){return arguments.length?(n=typeof e==="function"?e:mg(+e),r=null,s):n};s.y0=function(e){return arguments.length?(n=typeof e==="function"?e:mg(+e),s):n};s.y1=function(e){return arguments.length?(r=e==null?null:typeof e==="function"?e:mg(+e),s):r};s.lineX0=s.lineY0=function(){return l().x(e).y(n)};s.lineY1=function(){return l().x(e).y(r)};s.lineX1=function(){return l().x(t).y(n)};s.defined=function(e){return arguments.length?(i=typeof e==="function"?e:mg(!!e),s):i};s.curve=function(e){return arguments.length?(o=e,a!=null&&(u=o(a)),s):o};s.context=function(e){return arguments.length?(e==null?a=u=null:u=o(a=e),s):a};return s}var $g={draw:function(e,t){var n=Math.sqrt(t/Ag);e.moveTo(n,0);e.arc(0,0,n,0,Dg)}};function Gg(){var e=mg($g),t=mg(64),n=null;function r(){var r;if(!n)n=r=gg();e.apply(this,arguments).draw(n,+t.apply(this,arguments));if(r)return n=null,r+""||null}r.type=function(t){return arguments.length?(e=typeof t==="function"?t:mg(t),r):e};r.size=function(e){return arguments.length?(t=typeof e==="function"?e:mg(+e),r):t};r.context=function(e){return arguments.length?(n=e==null?null:e,r):n};return r}function Vg(){}function Yg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Xg(e){this._context=e}Xg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:Yg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Yg(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Jg(e){return new Xg(e)}function Zg(e){this._context=e}Zg.prototype={areaStart:Vg,areaEnd:Vg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=t;break;case 1:this._point=2;this._x3=e,this._y3=t;break;case 2:this._point=3;this._x4=e,this._y4=t;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Yg(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Qg(e){return new Zg(e)}function Kg(e){this._context=e}Kg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Yg(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function em(e){return new Kg(e)}function tm(e,t){this._basis=new Xg(e);this._beta=t}tm.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0){var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,u=-1,s;while(++u<=n){s=u/n;this._basis.point(this._beta*e[u]+(1-this._beta)*(r+s*a),this._beta*t[u]+(1-this._beta)*(i+s*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var nm=function e(t){function n(e){return t===1?new Xg(e):new tm(e,t)}n.beta=function(t){return e(+t)};return n}(.85);function rm(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function im(e,t){this._context=e;this._k=(1-t)/6}im.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:rm(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:rm(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var am=function e(t){function n(e){return new im(e,t)}n.tension=function(t){return e(+t)};return n}(0);function om(e,t){this._context=e;this._k=(1-t)/6}om.prototype={areaStart:Vg,areaEnd:Vg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:rm(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var um=function e(t){function n(e){return new om(e,t)}n.tension=function(t){return e(+t)};return n}(0);function sm(e,t){this._context=e;this._k=(1-t)/6}sm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:rm(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var lm=function e(t){function n(e){return new sm(e,t)}n.tension=function(t){return e(+t)};return n}(0);function fm(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>Og){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s;i=(i*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>Og){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/f;o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/f}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function cm(e,t){this._context=e;this._alpha=t}cm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:fm(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var dm=function e(t){function n(e){return t?new cm(e,t):new im(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function hm(e,t){this._context=e;this._alpha=t}hm.prototype={areaStart:Vg,areaEnd:Vg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:fm(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var pm=function e(t){function n(e){return t?new hm(e,t):new om(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function vm(e,t){this._context=e;this._alpha=t}vm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:fm(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var gm=function e(t){function n(e){return t?new vm(e,t):new sm(e,0)}n.alpha=function(t){return e(+t)};return n}(.5);function mm(e){this._context=e}mm.prototype={areaStart:Vg,areaEnd:Vg,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};function ym(e){return new mm(e)}function bm(e){return e<0?-1:1}function xm(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(bm(a)+bm(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function _m(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function wm(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,u=(a-r)/3;e._context.bezierCurveTo(r+u,i+u*t,a-u,o-u*n,a,o)}function km(e){this._context=e}km.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wm(this,this._t0,_m(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var n=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;wm(this,_m(this,n=xm(this,e,t)),n);break;default:wm(this,this._t0,n=xm(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=n}};function Em(e){this._context=new Om(e)}(Em.prototype=Object.create(km.prototype)).point=function(e,t){km.prototype.point.call(this,t,e)};function Om(e){this._context=e}Om.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function Am(e){return new km(e)}function Sm(e){return new Em(e)}function Dm(e){this._context=e}Dm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(n===2){this._context.lineTo(e[1],t[1])}else{var r=Cm(e),i=Cm(t);for(var a=0,o=1;o<n;++a,++o){this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function Cm(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);i[0]=0,a[0]=2,o[0]=e[0]+2*e[1];for(t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n];for(t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];i[n-1]=o[n-1]/a[n-1];for(t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];a[n-1]=(e[n]+i[n-1])/2;for(t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function Mm(e){return new Dm(e)}function jm(e,t){this._context=e;this._t=t}jm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Fm(e){return new jm(e,.5)}function Nm(e){return new jm(e,0)}function Tm(e){return new jm(e,1)}var zm={basis:{curve:Jg},"basis-closed":{curve:Qg},"basis-open":{curve:em},bundle:{curve:nm,tension:"beta",value:.85},cardinal:{curve:am,tension:"tension",value:0},"cardinal-open":{curve:lm,tension:"tension",value:0},"cardinal-closed":{curve:um,tension:"tension",value:0},"catmull-rom":{curve:dm,tension:"alpha",value:.5},"catmull-rom-closed":{curve:pm,tension:"alpha",value:.5},"catmull-rom-open":{curve:gm,tension:"alpha",value:.5},linear:{curve:Bg},"linear-closed":{curve:ym},monotone:{horizontal:Sm,vertical:Am},natural:{curve:Mm},step:{curve:Fm},"step-after":{curve:Tm},"step-before":{curve:Nm}};function Rm(e,t,n){var r=ta(zm,e)&&zm[e],i=null;if(r){i=r.curve||r[t||"vertical"];if(r.tension&&n!=null){i=i[r.tension](n)}}return i}var Pm={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Lm=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function Im(e){var t=[],n,r,i,a,o,u,s,l,f,c,d;n=e.slice().replace(Lm[0],"###$1").split(Lm[1]).slice(1);for(l=0,c=n.length;l<c;++l){r=n[l];i=r.slice(1).trim().replace(Lm[2],"$1###$2").split(Lm[3]);u=r.charAt(0);a=[u];for(f=0,d=i.length;f<d;++f){if((o=+i[f])===o){a.push(o)}}s=Pm[u.toLowerCase()];if(a.length-1>s){for(f=1,d=a.length;f<d;f+=s){t.push([u].concat(a.slice(f,f+s)))}}else{t.push(a)}}return t}var Bm=Math.PI/180;var Um=1e-14;var qm=Math.PI/2;var Wm=Math.PI*2;var Hm=Math.sqrt(3)/2;var $m={};var Gm={};var Vm=[].join;function Ym(e,t,n,r,i,a,o,u,s){var l=Vm.call(arguments);if($m[l]){return $m[l]}var f=o*Bm;var c=Math.sin(f);var d=Math.cos(f);n=Math.abs(n);r=Math.abs(r);var h=d*(u-e)*.5+c*(s-t)*.5;var p=d*(s-t)*.5-c*(u-e)*.5;var v=h*h/(n*n)+p*p/(r*r);if(v>1){v=Math.sqrt(v);n*=v;r*=v}var g=d/n;var m=c/n;var y=-c/r;var b=d/r;var x=g*u+m*s;var _=y*u+b*s;var w=g*e+m*t;var k=y*e+b*t;var E=(w-x)*(w-x)+(k-_)*(k-_);var O=1/E-.25;if(O<0)O=0;var A=Math.sqrt(O);if(a==i)A=-A;var S=.5*(x+w)-A*(k-_);var D=.5*(_+k)+A*(w-x);var C=Math.atan2(_-D,x-S);var M=Math.atan2(k-D,w-S);var j=M-C;if(j<0&&a===1){j+=Wm}else if(j>0&&a===0){j-=Wm}var F=Math.ceil(Math.abs(j/(qm+.001)));var N=[];for(var T=0;T<F;++T){var z=C+T*j/F;var R=C+(T+1)*j/F;N[T]=[S,D,z,R,n,r,c,d]}return $m[l]=N}function Xm(e){var t=Vm.call(e);if(Gm[t]){return Gm[t]}var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7];var f=l*o;var c=-s*u;var d=s*o;var h=l*u;var p=Math.cos(i);var v=Math.sin(i);var g=Math.cos(a);var m=Math.sin(a);var y=.5*(a-i);var b=Math.sin(y*.5);var x=8/3*b*b/Math.sin(y);var _=n+p-x*v;var w=r+v+x*p;var k=n+g;var E=r+m;var O=k+x*m;var A=E-x*g;return Gm[t]=[f*_+c*w,d*_+h*w,f*O+c*A,d*O+h*A,f*k+c*E,d*k+h*E]}var Jm=["l",0,0,0,0,0,0,0];function Zm(e,t,n){var r=Jm[0]=e[0];if(r==="a"||r==="A"){Jm[1]=t*e[1];Jm[2]=n*e[2];Jm[3]=e[3];Jm[4]=e[4];Jm[5]=e[5];Jm[6]=t*e[6];Jm[7]=n*e[7]}else if(r==="h"||r==="H"){Jm[1]=t*e[1]}else if(r==="v"||r==="V"){Jm[1]=n*e[1]}else{for(var i=1,a=e.length;i<a;++i){Jm[i]=(i%2==1?t:n)*e[i]}}return Jm}function Qm(e,t,n,r,i,a){var o,u=null,s=0,l=0,f=0,c=0,d,h,p,v;if(n==null)n=0;if(r==null)r=0;if(i==null)i=1;if(a==null)a=i;if(e.beginPath)e.beginPath();for(var g=0,m=t.length;g<m;++g){o=t[g];if(i!==1||a!==1){o=Zm(o,i,a)}switch(o[0]){case"l":s+=o[1];l+=o[2];e.lineTo(s+n,l+r);break;case"L":s=o[1];l=o[2];e.lineTo(s+n,l+r);break;case"h":s+=o[1];e.lineTo(s+n,l+r);break;case"H":s=o[1];e.lineTo(s+n,l+r);break;case"v":l+=o[1];e.lineTo(s+n,l+r);break;case"V":l=o[1];e.lineTo(s+n,l+r);break;case"m":s+=o[1];l+=o[2];e.moveTo(s+n,l+r);break;case"M":s=o[1];l=o[2];e.moveTo(s+n,l+r);break;case"c":d=s+o[5];h=l+o[6];f=s+o[3];c=l+o[4];e.bezierCurveTo(s+o[1]+n,l+o[2]+r,f+n,c+r,d+n,h+r);s=d;l=h;break;case"C":s=o[5];l=o[6];f=o[3];c=o[4];e.bezierCurveTo(o[1]+n,o[2]+r,f+n,c+r,s+n,l+r);break;case"s":d=s+o[3];h=l+o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,s+o[1]+n,l+o[2]+r,d+n,h+r);f=s+o[1];c=l+o[2];s=d;l=h;break;case"S":d=o[3];h=o[4];f=2*s-f;c=2*l-c;e.bezierCurveTo(f+n,c+r,o[1]+n,o[2]+r,d+n,h+r);s=d;l=h;f=o[1];c=o[2];break;case"q":d=s+o[3];h=l+o[4];f=s+o[1];c=l+o[2];e.quadraticCurveTo(f+n,c+r,d+n,h+r);s=d;l=h;break;case"Q":d=o[3];h=o[4];e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r);s=d;l=h;f=o[1];c=o[2];break;case"t":d=s+o[1];h=l+o[2];if(u[0].match(/[QqTt]/)===null){f=s;c=l}else if(u[0]==="t"){f=2*s-p;c=2*l-v}else if(u[0]==="q"){f=2*s-f;c=2*l-c}p=f;v=c;e.quadraticCurveTo(f+n,c+r,d+n,h+r);s=d;l=h;f=s+o[1];c=l+o[2];break;case"T":d=o[1];h=o[2];f=2*s-f;c=2*l-c;e.quadraticCurveTo(f+n,c+r,d+n,h+r);s=d;l=h;break;case"a":Km(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+r]);s+=o[6];l+=o[7];break;case"A":Km(e,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]);s=o[6];l=o[7];break;case"z":case"Z":e.closePath();break}u=o}}function Km(e,t,n,r){var i=Ym(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(var a=0;a<i.length;++a){var o=Xm(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var ey=.5773502691896257;var ty={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0);e.arc(0,0,n,0,Wm)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r);e.lineTo(-n,r);e.lineTo(-r,r);e.lineTo(-r,n);e.lineTo(r,n);e.lineTo(r,r);e.lineTo(n,r);e.lineTo(n,-r);e.lineTo(r,-r);e.lineTo(r,-n);e.lineTo(-r,-n);e.lineTo(-r,-r);e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(0,-n);e.lineTo(n,0);e.lineTo(0,n);e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n);e.lineTo(r,n);e.lineTo(r,-a);e.lineTo(i,-a);e.lineTo(0,-n);e.lineTo(-i,-a);e.lineTo(-r,-a);e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Hm*n,i=r-n*ey,a=n/4;e.moveTo(0,-r-i);e.lineTo(-a,r-i);e.lineTo(a,r-i);e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Hm*n,i=r-n*ey;e.moveTo(0,-r-i);e.lineTo(-n,r-i);e.lineTo(n,r-i);e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Hm*n;e.moveTo(0,-r);e.lineTo(-n,r);e.lineTo(n,r);e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Hm*n;e.moveTo(0,r);e.lineTo(-n,-r);e.lineTo(n,-r);e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Hm*n;e.moveTo(r,0);e.lineTo(-r,-n);e.lineTo(-r,n);e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Hm*n;e.moveTo(-r,0);e.lineTo(r,-n);e.lineTo(r,n);e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0);e.lineTo(n,0)}}};function ny(e){return ta(ty,e)?ty[e]:iy(e)}var ry={};function iy(e){if(!ta(ry,e)){var t=Im(e);ry[e]={draw:function(e,n){Qm(e,t,0,0,Math.sqrt(n)/2)}}}return ry[e]}var ay=.448084975506;function oy(e){return e.x}function uy(e){return e.y}function sy(e){return e.width}function ly(e){return e.height}function fy(e){return typeof e==="function"?e:function(){return+e}}function cy(e,t,n){return Math.max(t,Math.min(e,n))}function dy(){var e=oy,t=uy,n=sy,r=ly,i=fy(0),a=i,o=i,u=i,s=null;function l(l,f,c){var d,h=f!=null?f:+e.call(this,l),p=c!=null?c:+t.call(this,l),v=+n.call(this,l),g=+r.call(this,l),m=Math.min(v,g)/2,y=cy(+i.call(this,l),0,m),b=cy(+a.call(this,l),0,m),x=cy(+o.call(this,l),0,m),_=cy(+u.call(this,l),0,m);if(!s)s=d=gg();if(y<=0&&b<=0&&x<=0&&_<=0){s.rect(h,p,v,g)}else{var w=h+v,k=p+g;s.moveTo(h+y,p);s.lineTo(w-b,p);s.bezierCurveTo(w-ay*b,p,w,p+ay*b,w,p+b);s.lineTo(w,k-_);s.bezierCurveTo(w,k-ay*_,w-ay*_,k,w-_,k);s.lineTo(h+x,k);s.bezierCurveTo(h+ay*x,k,h,k-ay*x,h,k-x);s.lineTo(h,p+y);s.bezierCurveTo(h,p+ay*y,h+ay*y,p,h+y,p);s.closePath()}if(d){s=null;return d+""||null}}l.x=function(t){if(arguments.length){e=fy(t);return l}else{return e}};l.y=function(e){if(arguments.length){t=fy(e);return l}else{return t}};l.width=function(e){if(arguments.length){n=fy(e);return l}else{return n}};l.height=function(e){if(arguments.length){r=fy(e);return l}else{return r}};l.cornerRadius=function(e,t,n,r){if(arguments.length){i=fy(e);a=t!=null?fy(t):i;u=n!=null?fy(n):i;o=r!=null?fy(r):a;return l}else{return i}};l.context=function(e){if(arguments.length){s=e==null?null:e;return l}else{return s}};return l}function hy(){var e,t,n,r,i=null,a,o,u,s;function l(e,t,n){var r=n/2;if(a){var l=u-t,f=e-o;if(l||f){var c=Math.sqrt(l*l+f*f),d=(l/=c)*s,h=(f/=c)*s,p=Math.atan2(f,l);i.moveTo(o-d,u-h);i.lineTo(e-l*r,t-f*r);i.arc(e,t,r,p-Math.PI,p);i.lineTo(o+d,u+h);i.arc(o,u,s,p,p+Math.PI)}else{i.arc(e,t,r,0,Wm)}i.closePath()}else{a=1}o=e;u=t;s=r}function f(o){var u,s=o.length,f,c=false,d;if(i==null)i=d=gg();for(u=0;u<=s;++u){if(!(u<s&&r(f=o[u],u,o))===c){if(c=!c)a=0}if(c)l(+e(f,u,o),+t(f,u,o),+n(f,u,o))}if(d){i=null;return d+""||null}}f.x=function(t){if(arguments.length){e=t;return f}else{return e}};f.y=function(e){if(arguments.length){t=e;return f}else{return t}};f.size=function(e){if(arguments.length){n=e;return f}else{return n}};f.defined=function(e){if(arguments.length){r=e;return f}else{return r}};f.context=function(e){if(arguments.length){if(e==null){i=null}else{i=e}return f}else{return i}};return f}function py(e,t){return e!=null?e:t}var vy=function(e){return e.x||0},gy=function(e){return e.y||0},my=function(e){return e.width||0},yy=function(e){return e.height||0},by=function(e){return(e.x||0)+(e.width||0)},xy=function(e){return(e.y||0)+(e.height||0)},_y=function(e){return e.startAngle||0},wy=function(e){return e.endAngle||0},ky=function(e){return e.padAngle||0},Ey=function(e){return e.innerRadius||0},Oy=function(e){return e.outerRadius||0},Ay=function(e){return e.cornerRadius||0},Sy=function(e){return py(e.cornerRadiusTopLeft,e.cornerRadius)||0},Dy=function(e){return py(e.cornerRadiusTopRight,e.cornerRadius)||0},Cy=function(e){return py(e.cornerRadiusBottomRight,e.cornerRadius)||0},My=function(e){return py(e.cornerRadiusBottomLeft,e.cornerRadius)||0},jy=function(e){return py(e.size,64)},Fy=function(e){return e.size||1},Ny=function(e){return!(e.defined===false)},Ty=function(e){return ny(e.shape||"circle")};var zy=Lg().startAngle(_y).endAngle(wy).padAngle(ky).innerRadius(Ey).outerRadius(Oy).cornerRadius(Ay),Ry=Hg().x(vy).y1(gy).y0(xy).defined(Ny),Py=Hg().y(gy).x1(vy).x0(by).defined(Ny),Ly=Wg().x(vy).y(gy).defined(Ny),Iy=dy().x(vy).y(gy).width(my).height(yy).cornerRadius(Sy,Dy,Cy,My),By=Gg().type(Ty).size(jy),Uy=hy().x(vy).y(gy).defined(Ny).size(Fy);function qy(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Wy(e,t){return zy.context(e)(t)}function Hy(e,t){var n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Py:Ry).curve(Rm(r,n.orient,n.tension)).context(e)(t)}function $y(e,t){var n=t[0],r=n.interpolate||"linear";return Ly.curve(Rm(r,n.orient,n.tension)).context(e)(t)}function Gy(e,t,n,r){return Iy.context(e)(t,n,r)}function Vy(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Yy(e,t){return By.context(e)(t)}function Xy(e,t){return Uy.context(e)(t)}function Jy(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){var r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Zy(t,r):0))}return e}function Zy(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}var Qy,Ky,eb,tb=Wm-1e-8;function nb(e){Qy=e;return nb}function rb(){}function ib(e,t){Qy.add(e,t)}function ab(e,t){ib(Ky=e,eb=t)}function ob(e){ib(e,Qy.y1)}function ub(e){ib(Qy.x1,e)}nb.beginPath=rb;nb.closePath=rb;nb.moveTo=ab;nb.lineTo=ab;nb.rect=function(e,t,n,r){ib(e+n,t+r);ab(e,t)};nb.quadraticCurveTo=function(e,t,n,r){sb(Ky,e,n,ob);sb(eb,t,r,ub);ab(n,r)};function sb(e,t,n,r){var i=(e-t)/(e+n-2*t);if(0<i&&i<1)r(e+(t-e)*i)}nb.bezierCurveTo=function(e,t,n,r,i,a){lb(Ky,e,n,i,ob);lb(eb,t,r,a,ub);ab(i,a)};function lb(e,t,n,r,i){var a=r-e+3*t-3*n,o=e+n-2*t,u=e-t;var s=0,l=0,f;if(Math.abs(a)>Um){f=o*o+u*a;if(f>=0){f=Math.sqrt(f);s=(-o+f)/a;l=(-o-f)/a}}else{s=.5*u/o}if(0<s&&s<1)i(fb(s,e,t,n,r));if(0<l&&l<1)i(fb(l,e,t,n,r))}function fb(e,t,n,r,i){var a=1-e,o=a*a,u=e*e;return o*a*t+3*o*e*n+3*a*u*r+u*e*i}nb.arc=function(e,t,n,r,i,a){Ky=n*Math.cos(i)+e;eb=n*Math.sin(i)+t;if(Math.abs(i-r)>tb){ib(e-n,t-n);ib(e+n,t+n)}else{var o=function(r){return ib(n*Math.cos(r)+e,n*Math.sin(r)+t)};var u=void 0,s=void 0;o(r);o(i);if(i!==r){r=r%Wm;if(r<0)r+=Wm;i=i%Wm;if(i<0)i+=Wm;if(i<r){a=!a;u=r;r=i;i=u}if(a){i-=Wm;u=r-r%qm;for(s=0;s<4&&u>i;++s,u-=qm)o(u)}else{u=r-r%qm+qm;for(s=0;s<4&&u<i;++s,u=u+qm)o(u)}}}};var cb=(cb=ag(1,1))?cb.getContext("2d"):null;var db=new Xv;function hb(e){return function(t,n){if(!cb)return true;e(cb,t);db.clear().union(t.bounds).intersect(n).round();var r=db.x1,i=db.y1,a=db.x2,o=db.y2;for(var u=i;u<=o;++u){for(var s=r;s<=a;++s){if(cb.isPointInPath(s,u)){return true}}}return false}}function pb(e,t){return t.contains(e.x||0,e.y||0)}function vb(e,t){var n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(db.set(n,r,n+i,r+a))}function gb(e,t){var n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return mb(t,n,r,i,a)}function mb(e,t,n,r,i){var a=e.x1,o=e.y1,u=e.x2,s=e.y2,l=r-t,f=i-n;var c=0,d=1,h,p,v,g;for(g=0;g<4;++g){if(g===0){h=-l;p=-(a-t)}if(g===1){h=l;p=u-t}if(g===2){h=-f;p=-(o-n)}if(g===3){h=f;p=s-n}if(Math.abs(h)<1e-10&&p<0)return false;v=p/h;if(h<0){if(v>d)return false;else if(v>c)c=v}else if(h>0){if(v<c)return false;else if(v<d)d=v}}return true}function yb(e,t){e.globalCompositeOperation=t.blend||"source-over"}function bb(e,t){return e==null?t:e}function xb(e,t){var n=t.length;for(var r=0;r<n;++r){e.addColorStop(t[r].offset,t[r].color)}return e}function _b(e,t,n){var r=n.width(),i=n.height();var a;if(t.gradient==="radial"){a=e.createRadialGradient(n.x1+bb(t.x1,.5)*r,n.y1+bb(t.y1,.5)*i,Math.max(r,i)*bb(t.r1,0),n.x1+bb(t.x2,.5)*r,n.y1+bb(t.y2,.5)*i,Math.max(r,i)*bb(t.r2,.5))}else{var o=bb(t.x1,0),u=bb(t.y1,0),s=bb(t.x2,1),l=bb(t.y2,0);if(o===s||u===l||r===i){a=e.createLinearGradient(n.x1+o*r,n.y1+u*i,n.x1+s*r,n.y1+l*i)}else{var f=ag(Math.ceil(r),Math.ceil(i)),c=f.getContext("2d");c.scale(r,i);c.fillStyle=xb(c.createLinearGradient(o,u,s,l),t.stops);c.fillRect(0,0,r,i);return e.createPattern(f,"no-repeat")}}return xb(a,t.stops)}function wb(e,t,n){return Kv(n)?_b(e,n,t.bounds):n}function kb(e,t,n){n*=t.fillOpacity==null?1:t.fillOpacity;if(n>0){e.globalAlpha=n;e.fillStyle=wb(e,t,t.fill);return true}else{return false}}var Eb=[];function Ob(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;if(r<=0)return false;n*=t.strokeOpacity==null?1:t.strokeOpacity;if(n>0){e.globalAlpha=n;e.strokeStyle=wb(e,t,t.stroke);e.lineWidth=r;e.lineCap=t.strokeCap||"butt";e.lineJoin=t.strokeJoin||"miter";e.miterLimit=t.strokeMiterLimit||10;if(e.setLineDash){e.setLineDash(t.strokeDash||Eb);e.lineDashOffset=t.strokeDashOffset||0}return true}else{return false}}function Ab(e,t){return e.zindex-t.zindex||e.index-t.index}function Sb(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i){r=t[i];r.index=i;if(r.zindex)n.push(r)}e.zdirty=false;return e.zitems=n.sort(Ab)}function Db(e,t){var n=e.items,r,i;if(!n||!n.length)return;var a=Sb(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r){if(!n[r].zindex)t(n[r])}n=a}for(r=0,i=n.length;r<i;++r){t(n[r])}}function Cb(e,t){var n=e.items,r,i;if(!n||!n.length)return null;var a=Sb(e);if(a&&a.length)n=a;for(i=n.length;--i>=0;){if(r=t(n[i]))return r}if(n===a){for(n=e.items,i=n.length;--i>=0;){if(!n[i].zindex){if(r=t(n[i]))return r}}}return null}function Mb(e){return function(t,n,r){Db(n,(function(n){if(!r||r.intersects(n.bounds)){Fb(e,t,n,n)}}))}}function jb(e){return function(t,n,r){if(n.items.length&&(!r||r.intersects(n.bounds))){Fb(e,t,n.items[0],n.items)}}}function Fb(e,t,n,r){var i=n.opacity==null?1:n.opacity;if(i===0)return;if(e(t,r))return;yb(t,n);if(n.fill&&kb(t,n,i)){t.fill()}if(n.stroke&&Ob(t,n,i)){t.stroke()}}function Nb(e){e=e||hi;return function(t,n,r,i,a,o){r*=t.pixelRatio;i*=t.pixelRatio;return Cb(n,(function(n){var u=n.bounds;if(u&&!u.contains(a,o)||!u)return;if(e(t,n,r,i,a,o))return n}))}}function Tb(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,u=t==null?o.fill:t,s=o.stroke&&n.isPointInStroke,l,f;if(s){l=o.strokeWidth;f=o.strokeCap;n.lineWidth=l!=null?l:1;n.lineCap=f!=null?f:"butt"}return e(n,r)?false:u&&n.isPointInPath(i,a)||s&&n.isPointInStroke(i,a)}}function zb(e){return Nb(Tb(e))}function Rb(e,t){return"translate("+e+","+t+")"}function Pb(e){return"rotate("+e+")"}function Lb(e,t){return"scale("+e+","+t+")"}function Ib(e){return Rb(e.x||0,e.y||0)}function Bb(e){return Rb(e.x||0,e.y||0)+(e.angle?" "+Pb(e.angle):"")+(e.scaleX||e.scaleY?" "+Lb(e.scaleX||1,e.scaleY||1):"")}function Ub(e,t,n){function r(e,n){e("transform",Bb(n));e("d",t(null,n))}function i(e,n){var r=n.x||0,i=n.y||0;t(nb(e),n);Jy(e,n).translate(r,i);if(n.angle){e.rotate(n.angle*Bm,r,i)}return e}function a(e,n){var r=n.x||0,i=n.y||0,a=n.angle||0;e.translate(r,i);if(a)e.rotate(a*=Bm);e.beginPath();t(e,n);if(a)e.rotate(-a);e.translate(-r,-i)}return{type:e,tag:"path",nested:false,attr:r,bound:i,draw:Mb(a),pick:zb(a),isect:n||hb(a)}}var qb=Ub("arc",Wy);function Wb(e,t){var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=+Infinity,o,u;while(--i>=0){if(e[i].defined===false)continue;u=Math.abs(e[i][r]-n);if(u<a){a=u;o=e[i]}}return o}function Hb(e,t){var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;while(--r>=0){if(e[r].defined===false)continue;i=e[r].x-t[0];a=e[r].y-t[1];o=i*i+a*a;if(o<n)return e[r]}return null}function $b(e,t){var n=e.length,r,i,a;while(--n>=0){if(e[n].defined===false)continue;r=e[n].x-t[0];i=e[n].y-t[1];a=r*r+i*i;r=e[n].size||1;if(a<r*r)return e[n]}return null}function Gb(e,t,n){function r(e,n){var r=n.mark.items;if(r.length)e("d",t(null,r))}function i(e,n){var r=n.items;if(r.length===0){return e}else{t(nb(e),r);return Jy(e,r[0])}}function a(e,n){e.beginPath();t(e,n)}var o=Tb(a);function u(e,t,n,r,i,a){var u=t.items,s=t.bounds;if(!u||!u.length||s&&!s.contains(i,a)){return null}n*=e.pixelRatio;r*=e.pixelRatio;return o(e,u,n,r)?u[0]:null}return{type:e,tag:"path",nested:true,attr:r,bound:i,draw:jb(a),pick:u,isect:pb,tip:n}}var Vb=Gb("area",Hy,Wb);function Yb(e,t){var n=t.clip;e.save();if(Vi(n)){e.beginPath();n(e);e.clip()}else{Xb(e,t.group)}}function Xb(e,t){e.beginPath();qy(t)?Gy(e,t,0,0):e.rect(0,0,t.width||0,t.height||0);e.clip()}var Jb=1;function Zb(){Jb=1}function Qb(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Jb++),o=i.clipping[a]||(i.clipping[a]={id:a});if(Vi(r)){o.path=r(null)}else if(qy(n)){o.path=Gy(null,n,0,0)}else{o.width=n.width||0;o.height=n.height||0}return"url(#"+a+")"}function Kb(e){var t=(t=e.strokeWidth)!=null?t:1;return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function ex(e,t){e("transform",Ib(t))}function tx(e,t){var n=Kb(t);e("d",Gy(null,t,n,n))}function nx(e,t){e("class","background");tx(e,t)}function rx(e,t){e("class","foreground");if(t.strokeForeground){tx(e,t)}else{e("d","")}}function ix(e,t,n){var r=t.clip?Qb(n,t,t):null;e("clip-path",r)}function ax(e,t){if(!t.clip&&t.items){var n=t.items;for(var r=0,i=n.length;r<i;++r){e.union(n[r].bounds)}}if((t.clip||t.width||t.height)&&!t.noBound){e.add(0,0).add(t.width||0,t.height||0)}Jy(e,t);return e.translate(t.x||0,t.y||0)}function ox(e,t,n,r){var i=Kb(t);e.beginPath();Gy(e,t,(n||0)+i,(r||0)+i)}var ux=Tb(ox);var sx=Tb(ox,false);function lx(e,t,n){var r=this;Db(t,(function(t){var i=t.x||0,a=t.y||0,o=t.strokeForeground,u=t.opacity==null?1:t.opacity;if((t.stroke||t.fill)&&u){ox(e,t,i,a);yb(e,t);if(t.fill&&kb(e,t,u)){e.fill()}if(t.stroke&&!o&&Ob(e,t,u)){e.stroke()}}e.save();e.translate(i,a);if(t.clip)Xb(e,t);if(n)n.translate(-i,-a);Db(t,(function(t){r.draw(e,t,n)}));if(n)n.translate(i,a);e.restore();if(o&&t.stroke&&u){ox(e,t,i,a);yb(e,t);if(Ob(e,t,u)){e.stroke()}}}))}function fx(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items){return null}var o=this,u=n*e.pixelRatio,s=r*e.pixelRatio;return Cb(t,(function(l){var f,c,d,h,p,v,g,m,y;m=l.bounds;if(m&&!m.contains(i,a))return;h=l.x||0;p=l.y||0;v=h+(l.width||0);g=p+(l.height||0);y=l.clip;if(y&&(i<h||i>v||a<h||a>g))return;e.save();e.translate(h,p);h=i-h;p=a-p;if(y&&qy(l)&&!ux(e,l,u,s)){e.restore();return null}c=l.strokeForeground;d=t.interactive!==false;if(d&&c&&l.stroke&&sx(e,l,u,s)){e.restore();return l}f=Cb(l,(function(e){return cx(e,h,p)?o.pick(e,n,r,h,p):null}));if(!f&&d&&(l.fill||!c&&l.stroke)&&ux(e,l,u,s)){f=l}e.restore();return f||null}))}function cx(e,t,n){return(e.interactive!==false||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var dx={type:"group",tag:"g",nested:false,attr:ex,bound:ax,draw:lx,pick:fx,isect:vb,content:ix,background:nx,foreground:rx};function hx(e,t){var n=e.image;if(!n||e.url&&e.url!==n.url){n={complete:false,width:0,height:0};t.loadImage(e.url).then((function(t){e.image=t;e.image.url=e.url}))}return n}function px(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==false&&e.height?e.height*t.width/t.height:t.width}function vx(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==false&&e.width?e.width*t.height/t.width:t.height}function gx(e,t){return e==="center"?t/2:e==="right"?t:0}function mx(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function yx(e,t,n){var r=hx(t,n),i=t.x||0,a=t.y||0,o=px(t,r),u=vx(t,r),s=t.aspect===false?"none":"xMidYMid";i-=gx(t.align,o);a-=mx(t.baseline,u);if(!r.src&&r.toDataURL){e("href",r.toDataURL(),"http://www.w3.org/1999/xlink","xlink:href")}else{e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href")}e("transform",Rb(i,a));e("width",o);e("height",u);e("preserveAspectRatio",s)}function bx(e,t){var n=t.image,r=t.x||0,i=t.y||0,a=px(t,n),o=vx(t,n);r-=gx(t.align,a);i-=mx(t.baseline,o);return e.set(r,i,r+a,i+o)}function xx(e,t,n){var r=this;Db(t,(function(t){if(n&&!n.intersects(t.bounds))return;var i=hx(t,r),a=t.x||0,o=t.y||0,u=px(t,i),s=vx(t,i),l,f,c,d;a-=gx(t.align,u);o-=mx(t.baseline,s);if(t.aspect!==false){f=i.width/i.height;c=t.width/t.height;if(f===f&&c===c&&f!==c){if(c<f){d=u/f;o+=(s-d)/2;s=d}else{d=s*f;a+=(u-d)/2;u=d}}}if(i.complete||i.toDataURL){yb(e,t);e.globalAlpha=(l=t.opacity)!=null?l:1;e.imageSmoothingEnabled=t.smooth!==false;e.drawImage(i,a,o,u,s)}}))}var _x={type:"image",tag:"image",nested:false,attr:yx,bound:bx,draw:xx,pick:Nb(),isect:hi,get:hx,xOffset:gx,yOffset:mx};var wx=Gb("line",$y,Hb);function kx(e,t){var n=t.scaleX||1,r=t.scaleY||1;if(n!==1||r!==1){e("vector-effect","non-scaling-stroke")}e("transform",Bb(t));e("d",t.path)}function Ex(e,t){var n=t.path;if(n==null)return true;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*Bm,s=t.pathCache;if(!s||s.path!==n){(t.pathCache=s=Im(n)).path=n}if(u&&e.rotate&&e.translate){e.translate(r,i);e.rotate(u);Qm(e,s,0,0,a,o);e.rotate(-u);e.translate(-r,-i)}else{Qm(e,s,r,i,a,o)}}function Ox(e,t){Ex(nb(e),t)?e.set(0,0,0,0):Jy(e,t,true);if(t.angle){e.rotate(t.angle*Bm,t.x||0,t.y||0)}return e}var Ax={type:"path",tag:"path",nested:false,attr:kx,bound:Ox,draw:Mb(Ex),pick:zb(Ex),isect:hb(Ex)};function Sx(e,t){e("d",Gy(null,t))}function Dx(e,t){var n,r;return Jy(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Cx(e,t){e.beginPath();Gy(e,t)}var Mx={type:"rect",tag:"path",nested:false,attr:Sx,bound:Dx,draw:Mb(Cx),pick:zb(Cx),isect:vb};function jx(e,t){e("transform",Ib(t));e("x2",t.x2!=null?t.x2-(t.x||0):0);e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Fx(e,t){var n,r;return Jy(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function Nx(e,t,n){var r,i,a,o;if(t.stroke&&Ob(e,t,n)){r=t.x||0;i=t.y||0;a=t.x2!=null?t.x2:r;o=t.y2!=null?t.y2:i;e.beginPath();e.moveTo(r,i);e.lineTo(a,o);return true}return false}function Tx(e,t,n){Db(t,(function(t){if(n&&!n.intersects(t.bounds))return;var r=t.opacity==null?1:t.opacity;if(r&&Nx(e,t,r)){yb(e,t);e.stroke()}}))}function zx(e,t,n,r){if(!e.isPointInStroke)return false;return Nx(e,t,1)&&e.isPointInStroke(n,r)}var Rx={type:"rule",tag:"line",nested:false,attr:jx,bound:Fx,draw:Tx,pick:Nb(zx),isect:gb};var Px=Ub("shape",Vy);var Lx=Ub("symbol",Yy,pb);var Ix=pa();var Bx={height:Gx,measureWidth:Hx,estimateWidth:qx,width:qx,canvas:Ux};Ux(true);function Ux(e){Bx.width=e&&cb?Hx:qx}function qx(e,t){return Wx(Zx(e,t),Gx(e))}function Wx(e,t){return~~(.8*e.length*t)}function Hx(e,t){return Gx(e)<=0||!(t=Zx(e,t))?0:$x(t,t_(e))}function $x(e,t){var n="("+t+") "+e;var r=Ix.get(n);if(r===undefined){cb.font=t;r=cb.measureText(e).width;Ix.set(n,r)}return r}function Gx(e){return e.fontSize!=null?+e.fontSize||0:11}function Vx(e){return e.lineHeight!=null?e.lineHeight:Gx(e)+2}function Yx(e){return ri(e)?e.length>1?e:e[0]:e}function Xx(e){return Yx(e.lineBreak&&e.text&&!ri(e.text)?e.text.split(e.lineBreak):e.text)}function Jx(e){var t=Xx(e);return(ri(t)?t.length-1:0)*Vx(e)}function Zx(e,t){var n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Kx(e,n):n}function Qx(e){if(Bx.width===Hx){var t=t_(e);return function(e){return $x(e,t)}}else{var n=Gx(e);return function(e){return Wx(e,n)}}}function Kx(e,t){var n=+e.limit,r=Qx(e);if(r(t)<n)return t;var i=e.ellipsis||"…",a=e.dir==="rtl",o=0,u=t.length,s;n-=r(i);if(a){while(o<u){s=o+u>>>1;if(r(t.slice(s))>n)o=s+1;else u=s}return i+t.slice(o)}else{while(o<u){s=1+(o+u>>>1);if(r(t.slice(0,s))<n)o=s;else u=s-1}return t.slice(0,o)+i}}function e_(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function t_(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Gx(e)+"px "+e_(e,t)}function n_(e){var t=e.baseline,n=Gx(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Vx(e):t==="line-bottom"?.29*n-.5*Vx(e):0)}var r_={left:"start",center:"middle",right:"end"};var i_=new Xv;function a_(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;if(r){i=(e.theta||0)-qm;t+=r*Math.cos(i);n+=r*Math.sin(i)}i_.x1=t;i_.y1=n;return i_}function o_(e,t){var n=t.dx||0,r=(t.dy||0)+n_(t),i=a_(t),a=i.x1,o=i.y1,u=t.angle||0,s;e("text-anchor",r_[t.align]||"start");if(u){s=Rb(a,o)+" "+Pb(u);if(n||r)s+=" "+Rb(n,r)}else{s=Rb(a+n,o+r)}e("transform",s)}function u_(e,t,n){var r=Bx.height(t),i=t.align,a=a_(t),o=a.x1,u=a.y1,s=t.dx||0,l=(t.dy||0)+n_(t)-Math.round(.8*r),f=Xx(t),c;if(ri(f)){r+=Vx(t)*(f.length-1);c=f.reduce((function(e,n){return Math.max(e,Bx.width(t,n))}),0)}else{c=Bx.width(t,f)}if(i==="center"){s-=c/2}else if(i==="right"){s-=c}e.set(s+=o,l+=u,s+c,l+r);if(t.angle&&!n){e.rotate(t.angle*Bm,o,u)}else if(n===2){return e.rotatedPoints(t.angle*Bm,o,u)}return e}function s_(e,t,n){Db(t,(function(t){var r=t.opacity==null?1:t.opacity,i,a,o,u,s,l,f;if(n&&!n.intersects(t.bounds)||r===0||t.fontSize<=0||t.text==null||t.text.length===0)return;e.font=t_(t);e.textAlign=t.align||"left";i=a_(t);a=i.x1,o=i.y1;if(t.angle){e.save();e.translate(a,o);e.rotate(t.angle*Bm);a=o=0}a+=t.dx||0;o+=(t.dy||0)+n_(t);l=Xx(t);yb(e,t);if(ri(l)){s=Vx(t);for(u=0;u<l.length;++u){f=Zx(t,l[u]);if(t.fill&&kb(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&Ob(e,t,r)){e.strokeText(f,a,o)}o+=s}}else{f=Zx(t,l);if(t.fill&&kb(e,t,r)){e.fillText(f,a,o)}if(t.stroke&&Ob(e,t,r)){e.strokeText(f,a,o)}}if(t.angle)e.restore()}))}function l_(e,t,n,r,i,a){if(t.fontSize<=0)return false;if(!t.angle)return true;var o=a_(t),u=o.x1,s=o.y1,l=u_(i_,t,1),f=-t.angle*Bm,c=Math.cos(f),d=Math.sin(f),h=c*i-d*a+(u-c*u+d*s),p=d*i+c*a+(s-d*u-c*s);return l.contains(h,p)}function f_(e,t){var n=u_(i_,e,2);return mb(t,n[0],n[1],n[2],n[3])||mb(t,n[0],n[1],n[4],n[5])||mb(t,n[4],n[5],n[6],n[7])||mb(t,n[2],n[3],n[6],n[7])}var c_={type:"text",tag:"text",nested:false,attr:o_,bound:u_,draw:s_,pick:Nb(l_),isect:f_};var d_=Gb("trail",Xy,$b);var h_={arc:qb,area:Vb,group:dx,image:_x,line:wx,path:Ax,rect:Mx,rule:Rx,shape:Px,symbol:Lx,text:c_,trail:d_};function p_(e,t,n){var r=h_[e.mark.marktype],i=t||r.bound;if(r.nested)e=e.mark;return i(e.bounds||(e.bounds=new Xv),e,n)}var v_={mark:null};function g_(e,t,n){var r=h_[e.marktype],i=r.bound,a=e.items,o=a&&a.length,u,s,l,f;if(r.nested){if(o){l=a[0]}else{v_.mark=e;l=v_}f=p_(l,i,n);t=t&&t.union(f)||f;return t}t=t||e.bounds&&e.bounds.clear()||new Xv;if(o){for(u=0,s=a.length;u<s;++u){t.union(p_(a[u],i,n))}}return e.bounds=t}var m_=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant"];function y_(e,t){return JSON.stringify(e,m_,t)}function b_(e){var t=typeof e==="string"?JSON.parse(e):e;return x_(t)}function x_(e){var t=e.marktype,n=e.items,r,i,a;if(n){for(i=0,a=n.length;i<a;++i){r=t?"mark":"group";n[i][r]=e;if(n[i].zindex)n[i][r].zdirty=true;if("group"===(t||r))x_(n[i])}}if(t)g_(e);return e}function __(e){if(arguments.length){this.root=b_(e)}else{this.root=k_({marktype:"group",name:"root",role:"frame"});this.root.items=[new ig(this.root)]}}var w_=__.prototype;w_.toJSON=function(e){return y_(this.root,e||0)};w_.mark=function(e,t,n){t=t||this.root.items[0];var r=k_(e,t);t.items[n]=r;if(r.zindex)r.group.zdirty=true;return r};function k_(e,t){return{bounds:new Xv,clip:!!e.clip,group:t,interactive:e.interactive===false?false:true,items:[],marktype:e.marktype,name:e.name||undefined,role:e.role||undefined,zindex:e.zindex||0}}function E_(e,t,n){if(!e&&typeof document!=="undefined"&&document.createElement){e=document}return e?n?e.createElementNS(n,t):e.createElement(t):null}function O_(e,t){t=t.toLowerCase();var n=e.childNodes,r=0,i=n.length;for(;r<i;++r)if(n[r].tagName.toLowerCase()===t){return n[r]}}function A_(e,t,n,r){var i=e.childNodes[t],a;if(!i||i.tagName.toLowerCase()!==n.toLowerCase()){a=i||null;i=E_(e.ownerDocument,n,r);e.insertBefore(i,a)}return i}function S_(e,t){var n=e.childNodes,r=n.length;while(r>t)e.removeChild(n[--r]);return e}function D_(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function C_(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function M_(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=h_[i.marktype]).tip){o=C_(t,n);o[0]-=r[0];o[1]-=r[1];while(e=e.mark.group){o[0]-=e.x||0;o[1]-=e.y||0}e=a.tip(i.items,o)}return e}function j_(e,t){this._active=null;this._handlers={};this._loader=e||ll();this._tooltip=t||F_}function F_(e,t,n,r){e.element().setAttribute("title",r||"")}var N_=j_.prototype;N_.initialize=function(e,t,n){this._el=e;this._obj=n||null;return this.origin(t)};N_.element=function(){return this._el};N_.canvas=function(){return this._el&&this._el.firstChild};N_.origin=function(e){if(arguments.length){this._origin=e||[0,0];return this}else{return this._origin.slice()}};N_.scene=function(e){if(!arguments.length)return this._scene;this._scene=e;return this};N_.on=function(){};N_.off=function(){};N_._handlerIndex=function(e,t,n){for(var r=e?e.length:0;--r>=0;){if(e[r].type===t&&(!n||e[r].handler===n)){return r}}return-1};N_.handlers=function(e){var t=this._handlers,n=[],r;if(e){n.push.apply(n,t[this.eventName(e)])}else{for(r in t){n.push.apply(n,t[r])}}return n};N_.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)};N_.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=E_(null,"a");for(var i in t)r.setAttribute(i,t[i]);r.dispatchEvent(n)})).catch((function(){}))};N_.handleTooltip=function(e,t,n){if(t&&t.tooltip!=null){t=M_(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}};N_.getItemBoundingClientRect=function(e){if(!(t=this.canvas()))return;var t,n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();while(e.mark&&(e=e.mark.group)){a+=e.x||0;o+=e.y||0}return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}};function T_(e){this._el=null;this._bgcolor=null;this._loader=new ug(e)}var z_=T_.prototype;z_.initialize=function(e,t,n,r,i){this._el=e;return this.resize(t,n,r,i)};z_.element=function(){return this._el};z_.canvas=function(){return this._el&&this._el.firstChild};z_.background=function(e){if(arguments.length===0)return this._bgcolor;this._bgcolor=e;return this};z_.resize=function(e,t,n,r){this._width=e;this._height=t;this._origin=n||[0,0];this._scale=r||1;return this};z_.dirty=function(){};z_.render=function(e){var t=this;t._call=function(){t._render(e)};t._call();t._call=null;return t};z_._render=function(){};z_.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)};z_._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(e){if(e)i();n._ready=null}))}return r};z_.sanitizeURL=function(e){return this._load("sanitizeURL",e)};z_.loadImage=function(e){return this._load("loadImage",e)};var R_=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"];var P_="mousemove";var L_="mouseout";var I_="click";function B_(e,t){j_.call(this,e,t);this._down=null;this._touch=null;this._first=true}var U_=aa(B_,j_);U_.initialize=function(e,t,n){var r=this._canvas=e&&O_(e,"canvas");if(r){var i=this;this.events.forEach((function(e){r.addEventListener(e,(function(t){if(U_[e]){U_[e].call(i,t)}else{i.fire(e,t)}}))}))}return j_.prototype.initialize.call(this,e,t,n)};U_.canvas=function(){return this._canvas};U_.context=function(){return this._canvas.getContext("2d")};U_.events=R_;U_.DOMMouseScroll=function(e){this.fire("mousewheel",e)};function q_(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);if(a===i){this.fire(e,r)}else{if(!i||!i.exit){this.fire(n,r)}this._active=a;this.fire(t,r);this.fire(e,r)}}}function W_(e){return function(t){this.fire(e,t);this._active=null}}U_.mousemove=q_("mousemove","mouseover","mouseout");U_.dragover=q_("dragover","dragenter","dragleave");U_.mouseout=W_("mouseout");U_.dragleave=W_("dragleave");U_.mousedown=function(e){this._down=this._active;this.fire("mousedown",e)};U_.click=function(e){if(this._down===this._active){this.fire("click",e);this._down=null}};U_.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire("touchstart",e,true)};U_.touchmove=function(e){this.fire("touchmove",e,true)};U_.touchend=function(e){this.fire("touchend",e,true);this._touch=null};U_.fire=function(e,t,n){var r=n?this._touch:this._active,i=this._handlers[e],a,o;t.vegaType=e;if(e===I_&&r&&r.href){this.handleHref(t,r,r.href)}else if(e===P_||e===L_){this.handleTooltip(t,r,e!==L_)}if(i){for(a=0,o=i.length;a<o;++a){i[a].handler.call(this._obj,t,r)}}};U_.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){(r[n]||(r[n]=[])).push({type:e,handler:t})}return this};U_.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){r.splice(i,1)}return this};U_.pickEvent=function(e){var t=C_(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])};U_.pick=function(e,t,n,r,i){var a=this.context(),o=h_[e.marktype];return o.pick.call(this,a,e,t,n,r,i)};function H_(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var $_=H_();function G_(e,t,n,r,i,a){var o=typeof HTMLElement!=="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,u=e.getContext("2d"),s=o?$_:i;e.width=t*s;e.height=n*s;for(var l in a){u[l]=a[l]}if(o&&s!==1){e.style.width=t+"px";e.style.height=n+"px"}u.pixelRatio=s;u.setTransform(s,0,0,s,s*r[0],s*r[1]);return e}function V_(e){T_.call(this,e);this._redraw=false;this._dirty=new Xv}var Y_=aa(V_,T_),X_=T_.prototype,J_=new Xv;Y_.initialize=function(e,t,n,r,i,a){this._options=a;this._canvas=ag(1,1);if(e){S_(e,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return X_.initialize.call(this,e,t,n,r,i)};Y_.resize=function(e,t,n,r){X_.resize.call(this,e,t,n,r);G_(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context);this._redraw=true;return this};Y_.canvas=function(){return this._canvas};Y_.context=function(){return this._canvas?this._canvas.getContext("2d"):null};Y_.dirty=function(e){var t=K_(e.bounds,e.mark.group);this._dirty.union(t)};function Z_(e,t,n){t.expand(1).round();if(e.pixelRatio%1){t.scale(e.pixelRatio).round().scale(1/e.pixelRatio)}t.translate(-(n[0]%1),-(n[1]%1));e.beginPath();e.rect(t.x1,t.y1,t.width(),t.height());e.clip();return t}function Q_(e,t,n){return J_.set(0,0,t,n).translate(-e[0],-e[1])}function K_(e,t){if(t==null)return e;var n=J_.clear().union(e);for(;t!=null;t=t.mark.group){n.translate(t.x||0,t.y||0)}return n}Y_._render=function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;t.save();if(this._redraw||a.empty()){this._redraw=false;a=Q_(n,r,i).expand(1)}else{a=Z_(t,a.intersect(Q_(n,r,i)),n)}this.clear(-n[0],-n[1],r,i);this.draw(t,e,a);t.restore();this._dirty.clear();return this};Y_.draw=function(e,t,n){var r=h_[t.marktype];if(t.clip)Yb(e,t);r.draw.call(this,e,t,n);if(t.clip)e.restore()};Y_.clear=function(e,t,n,r){var i=this.context();i.clearRect(e,t,n,r);if(this._bgcolor!=null){i.fillStyle=this._bgcolor;i.fillRect(e,t,n,r)}};function ew(e,t){j_.call(this,e,t);var n=this;n._hrefHandler=nw(n,(function(e,t){if(t&&t.href)n.handleHref(e,t,t.href)}));n._tooltipHandler=nw(n,(function(e,t){n.handleTooltip(e,t,e.type!==L_)}))}var tw=aa(ew,j_);tw.initialize=function(e,t,n){var r=this._svg;if(r){r.removeEventListener(I_,this._hrefHandler);r.removeEventListener(P_,this._tooltipHandler);r.removeEventListener(L_,this._tooltipHandler)}this._svg=r=e&&O_(e,"svg");if(r){r.addEventListener(I_,this._hrefHandler);r.addEventListener(P_,this._tooltipHandler);r.addEventListener(L_,this._tooltipHandler)}return j_.prototype.initialize.call(this,e,t,n)};tw.canvas=function(){return this._svg};function nw(e,t){return function(n){var r=n.target,i=r.__data__;n.vegaType=n.type;i=Array.isArray(i)?i[0]:i;t.call(e._obj,n,i)}}tw.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){var a={type:e,handler:t,listener:nw(this,t)};(r[n]||(r[n]=[])).push(a);if(this._svg){this._svg.addEventListener(n,a.listener)}}return this};tw.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);if(i>=0){if(this._svg){this._svg.removeEventListener(n,r[i].listener)}r.splice(i,1)}return this};function rw(e,t,n){var r="<"+e,i,a;if(t){for(i in t){a=t[i];if(a!=null){r+=" "+i+'="'+a+'"'}}}if(n)r+=" "+n;return r+">"}function iw(e){return"</"+e+">"}var aw={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};var ow={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"};var uw=Object.keys(ow);var sw=aw.xmlns;function lw(e){T_.call(this,e);this._dirtyID=0;this._dirty=[];this._svg=null;this._root=null;this._defs=null}var fw=aa(lw,T_);var cw=T_.prototype;fw.initialize=function(e,t,n,r){if(e){this._svg=A_(e,0,"svg",sw);this._svg.setAttribute("class","marks");S_(e,1);this._root=A_(this._svg,0,"g",sw);S_(this._svg,1)}this._defs={gradient:{},clipping:{}};this.background(this._bgcolor);return cw.initialize.call(this,e,t,n,r)};fw.background=function(e){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",e)}return cw.background.apply(this,arguments)};fw.resize=function(e,t,n,r){cw.resize.call(this,e,t,n,r);if(this._svg){this._svg.setAttribute("width",this._width*this._scale);this._svg.setAttribute("height",this._height*this._scale);this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height);this._root.setAttribute("transform","translate("+this._origin+")")}this._dirty=[];return this};fw.canvas=function(){return this._svg};fw.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in aw){e[t]=aw[t]}var n=!this._bgcolor?"":rw("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+iw("rect");return rw("svg",e)+n+this._svg.innerHTML+iw("svg")};fw._render=function(e){if(this._dirtyCheck()){if(this._dirtyAll)this._resetDefs();this.draw(this._root,e);S_(this._root,1)}this.updateDefs();this._dirty=[];++this._dirtyID;return this};fw.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,r=0,i;for(i in t.gradient){if(!n)t.el=n=A_(e,0,"defs",sw);r=dw(n,t.gradient[i],r)}for(i in t.clipping){if(!n)t.el=n=A_(e,0,"defs",sw);r=hw(n,t.clipping[i],r)}if(n){if(r===0){e.removeChild(n);t.el=null}else{S_(n,r)}}};function dw(e,t,n){var r,i,a;if(t.gradient==="radial"){var o=A_(e,n++,"pattern",sw);o.setAttribute("id",Qv+t.id);o.setAttribute("viewBox","0,0,1,1");o.setAttribute("width","100%");o.setAttribute("height","100%");o.setAttribute("preserveAspectRatio","xMidYMid slice");o=A_(o,0,"rect",sw);o.setAttribute("width","1");o.setAttribute("height","1");o.setAttribute("fill","url("+kw()+"#"+t.id+")");e=A_(e,n++,"radialGradient",sw);e.setAttribute("id",t.id);e.setAttribute("fx",t.x1);e.setAttribute("fy",t.y1);e.setAttribute("fr",t.r1);e.setAttribute("cx",t.x2);e.setAttribute("cy",t.y2);e.setAttribute("r",t.r2)}else{e=A_(e,n++,"linearGradient",sw);e.setAttribute("id",t.id);e.setAttribute("x1",t.x1);e.setAttribute("x2",t.x2);e.setAttribute("y1",t.y1);e.setAttribute("y2",t.y2)}for(r=0,i=t.stops.length;r<i;++r){a=A_(e,r,"stop",sw);a.setAttribute("offset",t.stops[r].offset);a.setAttribute("stop-color",t.stops[r].color)}S_(e,r);return n}function hw(e,t,n){var r;e=A_(e,n,"clipPath",sw);e.setAttribute("id",t.id);if(t.path){r=A_(e,0,"path",sw);r.setAttribute("d",t.path)}else{r=A_(e,0,"rect",sw);r.setAttribute("x",0);r.setAttribute("y",0);r.setAttribute("width",t.width);r.setAttribute("height",t.height)}S_(e,1);return n+1}fw._resetDefs=function(){var e=this._defs;e.gradient={};e.clipping={}};fw.dirty=function(e){if(e.dirty!==this._dirtyID){e.dirty=this._dirtyID;this._dirty.push(e)}};fw.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID};fw._dirtyCheck=function(){this._dirtyAll=true;var e=this._dirty;if(!e.length||!this._dirtyID)return true;var t=++this._dirtyID,n,r,i,a,o,u,s;for(o=0,u=e.length;o<u;++o){n=e[o];r=n.mark;if(r.marktype!==i){i=r.marktype;a=h_[i]}if(r.zdirty&&r.dirty!==t){this._dirtyAll=false;pw(n,t);r.items.forEach((function(e){e.dirty=t}))}if(r.zdirty)continue;if(n.exit){if(a.nested&&r.items.length){s=r.items[0];if(s._svg)this._update(a,s._svg,s)}else if(n._svg){s=n._svg.parentNode;if(s)s.removeChild(n._svg)}n._svg=null;continue}n=a.nested?r.items[0]:n;if(n._update===t)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;pw(n,t)}else{this._update(a,n._svg,n)}n._update=t}return!this._dirtyAll};function pw(e,t){for(;e&&e.dirty!==t;e=e.mark.group){e.dirty=t;if(e.mark&&e.mark.dirty!==t){e.mark.dirty=t}else return}}fw.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r=this,i=this._svg,a=h_[t.marktype],o=t.interactive===false?"none":null,u=a.tag==="g",s=null,l=0,f;f=gw(t,e,n,"g",i);f.setAttribute("class",D_(t));if(!u){f.style.setProperty("pointer-events",o)}if(t.clip){f.setAttribute("clip-path",Qb(r,t,t.group))}else{f.removeAttribute("clip-path")}function c(e){var t=r.isDirty(e),n=gw(e,f,s,a.tag,i);if(t){r._update(a,n,e);if(u)vw(r,n,e)}s=n;++l}if(a.nested){if(t.items.length)c(t.items[0])}else{Db(t,c)}S_(f,l);return f};function vw(e,t,n){t=t.lastChild.previousSibling;var r,i=0;Db(n,(function(n){r=e.draw(t,n,r);++i}));S_(t,1+i)}function gw(e,t,n,r,i){var a=e._svg,o;if(!a){o=t.ownerDocument;a=E_(o,r,sw);e._svg=a;if(e.mark){a.__data__=e;a.__values__={fill:"default"};if(r==="g"){var u=E_(o,"path",sw);a.appendChild(u);u.__data__=e;var s=E_(o,"g",sw);a.appendChild(s);s.__data__=e;var l=E_(o,"path",sw);a.appendChild(l);l.__data__=e;l.__values__={fill:"default"}}}}if(a.ownerSVGElement!==i||mw(a,n)){t.insertBefore(a,n?n.nextSibling:t.firstChild)}return a}function mw(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}var yw=null,bw=null;var xw={group:function(e,t,n){var r,i;yw=r=t.childNodes[2];bw=r.__values__;e.foreground(ww,n,this);bw=t.__values__;yw=t.childNodes[1];e.content(ww,n,this);yw=i=t.childNodes[0];e.background(ww,n,this);var a=n.mark.interactive===false?"none":null;if(a!==bw.events){r.style.setProperty("pointer-events",a);i.style.setProperty("pointer-events",a);bw.events=a}if(n.strokeForeground&&n.stroke){var o=n.fill;r.style.removeProperty("display");this.style(i,n);i.style.removeProperty("stroke");if(o)n.fill=null;bw=r.__values__;this.style(r,n);if(o)n.fill=o;yw=null}else{r.style.setProperty("display","none");r.style.setProperty("fill","none")}},image:function(e,t,n){if(n.smooth===false){_w(t,"image-rendering","optimizeSpeed");_w(t,"image-rendering","pixelated")}else{_w(t,"image-rendering",null)}},text:function(e,t,n){var r=Xx(n),i,a,o,u;if(ri(r)){a=r.map((function(e){return Zx(n,e)}));i=a.join("\n");if(i!==bw.text){S_(t,0);o=t.ownerDocument;u=Vx(n);a.forEach((function(e,r){var i=E_(o,"tspan",sw);i.__data__=n;i.textContent=e;if(r){i.setAttribute("x",0);i.setAttribute("dy",u)}t.appendChild(i)}));bw.text=i}}else{a=Zx(n,r);if(a!==bw.text){t.textContent=a;bw.text=a}}_w(t,"font-family",e_(n));_w(t,"font-size",Gx(n)+"px");_w(t,"font-style",n.fontStyle);_w(t,"font-variant",n.fontVariant);_w(t,"font-weight",n.fontWeight)}};function _w(e,t,n){if(n!==bw[t]){if(n==null){e.style.removeProperty(t)}else{e.style.setProperty(t,n+"")}bw[t]=n}}fw._update=function(e,t,n){yw=t;bw=t.__values__;e.attr(ww,n,this);var r=xw[e.type];if(r)r.call(this,e,t,n);if(yw)this.style(yw,n)};function ww(e,t,n){if(t===bw[e])return;if(t!=null){if(n){yw.setAttributeNS(n,e,t)}else{yw.setAttribute(e,t)}}else{if(n){yw.removeAttributeNS(n,e)}else{yw.removeAttribute(e)}}bw[e]=t}fw.style=function(e,t){if(t==null)return;var n,r,i,a,o;for(n=0,r=uw.length;n<r;++n){i=uw[n];o=t[i];if(i==="font"){o=e_(t)}if(o===bw[i])continue;a=ow[i];if(o==null){if(a==="fill"){e.style.setProperty(a,"none")}else{e.style.removeProperty(a)}}else{if(Kv(o)){o=eg(o,this._defs.gradient,kw())}e.style.setProperty(a,o+"")}bw[i]=o}};function kw(){var e;return typeof window==="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Ew(e){T_.call(this,e);this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""};this._defs={gradient:{},clipping:{}}}var Ow=aa(Ew,T_);var Aw=T_.prototype;Ow.resize=function(e,t,n,r){Aw.resize.call(this,e,t,n,r);var i=this._origin,a=this._text;var o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in aw){o[u]=aw[u]}a.head=rw("svg",o);var s=this._bgcolor;if(s==="transparent"||s==="none")s=null;if(s){a.bg=rw("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+iw("rect")}else{a.bg=""}a.root=rw("g",{transform:"translate("+i+")"});a.foot=iw("g")+iw("svg");return this};Ow.background=function(){var e=Aw.background.apply(this,arguments);if(arguments.length&&this._text.head){this.resize(this._width,this._height,this._origin,this._scale)}return e};Ow.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot};Ow._render=function(e){this._text.body=this.mark(e);this._text.defs=this.buildDefs();return this};Ow.buildDefs=function(){var e=this._defs,t="",n,r,i,a,o;for(r in e.gradient){i=e.gradient[r];o=i.stops;if(i.gradient==="radial"){t+=rw(a="pattern",{id:Qv+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});t+=rw("rect",{width:"1",height:"1",fill:"url(#"+r+")"})+iw("rect");t+=iw(a);t+=rw(a="radialGradient",{id:r,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})}else{t+=rw(a="linearGradient",{id:r,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2})}for(n=0;n<o.length;++n){t+=rw("stop",{offset:o[n].offset,"stop-color":o[n].color})+iw("stop")}t+=iw(a)}for(r in e.clipping){i=e.clipping[r];t+=rw("clipPath",{id:r});if(i.path){t+=rw("path",{d:i.path})+iw("path")}else{t+=rw("rect",{x:0,y:0,width:i.width,height:i.height})+iw("rect")}t+=iw("clipPath")}return t.length>0?rw("defs")+t+iw("defs"):""};var Sw;function Dw(e,t,n,r){Sw[r||e]=t}Ow.attributes=function(e,t){Sw={};e(Dw,t,this);return Sw};Ow.href=function(e){var t=this,n=e.href,r;if(n){if(r=t._hrefs&&t._hrefs[n]){return r}else{t.sanitizeURL(n).then((function(e){e["xlink:href"]=e.href;e.href=null;(t._hrefs||(t._hrefs={}))[n]=e}))}}return null};Ow.mark=function(e){var t=this,n=h_[e.marktype],r=n.tag,i=this._defs,a="",o;if(r!=="g"&&e.interactive===false){o='style="pointer-events: none;"'}a+=rw("g",{class:D_(e),"clip-path":e.clip?Qb(t,e,e.group):null},o);function u(u){var s=t.href(u);if(s)a+=rw("a",s);o=r!=="g"?Cw(u,e,r,i):null;a+=rw(r,t.attributes(n.attr,u),o);if(r==="text"){var l=Xx(u);if(ri(l)){var f={x:0,dy:Vx(u)};for(var c=0;c<l.length;++c){a+=rw("tspan",c?f:null)+Mw(Zx(u,l[c]))+iw("tspan")}}else{a+=Mw(Zx(u,l))}}else if(r==="g"){var d=u.strokeForeground,h=u.fill,p=u.stroke;if(d&&p){u.stroke=null}a+=rw("path",t.attributes(n.background,u),Cw(u,e,"bgrect",i))+iw("path");a+=rw("g",t.attributes(n.content,u))+t.markGroup(u)+iw("g");if(d&&p){if(h)u.fill=null;u.stroke=p;a+=rw("path",t.attributes(n.foreground,u),Cw(u,e,"bgrect",i))+iw("path");if(h)u.fill=h}else{a+=rw("path",t.attributes(n.foreground,u),Cw({},e,"bgfore",i))+iw("path")}}a+=iw(r);if(s)a+=iw("a")}if(n.nested){if(e.items&&e.items.length)u(e.items[0])}else{Db(e,u)}return a+iw("g")};Ow.markGroup=function(e){var t=this,n="";Db(e,(function(e){n+=t.mark(e)}));return n};function Cw(e,t,n,r){if(e==null)return"";var i,a,o,u,s,l="";if(n==="bgrect"&&t.interactive===false){l+="pointer-events: none; "}if(n==="bgfore"){if(t.interactive===false){l+="pointer-events: none; "}l+="display: none; "}if(n==="image"){if(e.smooth===false){l+="image-rendering: optimizeSpeed; image-rendering: pixelated; "}}if(n==="text"){l+="font-family: "+e_(e)+"; ";l+="font-size: "+Gx(e)+"px; ";if(e.fontStyle)l+="font-style: "+e.fontStyle+"; ";if(e.fontVariant)l+="font-variant: "+e.fontVariant+"; ";if(e.fontWeight)l+="font-weight: "+e.fontWeight+"; "}for(i=0,a=uw.length;i<a;++i){o=uw[i];u=ow[o];s=e[o];if(s==null){if(u==="fill"){l+="fill: none; "}}else if(s==="transparent"&&(u==="fill"||u==="stroke")){l+=u+": none; "}else{if(Kv(s)){s=eg(s,r.gradient,"")}l+=u+": "+s+"; "}}return l?'style="'+l.trim()+'"':null}function Mw(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var jw="canvas";var Fw="png";var Nw="svg";var Tw="none";var zw={Canvas:jw,PNG:Fw,SVG:Nw,None:Tw};var Rw={};Rw[jw]=Rw[Fw]={renderer:V_,headless:V_,handler:B_};Rw[Nw]={renderer:lw,headless:Ew,handler:ew};Rw[Tw]={};function Pw(e,t){e=String(e||"").toLowerCase();if(arguments.length>1){Rw[e]=t;return this}else{return Rw[e]}}function Lw(e,t,n){var r=[],i=(new Xv).union(t),a=e.marktype;return a?Iw(e,i,n,r):a==="group"?Uw(e,i,n,r):ti("Intersect scene must be mark node or group item.")}function Iw(e,t,n,r){if(Bw(e,t,n)){var i=e.items,a=e.marktype,o=i.length;var u=0;if(a==="group"){for(;u<o;++u){Uw(i[u],t,n,r)}}else{for(var s=h_[a].isect;u<o;++u){var l=i[u];if(qw(l,t,s))r.push(l)}}}return r}function Bw(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==false&&(!n||n(e)))}function Uw(e,t,n,r){if(n&&n(e.mark)&&qw(e,t,h_.group.isect)){r.push(e)}var i=e.items,a=i&&i.length;if(a){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<a;++s){Iw(i[s],t,n,r)}t.translate(o,u)}return r}function qw(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}var Ww=new Xv;function Hw(e){var t=e.clip;if(Vi(t)){t(nb(Ww.clear()))}else if(t){Ww.set(0,0,e.group.width,e.group.height)}else return;e.bounds.intersect(Ww)}var $w=1e-9;function Gw(e,t,n){return e===t?true:n==="path"?Vw(e,t):e instanceof Date&&t instanceof Date?+e===+t:la(e)&&la(t)?Math.abs(e-t)<=$w:!e||!t||!ii(e)&&!ii(t)?e==t:e==null||t==null?false:Yw(e,t)}function Vw(e,t){return Gw(Im(e),Im(t))}function Yw(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return false;n.sort();r.sort();for(a=n.length-1;a>=0;a--){if(n[a]!=r[a])return false}for(a=n.length-1;a>=0;a--){i=n[a];if(!Gw(e[i],t[i],i))return false}return typeof e===typeof t}function Xw(e){af.call(this,null,e)}var Jw=aa(Xw,af);Jw.transform=function(e,t){var n=t.dataflow,r=e.mark,i=r.marktype,a=h_[i],o=a.bound,u=r.bounds,s;if(a.nested){if(r.items.length)n.dirty(r.items[0]);u=Zw(r,o);r.items.forEach((function(e){e.bounds.clear().union(u)}))}else if(i===Ov||e.modified()){t.visit(t.MOD,(function(e){n.dirty(e)}));u.clear();r.items.forEach((function(e){u.union(Zw(e,o))}));switch(r.role){case Av:case Mv:case Sv:t.reflow()}}else{s=t.changed(t.REM);t.visit(t.ADD,(function(e){u.union(Zw(e,o))}));t.visit(t.MOD,(function(e){s=s||u.alignsWith(e.bounds);n.dirty(e);u.union(Zw(e,o))}));if(s){u.clear();r.items.forEach((function(e){u.union(e.bounds)}))}}Hw(r);return t.modifies("bounds")};function Zw(e,t,n){return t(e.bounds.clear(),e,n)}var Qw=":vega_identifier:";function Kw(e){af.call(this,0,e)}Kw.Definition={type:"Identifier",metadata:{modifies:true},params:[{name:"as",type:"string",required:true}]};var ek=aa(Kw,af);ek.transform=function(e,t){var n=tk(t.dataflow),r=n.value,i=e.as;t.visit(t.ADD,(function(e){if(!e[i])e[i]=++r}));n.set(this.value=r);return t};function tk(e){var t=e._signals[Qw];if(!t){e._signals[Qw]=t=e.add(0)}return t}function nk(e){af.call(this,null,e)}var rk=aa(nk,af);rk.transform=function(e,t){var n=this.value;if(!n){n=t.dataflow.scenegraph().mark(e.markdef,ik(e),e.index);n.group.context=e.context;if(!e.context.group)e.context.group=n.group;n.source=this.source;n.clip=e.clip;n.interactive=e.interactive;this.value=n}var r=n.marktype===Ov?ig:rg;t.visit(t.ADD,(function(e){r.call(e,n)}));if(e.modified("clip")||e.modified("interactive")){n.clip=e.clip;n.interactive=!!e.interactive;n.zdirty=true;t.reflow()}n.items=t.source;return t};function ik(e){var t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function ak(e){af.call(this,null,e)}var ok=aa(ak,af);var uk={parity:function(e){return e.filter((function(e,t){return t%2?e.opacity=0:1}))},greedy:function(e,t){var n;return e.filter((function(e,r){if(!r||!sk(n.bounds,e.bounds,t)){n=e;return 1}else{return e.opacity=0}}))}};function sk(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)}function lk(e,t){for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n){if(sk(i,a=e[n].bounds,t))return true}}function fk(e){var t=e.bounds;return t.width()>1&&t.height()>1}function ck(e,t,n){var r=e.range(),i=new Xv;if(t===dv||t===vv){i.set(r[0],-Infinity,r[1],+Infinity)}else{i.set(-Infinity,r[0],+Infinity,r[1])}i.expand(n||1);return function(e){return i.encloses(e.bounds)}}function dk(e){e.forEach((function(e){return e.opacity=1}));return e}function hk(e,t){return e.reflow(t.modified()).modifies("opacity")}ok.transform=function(e,t){var n=uk[e.method]||uk.parity,r=t.materialize(t.SOURCE).source,i=e.separation||0,a,o,u;if(!r||!r.length)return;if(!e.method){if(e.modified("method")){dk(r);t=hk(t,e)}return t}r=r.filter(fk);if(!r.length)return;if(e.sort){r=r.slice().sort(e.sort)}a=dk(r);t=hk(t,e);if(a.length>=3&&lk(a,i)){do{a=n(a,i)}while(a.length>=3&&lk(a,i));if(a.length<3&&!Ai(r).opacity){if(a.length>1)Ai(a).opacity=0;Ai(r).opacity=1}}if(e.boundScale&&e.boundTolerance>=0){o=ck(e.boundScale,e.boundOrient,+e.boundTolerance);r.forEach((function(e){if(!o(e))e.opacity=0}))}u=a[0].mark.bounds.clear();r.forEach((function(e){if(e.opacity)u.union(e.bounds)}));return t};function pk(e){af.call(this,null,e)}var vk=aa(pk,af);vk.transform=function(e,t){var n=t.dataflow;t.visit(t.ALL,(function(e){n.dirty(e)}));if(t.fields&&t.fields["zindex"]){var r=t.source&&t.source[0];if(r)r.mark.zdirty=true}};var gk=new Xv;function mk(e,t,n){return e[t]===n?0:(e[t]=n,1)}function yk(e){var t=e.items[0].datum.orient;return t===hv||t===pv}function bk(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function xk(e,t,n,r){var i=t.items[0],a=i.datum,o=a.orient,u=a.translate!=null?a.translate:.5,s=bk(a),l=i.range,f=i.offset,c=i.position,d=i.minExtent,h=i.maxExtent,p=a.title&&i.items[s[2]].items[0],v=i.titlePadding,g=i.bounds,m=p&&Jx(p),y=0,b=0,x,_;gk.clear().union(g);g.clear();if((x=s[0])>-1)g.union(i.items[x].bounds);if((x=s[1])>-1)g.union(i.items[x].bounds);switch(o){case dv:y=c||0;b=-f;_=Math.max(d,Math.min(h,-g.y1));g.add(0,-_).add(l,0);if(p)_k(e,p,_,v,m,0,-1,g);break;case hv:y=-f;b=c||0;_=Math.max(d,Math.min(h,-g.x1));g.add(-_,0).add(0,l);if(p)_k(e,p,_,v,m,1,-1,g);break;case pv:y=n+f;b=c||0;_=Math.max(d,Math.min(h,g.x2));g.add(0,0).add(_,l);if(p)_k(e,p,_,v,m,1,1,g);break;case vv:y=c||0;b=r+f;_=Math.max(d,Math.min(h,g.y2));g.add(0,0).add(l,_);if(p)_k(e,p,_,v,0,0,1,g);break;default:y=i.x;b=i.y}Jy(g.translate(y,b),i);if(mk(i,"x",y+u)|mk(i,"y",b+u)){i.bounds=gk;e.dirty(i);i.bounds=g;e.dirty(i)}return i.mark.bounds.clear().union(g)}function _k(e,t,n,r,i,a,o,u){var s=t.bounds;if(t.auto){var l=o*(n+i+r);var f=0,c=0;e.dirty(t);a?f=(t.x||0)-(t.x=l):c=(t.y||0)-(t.y=l);t.mark.bounds.clear().union(s.translate(-f,-c));e.dirty(t)}u.union(s)}function wk(e){var t,n,r,i,a;var o=e.items,u=o.length,s=0,l,f;var c={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;s<u;++s){l=o[s];f=l.items;if(l.marktype===Ov){switch(l.role){case Av:case Mv:case Sv:break;case jv:(t=c.rowheaders).push.apply(t,f);break;case Fv:(n=c.rowfooters).push.apply(n,f);break;case Tv:(r=c.colheaders).push.apply(r,f);break;case zv:(i=c.colfooters).push.apply(i,f);break;case Nv:c.rowtitle=f[0];break;case Rv:c.coltitle=f[0];break;default:(a=c.marks).push.apply(a,f)}}}return c}function kk(e){return(new Xv).set(0,0,e.width||0,e.height||0)}function Ek(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Ok(e,t,n){var r=ii(e)?e[t]:e;return r!=null?r:n!==undefined?n:0}function Ak(e){return e<0?Math.ceil(-e):0}function Sk(e,t,n){var r=!n.nodirty,i=n.bounds===Gv?kk:Ek,a=gk.set(0,0,0,0),o=Ok(n.align,Vv),u=Ok(n.align,Yv),s=Ok(n.padding,Vv),l=Ok(n.padding,Yv),f=n.columns||t.length,c=f<0?1:Math.ceil(t.length/f),d=t.length,h=Array(d),p=Array(f),v=0,g=Array(d),m=Array(c),y=0,b=Array(d),x=Array(d),_=Array(d),w,k,E,O,A,S,D,C,M,j,F;for(k=0;k<f;++k)p[k]=0;for(k=0;k<c;++k)m[k]=0;for(k=0;k<d;++k){S=t[k];A=_[k]=i(S);S.x=S.x||0;b[k]=0;S.y=S.y||0;x[k]=0;E=k%f;O=~~(k/f);v=Math.max(v,D=Math.ceil(A.x2));y=Math.max(y,C=Math.ceil(A.y2));p[E]=Math.max(p[E],D);m[O]=Math.max(m[O],C);h[k]=s+Ak(A.x1);g[k]=l+Ak(A.y1);if(r)e.dirty(t[k])}for(k=0;k<d;++k){if(k%f===0)h[k]=0;if(k<f)g[k]=0}if(o===$v){for(E=1;E<f;++E){for(F=0,k=E;k<d;k+=f){if(F<h[k])F=h[k]}for(k=E;k<d;k+=f){h[k]=F+p[E-1]}}}else if(o===Hv){for(F=0,k=0;k<d;++k){if(k%f&&F<h[k])F=h[k]}for(k=0;k<d;++k){if(k%f)h[k]=F+v}}else{for(o=false,E=1;E<f;++E){for(k=E;k<d;k+=f){h[k]+=p[E-1]}}}if(u===$v){for(O=1;O<c;++O){for(F=0,k=O*f,w=k+f;k<w;++k){if(F<g[k])F=g[k]}for(k=O*f;k<w;++k){g[k]=F+m[O-1]}}}else if(u===Hv){for(F=0,k=f;k<d;++k){if(F<g[k])F=g[k]}for(k=f;k<d;++k){g[k]=F+y}}else{for(u=false,O=1;O<c;++O){for(k=O*f,w=k+f;k<w;++k){g[k]+=m[O-1]}}}for(M=0,k=0;k<d;++k){M=h[k]+(k%f?M:0);b[k]+=M-t[k].x}for(E=0;E<f;++E){for(j=0,k=E;k<d;k+=f){j+=g[k];x[k]+=j-t[k].y}}if(o&&Ok(n.center,Vv)&&c>1){for(k=0;k<d;++k){A=o===Hv?v:p[k%f];M=A-_[k].x2-t[k].x-b[k];if(M>0)b[k]+=M/2}}if(u&&Ok(n.center,Yv)&&f!==1){for(k=0;k<d;++k){A=u===Hv?y:m[~~(k/f)];j=A-_[k].y2-t[k].y-x[k];if(j>0)x[k]+=j/2}}for(k=0;k<d;++k){a.union(_[k].translate(b[k],x[k]))}M=Ok(n.anchor,kv);j=Ok(n.anchor,Ev);switch(Ok(n.anchor,Vv)){case wv:M-=a.width();break;case _v:M-=a.width()/2}switch(Ok(n.anchor,Yv)){case wv:j-=a.height();break;case _v:j-=a.height()/2}M=Math.round(M);j=Math.round(j);a.clear();for(k=0;k<d;++k){t[k].mark.bounds.clear()}for(k=0;k<d;++k){S=t[k];S.x+=b[k]+=M;S.y+=x[k]+=j;a.union(S.mark.bounds.union(S.bounds.translate(b[k],x[k])));if(r)e.dirty(S)}return a}function Dk(e,t,n){var r=wk(t),i=r.marks,a=n.bounds===Gv?Ck:Mk,o=n.offset,u=n.columns||i.length,s=u<0?1:Math.ceil(i.length/u),l=s*u,f,c,d,h,p,v,g;var m=Sk(e,i,n);if(r.rowheaders){v=Ok(n.headerBand,Yv,null);f=Nk(e,r.rowheaders,i,u,s,-Ok(o,"rowHeader"),jk,0,a,"x1",0,u,1,v)}if(r.colheaders){v=Ok(n.headerBand,Vv,null);c=Nk(e,r.colheaders,i,u,u,-Ok(o,"columnHeader"),jk,1,a,"y1",0,1,u,v)}if(r.rowfooters){v=Ok(n.footerBand,Yv,null);d=Nk(e,r.rowfooters,i,u,s,Ok(o,"rowFooter"),Fk,0,a,"x2",u-1,u,1,v)}if(r.colfooters){v=Ok(n.footerBand,Vv,null);h=Nk(e,r.colfooters,i,u,u,Ok(o,"columnFooter"),Fk,1,a,"y2",l-u,1,u,v)}if(r.rowtitle){p=Ok(n.titleAnchor,Yv);g=Ok(o,"rowTitle");g=p===wv?d+g:f-g;v=Ok(n.titleBand,Yv,.5);Tk(e,r.rowtitle,g,0,m,v)}if(r.coltitle){p=Ok(n.titleAnchor,Vv);g=Ok(o,"columnTitle");g=p===wv?h+g:c-g;v=Ok(n.titleBand,Vv,.5);Tk(e,r.coltitle,g,1,m,v)}}function Ck(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):undefined}function Mk(e,t){return e.bounds[t]}function jk(e,t){return Math.floor(Math.min(e,t))}function Fk(e,t){return Math.ceil(Math.max(e,t))}function Nk(e,t,n,r,i,a,o,u,s,l,f,c,d,h){var p=n.length,v=0,g=0,m,y,b,x,_,w,k,E,O;if(!p)return v;for(m=f;m<p;m+=c){if(n[m])v=o(v,s(n[m],l))}if(!t.length)return v;if(t.length>i){e.warn("Grid headers exceed limit: "+i);t=t.slice(0,i)}v+=a;for(y=0,x=t.length;y<x;++y){e.dirty(t[y]);t[y].mark.bounds.clear()}for(m=f,y=0,x=t.length;y<x;++y,m+=c){w=t[y];_=w.mark.bounds;for(b=m;b>=0&&(k=n[b])==null;b-=d);if(u){E=h==null?k.x:Math.round(k.bounds.x1+h*k.bounds.width());O=v}else{E=v;O=h==null?k.y:Math.round(k.bounds.y1+h*k.bounds.height())}_.union(w.bounds.translate(E-(w.x||0),O-(w.y||0)));w.x=E;w.y=O;e.dirty(w);g=o(g,_[l])}return g}function Tk(e,t,n,r,i,a){if(!t)return;e.dirty(t);var o=n,u=n;r?o=Math.round(i.x1+a*i.width()):u=Math.round(i.y1+a*i.height());t.bounds.translate(o-(t.x||0),u-(t.y||0));t.mark.bounds.clear().union(t.bounds);t.x=o;t.y=u;e.dirty(t)}function zk(e,t){var n=e[t]||{};return function(t,r){return n[t]!=null?n[t]:e[t]!=null?e[t]:r}}function Rk(e,t){var n=-Infinity;e.forEach((function(e){if(e.offset!=null)n=Math.max(n,e.offset)}));return n>-Infinity?n:t}function Pk(e,t,n,r,i,a,o){var u=zk(n,t),s=Rk(e,u("offset",0)),l=u("anchor",xv),f=l===wv?1:l===_v?.5:0;var c={align:$v,bounds:u("bounds",Gv),columns:u("direction")==="vertical"?1:e.length,padding:u("margin",8),center:u("center"),nodirty:true};switch(t){case hv:c.anchor={x:Math.floor(r.x1)-s,column:wv,y:f*(o||r.height()+2*r.y1),row:l};break;case pv:c.anchor={x:Math.ceil(r.x2)+s,y:f*(o||r.height()+2*r.y1),row:l};break;case dv:c.anchor={y:Math.floor(i.y1)-s,row:wv,x:f*(a||i.width()+2*i.x1),column:l};break;case vv:c.anchor={y:Math.ceil(i.y2)+s,x:f*(a||i.width()+2*i.x1),column:l};break;case gv:c.anchor={x:s,y:s};break;case mv:c.anchor={x:a-s,y:s,column:wv};break;case yv:c.anchor={x:s,y:o-s,row:wv};break;case bv:c.anchor={x:a-s,y:o-s,column:wv,row:wv};break}return c}function Lk(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,u=n.y,s,l;n._bounds?n._bounds.clear().union(a):n._bounds=a.clone();a.clear();Bk(e,n,n.items[0].items[0]);a=Ik(n,a);s=2*n.padding;l=2*n.padding;if(!a.empty()){s=Math.ceil(a.width()+s);l=Math.ceil(a.height()+l)}if(r.type===Lv){Wk(n.items[0].items[0].items[0].items)}if(i!==Wv){n.x=o=0;n.y=u=0}n.width=s;n.height=l;Jy(a.set(o,u,o+s,u+l),n);n.mark.bounds.clear().union(a);return n}function Ik(e,t){e.items.forEach((function(e){return t.union(e.bounds)}));t.x1=e.padding;t.y1=e.padding;return t}function Bk(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title){if(i||a)qk(e,n,i,a)}else{var o=t.items[1].items[0],u=o.anchor,s=t.titlePadding||0,l=r-o.x,f=r-o.y;switch(o.orient){case hv:i+=Math.ceil(o.bounds.width())+s;break;case pv:case vv:break;default:a+=o.bounds.height()+s}if(i||a)qk(e,n,i,a);switch(o.orient){case hv:f+=Uk(t,n,o,u,1,1);break;case pv:l+=Uk(t,n,o,wv,0,0)+s;f+=Uk(t,n,o,u,1,1);break;case vv:l+=Uk(t,n,o,u,0,0);f+=Uk(t,n,o,wv,-1,0,1)+s;break;default:l+=Uk(t,n,o,u,0,0)}if(l||f)qk(e,o,l,f);if((l=Math.round(o.bounds.x1-r))<0){qk(e,n,-l,0);qk(e,o,-l,0)}}}function Uk(e,t,n,r,i,a,o){var u=e.datum.type!=="symbol",s=n.datum.vgrad,l=u&&(a||!s)&&!o?t.items[0]:t,f=l.bounds[i?"y2":"x2"]-e.padding,c=s&&a?f:0,d=s&&a?0:f,h=i<=0?0:Jx(n);return Math.round(r===xv?c:r===wv?d-h:.5*(f-h))}function qk(e,t,n,r){t.x+=n;t.y+=r;t.bounds.translate(n,r);t.mark.bounds.translate(n,r);e.dirty(t)}function Wk(e){var t=e.reduce((function(e,t){e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0);return e}),{});e.forEach((function(e){e.width=t[e.column];e.height=e.bounds.y2-e.y}))}function Hk(e,t,n,r,i){var a=t.items[0],o=a.frame,u=a.orient,s=a.anchor,l=a.offset,f=a.padding,c=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],h=u===hv||u===pv?r:n,p=0,v=0,g=0,m=0,y=0,b;if(o!==Ov){u===hv?(p=i.y2,h=i.y1):u===pv?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2)}else if(u===hv){p=r,h=0}b=s===xv?p:s===wv?h:(p+h)/2;if(d&&d.text){switch(u){case dv:case vv:y=c.bounds.height()+f;break;case hv:m=c.bounds.width()+f;break;case pv:m=-c.bounds.width()-f;break}gk.clear().union(d.bounds);gk.translate(m-(d.x||0),y-(d.y||0));if(mk(d,"x",m)|mk(d,"y",y)){e.dirty(d);d.bounds.clear().union(gk);d.mark.bounds.clear().union(gk);e.dirty(d)}gk.clear().union(d.bounds)}else{gk.clear()}gk.union(c.bounds);switch(u){case dv:v=b;g=i.y1-gk.height()-l;break;case hv:v=i.x1-gk.width()-l;g=b;break;case pv:v=i.x2+gk.width()+l;g=b;break;case vv:v=b;g=i.y2+l;break;default:v=a.x;g=a.y}if(mk(a,"x",v)|mk(a,"y",g)){gk.translate(v,g);e.dirty(a);a.bounds.clear().union(gk);t.bounds.clear().union(gk);e.dirty(a)}return a.bounds}function $k(e){af.call(this,null,e)}var Gk=aa($k,af);Gk.transform=function(e,t){var n=t.dataflow;e.mark.items.forEach((function(t){if(e.layout)Dk(n,t,e.layout);Vk(n,t,e)}));if(e.modified())t.reflow();return t};function Vk(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=(new Xv).set(0,0,i,a),u=o.clone(),s=o.clone(),l=[],f,c,d,h,p,v;for(p=0,v=r.length;p<v;++p){c=r[p];switch(c.role){case Av:h=yk(c)?u:s;h.union(xk(e,c,i,a));break;case Sv:f=c;break;case Mv:l.push(Lk(e,c));break;case Dv:case Cv:case jv:case Fv:case Nv:case Tv:case zv:case Rv:u.union(c.bounds);s.union(c.bounds);break;default:o.union(c.bounds)}}if(l.length){var g={};l.forEach((function(e){d=e.orient||pv;if(d!==Wv)(g[d]||(g[d]=[])).push(e)}));for(var m in g){var y=g[m];Sk(e,y,Pk(y,m,n.legends,u,s,i,a))}l.forEach((function(t){var r=t.bounds;if(!r.equals(t._bounds)){t.bounds=t._bounds;e.dirty(t);t.bounds=r;e.dirty(t)}if(n.autosize&&n.autosize.type===Iv){switch(t.orient){case hv:case pv:o.add(r.x1,0).add(r.x2,0);break;case dv:case vv:o.add(0,r.y1).add(0,r.y2)}}else{o.union(r)}}))}o.union(u).union(s);if(f){o.union(Hk(e,f,i,a,o))}if(t.clip){o.set(0,0,t.width||0,t.height||0)}Yk(e,t,o,n)}function Yk(e,t,n,r){var i=r.autosize||{},a=i.type;if(e._autosize<1||!a)return;var o=e._width,u=e._height,s=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,Math.ceil(n.x2-s)),c=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Pv){var p=e.padding();o-=p.left+p.right;u-=p.top+p.bottom}if(a===Wv){l=0;d=0;s=o;c=u}else if(a===Iv){s=Math.max(0,o-l-f);c=Math.max(0,u-d-h)}else if(a===Bv){s=Math.max(0,o-l-f);u=c+d+h}else if(a===Uv){o=s+l+f;c=Math.max(0,u-d-h)}else if(a===qv){o=s+l+f;u=c+d+h}e._resizeView(o,u,s,c,[l,d],i.resize)}var Xk=Object.freeze({__proto__:null,bound:Xw,identifier:Kw,mark:nk,overlap:ak,render:pk,viewlayout:$k});function Jk(e,t,n){var r=e-t+n*2;return e?r>0?r:1:0}var Zk="identity";var Qk="linear";var Kk="log";var eE="pow";var tE="sqrt";var nE="symlog";var rE="time";var iE="utc";var aE="sequential";var oE="diverging";var uE="quantile";var sE="quantize";var lE="threshold";var fE="ordinal";var cE="point";var dE="band";var hE="bin-ordinal";var pE="continuous";var vE="discrete";var gE="discretizing";var mE="interpolating";var yE="temporal";function bE(e){return function(t){var n=t[0],r=t[1],i;if(r<n){i=n;n=r;r=i}return[e.invert(n),e.invert(r)]}}function xE(e){return function(t){var n=e.range(),r=t[0],i=t[1],a=-1,o,u,s,l;if(i<r){u=r;r=i;i=u}for(s=0,l=n.length;s<l;++s){if(n[s]>=r&&n[s]<=i){if(a<0)a=s;o=s}}if(a<0)return undefined;r=e.invertExtent(n[a]);i=e.invertExtent(n[o]);return[r[0]===undefined?r[1]:r[0],i[1]===undefined?i[0]:i[1]]}}function _E(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function wE(e,t){switch(arguments.length){case 0:break;case 1:{if(typeof e==="function")this.interpolator(e);else this.range(e);break}default:{this.domain(e);if(typeof t==="function")this.interpolator(t);else this.range(t);break}}return this}var kE=Symbol("implicit");function EE(){var e=new Map,t=[],n=[],r=kE;function i(i){var a=i+"",o=e.get(a);if(!o){if(r!==kE)return r;e.set(a,o=t.push(i))}return n[(o-1)%n.length]}i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(var r=0,a=n;r<a.length;r++){var o=a[r];var u=o+"";if(e.has(u))continue;e.set(u,t.push(o))}return i};i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()};i.unknown=function(e){return arguments.length?(r=e,i):r};i.copy=function(){return EE(t,n).unknown(r)};_E.apply(i,arguments);return i}function OE(e,t,n){e.prototype=t.prototype=n;n.constructor=e}function AE(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function SE(){}var DE=.7;var CE=1/DE;var ME="\\s*([+-]?\\d+)\\s*",jE="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",FE="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",NE=/^#([0-9a-f]{3,8})$/,TE=new RegExp("^rgb\\("+[ME,ME,ME]+"\\)$"),zE=new RegExp("^rgb\\("+[FE,FE,FE]+"\\)$"),RE=new RegExp("^rgba\\("+[ME,ME,ME,jE]+"\\)$"),PE=new RegExp("^rgba\\("+[FE,FE,FE,jE]+"\\)$"),LE=new RegExp("^hsl\\("+[jE,FE,FE]+"\\)$"),IE=new RegExp("^hsla\\("+[jE,FE,FE,jE]+"\\)$");var BE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};OE(SE,HE,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:UE,formatHex:UE,formatHsl:qE,formatRgb:WE,toString:WE});function UE(){return this.rgb().formatHex()}function qE(){return eO(this).formatHsl()}function WE(){return this.rgb().formatRgb()}function HE(e){var t,n;e=(e+"").trim().toLowerCase();return(t=NE.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?$E(t):n===3?new XE(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?new XE(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?new XE(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=TE.exec(e))?new XE(t[1],t[2],t[3],1):(t=zE.exec(e))?new XE(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=RE.exec(e))?GE(t[1],t[2],t[3],t[4]):(t=PE.exec(e))?GE(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=LE.exec(e))?KE(t[1],t[2]/100,t[3]/100,1):(t=IE.exec(e))?KE(t[1],t[2]/100,t[3]/100,t[4]):BE.hasOwnProperty(e)?$E(BE[e]):e==="transparent"?new XE(NaN,NaN,NaN,0):null}function $E(e){return new XE(e>>16&255,e>>8&255,e&255,1)}function GE(e,t,n,r){if(r<=0)e=t=n=NaN;return new XE(e,t,n,r)}function VE(e){if(!(e instanceof SE))e=HE(e);if(!e)return new XE;e=e.rgb();return new XE(e.r,e.g,e.b,e.opacity)}function YE(e,t,n,r){return arguments.length===1?VE(e):new XE(e,t,n,r==null?1:r)}function XE(e,t,n,r){this.r=+e;this.g=+t;this.b=+n;this.opacity=+r}OE(XE,YE,AE(SE,{brighter:function(e){e=e==null?CE:Math.pow(CE,e);return new XE(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){e=e==null?DE:Math.pow(DE,e);return new XE(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&(-.5<=this.g&&this.g<255.5)&&(-.5<=this.b&&this.b<255.5)&&(0<=this.opacity&&this.opacity<=1)},hex:JE,formatHex:JE,formatRgb:ZE,toString:ZE}));function JE(){return"#"+QE(this.r)+QE(this.g)+QE(this.b)}function ZE(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function QE(e){e=Math.max(0,Math.min(255,Math.round(e)||0));return(e<16?"0":"")+e.toString(16)}function KE(e,t,n,r){if(r<=0)e=t=n=NaN;else if(n<=0||n>=1)e=t=NaN;else if(t<=0)e=NaN;return new nO(e,t,n,r)}function eO(e){if(e instanceof nO)return new nO(e.h,e.s,e.l,e.opacity);if(!(e instanceof SE))e=HE(e);if(!e)return new nO;if(e instanceof nO)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,u=a-i,s=(a+i)/2;if(u){if(t===a)o=(n-r)/u+(n<r)*6;else if(n===a)o=(r-t)/u+2;else o=(t-n)/u+4;u/=s<.5?a+i:2-a-i;o*=60}else{u=s>0&&s<1?0:o}return new nO(o,u,s,e.opacity)}function tO(e,t,n,r){return arguments.length===1?eO(e):new nO(e,t,n,r==null?1:r)}function nO(e,t,n,r){this.h=+e;this.s=+t;this.l=+n;this.opacity=+r}OE(nO,tO,AE(SE,{brighter:function(e){e=e==null?CE:Math.pow(CE,e);return new nO(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?DE:Math.pow(DE,e);return new nO(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new XE(rO(e>=240?e-240:e+120,i,r),rO(e,i,r),rO(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)},formatHsl:function(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function rO(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var iO=Math.PI/180;var aO=180/Math.PI;var oO=18,uO=.96422,sO=1,lO=.82521,fO=4/29,cO=6/29,dO=3*cO*cO,hO=cO*cO*cO;function pO(e){if(e instanceof gO)return new gO(e.l,e.a,e.b,e.opacity);if(e instanceof kO)return EO(e);if(!(e instanceof XE))e=VE(e);var t=xO(e.r),n=xO(e.g),r=xO(e.b),i=mO((.2225045*t+.7168786*n+.0606169*r)/sO),a,o;if(t===n&&n===r)a=o=i;else{a=mO((.4360747*t+.3850649*n+.1430804*r)/uO);o=mO((.0139322*t+.0971045*n+.7141733*r)/lO)}return new gO(116*i-16,500*(a-i),200*(i-o),e.opacity)}function vO(e,t,n,r){return arguments.length===1?pO(e):new gO(e,t,n,r==null?1:r)}function gO(e,t,n,r){this.l=+e;this.a=+t;this.b=+n;this.opacity=+r}OE(gO,vO,AE(SE,{brighter:function(e){return new gO(this.l+oO*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new gO(this.l-oO*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;t=uO*yO(t);e=sO*yO(e);n=lO*yO(n);return new XE(bO(3.1338561*t-1.6168667*e-.4906146*n),bO(-.9787684*t+1.9161415*e+.033454*n),bO(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function mO(e){return e>hO?Math.pow(e,1/3):e/dO+fO}function yO(e){return e>cO?e*e*e:dO*(e-fO)}function bO(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function xO(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function _O(e){if(e instanceof kO)return new kO(e.h,e.c,e.l,e.opacity);if(!(e instanceof gO))e=pO(e);if(e.a===0&&e.b===0)return new kO(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*aO;return new kO(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function wO(e,t,n,r){return arguments.length===1?_O(e):new kO(e,t,n,r==null?1:r)}function kO(e,t,n,r){this.h=+e;this.c=+t;this.l=+n;this.opacity=+r}function EO(e){if(isNaN(e.h))return new gO(e.l,0,0,e.opacity);var t=e.h*iO;return new gO(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}OE(kO,wO,AE(SE,{brighter:function(e){return new kO(this.h,this.c,this.l+oO*(e==null?1:e),this.opacity)},darker:function(e){return new kO(this.h,this.c,this.l-oO*(e==null?1:e),this.opacity)},rgb:function(){return EO(this).rgb()}}));var OO=-.14861,AO=+1.78277,SO=-.29227,DO=-.90649,CO=+1.97294,MO=CO*DO,jO=CO*AO,FO=AO*SO-DO*OO;function NO(e){if(e instanceof zO)return new zO(e.h,e.s,e.l,e.opacity);if(!(e instanceof XE))e=VE(e);var t=e.r/255,n=e.g/255,r=e.b/255,i=(FO*r+MO*t-jO*n)/(FO+MO-jO),a=r-i,o=(CO*(n-i)-SO*a)/DO,u=Math.sqrt(o*o+a*a)/(CO*i*(1-i)),s=u?Math.atan2(o,a)*aO-120:NaN;return new zO(s<0?s+360:s,u,i,e.opacity)}function TO(e,t,n,r){return arguments.length===1?NO(e):new zO(e,t,n,r==null?1:r)}function zO(e,t,n,r){this.h=+e;this.s=+t;this.l=+n;this.opacity=+r}OE(zO,TO,AE(SE,{brighter:function(e){e=e==null?CE:Math.pow(CE,e);return new zO(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?DE:Math.pow(DE,e);return new zO(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*iO,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new XE(255*(t+n*(OO*r+AO*i)),255*(t+n*(SO*r+DO*i)),255*(t+n*(CO*r)),this.opacity)}}));function RO(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function PO(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,u=r<t-1?e[r+2]:2*a-i;return RO((n-r/t)*t,o,i,a,u)}}function LO(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return RO((n-r/t)*t,i,a,o,u)}}function IO(e){return function(){return e}}function BO(e,t){return function(n){return e+n*t}}function UO(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function qO(e,t){var n=t-e;return n?BO(e,n>180||n<-180?n-360*Math.round(n/360):n):IO(isNaN(e)?t:e)}function WO(e){return(e=+e)===1?HO:function(t,n){return n-t?UO(t,n,e):IO(isNaN(t)?n:t)}}function HO(e,t){var n=t-e;return n?BO(e,n):IO(isNaN(e)?t:e)}var $O=function e(t){var n=WO(t);function r(e,t){var r=n((e=YE(e)).r,(t=YE(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=HO(e.opacity,t.opacity);return function(t){e.r=r(t);e.g=i(t);e.b=a(t);e.opacity=o(t);return e+""}}r.gamma=e;return r}(1);function GO(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,u;for(o=0;o<n;++o){u=YE(t[o]);r[o]=u.r||0;i[o]=u.g||0;a[o]=u.b||0}r=e(r);i=e(i);a=e(a);u.opacity=1;return function(e){u.r=r(e);u.g=i(e);u.b=a(e);return u+""}}}var VO=GO(PO);var YO=GO(LO);function XO(e,t){if(!t)t=[];var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function JO(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ZO(e,t){return(JO(t)?XO:QO)(e,t)}function QO(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=uA(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function KO(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function eA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function tA(e,t){var n={},r={},i;if(e===null||typeof e!=="object")e={};if(t===null||typeof t!=="object")t={};for(i in t){if(i in e){n[i]=uA(e[i],t[i])}else{r[i]=t[i]}}return function(e){for(i in n)r[i]=n[i](e);return r}}var nA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rA=new RegExp(nA.source,"g");function iA(e){return function(){return e}}function aA(e){return function(t){return e(t)+""}}function oA(e,t){var n=nA.lastIndex=rA.lastIndex=0,r,i,a,o=-1,u=[],s=[];e=e+"",t=t+"";while((r=nA.exec(e))&&(i=rA.exec(t))){if((a=i.index)>n){a=t.slice(n,a);if(u[o])u[o]+=a;else u[++o]=a}if((r=r[0])===(i=i[0])){if(u[o])u[o]+=i;else u[++o]=i}else{u[++o]=null;s.push({i:o,x:eA(r,i)})}n=rA.lastIndex}if(n<t.length){a=t.slice(n);if(u[o])u[o]+=a;else u[++o]=a}return u.length<2?s[0]?aA(s[0].x):iA(t):(t=s.length,function(e){for(var n=0,r;n<t;++n)u[(r=s[n]).i]=r.x(e);return u.join("")})}function uA(e,t){var n=typeof t,r;return t==null||n==="boolean"?IO(t):(n==="number"?eA:n==="string"?(r=HE(t))?(t=r,$O):oA:t instanceof HE?$O:t instanceof Date?KO:JO(t)?XO:Array.isArray(t)?QO:typeof t.valueOf!=="function"&&typeof t.toString!=="function"||isNaN(t)?tA:eA)(e,t)}function sA(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function lA(e,t){var n=qO(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function fA(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var cA=180/Math.PI;var dA={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hA(e,t,n,r,i,a){var o,u,s;if(o=Math.sqrt(e*e+t*t))e/=o,t/=o;if(s=e*n+t*r)n-=e*s,r-=t*s;if(u=Math.sqrt(n*n+r*r))n/=u,r/=u,s/=u;if(e*r<t*n)e=-e,t=-t,s=-s,o=-o;return{translateX:i,translateY:a,rotate:Math.atan2(t,e)*cA,skewX:Math.atan(s)*cA,scaleX:o,scaleY:u}}var pA,vA,gA,mA;function yA(e){if(e==="none")return dA;if(!pA)pA=document.createElement("DIV"),vA=document.documentElement,gA=document.defaultView;pA.style.transform=e;e=gA.getComputedStyle(vA.appendChild(pA),null).getPropertyValue("transform");vA.removeChild(pA);e=e.slice(7,-1).split(",");return hA(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5])}function bA(e){if(e==null)return dA;if(!mA)mA=document.createElementNS("http://www.w3.org/2000/svg","g");mA.setAttribute("transform",e);if(!(e=mA.transform.baseVal.consolidate()))return dA;e=e.matrix;return hA(e.a,e.b,e.c,e.d,e.e,e.f)}function xA(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}function a(e,r,i,a,o,u){if(e!==i||r!==a){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:eA(e,i)},{i:s-2,x:eA(r,a)})}else if(i||a){o.push("translate("+i+t+a+n)}}function o(e,t,n,a){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:eA(e,t)})}else if(t){n.push(i(n)+"rotate("+t+r)}}function u(e,t,n,a){if(e!==t){a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:eA(e,t)})}else if(t){n.push(i(n)+"skewX("+t+r)}}function s(e,t,n,r,a,o){if(e!==n||t!==r){var u=a.push(i(a)+"scale(",null,",",null,")");o.push({i:u-4,x:eA(e,n)},{i:u-2,x:eA(t,r)})}else if(n!==1||r!==1){a.push(i(a)+"scale("+n+","+r+")")}}return function(t,n){var r=[],i=[];t=e(t),n=e(n);a(t.translateX,t.translateY,n.translateX,n.translateY,r,i);o(t.rotate,n.rotate,r,i);u(t.skewX,n.skewX,r,i);s(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i);t=n=null;return function(e){var t=-1,n=i.length,a;while(++t<n)r[(a=i[t]).i]=a.x(e);return r.join("")}}}var _A=xA(yA,"px, ","px)","deg)");var wA=xA(bA,", ",")",")");var kA=Math.SQRT2,EA=2,OA=4,AA=1e-12;function SA(e){return((e=Math.exp(e))+1/e)/2}function DA(e){return((e=Math.exp(e))-1/e)/2}function CA(e){return((e=Math.exp(2*e))-1)/(e+1)}function MA(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],u=t[2],s=a-n,l=o-r,f=s*s+l*l,c,d;if(f<AA){d=Math.log(u/i)/kA;c=function(e){return[n+e*s,r+e*l,i*Math.exp(kA*e*d)]}}else{var h=Math.sqrt(f),p=(u*u-i*i+OA*f)/(2*i*EA*h),v=(u*u-i*i-OA*f)/(2*u*EA*h),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(v*v+1)-v);d=(m-g)/kA;c=function(e){var t=e*d,a=SA(g),o=i/(EA*h)*(a*CA(kA*t+g)-DA(g));return[n+o*s,r+o*l,i*a/SA(kA*t+g)]}}c.duration=d*1e3;return c}function jA(e){return function(t,n){var r=e((t=tO(t)).h,(n=tO(n)).h),i=HO(t.s,n.s),a=HO(t.l,n.l),o=HO(t.opacity,n.opacity);return function(e){t.h=r(e);t.s=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var FA=jA(qO);var NA=jA(HO);function TA(e,t){var n=HO((e=vO(e)).l,(t=vO(t)).l),r=HO(e.a,t.a),i=HO(e.b,t.b),a=HO(e.opacity,t.opacity);return function(t){e.l=n(t);e.a=r(t);e.b=i(t);e.opacity=a(t);return e+""}}function zA(e){return function(t,n){var r=e((t=wO(t)).h,(n=wO(n)).h),i=HO(t.c,n.c),a=HO(t.l,n.l),o=HO(t.opacity,n.opacity);return function(e){t.h=r(e);t.c=i(e);t.l=a(e);t.opacity=o(e);return t+""}}}var RA=zA(qO);var PA=zA(HO);function LA(e){return function t(n){n=+n;function r(t,r){var i=e((t=TO(t)).h,(r=TO(r)).h),a=HO(t.s,r.s),o=HO(t.l,r.l),u=HO(t.opacity,r.opacity);return function(e){t.h=i(e);t.s=a(e);t.l=o(Math.pow(e,n));t.opacity=u(e);return t+""}}r.gamma=t;return r}(1)}var IA=LA(qO);var BA=LA(HO);function UA(e,t){var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);while(n<r)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}function qA(e,t){var n=new Array(t);for(var r=0;r<t;++r)n[r]=e(r/(t-1));return n}var WA=Object.freeze({__proto__:null,interpolate:uA,interpolateArray:ZO,interpolateBasis:PO,interpolateBasisClosed:LO,interpolateDate:KO,interpolateDiscrete:sA,interpolateHue:lA,interpolateNumber:eA,interpolateNumberArray:XO,interpolateObject:tA,interpolateRound:fA,interpolateString:oA,interpolateTransformCss:_A,interpolateTransformSvg:wA,interpolateZoom:MA,interpolateRgb:$O,interpolateRgbBasis:VO,interpolateRgbBasisClosed:YO,interpolateHsl:FA,interpolateHslLong:NA,interpolateLab:TA,interpolateHcl:RA,interpolateHclLong:PA,interpolateCubehelix:IA,interpolateCubehelixLong:BA,piecewise:UA,quantize:qA});function HA(e){return function(){return e}}function $A(e){return+e}var GA=[0,1];function VA(e){return e}function YA(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:HA(isNaN(t)?NaN:.5)}function XA(e,t){var n;if(e>t)n=e,e=t,t=n;return function(n){return Math.max(e,Math.min(t,n))}}function JA(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];if(i<r)r=YA(i,r),a=n(o,a);else r=YA(r,i),a=n(a,o);return function(e){return a(r(e))}}function ZA(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;if(e[r]<e[0]){e=e.slice().reverse();t=t.slice().reverse()}while(++o<r){i[o]=YA(e[o],e[o+1]);a[o]=n(t[o],t[o+1])}return function(t){var n=Of(e,t,1,r)-1;return a[n](i[n](t))}}function QA(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function KA(){var e=GA,t=GA,n=uA,r,i,a,o=VA,u,s,l;function f(){var n=Math.min(e.length,t.length);if(o!==VA)o=XA(e[0],e[n-1]);u=n>2?ZA:JA;s=l=null;return c}function c(i){return isNaN(i=+i)?a:(s||(s=u(e.map(r),t,n)))(r(o(i)))}c.invert=function(n){return o(i((l||(l=u(t,e.map(r),eA)))(n)))};c.domain=function(t){return arguments.length?(e=Array.from(t,$A),f()):e.slice()};c.range=function(e){return arguments.length?(t=Array.from(e),f()):t.slice()};c.rangeRound=function(e){return t=Array.from(e),n=fA,f()};c.clamp=function(e){return arguments.length?(o=e?true:VA,f()):o!==VA};c.interpolate=function(e){return arguments.length?(n=e,f()):n};c.unknown=function(e){return arguments.length?(a=e,c):a};return function(e,t){r=e,i=t;return f()}}function eS(){return KA()(VA,VA)}function tS(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function nS(e){return e=tS(Math.abs(e)),e?e[1]:NaN}function rS(e,t){return function(n,r){var i=n.length,a=[],o=0,u=e[0],s=0;while(i>0&&u>0){if(s+u+1>r)u=Math.max(1,r-s);a.push(n.substring(i-=u,i+u));if((s+=u+1)>r)break;u=e[o=(o+1)%e.length]}return a.reverse().join(t)}}function iS(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var aS=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function oS(e){if(!(t=aS.exec(e)))throw new Error("invalid format: "+e);var t;return new uS({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}oS.prototype=uS.prototype;function uS(e){this.fill=e.fill===undefined?" ":e.fill+"";this.align=e.align===undefined?">":e.align+"";this.sign=e.sign===undefined?"-":e.sign+"";this.symbol=e.symbol===undefined?"":e.symbol+"";this.zero=!!e.zero;this.width=e.width===undefined?undefined:+e.width;this.comma=!!e.comma;this.precision=e.precision===undefined?undefined:+e.precision;this.trim=!!e.trim;this.type=e.type===undefined?"":e.type+""}uS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sS(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n){switch(e[n]){case".":r=i=n;break;case"0":if(r===0)r=n;i=n;break;default:if(!+e[n])break e;if(r>0)r=0;break}}return r>0?e.slice(0,r)+e.slice(i+1):e}var lS;function fS(e,t){var n=tS(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(lS=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+tS(e,Math.max(0,t+a-1))[0]}function cS(e,t){var n=tS(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var dS={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return cS(e*100,t)},r:cS,s:fS,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function hS(e){return e}var pS=Array.prototype.map,vS=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function gS(e){var t=e.grouping===undefined||e.thousands===undefined?hS:rS(pS.call(e.grouping,Number),e.thousands+""),n=e.currency===undefined?"":e.currency[0]+"",r=e.currency===undefined?"":e.currency[1]+"",i=e.decimal===undefined?".":e.decimal+"",a=e.numerals===undefined?hS:iS(pS.call(e.numerals,String)),o=e.percent===undefined?"%":e.percent+"",u=e.minus===undefined?"-":e.minus+"",s=e.nan===undefined?"NaN":e.nan+"";function l(e){e=oS(e);var l=e.fill,f=e.align,c=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;if(y==="n")v=true,y="g";else if(!dS[y])g===undefined&&(g=12),m=true,y="g";if(h||l==="0"&&f==="=")h=true,l="0",f="=";var b=d==="$"?n:d==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=d==="$"?r:/[%p]/.test(y)?o:"";var _=dS[y],w=/[defgprs%]/.test(y);g=g===undefined?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function k(e){var n=b,r=x,o,d,k;if(y==="c"){r=_(e)+r;e=""}else{e=+e;var E=e<0||1/e<0;e=isNaN(e)?s:_(Math.abs(e),g);if(m)e=sS(e);if(E&&+e===0&&c!=="+")E=false;n=(E?c==="("?c:u:c==="-"||c==="("?"":c)+n;r=(y==="s"?vS[8+lS/3]:"")+r+(E&&c==="("?")":"");if(w){o=-1,d=e.length;while(++o<d){if(k=e.charCodeAt(o),48>k||k>57){r=(k===46?i+e.slice(o+1):e.slice(o))+r;e=e.slice(0,o);break}}}}if(v&&!h)e=t(e,Infinity);var O=n.length+e.length+r.length,A=O<p?new Array(p-O+1).join(l):"";if(v&&h)e=t(A+e,A.length?p-r.length:Infinity),A="";switch(f){case"<":e=n+e+r+A;break;case"=":e=n+A+e+r;break;case"^":e=A.slice(0,O=A.length>>1)+n+e+r+A.slice(O);break;default:e=A+n+e+r;break}return a(e)}k.toString=function(){return e+""};return k}function f(e,t){var n=l((e=oS(e),e.type="f",e)),r=Math.max(-8,Math.min(8,Math.floor(nS(t)/3)))*3,i=Math.pow(10,-r),a=vS[8+r/3];return function(e){return n(i*e)+a}}return{format:l,formatPrefix:f}}var mS;var yS;var bS;xS({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function xS(e){mS=gS(e);yS=mS.format;bS=mS.formatPrefix;return mS}function _S(e){return Math.max(0,-nS(Math.abs(e)))}function wS(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(nS(t)/3)))*3-nS(Math.abs(e)))}function kS(e,t){e=Math.abs(e),t=Math.abs(t)-e;return Math.max(0,nS(t)-nS(e))+1}function ES(e,t,n,r){var i=zf(e,t,n),a;r=oS(r==null?",f":r);switch(r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));if(r.precision==null&&!isNaN(a=wS(i,o)))r.precision=a;return bS(r,o)}case"":case"e":case"g":case"p":case"r":{if(r.precision==null&&!isNaN(a=kS(i,Math.max(Math.abs(e),Math.abs(t)))))r.precision=a-(r.type==="e");break}case"f":case"%":{if(r.precision==null&&!isNaN(a=_S(i)))r.precision=a-(r.type==="%")*2;break}}return yS(r)}function OS(e){var t=e.domain;e.ticks=function(e){var n=t();return Nf(n[0],n[n.length-1],e==null?10:e)};e.tickFormat=function(e,n){var r=t();return ES(r[0],r[r.length-1],e==null?10:e,n)};e.nice=function(n){if(n==null)n=10;var r=t(),i=0,a=r.length-1,o=r[i],u=r[a],s;if(u<o){s=o,o=u,u=s;s=i,i=a,a=s}s=Tf(o,u,n);if(s>0){o=Math.floor(o/s)*s;u=Math.ceil(u/s)*s;s=Tf(o,u,n)}else if(s<0){o=Math.ceil(o*s)/s;u=Math.floor(u*s)/s;s=Tf(o,u,n)}if(s>0){r[i]=Math.floor(o/s)*s;r[a]=Math.ceil(u/s)*s;t(r)}else if(s<0){r[i]=Math.ceil(o*s)/s;r[a]=Math.floor(u*s)/s;t(r)}return e};return e}function AS(){var e=eS();e.copy=function(){return QA(e,AS())};_E.apply(e,arguments);return OS(e)}function SS(e){var t;function n(e){return isNaN(e=+e)?t:e}n.invert=n;n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,$A),n):e.slice()};n.unknown=function(e){return arguments.length?(t=e,n):t};n.copy=function(){return SS(e).unknown(t)};e=arguments.length?Array.from(e,$A):[0,1];return OS(n)}function DS(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;if(a<i){o=n,n=r,r=o;o=i,i=a,a=o}e[n]=t.floor(i);e[r]=t.ceil(a);return e}function CS(e){return Math.log(e)}function MS(e){return Math.exp(e)}function jS(e){return-Math.log(-e)}function FS(e){return-Math.exp(-e)}function NS(e){return isFinite(e)?+("1e"+e):e<0?0:e}function TS(e){return e===10?NS:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function zS(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function RS(e){return function(t){return-e(-t)}}function PS(e){var t=e(CS,MS),n=t.domain,r=10,i,a;function o(){i=zS(r),a=TS(r);if(n()[0]<0){i=RS(i),a=RS(a);e(jS,FS)}else{e(CS,MS)}return t}t.base=function(e){return arguments.length?(r=+e,o()):r};t.domain=function(e){return arguments.length?(n(e),o()):n()};t.ticks=function(e){var t=n(),o=t[0],u=t[t.length-1],s;if(s=u<o)l=o,o=u,u=l;var l=i(o),f=i(u),c,d,h,p=e==null?10:+e,v=[];if(!(r%1)&&f-l<p){l=Math.floor(l),f=Math.ceil(f);if(o>0)for(;l<=f;++l){for(d=1,c=a(l);d<r;++d){h=c*d;if(h<o)continue;if(h>u)break;v.push(h)}}else for(;l<=f;++l){for(d=r-1,c=a(l);d>=1;--d){h=c*d;if(h<o)continue;if(h>u)break;v.push(h)}}if(v.length*2<p)v=Nf(o,u,p)}else{v=Nf(l,f,Math.min(f-l,p)).map(a)}return s?v.reverse():v};t.tickFormat=function(e,n){if(n==null)n=r===10?".0e":",";if(typeof n!=="function")n=yS(n);if(e===Infinity)return n;if(e==null)e=10;var o=Math.max(1,r*e/t.ticks().length);return function(e){var t=e/a(Math.round(i(e)));if(t*r<r-.5)t*=r;return t<=o?n(e):""}};t.nice=function(){return n(DS(n(),{floor:function(e){return a(Math.floor(i(e)))},ceil:function(e){return a(Math.ceil(i(e)))}}))};return t}function LS(){var e=PS(KA()).domain([1,10]);e.copy=function(){return QA(e,LS()).base(e.base())};_E.apply(e,arguments);return e}function IS(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function BS(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function US(e){var t=1,n=e(IS(t),BS(t));n.constant=function(n){return arguments.length?e(IS(t=+n),BS(t)):t};return OS(n)}function qS(){var e=US(KA());e.copy=function(){return QA(e,qS()).constant(e.constant())};return _E.apply(e,arguments)}function WS(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function HS(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function $S(e){return e<0?-e*e:e*e}function GS(e){var t=e(VA,VA),n=1;function r(){return n===1?e(VA,VA):n===.5?e(HS,$S):e(WS(n),WS(1/n))}t.exponent=function(e){return arguments.length?(n=+e,r()):n};return OS(t)}function VS(){var e=GS(KA());e.copy=function(){return QA(e,VS()).exponent(e.exponent())};_E.apply(e,arguments);return e}function YS(){return VS.apply(null,arguments).exponent(.5)}function XS(){var e=[],t=[],n=[],r;function i(){var r=0,i=Math.max(1,t.length);n=new Array(i-1);while(++r<i)n[r-1]=qf(e,r/i);return a}function a(e){return isNaN(e=+e)?r:t[Of(n,e)]}a.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]};a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n=0,r=t;n<r.length;n++){var a=r[n];if(a!=null&&!isNaN(a=+a))e.push(a)}e.sort(_f);return i()};a.range=function(e){return arguments.length?(t=Array.from(e),i()):t.slice()};a.unknown=function(e){return arguments.length?(r=e,a):r};a.quantiles=function(){return n.slice()};a.copy=function(){return XS().domain(e).range(t).unknown(r)};return _E.apply(a,arguments)}function JS(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(e){return e<=e?i[Of(r,e,0,n)]:a}function u(){var i=-1;r=new Array(n);while(++i<n)r[i]=((i+1)*t-(i-n)*e)/(n+1);return o}o.domain=function(n){return arguments.length?(e=n[0],t=n[1],n,e=+e,t=+t,u()):[e,t]};o.range=function(e){return arguments.length?(n=(i=Array.from(e)).length-1,u()):i.slice()};o.invertExtent=function(a){var o=i.indexOf(a);return o<0?[NaN,NaN]:o<1?[e,r[0]]:o>=n?[r[n-1],t]:[r[o-1],r[o]]};o.unknown=function(e){return arguments.length?(a=e,o):o};o.thresholds=function(){return r.slice()};o.copy=function(){return JS().domain([e,t]).range(i).unknown(a)};return _E.apply(OS(o),arguments)}function ZS(){var e=[.5],t=[0,1],n,r=1;function i(i){return i<=i?t[Of(e,i,0,r)]:n}i.domain=function(n){return arguments.length?(e=Array.from(n),r=Math.min(e.length,t.length-1),i):e.slice()};i.range=function(n){return arguments.length?(t=Array.from(n),r=Math.min(e.length,t.length-1),i):t.slice()};i.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]};i.unknown=function(e){return arguments.length?(n=e,i):n};i.copy=function(){return ZS().domain(e).range(t).unknown(n)};return _E.apply(i,arguments)}var QS=1e3,KS=QS*60,eD=KS*60,tD=eD*24,nD=tD*7,rD=tD*30,iD=tD*365;function aD(e){return new Date(e)}function oD(e){return e instanceof Date?+e:+new Date(+e)}function uD(e,t,n,r,i,a,o,u,s){var l=eS(),f=l.invert,c=l.domain;var d=s(".%L"),h=s(":%S"),p=s("%I:%M"),v=s("%I %p"),g=s("%a %d"),m=s("%b %d"),y=s("%B"),b=s("%Y");var x=[[o,1,QS],[o,5,5*QS],[o,15,15*QS],[o,30,30*QS],[a,1,KS],[a,5,5*KS],[a,15,15*KS],[a,30,30*KS],[i,1,eD],[i,3,3*eD],[i,6,6*eD],[i,12,12*eD],[r,1,tD],[r,2,2*tD],[n,1,nD],[t,1,rD],[t,3,3*rD],[e,1,iD]];function _(u){return(o(u)<u?d:a(u)<u?h:i(u)<u?p:r(u)<u?v:t(u)<u?n(u)<u?g:m:e(u)<u?y:b)(u)}function w(t,n,r){if(t==null)t=10;if(typeof t==="number"){var i=Math.abs(r-n)/t,a=wf((function(e){return e[2]})).right(x,i),o;if(a===x.length){o=zf(n/iD,r/iD,t);t=e}else if(a){a=x[i/x[a-1][2]<x[a][2]/i?a-1:a];o=a[1];t=a[0]}else{o=Math.max(zf(n,r,t),1);t=u}return t.every(o)}return t}l.invert=function(e){return new Date(f(e))};l.domain=function(e){return arguments.length?c(Array.from(e,oD)):c().map(aD)};l.ticks=function(e){var t=c(),n=t[0],r=t[t.length-1],i=r<n,a;if(i)a=n,n=r,r=a;a=w(e,n,r);a=a?a.range(n,r+1):[];return i?a.reverse():a};l.tickFormat=function(e,t){return t==null?_:s(t)};l.nice=function(e){var t=c();return(e=w(e,t[0],t[t.length-1]))?c(DS(t,e)):l};l.copy=function(){return QA(l,uD(e,t,n,r,i,a,o,u,s))};return l}function sD(){return _E.apply(uD(Au,Ou,yu,gu,vu,pu,hu,uu,nl).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lD(){return _E.apply(uD(Iu,Lu,ju,Cu,Du,Su,hu,uu,il).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function fD(){var e=0,t=1,n,r,i,a,o=VA,u=false,s;function l(e){return isNaN(e=+e)?s:o(i===0?.5:(e=(a(e)-n)*i,u?Math.max(0,Math.min(1,e)):e))}l.domain=function(o){return arguments.length?(e=o[0],t=o[1],o,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]};l.clamp=function(e){return arguments.length?(u=!!e,l):u};l.interpolator=function(e){return arguments.length?(o=e,l):o};function f(e){return function(t){var n,r;return arguments.length?(n=t[0],r=t[1],t,o=e(n,r),l):[o(0),o(1)]}}l.range=f(uA);l.rangeRound=f(fA);l.unknown=function(e){return arguments.length?(s=e,l):s};return function(o){a=o,n=o(e),r=o(t),i=n===r?0:1/(r-n);return l}}function cD(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function dD(){var e=OS(fD()(VA));e.copy=function(){return cD(e,dD())};return wE.apply(e,arguments)}function hD(){var e=PS(fD()).domain([1,10]);e.copy=function(){return cD(e,hD()).base(e.base())};return wE.apply(e,arguments)}function pD(){var e=US(fD());e.copy=function(){return cD(e,pD()).constant(e.constant())};return wE.apply(e,arguments)}function vD(){var e=GS(fD());e.copy=function(){return cD(e,vD()).exponent(e.exponent())};return wE.apply(e,arguments)}function gD(){return vD.apply(null,arguments).exponent(.5)}function mD(){var e=0,t=.5,n=1,r=1,i,a,o,u,s,l=VA,f,c=false,d;function h(e){return isNaN(e=+e)?d:(e=.5+((e=+f(e))-a)*(r*e<r*a?u:s),l(c?Math.max(0,Math.min(1,e)):e))}h.domain=function(l){return arguments.length?(e=l[0],t=l[1],n=l[2],l,i=f(e=+e),a=f(t=+t),o=f(n=+n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]};h.clamp=function(e){return arguments.length?(c=!!e,h):c};h.interpolator=function(e){return arguments.length?(l=e,h):l};function p(e){return function(t){var n,r,i;return arguments.length?(n=t[0],r=t[1],i=t[2],t,l=UA(e,[n,r,i]),h):[l(0),l(.5),l(1)]}}h.range=p(uA);h.rangeRound=p(fA);h.unknown=function(e){return arguments.length?(d=e,h):d};return function(l){f=l,i=l(e),a=l(t),o=l(n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1;return h}}function yD(){var e=OS(mD()(VA));e.copy=function(){return cD(e,yD())};return wE.apply(e,arguments)}function bD(){var e=PS(mD()).domain([.1,1,10]);e.copy=function(){return cD(e,bD()).base(e.base())};return wE.apply(e,arguments)}function xD(){var e=US(mD());e.copy=function(){return cD(e,xD()).constant(e.constant())};return wE.apply(e,arguments)}function _D(){var e=GS(mD());e.copy=function(){return cD(e,_D()).exponent(e.exponent())};return wE.apply(e,arguments)}function wD(){return _D.apply(null,arguments).exponent(.5)}function kD(){var e=EE().unknown(undefined),t=e.domain,n=e.range,r=[0,1],i,a,o=false,u=0,s=0,l=.5;delete e.unknown;function f(){var e=t().length,f=r[1]<r[0],c=r[f-0],d=r[1-f],h=Jk(e,u,s);i=(d-c)/(h||1);if(o){i=Math.floor(i)}c+=(d-c-i*(e-u))*l;a=i*(1-u);if(o){c=Math.round(c);a=Math.round(a)}var p=Cf(e).map((function(e){return c+i*e}));return n(f?p.reverse():p)}e.domain=function(e){if(arguments.length){t(e);return f()}else{return t()}};e.range=function(e){if(arguments.length){r=[+e[0],+e[1]];return f()}else{return r.slice()}};e.rangeRound=function(e){r=[+e[0],+e[1]];o=true;return f()};e.bandwidth=function(){return a};e.step=function(){return i};e.round=function(e){if(arguments.length){o=!!e;return f()}else{return o}};e.padding=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));u=s;return f()}else{return u}};e.paddingInner=function(e){if(arguments.length){u=Math.max(0,Math.min(1,e));return f()}else{return u}};e.paddingOuter=function(e){if(arguments.length){s=Math.max(0,Math.min(1,e));return f()}else{return s}};e.align=function(e){if(arguments.length){l=Math.max(0,Math.min(1,e));return f()}else{return l}};e.invertRange=function(e){if(e[0]==null||e[1]==null)return;var i=+e[0],o=+e[1],u=r[1]<r[0],s=u?n().reverse():n(),l=s.length-1,f,c,d;if(i!==i||o!==o)return;if(o<i){d=i;i=o;o=d}if(o<s[0]||i>r[1-u])return;f=Math.max(0,Of(s,i)-1);c=i===o?f:Of(s,o)-1;if(i-s[f]>a+1e-10)++f;if(u){d=f;f=l-c;c=l-d}return f>c?undefined:t().slice(f,c+1)};e.invert=function(t){var n=e.invertRange([t,t]);return n?n[0]:n};e.copy=function(){return kD().domain(t()).range(r).round(o).paddingInner(u).paddingOuter(s).align(l)};return f()}function ED(e){var t=e.copy;e.padding=e.paddingOuter;delete e.paddingInner;e.copy=function(){return ED(t())};return e}function OD(){return ED(kD().paddingInner(1))}var AD=Array.prototype.map;function SD(e){return AD.call(e,(function(e){return+e}))}var DD=Array.prototype.slice;function CD(){var e=[],t=[];function n(n){return n==null||n!==n?undefined:t[(Of(e,n)-1)%t.length]}n.domain=function(t){if(arguments.length){e=SD(t);return n}else{return e.slice()}};n.range=function(e){if(arguments.length){t=DD.call(e);return n}else{return t.slice()}};n.tickFormat=function(t,n){return ES(e[0],Ai(e),t==null?10:t,n)};n.copy=function(){return CD().domain(n.domain()).range(n.range())};return n}var MD={};function jD(e,t,n){var r=function n(){var r=t();if(!r.invertRange){r.invertRange=r.invert?bE(r):r.invertExtent?xE(r):undefined}r.type=e;return r};r.metadata=ka($i(n));return r}function FD(e,t,n){if(arguments.length>1){MD[e]=jD(e,t,n);return this}else{return ND(e)?MD[e]:undefined}}FD(Zk,SS);FD(Qk,AS,pE);FD(Kk,LS,[pE,Kk]);FD(eE,VS,pE);FD(tE,YS,pE);FD(nE,qS,pE);FD(rE,sD,[pE,yE]);FD(iE,lD,[pE,yE]);FD(aE,dD,[pE,mE]);FD(aE+"-"+Qk,dD,[pE,mE]);FD(aE+"-"+Kk,hD,[pE,mE,Kk]);FD(aE+"-"+eE,vD,[pE,mE]);FD(aE+"-"+tE,gD,[pE,mE]);FD(aE+"-"+nE,pD,[pE,mE]);FD(oE+"-"+Qk,yD,[pE,mE]);FD(oE+"-"+Kk,bD,[pE,mE,Kk]);FD(oE+"-"+eE,_D,[pE,mE]);FD(oE+"-"+tE,wD,[pE,mE]);FD(oE+"-"+nE,xD,[pE,mE]);FD(uE,XS,[gE,uE]);FD(sE,JS,gE);FD(lE,ZS,gE);FD(hE,CD,[vE,gE]);FD(fE,EE,vE);FD(dE,kD,vE);FD(cE,OD,vE);function ND(e){return ta(MD,e)}function TD(e,t){var n=MD[e];return n&&n.metadata[t]}function zD(e){return TD(e,pE)}function RD(e){return TD(e,vE)}function PD(e){return TD(e,gE)}function LD(e){return TD(e,Kk)}function ID(e){return TD(e,mE)}function BD(e){return TD(e,uE)}var UD=["clamp","base","constant","exponent"];function qD(e,t){var n=t[0],r=Ai(t)-n;return function(t){return e(n+t*r)}}function WD(e,t,n){return UA(GD(t||"rgb",n),e)}function HD(e,t){var n=new Array(t),r=t+1;for(var i=0;i<t;)n[i]=e(++i/r);return n}function $D(e,t,n){var r=n-t,i,a,o;if(!r||!Number.isFinite(r)){return Xi(.5)}else{i=(a=e.type).indexOf("-");a=i<0?a:a.slice(i+1);o=FD(a)().domain([t,n]).range([0,1]);UD.forEach((function(t){return e[t]?o[t](e[t]()):0}));return o}}function GD(e,t){var n=WA[VD(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function VD(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}var YD={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"};var XD={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function JD(e){var t=e.length/6|0,n=new Array(t),r=0;while(r<t)n[r]="#"+e.slice(r*6,++r*6);return n}function ZD(e,t){for(var n in e)KD(n,t(e[n]))}var QD={};ZD(XD,JD);ZD(YD,(function(e){return WD(JD(e))}));function KD(e,t){e=e&&e.toLowerCase();if(arguments.length>1){QD[e]=t;return this}else{return QD[e]}}var eC=function(e){return ri(e)?e.map((function(e){return String(e)})):String(e)};function tC(e,t,n){var r;if(la(t)){if(e.bins){t=Math.max(t,e.bins.length)}if(n!=null){t=Math.min(t,~~(ya(e.domain())/n)||1)}}if(ii(t)){r=t.step;t=t.interval}if(ai(t)){t=e.type===rE?vp(t):e.type==iE?gp(t):ti("Only time and utc scales accept interval strings.");if(r)t=t.every(r)}return t}function nC(e,t,n){var r=e.range(),i=Math.floor(r[0]),a=Math.ceil(Ai(r));if(i>a){r=a;a=i;i=r}t=t.filter((function(t){t=e(t);return i<=t&&t<=a}));if(n>0&&t.length>1){var o=[t[0],Ai(t)];while(t.length>n&&t.length>=3){t=t.filter((function(e,t){return!(t%2)}))}if(t.length<3){t=o}}return t}function rC(e,t){return e.bins?nC(e,e.bins):e.ticks?e.ticks(t):e.domain()}function iC(e,t,n,r,i){var a=e.type,o=a===rE||r===rE?Op(n):a===iE||r===iE?Ap(n):e.tickFormat?e.tickFormat(t,n):n?yS(n):eC;if(LD(a)){var u=oC(n);o=i||e.bins?u:aC(o,u)}return o}function aC(e,t){return function(n){return e(n)?t(n):""}}function oC(e){var t=oS(e||",");if(t.precision==null){t.precision=12;switch(t.type){case"%":t.precision-=2;break;case"e":t.precision-=1;break}return uC(yS(t),yS(".1f")(1)[1])}else{return yS(t)}}function uC(e,t){return function(n){var r=e(n),i=r.indexOf(t),a,o;if(i<0)return r;a=sC(r,i);o=a<r.length?r.slice(a):"";while(--a>i)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function sC(e,t){var n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;){r=e.charCodeAt(n);if(r>=48&&r<=57)return n+1}}function lC(e){af.call(this,null,e)}var fC=aa(lC,af);fC.transform=function(e,t){if(this.value&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,o=tC(i,a,e.minstep),u=e.format||iC(i,o,e.formatSpecifier,e.formatType,!!e.values),s=e.values?nC(i,e.values,o):rC(i,o);if(r)n.rem=r;r=s.map((function(e,t){return Na({index:t/(s.length-1||1),value:e,label:u(e)})}));if(e.extra&&r.length){r.push(Na({index:-1,extra:{value:r[0].value},label:""}))}n.source=r;n.add=r;this.value=r;return n};function cC(e){af.call(this,null,e)}var dC=aa(cC,af);function hC(){return Na({})}function pC(e){return e.exit}dC.transform=function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||hC,a=e.key||ja,o=this.value;if(ri(r.encode)){r.encode=null}if(o&&(e.modified("key")||t.modified(a))){ti("DataJoin does not support modified key function or fields.")}if(!o){t=t.addAll();this.value=o=ra().test(pC);o.lookup=function(e){return o.get(a(e))}}t.visit(t.ADD,(function(e){var t=a(e),n=o.get(t);if(n){if(n.exit){o.empty--;r.add.push(n)}else{r.mod.push(n)}}else{o.set(t,n=i(e));r.add.push(n)}n.datum=e;n.exit=false}));t.visit(t.MOD,(function(e){var t=a(e),n=o.get(t);if(n){n.datum=e;r.mod.push(n)}}));t.visit(t.REM,(function(e){var t=a(e),n=o.get(t);if(e===n.datum&&!n.exit){r.rem.push(n);n.exit=true;++o.empty}}));if(t.changed(t.ADD_MOD))r.modifies("datum");if(e.clean&&o.empty>n.cleanThreshold)n.runAfter(o.clean);return r};function vC(e){af.call(this,null,e)}var gC=aa(vC,af);gC.transform=function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||false,i=e.encoders,a=t.encode;if(ri(a)){if(n.changed()||a.every((function(e){return i[e]}))){a=a[0];n.encode=null}else{return t.StopPropagation}}var o=a==="enter",u=i.update||pi,s=i.enter||pi,l=i.exit||pi,f=(a&&!o?i[a]:u)||pi;if(t.changed(t.ADD)){t.visit(t.ADD,(function(t){s(t,e);u(t,e)}));n.modifies(s.output);n.modifies(u.output);if(f!==pi&&f!==u){t.visit(t.ADD,(function(t){f(t,e)}));n.modifies(f.output)}}if(t.changed(t.REM)&&l!==pi){t.visit(t.REM,(function(t){l(t,e)}));n.modifies(l.output)}if(o||f!==pi){var c=t.MOD|(e.modified()?t.REFLOW:0);if(o){t.visit(c,(function(t){var i=s(t,e)||r;if(f(t,e)||i)n.mod.push(t)}));if(n.mod.length)n.modifies(s.output)}else{t.visit(c,(function(t){if(f(t,e)||r)n.mod.push(t)}))}if(n.mod.length)n.modifies(f.output)}return n.changed()?n:t.StopPropagation};var mC="symbol";var yC="discrete";var bC="gradient";var xC=(c={},c[uE]="quantiles",c[sE]="thresholds",c[lE]="domain",c);var _C=(d={},d[uE]="quantiles",d[sE]="domain",d);function wC(e,t){return e.bins?AC(e.bins):e.type===Kk?kC(e,t):xC[e.type]?OC(e[xC[e.type]]()):rC(e,t)}function kC(e,t){var n=rC(e,t),r=e.base(),i=Math.log(r),a=Math.max(1,r*t/n.length);return n.filter((function(e){var t=e/Math.pow(r,Math.round(Math.log(e)/i));if(t*r<r-.5)t*=r;return t<=a}))}function EC(e,t){var n=e[_C[e.type]](),r=n.length,i=r>1?n[1]-n[0]:n[0],a;for(a=1;a<r;++a){i=Math.min(i,n[a]-n[a-1])}return ES(0,i,3*10,t)}function OC(e){var t=[-Infinity].concat(e);t.max=+Infinity;return t}function AC(e){var t=e.slice(0,-1);t.max=Ai(e);return t}function SC(e){return xC[e.type]||e.bins}function DC(e,t,n,r,i,a){var o=_C[e.type]&&i!==rE&&i!==iE?EC(e,r):iC(e,t,r,i,a);return n===mC&&SC(e)?CC(o):n===yC?jC(o):FC(o)}function CC(e){return function(t,n,r){var i=MC(r[n+1],MC(r.max,+Infinity)),a=NC(t,e),o=NC(i,e);return a&&o?a+" – "+o:o?"< "+o:"≥ "+a}}function MC(e,t){return e!=null?e:t}function jC(e){return function(t,n){return n?e(t):null}}function FC(e){return function(t){return e(t)}}function NC(e,t){return Number.isFinite(e)?t(e):null}function TC(e){var t=e.domain(),n=t.length-1,r=+t[0],i=+Ai(t),a=i-r;if(e.type===lE){var o=n?a/n:.1;r-=o;i+=o;a=i-r}return function(e){return(e-r)/a}}function zC(e){af.call(this,[],e)}var RC=aa(zC,af);RC.transform=function(e,t){if(this.value!=null&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.type||mC,a=e.scale,o=+e.limit,u=tC(a,e.count==null?5:e.count,e.minstep),s=!!e.values||i===mC,l=e.format||DC(a,u,i,e.formatSpecifier,e.formatType,s),f=e.values||wC(a,u),c,d,h,p,v;if(r)n.rem=r;if(i===mC){if(o&&f.length>o){t.dataflow.warn("Symbol legend count exceeds limit, filtering items.");r=f.slice(0,o-1);v=true}else{r=f}if(Vi(h=e.size)){if(!e.values&&a(r[0])===0){r=r.slice(1)}p=r.reduce((function(t,n){return Math.max(t,h(n,e))}),0)}else{h=Xi(p=h||8)}r=r.map((function(t,n){return Na({index:n,label:l(t,n,r),value:t,offset:p,size:h(t,e)})}));if(v){v=f[r.length];r.push(Na({index:r.length,label:"…"+(f.length-r.length)+" entries",value:v,offset:p,size:h(v,e)}))}}else if(i===bC){c=a.domain(),d=$D(a,c[0],Ai(c));if(f.length<3&&!e.values&&c[0]!==Ai(c)){f=[c[0],Ai(c)]}r=f.map((function(e,t){return Na({index:t,label:l(e,t,f),value:e,perc:d(e)})}))}else{h=f.length-1;d=TC(a);r=f.map((function(e,t){return Na({index:t,label:l(e,t,f),value:e,perc:t?d(e):0,perc2:t===h?1:d(f[t+1])})}))}n.source=r;n.add=r;this.value=r;return n};var PC=ra({line:HC,"line-radial":$C,arc:GC,"arc-radial":VC,curve:YC,"curve-radial":XC,"orthogonal-horizontal":JC,"orthogonal-vertical":ZC,"orthogonal-radial":QC,"diagonal-horizontal":KC,"diagonal-vertical":eM,"diagonal-radial":tM});function LC(e){return e.source.x}function IC(e){return e.source.y}function BC(e){return e.target.x}function UC(e){return e.target.y}function qC(e){af.call(this,{},e)}qC.Definition={type:"LinkPath",metadata:{modifies:true},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};var WC=aa(qC,af);WC.transform=function(e,t){var n=e.sourceX||LC,r=e.sourceY||IC,i=e.targetX||BC,a=e.targetY||UC,o=e.as||"path",u=e.orient||"vertical",s=e.shape||"line",l=PC.get(s+"-"+u)||PC.get(s);if(!l){ti("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:""))}t.visit(t.SOURCE,(function(e){e[o]=l(n(e),r(e),i(e),a(e))}));return t.reflow(e.modified()).modifies(o)};function HC(e,t,n,r){return"M"+e+","+t+"L"+n+","+r}function $C(e,t,n,r){return HC(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function GC(e,t,n,r){var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2,u=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+u+" 0 1"+" "+n+","+r}function VC(e,t,n,r){return GC(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function YC(e,t,n,r){var i=n-e,a=r-t,o=.2*(i+a),u=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r}function XC(e,t,n,r){return YC(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function JC(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n}function ZC(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r}function QC(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(s?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u}function KC(e,t,n,r){var i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r}function eM(e,t,n,r){var i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r}function tM(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=(t+r)/2;return"M"+t*i+","+t*a+"C"+s*i+","+s*a+" "+s*o+","+s*u+" "+r*o+","+r*u}function nM(e){af.call(this,null,e)}nM.Definition={type:"Pie",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:false},{name:"as",type:"string",array:true,length:2,default:["startAngle","endAngle"]}]};var rM=aa(nM,af);rM.transform=function(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||di,o=e.startAngle||0,u=e.endAngle!=null?e.endAngle:2*Math.PI,s=t.source,l=s.map(a),f=l.length,c=o,d=(u-o)/Vf(l),h=Cf(f),p,v,g;if(e.sort){h.sort((function(e,t){return l[e]-l[t]}))}for(p=0;p<f;++p){g=l[h[p]];v=s[h[p]];v[r]=c;v[i]=c+=g*d}this.value=l;return t.reflow(e.modified()).modifies(n)};var iM=5;function aM(e){var t=e.type;return!e.bins&&(t===Qk||t===eE||t===tE)}function oM(e){return zD(e)&&e!==aE}var uM=ka(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function sM(e){af.call(this,null,e);this.modified(true)}var lM=aa(sM,af);lM.transform=function(e,t){var n=t.dataflow,r=this.value,i=fM(e);if(!r||i!==r.type){this.value=r=FD(i)()}for(i in e)if(!uM[i]){if(i==="padding"&&oM(r.type))continue;Vi(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}mM(r,e,gM(r,e,dM(r,e,n)));return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function fM(e){var t=e.type,n="",r;if(t===aE)return aE+"-"+Qk;if(cM(e)){r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0;n=r===2?aE+"-":r===3?oE+"-":""}return(n+t||Qk).toLowerCase()}function cM(e){var t=e.type;return zD(t)&&t!==rE&&t!==iE&&(e.scheme||e.range&&e.range.length&&e.range.every(ai))}function dM(e,t,n){var r=hM(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===undefined&&aM(e),u,s;if(!i)return 0;if(oM(a)&&t.padding&&i[0]!==Ai(i)){i=pM(a,i,t.range,t.padding,t.exponent,t.constant)}if(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null){u=(i=i.slice()).length-1||1;if(o){if(i[0]>0)i[0]=0;if(i[u]<0)i[u]=0}if(t.domainMin!=null)i[0]=t.domainMin;if(t.domainMax!=null)i[u]=t.domainMax;if(t.domainMid!=null){s=t.domainMid;if(s<i[0]||s>i[u]){n.warn("Scale domainMid exceeds domain min or max.",s)}i.splice(u,0,s)}}e.domain(vM(a,i,n));if(a===fE){e.unknown(t.domainImplicit?kE:undefined)}if(t.nice&&e.nice){e.nice(t.nice!==true&&tC(e,t.nice)||null)}return i.length}function hM(e,t,n){if(t){e.domain(vM(e.type,t,n));return t.length}else{return-1}}function pM(e,t,n,r,i,a){var o=Math.abs(Ai(n)-n[0]),u=o/(o-2*r),s=e===Kk?Bi(t,null,u):e===tE?Ui(t,null,u,.5):e===eE?Ui(t,null,u,i||1):e===nE?qi(t,null,u,a||1):Ii(t,null,u);t=t.slice();t[0]=s[0];t[t.length-1]=s[1];return t}function vM(e,t,n){if(LD(e)){var r=Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0));if(r!==t.length){n.warn("Log scale domain includes zero: "+oi(t))}}return t}function gM(e,t,n){var r=t.bins;if(r&&!ri(r)){var i=e.domain(),a=i[0],o=Ai(i),u=r.start==null?a:r.start,s=r.stop==null?o:r.stop,l=r.step;if(!l)ti("Scale bins parameter missing step property.");if(u<a)u=l*Math.ceil(a/l);if(s>o)s=l*Math.floor(o/l);r=Cf(u,s+l/2,l)}if(r){e.bins=r}else if(e.bins){delete e.bins}if(e.type===hE){if(!r){e.bins=e.domain()}else if(!t.domain&&!t.domainRaw){e.domain(r);n=r.length}}return n}function mM(e,t,n){var r=e.type,i=t.round||false,a=t.range;if(t.rangeStep!=null){a=yM(r,t,n)}else if(t.scheme){a=bM(r,t,n);if(Vi(a)){if(e.interpolator){return e.interpolator(a)}else{ti("Scale type "+r+" does not support interpolating color schemes.")}}}if(a&&ID(r)){return e.interpolator(WD(_M(a,t.reverse),t.interpolate,t.interpolateGamma))}if(a&&t.interpolate&&e.interpolate){e.interpolate(GD(t.interpolate,t.interpolateGamma))}else if(Vi(e.round)){e.round(i)}else if(Vi(e.rangeRound)){e.interpolate(i?fA:uA)}if(a)e.range(_M(a,t.reverse))}function yM(e,t,n){if(e!==dE&&e!==cE){ti("Only band and point scales support rangeStep.")}var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===cE?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Jk(n,i,r)]}function bM(e,t,n){var r=t.schemeExtent,i,a;if(ri(t.scheme)){a=WD(t.scheme,t.interpolate,t.interpolateGamma)}else{i=t.scheme.toLowerCase();a=KD(i);if(!a)ti("Unrecognized scheme name: "+t.scheme)}n=e===lE?n+1:e===hE?n-1:e===uE||e===sE?+t.schemeCount||iM:n;return ID(e)?xM(a,r,t.reverse):Vi(a)?HD(xM(a,r),n):e===fE?a:a.slice(0,n)}function xM(e,t,n){return Vi(e)&&(t||n)?qD(e,_M(t||[0,1],n)):e}function _M(e,t){return t?e.slice().reverse():e}function wM(e){af.call(this,null,e)}var kM=aa(wM,af);kM.transform=function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");if(n)t.source.sort(Pa(e.sort));this.modified(n);return t};var EM="zero",OM="center",AM="normalize",SM=["y0","y1"];function DM(e){af.call(this,null,e)}DM.Definition={type:"Stack",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:true},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:EM,values:[EM,OM,AM]},{name:"as",type:"string",array:true,length:2,default:SM}]};var CM=aa(DM,af);CM.transform=function(e,t){var n=e.as||SM,r=n[0],i=n[1],a=Pa(e.sort),o=e.field||di,u=e.offset===OM?MM:e.offset===AM?jM:FM,s,l,f,c;s=NM(t.source,e.groupby,a,o);for(l=0,f=s.length,c=s.max;l<f;++l){u(s[l],c,o,r,i)}return t.reflow(e.modified()).modifies(n)};function MM(e,t,n,r,i){var a=(t-e.sum)/2,o=e.length,u=0,s;for(;u<o;++u){s=e[u];s[r]=a;s[i]=a+=Math.abs(n(s))}}function jM(e,t,n,r,i){var a=1/e.sum,o=0,u=e.length,s=0,l=0,f;for(;s<u;++s){f=e[s];f[r]=o;f[i]=o=a*(l+=Math.abs(n(f)))}}function FM(e,t,n,r,i){var a=0,o=0,u=e.length,s=0,l,f;for(;s<u;++s){f=e[s];l=+n(f);if(l<0){f[r]=o;f[i]=o+=l}else{f[r]=a;f[i]=a+=l}}}function NM(e,t,n,r){var i=[],a=function(e){return e(f)},o,u,s,l,f,c,d,h,p;if(t==null){i.push(e.slice())}else{for(o={},u=0,s=e.length;u<s;++u){f=e[u];c=t.map(a);d=o[c];if(!d){o[c]=d=[];i.push(d)}d.push(f)}}for(c=0,p=0,l=i.length;c<l;++c){d=i[c];for(u=0,h=0,s=d.length;u<s;++u){h+=Math.abs(r(d[u]))}d.sum=h;if(h>p)p=h;if(n)d.sort(n)}i.max=p;return i}var TM=Object.freeze({__proto__:null,axisticks:lC,datajoin:cC,encode:vC,legendentries:zC,linkpath:qC,pie:nM,scale:sM,sortitems:wM,stack:DM,validTicks:nC});function zM(){}var RM=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function PM(){var e=1,t=1,n=u;function r(e,t){return t.map((function(t){return i(e,t)}))}function i(e,t){var r=[],i=[];a(e,t,(function(a){n(a,e,t);if(LM(a)>0)r.push([a]);else i.push(a)}));i.forEach((function(e){for(var t=0,n=r.length,i;t<n;++t){if(IM((i=r[t])[0],e)!==-1){i.push(e);return}}}));return{type:"MultiPolygon",value:t,coordinates:r}}function a(n,r,i){var a=new Array,u=new Array,s,l,f,c,d,h;s=l=-1;c=n[0]>=r;RM[c<<1].forEach(p);while(++s<e-1){f=c,c=n[s+1]>=r;RM[f|c<<1].forEach(p)}RM[c<<0].forEach(p);while(++l<t-1){s=-1;c=n[l*e+e]>=r;d=n[l*e]>=r;RM[c<<1|d<<2].forEach(p);while(++s<e-1){f=c,c=n[l*e+e+s+1]>=r;h=d,d=n[l*e+s+1]>=r;RM[f|c<<1|d<<2|h<<3].forEach(p)}RM[c|d<<3].forEach(p)}s=-1;d=n[l*e]>=r;RM[d<<2].forEach(p);while(++s<e-1){h=d,d=n[l*e+s+1]>=r;RM[d<<2|h<<3].forEach(p)}RM[d<<3].forEach(p);function p(e){var t=[e[0][0]+s,e[0][1]+l],n=[e[1][0]+s,e[1][1]+l],r=o(t),f=o(n),c,d;if(c=u[r]){if(d=a[f]){delete u[c.end];delete a[d.start];if(c===d){c.ring.push(n);i(c.ring)}else{a[c.start]=u[d.end]={start:c.start,end:d.end,ring:c.ring.concat(d.ring)}}}else{delete u[c.end];c.ring.push(n);u[c.end=f]=c}}else if(c=a[f]){if(d=u[r]){delete a[c.start];delete u[d.end];if(c===d){c.ring.push(n);i(c.ring)}else{a[d.start]=u[c.end]={start:d.start,end:c.end,ring:d.ring.concat(c.ring)}}}else{delete a[c.start];c.ring.unshift(t);a[c.start=r]=c}}else{a[r]=u[f]={start:r,end:f,ring:[t,n]}}}}function o(t){return t[0]*2+t[1]*(e+1)*4}function u(n,r,i){n.forEach((function(n){var a=n[0],o=n[1],u=a|0,s=o|0,l,f=r[s*e+u];if(a>0&&a<e&&u===a){l=r[s*e+u-1];n[0]=a+(i-l)/(f-l)-.5}if(o>0&&o<t&&s===o){l=r[(s-1)*e+u];n[1]=o+(i-l)/(f-l)-.5}}))}r.contour=i;r.size=function(n){if(!arguments.length)return[e,t];var i=Math.ceil(n[0]),a=Math.ceil(n[1]);if(!(i>0)||!(a>0))ti("invalid size");return e=i,t=a,r};r.smooth=function(e){return arguments.length?(n=e?u:zM,r):n===u};return r}function LM(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];while(++t<n)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function IM(e,t){var n=-1,r=t.length,i;while(++n<r)if(i=BM(e,t[n]))return i;return 0}function BM(e,t){var n=t[0],r=t[1],i=-1;for(var a=0,o=e.length,u=o-1;a<o;u=a++){var s=e[a],l=s[0],f=s[1],c=e[u],d=c[0],h=c[1];if(UM(s,c,t))return 0;if(f>r!==h>r&&n<(d-l)*(r-f)/(h-f)+l)i=-i}return i}function UM(e,t,n){var r;return qM(e,t,n)&&WM(e[r=+(e[0]===t[0])],n[r],t[r])}function qM(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function WM(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function HM(e,t,n){return function(r){var i=Qi(r),a=n?Math.min(i[0],0):i[0],o=i[1],u=o-a,s=t?zf(a,o,e):u/(e+1);return Cf(s,o,s)}}function $M(e){af.call(this,null,e)}$M.Definition={type:"Isocontour",metadata:{generates:true},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:true},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:false},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:true},{name:"smooth",type:"boolean",default:true},{name:"scale",type:"number",expr:true},{name:"translate",type:"number",array:true,expr:true},{name:"as",type:"string",null:true,default:"contour"}]};var GM=aa($M,af);GM.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||fi,a=PM().smooth(e.smooth!==false),o=e.thresholds||VM(r,i,e),u=e.as===null?null:e.as||"contour",s=[];r.forEach((function(t){var n=i(t);var r=a.size([n.width,n.height])(n.values,ri(o)?o:o(n.values));YM(r,n,t,e);r.forEach((function(e){var n;s.push(za(t,Na(u!=null?(n={},n[u]=e,n):e)))}))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n};function VM(e,t,n){var r=HM(n.levels||10,n.nice,n.zero!==false);return n.resolve!=="shared"?r:r(e.map((function(e){return Rf(t(e).values)})))}function YM(e,t,n,r){var i=r.scale||t.scale,a=r.translate||t.translate;if(Vi(i))i=i(n,r);if(Vi(a))a=a(n,r);if((i===1||i==null)&&!a)return;var o=(la(i)?i:i[0])||1,u=(la(i)?i:i[1])||1,s=a&&a[0]||0,l=a&&a[1]||0;e.forEach(XM(t,o,u,s,l))}function XM(e,t,n,r,i){var a=e.x1||0,o=e.y1||0,u=t*n<0;function s(e){e.forEach(l)}function l(e){if(u)e.reverse();e.forEach(f)}function f(e){e[0]=(e[0]-a)*t+r;e[1]=(e[1]-o)*n+i}return function(e){e.coordinates.forEach(s);return e}}function JM(e,t,n){var r=e>=0?e:Jf(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function ZM(e){return Vi(e)?e:Xi(+e)}function QM(){var e=function(e){return e[0]},t=function(e){return e[1]},n=di,r=[-1,-1],i=960,a=500,o=2;function u(u,s){var l=JM(r[0],u,e)>>o,f=JM(r[1],u,t)>>o,c=l?l+2:0,d=f?f+2:0,h=2*c+(i>>o),p=2*d+(a>>o),v=new Float32Array(h*p),g=new Float32Array(h*p);var m=v;u.forEach((function(r){var i=c+(+e(r)>>o),a=d+(+t(r)>>o);if(i>=0&&i<h&&a>=0&&a<p){v[i+a*h]+=+n(r)}}));if(l>0&&f>0){KM(h,p,v,g,l);ej(h,p,g,v,f);KM(h,p,v,g,l);ej(h,p,g,v,f);KM(h,p,v,g,l);ej(h,p,g,v,f)}else if(l>0){KM(h,p,v,g,l);KM(h,p,g,v,l);KM(h,p,v,g,l);m=g}else if(f>0){ej(h,p,v,g,f);ej(h,p,g,v,f);ej(h,p,v,g,f);m=g}var y=s?Math.pow(2,-2*o):1/Vf(m);for(var b=0,x=h*p;b<x;++b)m[b]*=y;return{values:m,scale:1<<o,width:h,height:p,x1:c,y1:d,x2:c+(i>>o),y2:d+(a>>o)}}u.x=function(t){return arguments.length?(e=ZM(t),u):e};u.y=function(e){return arguments.length?(t=ZM(e),u):t};u.weight=function(e){return arguments.length?(n=ZM(e),u):n};u.size=function(e){if(!arguments.length)return[i,a];var t=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!(t>=0)&&!(t>=0))ti("invalid size");return i=t,a=n,u};u.cellSize=function(e){if(!arguments.length)return 1<<o;if(!((e=+e)>=1))ti("invalid cell size");o=Math.floor(Math.log(e)/Math.LN2);return u};u.bandwidth=function(e){if(!arguments.length)return r;e=$i(e);if(e.length===1)e=[+e[0],+e[0]];if(e.length!==2)ti("invalid bandwidth");return r=e,u};return u}function KM(e,t,n,r,i){var a=(i<<1)+1;for(var o=0;o<t;++o){for(var u=0,s=0;u<e+i;++u){if(u<e){s+=n[u+o*e]}if(u>=i){if(u>=a){s-=n[u-a+o*e]}r[u-i+o*e]=s/Math.min(u+1,e-1+a-u,a)}}}}function ej(e,t,n,r,i){var a=(i<<1)+1;for(var o=0;o<e;++o){for(var u=0,s=0;u<t+i;++u){if(u<t){s+=n[o+u*e]}if(u>=i){if(u>=a){s-=n[o+(u-a)*e]}r[o+(u-i)*e]=s/Math.min(u+1,t-1+a-u,a)}}}}function tj(e){af.call(this,null,e)}tj.Definition={type:"KDE2D",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"weight",type:"field"},{name:"groupby",type:"field",array:true},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:true,length:2},{name:"counts",type:"boolean",default:false},{name:"as",type:"string",default:"grid"}]};var nj=aa(tj,af);var rj=["x","y","weight","size","cellSize","bandwidth"];function ij(e,t){rj.forEach((function(n){return t[n]!=null?e[n](t[n]):0}));return e}nj.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=aj(r,e.groupby),a=(e.groupby||[]).map(Kr),o=ij(QM(),e),u=e.as||"grid",s=[];function l(e,t){for(var n=0;n<a.length;++n)e[a[n]]=t[n];return e}s=i.map((function(t){var n;return Na(l((n={},n[u]=o(t,e.counts),n),t.dims))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n};function aj(e,t){var n=[],r=function(e){return e(u)},i,a,o,u,s,l;if(t==null){n.push(e)}else{for(i={},a=0,o=e.length;a<o;++a){u=e[a];s=t.map(r);l=i[s];if(!l){i[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function oj(e){af.call(this,null,e)}oj.Definition={type:"Contour",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"values",type:"number",array:true},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:false},{name:"thresholds",type:"number",array:true},{name:"smooth",type:"boolean",default:true}]};var uj=aa(oj,af);uj.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=PM().smooth(e.smooth!==false),i=e.values,a=e.thresholds||HM(e.count||10,e.nice,!!i),o=e.size,u,s;if(!i){i=t.materialize(t.SOURCE).source;u=ij(QM(),e)(i,true);s=XM(u,u.scale||1,u.scale||1,0,0);o=[u.width,u.height];i=u.values}a=ri(a)?a:a(i);i=r.size(o)(i,a);if(s)i.forEach(s);if(this.value)n.rem=this.value;this.value=n.source=n.add=(i||[]).map(Na);return n};var sj="Feature";var lj="FeatureCollection";var fj="MultiPoint";function cj(e){af.call(this,null,e)}cj.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:true,length:2},{name:"geojson",type:"field"}]};var dj=aa(cj,af);dj.transform=function(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],u=e.geojson||!i&&fi,s=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(ei(u))||a&&t.modified(ei(a))||o&&t.modified(ei(o));if(!this.value||l){s=t.SOURCE;this._features=n=[];this._points=r=[]}if(u){t.visit(s,(function(e){n.push(u(e))}))}if(a&&o){t.visit(s,(function(e){var t=a(e),n=o(e);if(t!=null&&n!=null&&(t=+t)===t&&(n=+n)===n){r.push([t,n])}}));n=n.concat({type:sj,geometry:{type:fj,coordinates:r}})}this.value={type:lj,features:n}};function hj(){return new pj}function pj(){this.reset()}pj.prototype={constructor:pj,reset:function(){this.s=this.t=0},add:function(e){gj(vj,e,this.t);gj(this,vj.s,this.s);if(this.s)this.t+=vj.t;else this.s=vj.t},valueOf:function(){return this.s}};var vj=new pj;function gj(e,t,n){var r=e.s=t+n,i=r-t,a=r-i;e.t=t-a+(n-i)}var mj=1e-6;var yj=1e-12;var bj=Math.PI;var xj=bj/2;var _j=bj/4;var wj=bj*2;var kj=180/bj;var Ej=bj/180;var Oj=Math.abs;var Aj=Math.atan;var Sj=Math.atan2;var Dj=Math.cos;var Cj=Math.ceil;var Mj=Math.exp;var jj=Math.log;var Fj=Math.pow;var Nj=Math.sin;var Tj=Math.sign||function(e){return e>0?1:e<0?-1:0};var zj=Math.sqrt;var Rj=Math.tan;function Pj(e){return e>1?0:e<-1?bj:Math.acos(e)}function Lj(e){return e>1?xj:e<-1?-xj:Math.asin(e)}function Ij(){}function Bj(e,t){if(e&&qj.hasOwnProperty(e.type)){qj[e.type](e,t)}}var Uj={Feature:function(e,t){Bj(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)Bj(n[r].geometry,t)}};var qj={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Wj(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)Wj(n[r],t,0)},Polygon:function(e,t){Hj(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)Hj(n[r],t)},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)Bj(n[r],t)}};function Wj(e,t,n){var r=-1,i=e.length-n,a;t.lineStart();while(++r<i)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function Hj(e,t){var n=-1,r=e.length;t.polygonStart();while(++n<r)Wj(e[n],t,1);t.polygonEnd()}function $j(e,t){if(e&&Uj.hasOwnProperty(e.type)){Uj[e.type](e,t)}else{Bj(e,t)}}var Gj=hj();var Vj=hj(),Yj,Xj,Jj,Zj,Qj;var Kj={point:Ij,lineStart:Ij,lineEnd:Ij,polygonStart:function(){Gj.reset();Kj.lineStart=eF;Kj.lineEnd=tF},polygonEnd:function(){var e=+Gj;Vj.add(e<0?wj+e:e);this.lineStart=this.lineEnd=this.point=Ij},sphere:function(){Vj.add(wj)}};function eF(){Kj.point=nF}function tF(){rF(Yj,Xj)}function nF(e,t){Kj.point=rF;Yj=e,Xj=t;e*=Ej,t*=Ej;Jj=e,Zj=Dj(t=t/2+_j),Qj=Nj(t)}function rF(e,t){e*=Ej,t*=Ej;t=t/2+_j;var n=e-Jj,r=n>=0?1:-1,i=r*n,a=Dj(t),o=Nj(t),u=Qj*o,s=Zj*a+u*Dj(i),l=u*r*Nj(i);Gj.add(Sj(l,s));Jj=e,Zj=a,Qj=o}function iF(e){Vj.reset();$j(e,Kj);return Vj*2}function aF(e){return[Sj(e[1],e[0]),Lj(e[2])]}function oF(e){var t=e[0],n=e[1],r=Dj(n);return[r*Dj(t),r*Nj(t),Nj(n)]}function uF(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function sF(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function lF(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function fF(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function cF(e){var t=zj(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var dF,hF,pF,vF,gF,mF,yF,bF,xF=hj(),_F,wF;var kF={point:EF,lineStart:AF,lineEnd:SF,polygonStart:function(){kF.point=DF;kF.lineStart=CF;kF.lineEnd=MF;xF.reset();Kj.polygonStart()},polygonEnd:function(){Kj.polygonEnd();kF.point=EF;kF.lineStart=AF;kF.lineEnd=SF;if(Gj<0)dF=-(pF=180),hF=-(vF=90);else if(xF>mj)vF=90;else if(xF<-mj)hF=-90;wF[0]=dF,wF[1]=pF},sphere:function(){dF=-(pF=180),hF=-(vF=90)}};function EF(e,t){_F.push(wF=[dF=e,pF=e]);if(t<hF)hF=t;if(t>vF)vF=t}function OF(e,t){var n=oF([e*Ej,t*Ej]);if(bF){var r=sF(bF,n),i=[r[1],-r[0],0],a=sF(i,r);cF(a);a=aF(a);var o=e-gF,u=o>0?1:-1,s=a[0]*kj*u,l,f=Oj(o)>180;if(f^(u*gF<s&&s<u*e)){l=a[1]*kj;if(l>vF)vF=l}else if(s=(s+360)%360-180,f^(u*gF<s&&s<u*e)){l=-a[1]*kj;if(l<hF)hF=l}else{if(t<hF)hF=t;if(t>vF)vF=t}if(f){if(e<gF){if(jF(dF,e)>jF(dF,pF))pF=e}else{if(jF(e,pF)>jF(dF,pF))dF=e}}else{if(pF>=dF){if(e<dF)dF=e;if(e>pF)pF=e}else{if(e>gF){if(jF(dF,e)>jF(dF,pF))pF=e}else{if(jF(e,pF)>jF(dF,pF))dF=e}}}}else{_F.push(wF=[dF=e,pF=e])}if(t<hF)hF=t;if(t>vF)vF=t;bF=n,gF=e}function AF(){kF.point=OF}function SF(){wF[0]=dF,wF[1]=pF;kF.point=EF;bF=null}function DF(e,t){if(bF){var n=e-gF;xF.add(Oj(n)>180?n+(n>0?360:-360):n)}else{mF=e,yF=t}Kj.point(e,t);OF(e,t)}function CF(){Kj.lineStart()}function MF(){DF(mF,yF);Kj.lineEnd();if(Oj(xF)>mj)dF=-(pF=180);wF[0]=dF,wF[1]=pF;bF=null}function jF(e,t){return(t-=e)<0?t+360:t}function FF(e,t){return e[0]-t[0]}function NF(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function TF(e){var t,n,r,i,a,o,u;vF=pF=-(dF=hF=Infinity);_F=[];$j(e,kF);if(n=_F.length){_F.sort(FF);for(t=1,r=_F[0],a=[r];t<n;++t){i=_F[t];if(NF(r,i[0])||NF(r,i[1])){if(jF(r[0],i[1])>jF(r[0],r[1]))r[1]=i[1];if(jF(i[0],r[1])>jF(r[0],r[1]))r[0]=i[0]}else{a.push(r=i)}}for(o=-Infinity,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t){i=a[t];if((u=jF(r[1],i[0]))>o)o=u,dF=i[0],pF=r[1]}}_F=wF=null;return dF===Infinity||hF===Infinity?[[NaN,NaN],[NaN,NaN]]:[[dF,hF],[pF,vF]]}var zF,RF,PF,LF,IF,BF,UF,qF,WF,HF,$F,GF,VF,YF,XF,JF;var ZF={sphere:Ij,point:QF,lineStart:eN,lineEnd:rN,polygonStart:function(){ZF.lineStart=iN;ZF.lineEnd=aN},polygonEnd:function(){ZF.lineStart=eN;ZF.lineEnd=rN}};function QF(e,t){e*=Ej,t*=Ej;var n=Dj(t);KF(n*Dj(e),n*Nj(e),Nj(t))}function KF(e,t,n){++zF;PF+=(e-PF)/zF;LF+=(t-LF)/zF;IF+=(n-IF)/zF}function eN(){ZF.point=tN}function tN(e,t){e*=Ej,t*=Ej;var n=Dj(t);YF=n*Dj(e);XF=n*Nj(e);JF=Nj(t);ZF.point=nN;KF(YF,XF,JF)}function nN(e,t){e*=Ej,t*=Ej;var n=Dj(t),r=n*Dj(e),i=n*Nj(e),a=Nj(t),o=Sj(zj((o=XF*a-JF*i)*o+(o=JF*r-YF*a)*o+(o=YF*i-XF*r)*o),YF*r+XF*i+JF*a);RF+=o;BF+=o*(YF+(YF=r));UF+=o*(XF+(XF=i));qF+=o*(JF+(JF=a));KF(YF,XF,JF)}function rN(){ZF.point=QF}function iN(){ZF.point=oN}function aN(){uN(GF,VF);ZF.point=QF}function oN(e,t){GF=e,VF=t;e*=Ej,t*=Ej;ZF.point=uN;var n=Dj(t);YF=n*Dj(e);XF=n*Nj(e);JF=Nj(t);KF(YF,XF,JF)}function uN(e,t){e*=Ej,t*=Ej;var n=Dj(t),r=n*Dj(e),i=n*Nj(e),a=Nj(t),o=XF*a-JF*i,u=JF*r-YF*a,s=YF*i-XF*r,l=zj(o*o+u*u+s*s),f=Lj(l),c=l&&-f/l;WF+=c*o;HF+=c*u;$F+=c*s;RF+=f;BF+=f*(YF+(YF=r));UF+=f*(XF+(XF=i));qF+=f*(JF+(JF=a));KF(YF,XF,JF)}function sN(e){zF=RF=PF=LF=IF=BF=UF=qF=WF=HF=$F=0;$j(e,ZF);var t=WF,n=HF,r=$F,i=t*t+n*n+r*r;if(i<yj){t=BF,n=UF,r=qF;if(RF<mj)t=PF,n=LF,r=IF;i=t*t+n*n+r*r;if(i<yj)return[NaN,NaN]}return[Sj(n,t)*kj,Lj(r/zj(i))*kj]}function lN(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}if(e.invert&&t.invert)n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])};return n}function fN(e,t){return[Oj(e)>bj?e+Math.round(-e/wj)*wj:e,t]}fN.invert=fN;function cN(e,t,n){return(e%=wj)?t||n?lN(hN(e),pN(t,n)):hN(e):t||n?pN(t,n):fN}function dN(e){return function(t,n){return t+=e,[t>bj?t-wj:t<-bj?t+wj:t,n]}}function hN(e){var t=dN(e);t.invert=dN(-e);return t}function pN(e,t){var n=Dj(e),r=Nj(e),i=Dj(t),a=Nj(t);function o(e,t){var o=Dj(t),u=Dj(e)*o,s=Nj(e)*o,l=Nj(t),f=l*n+u*r;return[Sj(s*i-f*a,u*n-l*r),Lj(f*i+s*a)]}o.invert=function(e,t){var o=Dj(t),u=Dj(e)*o,s=Nj(e)*o,l=Nj(t),f=l*i-s*a;return[Sj(s*i+l*a,u*n+f*r),Lj(f*n-u*r)]};return o}function vN(e){e=cN(e[0]*Ej,e[1]*Ej,e.length>2?e[2]*Ej:0);function t(t){t=e(t[0]*Ej,t[1]*Ej);return t[0]*=kj,t[1]*=kj,t}t.invert=function(t){t=e.invert(t[0]*Ej,t[1]*Ej);return t[0]*=kj,t[1]*=kj,t};return t}function gN(e,t,n,r,i,a){if(!n)return;var o=Dj(t),u=Nj(t),s=r*n;if(i==null){i=t+r*wj;a=t-s/2}else{i=mN(o,i);a=mN(o,a);if(r>0?i<a:i>a)i+=r*wj}for(var l,f=i;r>0?f>a:f<a;f-=s){l=aF([o,-u*Dj(f),-u*Nj(f)]);e.point(l[0],l[1])}}function mN(e,t){t=oF(t),t[0]-=e;cF(t);var n=Pj(-t[1]);return((-t[2]<0?-n:n)+wj-mj)%wj}function yN(){var e=[],t;return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Ij,rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))},result:function(){var n=e;e=[];t=null;return n}}}function bN(e,t){return Oj(e[0]-t[0])<mj&&Oj(e[1]-t[1])<mj}function xN(e,t,n,r){this.x=e;this.z=t;this.o=n;this.e=r;this.v=false;this.n=this.p=null}function _N(e,t,n,r,i){var a=[],o=[],u,s;e.forEach((function(e){if((t=e.length-1)<=0)return;var t,n=e[0],r=e[t],s;if(bN(n,r)){i.lineStart();for(u=0;u<t;++u)i.point((n=e[u])[0],n[1]);i.lineEnd();return}a.push(s=new xN(n,e,null,true));o.push(s.o=new xN(n,null,s,false));a.push(s=new xN(r,e,null,false));o.push(s.o=new xN(r,null,s,true))}));if(!a.length)return;o.sort(t);wN(a);wN(o);for(u=0,s=o.length;u<s;++u){o[u].e=n=!n}var l=a[0],f,c;while(1){var d=l,h=true;while(d.v)if((d=d.n)===l)return;f=d.z;i.lineStart();do{d.v=d.o.v=true;if(d.e){if(h){for(u=0,s=f.length;u<s;++u)i.point((c=f[u])[0],c[1])}else{r(d.x,d.n.x,1,i)}d=d.n}else{if(h){f=d.p.z;for(u=f.length-1;u>=0;--u)i.point((c=f[u])[0],c[1])}else{r(d.x,d.p.x,-1,i)}d=d.p}d=d.o;f=d.z;h=!h}while(!d.v);i.lineEnd()}}function wN(e){if(!(t=e.length))return;var t,n=0,r=e[0],i;while(++n<t){r.n=i=e[n];i.p=r;r=i}r.n=i=e[0];i.p=r}var kN=hj();function EN(e){if(Oj(e[0])<=bj)return e[0];else return Tj(e[0])*((Oj(e[0])+bj)%wj-bj)}function ON(e,t){var n=EN(t),r=t[1],i=Nj(r),a=[Nj(n),-Dj(n),0],o=0,u=0;kN.reset();if(i===1)r=xj+mj;else if(i===-1)r=-xj-mj;for(var s=0,l=e.length;s<l;++s){if(!(c=(f=e[s]).length))continue;var f,c,d=f[c-1],h=EN(d),p=d[1]/2+_j,v=Nj(p),g=Dj(p);for(var m=0;m<c;++m,h=b,v=_,g=w,d=y){var y=f[m],b=EN(y),x=y[1]/2+_j,_=Nj(x),w=Dj(x),k=b-h,E=k>=0?1:-1,O=E*k,A=O>bj,S=v*_;kN.add(Sj(S*E*Nj(O),g*w+S*Dj(O)));o+=A?k+E*wj:k;if(A^h>=n^b>=n){var D=sF(oF(d),oF(y));cF(D);var C=sF(a,D);cF(C);var M=(A^k>=0?-1:1)*Lj(C[2]);if(r>M||r===M&&(D[0]||D[1])){u+=A^k>=0?1:-1}}}}return(o<-mj||o<mj&&kN<-mj)^u&1}function AN(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);while(++r<i){a[r]=e+r*n}return a}function SN(e){var t=e.length,n,r=-1,i=0,a,o;while(++r<t)i+=e[r].length;a=new Array(i);while(--t>=0){o=e[t];n=o.length;while(--n>=0){a[--i]=o[n]}}return a}function DN(e,t,n,r){return function(i){var a=t(i),o=yN(),u=t(o),s=false,l,f,c;var d={point:h,lineStart:v,lineEnd:g,polygonStart:function(){d.point=m;d.lineStart=y;d.lineEnd=b;f=[];l=[]},polygonEnd:function(){d.point=h;d.lineStart=v;d.lineEnd=g;f=SN(f);var e=ON(l,r);if(f.length){if(!s)i.polygonStart(),s=true;_N(f,MN,e,n,i)}else if(e){if(!s)i.polygonStart(),s=true;i.lineStart();n(null,null,1,i);i.lineEnd()}if(s)i.polygonEnd(),s=false;f=l=null},sphere:function(){i.polygonStart();i.lineStart();n(null,null,1,i);i.lineEnd();i.polygonEnd()}};function h(t,n){if(e(t,n))i.point(t,n)}function p(e,t){a.point(e,t)}function v(){d.point=p;a.lineStart()}function g(){d.point=h;a.lineEnd()}function m(e,t){c.push([e,t]);u.point(e,t)}function y(){u.lineStart();c=[]}function b(){m(c[0][0],c[0][1]);u.lineEnd();var e=u.clean(),t=o.result(),n,r=t.length,a,d,h;c.pop();l.push(c);c=null;if(!r)return;if(e&1){d=t[0];if((a=d.length-1)>0){if(!s)i.polygonStart(),s=true;i.lineStart();for(n=0;n<a;++n)i.point((h=d[n])[0],h[1]);i.lineEnd()}return}if(r>1&&e&2)t.push(t.pop().concat(t.shift()));f.push(t.filter(CN))}return d}}function CN(e){return e.length>1}function MN(e,t){return((e=e.x)[0]<0?e[1]-xj-mj:xj-e[1])-((t=t.x)[0]<0?t[1]-xj-mj:xj-t[1])}var jN=DN((function(){return true}),FN,TN,[-bj,-xj]);function FN(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart();i=1},point:function(a,o){var u=a>0?bj:-bj,s=Oj(a-t);if(Oj(s-bj)<mj){e.point(t,n=(n+o)/2>0?xj:-xj);e.point(r,n);e.lineEnd();e.lineStart();e.point(u,n);e.point(a,n);i=0}else if(r!==u&&s>=bj){if(Oj(t-r)<mj)t-=r*mj;if(Oj(a-u)<mj)a-=u*mj;n=NN(t,n,a,o);e.point(r,n);e.lineEnd();e.lineStart();e.point(u,n);i=0}e.point(t=a,n=o);r=u},lineEnd:function(){e.lineEnd();t=n=NaN},clean:function(){return 2-i}}}function NN(e,t,n,r){var i,a,o=Nj(e-n);return Oj(o)>mj?Aj((Nj(t)*(a=Dj(r))*Nj(n)-Nj(r)*(i=Dj(t))*Nj(e))/(i*a*o)):(t+r)/2}function TN(e,t,n,r){var i;if(e==null){i=n*xj;r.point(-bj,i);r.point(0,i);r.point(bj,i);r.point(bj,0);r.point(bj,-i);r.point(0,-i);r.point(-bj,-i);r.point(-bj,0);r.point(-bj,i)}else if(Oj(e[0]-t[0])>mj){var a=e[0]<t[0]?bj:-bj;i=n*a/2;r.point(-a,i);r.point(0,i);r.point(a,i)}else{r.point(t[0],t[1])}}function zN(e){var t=Dj(e),n=6*Ej,r=t>0,i=Oj(t)>mj;function a(t,r,i,a){gN(a,e,n,i,t,r)}function o(e,n){return Dj(e)*Dj(n)>t}function u(e){var t,n,a,u,f;return{lineStart:function(){u=a=false;f=1},point:function(c,d){var h=[c,d],p,v=o(c,d),g=r?v?0:l(c,d):v?l(c+(c<0?bj:-bj),d):0;if(!t&&(u=a=v))e.lineStart();if(v!==a){p=s(t,h);if(!p||bN(t,p)||bN(h,p)){h[0]+=mj;h[1]+=mj;v=o(h[0],h[1])}}if(v!==a){f=0;if(v){e.lineStart();p=s(h,t);e.point(p[0],p[1])}else{p=s(t,h);e.point(p[0],p[1]);e.lineEnd()}t=p}else if(i&&t&&r^v){var m;if(!(g&n)&&(m=s(h,t,true))){f=0;if(r){e.lineStart();e.point(m[0][0],m[0][1]);e.point(m[1][0],m[1][1]);e.lineEnd()}else{e.point(m[1][0],m[1][1]);e.lineEnd();e.lineStart();e.point(m[0][0],m[0][1])}}}if(v&&(!t||!bN(t,h))){e.point(h[0],h[1])}t=h,a=v,n=g},lineEnd:function(){if(a)e.lineEnd();t=null},clean:function(){return f|(u&&a)<<1}}}function s(e,n,r){var i=oF(e),a=oF(n);var o=[1,0,0],u=sF(i,a),s=uF(u,u),l=u[0],f=s-l*l;if(!f)return!r&&e;var c=t*s/f,d=-t*l/f,h=sF(o,u),p=fF(o,c),v=fF(u,d);lF(p,v);var g=h,m=uF(p,g),y=uF(g,g),b=m*m-y*(uF(p,p)-1);if(b<0)return;var x=zj(b),_=fF(g,(-m-x)/y);lF(_,p);_=aF(_);if(!r)return _;var w=e[0],k=n[0],E=e[1],O=n[1],A;if(k<w)A=w,w=k,k=A;var S=k-w,D=Oj(S-bj)<mj,C=D||S<mj;if(!D&&O<E)A=E,E=O,O=A;if(C?D?E+O>0^_[1]<(Oj(_[0]-w)<mj?E:O):E<=_[1]&&_[1]<=O:S>bj^(w<=_[0]&&_[0]<=k)){var M=fF(g,(-m+x)/y);lF(M,p);return[_,aF(M)]}}function l(t,n){var i=r?e:bj-e,a=0;if(t<-i)a|=1;else if(t>i)a|=2;if(n<-i)a|=4;else if(n>i)a|=8;return a}return DN(o,u,a,r?[0,-e]:[-bj,e-bj])}function RN(e,t,n,r,i,a){var o=e[0],u=e[1],s=t[0],l=t[1],f=0,c=1,d=s-o,h=l-u,p;p=n-o;if(!d&&p>0)return;p/=d;if(d<0){if(p<f)return;if(p<c)c=p}else if(d>0){if(p>c)return;if(p>f)f=p}p=i-o;if(!d&&p<0)return;p/=d;if(d<0){if(p>c)return;if(p>f)f=p}else if(d>0){if(p<f)return;if(p<c)c=p}p=r-u;if(!h&&p>0)return;p/=h;if(h<0){if(p<f)return;if(p<c)c=p}else if(h>0){if(p>c)return;if(p>f)f=p}p=a-u;if(!h&&p<0)return;p/=h;if(h<0){if(p>c)return;if(p>f)f=p}else if(h>0){if(p<f)return;if(p<c)c=p}if(f>0)e[0]=o+f*d,e[1]=u+f*h;if(c<1)t[0]=o+c*d,t[1]=u+c*h;return true}var PN=1e9,LN=-PN;function IN(e,t,n,r){function i(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function a(i,a,u,l){var f=0,c=0;if(i==null||(f=o(i,u))!==(c=o(a,u))||s(i,a)<0^u>0){do{l.point(f===0||f===3?e:n,f>1?r:t)}while((f=(f+u+4)%4)!==c)}else{l.point(a[0],a[1])}}function o(r,i){return Oj(r[0]-e)<mj?i>0?0:3:Oj(r[0]-n)<mj?i>0?2:1:Oj(r[1]-t)<mj?i>0?1:0:i>0?3:2}function u(e,t){return s(e.x,t.x)}function s(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:n===0?t[1]-e[1]:n===1?e[0]-t[0]:n===2?e[1]-t[1]:t[0]-e[0]}return function(o){var s=o,l=yN(),f,c,d,h,p,v,g,m,y,b,x;var _={point:w,lineStart:A,lineEnd:S,polygonStart:E,polygonEnd:O};function w(e,t){if(i(e,t))s.point(e,t)}function k(){var t=0;for(var n=0,i=c.length;n<i;++n){for(var a=c[n],o=1,u=a.length,s=a[0],l,f,d=s[0],h=s[1];o<u;++o){l=d,f=h,s=a[o],d=s[0],h=s[1];if(f<=r){if(h>r&&(d-l)*(r-f)>(h-f)*(e-l))++t}else{if(h<=r&&(d-l)*(r-f)<(h-f)*(e-l))--t}}}return t}function E(){s=l,f=[],c=[],x=true}function O(){var e=k(),t=x&&e,n=(f=SN(f)).length;if(t||n){o.polygonStart();if(t){o.lineStart();a(null,null,1,o);o.lineEnd()}if(n){_N(f,u,e,a,o)}o.polygonEnd()}s=o,f=c=d=null}function A(){_.point=D;if(c)c.push(d=[]);b=true;y=false;g=m=NaN}function S(){if(f){D(h,p);if(v&&y)l.rejoin();f.push(l.result())}_.point=w;if(y)s.lineEnd()}function D(a,o){var u=i(a,o);if(c)d.push([a,o]);if(b){h=a,p=o,v=u;b=false;if(u){s.lineStart();s.point(a,o)}}else{if(u&&y)s.point(a,o);else{var l=[g=Math.max(LN,Math.min(PN,g)),m=Math.max(LN,Math.min(PN,m))],f=[a=Math.max(LN,Math.min(PN,a)),o=Math.max(LN,Math.min(PN,o))];if(RN(l,f,e,t,n,r)){if(!y){s.lineStart();s.point(l[0],l[1])}s.point(f[0],f[1]);if(!u)s.lineEnd();x=false}else if(u){s.lineStart();s.point(a,o);x=false}}}g=a,m=o,y=u}return _}}function BN(e,t,n){var r=AN(e,t-mj,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function UN(e,t,n){var r=AN(e,t-mj,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function qN(){var e,t,n,r,i,a,o,u,s=10,l=s,f=90,c=360,d,h,p,v,g=2.5;function m(){return{type:"MultiLineString",coordinates:y()}}function y(){return AN(Cj(r/f)*f,n,f).map(p).concat(AN(Cj(u/c)*c,o,c).map(v)).concat(AN(Cj(t/s)*s,e,s).filter((function(e){return Oj(e%f)>mj})).map(d)).concat(AN(Cj(a/l)*l,i,l).filter((function(e){return Oj(e%c)>mj})).map(h))}m.lines=function(){return y().map((function(e){return{type:"LineString",coordinates:e}}))};m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(v(o).slice(1),p(n).reverse().slice(1),v(u).reverse().slice(1))]}};m.extent=function(e){if(!arguments.length)return m.extentMinor();return m.extentMajor(e).extentMinor(e)};m.extentMajor=function(e){if(!arguments.length)return[[r,u],[n,o]];r=+e[0][0],n=+e[1][0];u=+e[0][1],o=+e[1][1];if(r>n)e=r,r=n,n=e;if(u>o)e=u,u=o,o=e;return m.precision(g)};m.extentMinor=function(n){if(!arguments.length)return[[t,a],[e,i]];t=+n[0][0],e=+n[1][0];a=+n[0][1],i=+n[1][1];if(t>e)n=t,t=e,e=n;if(a>i)n=a,a=i,i=n;return m.precision(g)};m.step=function(e){if(!arguments.length)return m.stepMinor();return m.stepMajor(e).stepMinor(e)};m.stepMajor=function(e){if(!arguments.length)return[f,c];f=+e[0],c=+e[1];return m};m.stepMinor=function(e){if(!arguments.length)return[s,l];s=+e[0],l=+e[1];return m};m.precision=function(s){if(!arguments.length)return g;g=+s;d=BN(a,i,90);h=UN(t,e,g);p=BN(u,o,90);v=UN(r,n,g);return m};return m.extentMajor([[-180,-90+mj],[180,90-mj]]).extentMinor([[-180,-80-mj],[180,80+mj]])}function WN(e){return e}var HN=hj(),$N=hj(),GN,VN,YN,XN;var JN={point:Ij,lineStart:Ij,lineEnd:Ij,polygonStart:function(){JN.lineStart=ZN;JN.lineEnd=eT},polygonEnd:function(){JN.lineStart=JN.lineEnd=JN.point=Ij;HN.add(Oj($N));$N.reset()},result:function(){var e=HN/2;HN.reset();return e}};function ZN(){JN.point=QN}function QN(e,t){JN.point=KN;GN=YN=e,VN=XN=t}function KN(e,t){$N.add(XN*e-YN*t);YN=e,XN=t}function eT(){KN(GN,VN)}var tT=Infinity,nT=tT,rT=-tT,iT=rT;var aT={point:oT,lineStart:Ij,lineEnd:Ij,polygonStart:Ij,polygonEnd:Ij,result:function(){var e=[[tT,nT],[rT,iT]];rT=iT=-(nT=tT=Infinity);return e}};function oT(e,t){if(e<tT)tT=e;if(e>rT)rT=e;if(t<nT)nT=t;if(t>iT)iT=t}var uT=0,sT=0,lT=0,fT=0,cT=0,dT=0,hT=0,pT=0,vT=0,gT,mT,yT,bT;var xT={point:_T,lineStart:wT,lineEnd:OT,polygonStart:function(){xT.lineStart=AT;xT.lineEnd=ST},polygonEnd:function(){xT.point=_T;xT.lineStart=wT;xT.lineEnd=OT},result:function(){var e=vT?[hT/vT,pT/vT]:dT?[fT/dT,cT/dT]:lT?[uT/lT,sT/lT]:[NaN,NaN];uT=sT=lT=fT=cT=dT=hT=pT=vT=0;return e}};function _T(e,t){uT+=e;sT+=t;++lT}function wT(){xT.point=kT}function kT(e,t){xT.point=ET;_T(yT=e,bT=t)}function ET(e,t){var n=e-yT,r=t-bT,i=zj(n*n+r*r);fT+=i*(yT+e)/2;cT+=i*(bT+t)/2;dT+=i;_T(yT=e,bT=t)}function OT(){xT.point=_T}function AT(){xT.point=DT}function ST(){CT(gT,mT)}function DT(e,t){xT.point=CT;_T(gT=yT=e,mT=bT=t)}function CT(e,t){var n=e-yT,r=t-bT,i=zj(n*n+r*r);fT+=i*(yT+e)/2;cT+=i*(bT+t)/2;dT+=i;i=bT*e-yT*t;hT+=i*(yT+e);pT+=i*(bT+t);vT+=i*3;_T(yT=e,bT=t)}function MT(e){this._context=e}MT.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._context.closePath();this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t);this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t);this._context.arc(e,t,this._radius,0,wj);break}}},result:Ij};var jT=hj(),FT,NT,TT,zT,RT;var PT={point:Ij,lineStart:function(){PT.point=LT},lineEnd:function(){if(FT)IT(NT,TT);PT.point=Ij},polygonStart:function(){FT=true},polygonEnd:function(){FT=null},result:function(){var e=+jT;jT.reset();return e}};function LT(e,t){PT.point=IT;NT=zT=e,TT=RT=t}function IT(e,t){zT-=e,RT-=t;jT.add(zj(zT*zT+RT*RT));zT=e,RT=t}function BT(){this._string=[]}BT.prototype={_radius:4.5,_circle:UT(4.5),pointRadius:function(e){if((e=+e)!==this._radius)this._radius=e,this._circle=null;return this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._string.push("Z");this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t);this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{if(this._circle==null)this._circle=UT(this._radius);this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");this._string=[];return e}else{return null}}};function UT(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function qT(e,t){var n=4.5,r,i;function a(e){if(e){if(typeof n==="function")i.pointRadius(+n.apply(this,arguments));$j(e,r(i))}return i.result()}a.area=function(e){$j(e,r(JN));return JN.result()};a.measure=function(e){$j(e,r(PT));return PT.result()};a.bounds=function(e){$j(e,r(aT));return aT.result()};a.centroid=function(e){$j(e,r(xT));return xT.result()};a.projection=function(t){return arguments.length?(r=t==null?(e=null,WN):(e=t).stream,a):e};a.context=function(e){if(!arguments.length)return t;i=e==null?(t=null,new BT):new MT(t=e);if(typeof n!=="function")i.pointRadius(n);return a};a.pointRadius=function(e){if(!arguments.length)return n;n=typeof e==="function"?e:(i.pointRadius(+e),+e);return a};return a.projection(e).context(t)}function WT(e){return function(t){var n=new HT;for(var r in e)n[r]=e[r];n.stream=t;return n}}function HT(){}HT.prototype={constructor:HT,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function $T(e,t,n){var r=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]);if(r!=null)e.clipExtent(null);$j(n,e.stream(aT));t(aT.result());if(r!=null)e.clipExtent(r);return e}function GT(e,t,n){return $T(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+t[0][0]+(r-a*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([o,u])}),n)}function VT(e,t,n){return GT(e,[[0,0],t],n)}function YT(e,t,n){return $T(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];e.scale(150*i).translate([a,o])}),n)}function XT(e,t,n){return $T(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,o])}),n)}var JT=16,ZT=Dj(30*Ej);function QT(e,t){return+t?ez(e,t):KT(e)}function KT(e){return WT({point:function(t,n){t=e(t,n);this.stream.point(t[0],t[1])}})}function ez(e,t){function n(r,i,a,o,u,s,l,f,c,d,h,p,v,g){var m=l-r,y=f-i,b=m*m+y*y;if(b>4*t&&v--){var x=o+d,_=u+h,w=s+p,k=zj(x*x+_*_+w*w),E=Lj(w/=k),O=Oj(Oj(w)-1)<mj||Oj(a-c)<mj?(a+c)/2:Sj(_,x),A=e(O,E),S=A[0],D=A[1],C=S-r,M=D-i,j=y*C-m*M;if(j*j/b>t||Oj((m*C+y*M)/b-.5)>.3||o*d+u*h+s*p<ZT){n(r,i,a,o,u,s,S,D,O,x/=k,_/=k,w,v,g);g.point(S,D);n(S,D,O,x,_,w,l,f,c,d,h,p,v,g)}}}return function(t){var r,i,a,o,u,s,l,f,c,d,h,p;var v={point:g,lineStart:m,lineEnd:b,polygonStart:function(){t.polygonStart();v.lineStart=x},polygonEnd:function(){t.polygonEnd();v.lineStart=m}};function g(n,r){n=e(n,r);t.point(n[0],n[1])}function m(){f=NaN;v.point=y;t.lineStart()}function y(r,i){var a=oF([r,i]),o=e(r,i);n(f,c,l,d,h,p,f=o[0],c=o[1],l=r,d=a[0],h=a[1],p=a[2],JT,t);t.point(f,c)}function b(){v.point=g;t.lineEnd()}function x(){m();v.point=_;v.lineEnd=w}function _(e,t){y(r=e,t),i=f,a=c,o=d,u=h,s=p;v.point=y}function w(){n(f,c,l,d,h,p,i,a,r,o,u,s,JT,t);v.lineEnd=b;b()}return v}}var tz=WT({point:function(e,t){this.stream.point(e*Ej,t*Ej)}});function nz(e){return WT({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function rz(e,t,n){function r(r,i){return[t+e*r,n-e*i]}r.invert=function(r,i){return[(r-t)/e,(n-i)/e]};return r}function iz(e,t,n,r){var i=Dj(r),a=Nj(r),o=i*e,u=a*e,s=i/e,l=a/e,f=(a*n-i*t)/e,c=(a*t+i*n)/e;function d(e,r){return[o*e-u*r+t,n-u*e-o*r]}d.invert=function(e,t){return[s*e-l*t+f,c-l*e-s*t]};return d}function az(e){return oz((function(){return e}))()}function oz(e){var t,n=150,r=480,i=250,a=0,o=0,u=0,s=0,l=0,f,c=0,d=null,h=jN,p=null,v,g,m,y=WN,b=.5,x,_,w,k,E;function O(e){return w(e[0]*Ej,e[1]*Ej)}function A(e){e=w.invert(e[0],e[1]);return e&&[e[0]*kj,e[1]*kj]}O.stream=function(e){return k&&E===e?k:k=tz(nz(f)(h(x(y(E=e)))))};O.preclip=function(e){return arguments.length?(h=e,d=undefined,D()):h};O.postclip=function(e){return arguments.length?(y=e,p=v=g=m=null,D()):y};O.clipAngle=function(e){return arguments.length?(h=+e?zN(d=e*Ej):(d=null,jN),D()):d*kj};O.clipExtent=function(e){return arguments.length?(y=e==null?(p=v=g=m=null,WN):IN(p=+e[0][0],v=+e[0][1],g=+e[1][0],m=+e[1][1]),D()):p==null?null:[[p,v],[g,m]]};O.scale=function(e){return arguments.length?(n=+e,S()):n};O.translate=function(e){return arguments.length?(r=+e[0],i=+e[1],S()):[r,i]};O.center=function(e){return arguments.length?(a=e[0]%360*Ej,o=e[1]%360*Ej,S()):[a*kj,o*kj]};O.rotate=function(e){return arguments.length?(u=e[0]%360*Ej,s=e[1]%360*Ej,l=e.length>2?e[2]%360*Ej:0,S()):[u*kj,s*kj,l*kj]};O.angle=function(e){return arguments.length?(c=e%360*Ej,S()):c*kj};O.precision=function(e){return arguments.length?(x=QT(_,b=e*e),D()):zj(b)};O.fitExtent=function(e,t){return GT(O,e,t)};O.fitSize=function(e,t){return VT(O,e,t)};O.fitWidth=function(e,t){return YT(O,e,t)};O.fitHeight=function(e,t){return XT(O,e,t)};function S(){var e=iz(n,0,0,c).apply(null,t(a,o)),d=(c?iz:rz)(n,r-e[0],i-e[1],c);f=cN(u,s,l);_=lN(t,d);w=lN(f,_);x=QT(_,b);return D()}function D(){k=E=null;return O}return function(){t=e.apply(this,arguments);O.invert=t.invert&&A;return S()}}function uz(e){var t=0,n=bj/3,r=oz(e),i=r(t,n);i.parallels=function(e){return arguments.length?r(t=e[0]*Ej,n=e[1]*Ej):[t*kj,n*kj]};return i}function sz(e){var t=Dj(e);function n(e,n){return[e*t,Nj(n)/t]}n.invert=function(e,n){return[e/t,Lj(n*t)]};return n}function lz(e,t){var n=Nj(e),r=(n+Nj(t))/2;if(Oj(r)<mj)return sz(e);var i=1+n*(2*r-n),a=zj(i)/r;function o(e,t){var n=zj(i-2*r*Nj(t))/r;return[n*Nj(e*=r),a-n*Dj(e)]}o.invert=function(e,t){var n=a-t;return[Sj(e,Oj(n))/r*Tj(n),Lj((i-(e*e+n*n)*r*r)/(2*r))]};return o}function fz(){return uz(lz).scale(155.424).center([0,33.6442])}function cz(){return fz().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function dz(e){var t=e.length;return{point:function(n,r){var i=-1;while(++i<t)e[i].point(n,r)},sphere:function(){var n=-1;while(++n<t)e[n].sphere()},lineStart:function(){var n=-1;while(++n<t)e[n].lineStart()},lineEnd:function(){var n=-1;while(++n<t)e[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<t)e[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<t)e[n].polygonEnd()}}}function hz(){var e,t,n=cz(),r,i=fz().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=fz().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,s,l={point:function(e,t){s=[e,t]}};function f(e){var t=e[0],n=e[1];return s=null,(r.point(t,n),s)||(a.point(t,n),s)||(u.point(t,n),s)}f.invert=function(e){var t=n.scale(),r=n.translate(),a=(e[0]-r[0])/t,u=(e[1]-r[1])/t;return(u>=.12&&u<.234&&a>=-.425&&a<-.214?i:u>=.166&&u<.234&&a>=-.214&&a<-.115?o:n).invert(e)};f.stream=function(r){return e&&t===r?e:e=dz([n.stream(t=r),i.stream(r),o.stream(r)])};f.precision=function(e){if(!arguments.length)return n.precision();n.precision(e),i.precision(e),o.precision(e);return c()};f.scale=function(e){if(!arguments.length)return n.scale();n.scale(e),i.scale(e*.35),o.scale(e);return f.translate(n.translate())};f.translate=function(e){if(!arguments.length)return n.translate();var t=n.scale(),s=+e[0],f=+e[1];r=n.translate(e).clipExtent([[s-.455*t,f-.238*t],[s+.455*t,f+.238*t]]).stream(l);a=i.translate([s-.307*t,f+.201*t]).clipExtent([[s-.425*t+mj,f+.12*t+mj],[s-.214*t-mj,f+.234*t-mj]]).stream(l);u=o.translate([s-.205*t,f+.212*t]).clipExtent([[s-.214*t+mj,f+.166*t+mj],[s-.115*t-mj,f+.234*t-mj]]).stream(l);return c()};f.fitExtent=function(e,t){return GT(f,e,t)};f.fitSize=function(e,t){return VT(f,e,t)};f.fitWidth=function(e,t){return YT(f,e,t)};f.fitHeight=function(e,t){return XT(f,e,t)};function c(){e=t=null;return f}return f.scale(1070)}function pz(e){return function(t,n){var r=Dj(t),i=Dj(n),a=e(r*i);return[a*i*Nj(t),a*Nj(n)]}}function vz(e){return function(t,n){var r=zj(t*t+n*n),i=e(r),a=Nj(i),o=Dj(i);return[Sj(t*a,r*o),Lj(r&&n*a/r)]}}var gz=pz((function(e){return zj(2/(1+e))}));gz.invert=vz((function(e){return 2*Lj(e/2)}));function mz(){return az(gz).scale(124.75).clipAngle(180-.001)}var yz=pz((function(e){return(e=Pj(e))&&e/Nj(e)}));yz.invert=vz((function(e){return e}));function bz(){return az(yz).scale(79.4188).clipAngle(180-.001)}function xz(e,t){return[e,jj(Rj((xj+t)/2))]}xz.invert=function(e,t){return[e,2*Aj(Mj(t))-xj]};function _z(){return wz(xz).scale(961/wj)}function wz(e){var t=az(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,u,s,l;t.scale=function(e){return arguments.length?(r(e),f()):r()};t.translate=function(e){return arguments.length?(i(e),f()):i()};t.center=function(e){return arguments.length?(n(e),f()):n()};t.clipExtent=function(e){return arguments.length?(e==null?o=u=s=l=null:(o=+e[0][0],u=+e[0][1],s=+e[1][0],l=+e[1][1]),f()):o==null?null:[[o,u],[s,l]]};function f(){var n=bj*r(),i=t(vN(t.rotate()).invert([0,0]));return a(o==null?[[i[0]-n,i[1]-n],[i[0]+n,i[1]+n]]:e===xz?[[Math.max(i[0]-n,o),u],[Math.min(i[0]+n,s),l]]:[[o,Math.max(i[1]-n,u)],[s,Math.min(i[1]+n,l)]])}return f()}function kz(e){return Rj((xj+e)/2)}function Ez(e,t){var n=Dj(e),r=e===t?Nj(e):jj(n/Dj(t))/jj(kz(t)/kz(e)),i=n*Fj(kz(e),r)/r;if(!r)return xz;function a(e,t){if(i>0){if(t<-xj+mj)t=-xj+mj}else{if(t>xj-mj)t=xj-mj}var n=i/Fj(kz(t),r);return[n*Nj(r*e),i-n*Dj(r*e)]}a.invert=function(e,t){var n=i-t,a=Tj(r)*zj(e*e+n*n);return[Sj(e,Oj(n))/r*Tj(n),2*Aj(Fj(i/a,1/r))-xj]};return a}function Oz(){return uz(Ez).scale(109.5).parallels([30,30])}function Az(e,t){return[e,t]}Az.invert=Az;function Sz(){return az(Az).scale(152.63)}function Dz(e,t){var n=Dj(e),r=e===t?Nj(e):(n-Dj(t))/(t-e),i=n/r+e;if(Oj(r)<mj)return Az;function a(e,t){var n=i-t,a=r*e;return[n*Nj(a),i-n*Dj(a)]}a.invert=function(e,t){var n=i-t;return[Sj(e,Oj(n))/r*Tj(n),i-Tj(r)*zj(e*e+n*n)]};return a}function Cz(){return uz(Dz).scale(131.154).center([0,13.9389])}var Mz=1.340264,jz=-.081106,Fz=893e-6,Nz=.003796,Tz=zj(3)/2,zz=12;function Rz(e,t){var n=Lj(Tz*Nj(t)),r=n*n,i=r*r*r;return[e*Dj(n)/(Tz*(Mz+3*jz*r+i*(7*Fz+9*Nz*r))),n*(Mz+jz*r+i*(Fz+Nz*r))]}Rz.invert=function(e,t){var n=t,r=n*n,i=r*r*r;for(var a=0,o,u,s;a<zz;++a){u=n*(Mz+jz*r+i*(Fz+Nz*r))-t;s=Mz+3*jz*r+i*(7*Fz+9*Nz*r);n-=o=u/s,r=n*n,i=r*r*r;if(Oj(o)<yj)break}return[Tz*e*(Mz+3*jz*r+i*(7*Fz+9*Nz*r))/Dj(n),Lj(Nj(n)/Tz)]};function Pz(){return az(Rz).scale(177.158)}function Lz(e,t){var n=Dj(t),r=Dj(e)*n;return[n*Nj(e)/r,Nj(t)/r]}Lz.invert=vz(Aj);function Iz(){return az(Lz).scale(144.049).clipAngle(60)}function Bz(e,t,n,r){return e===1&&t===1&&n===0&&r===0?WN:WT({point:function(i,a){this.stream.point(i*e+n,a*t+r)}})}function Uz(){var e=1,t=0,n=0,r=1,i=1,a=WN,o=null,u,s,l,f=WN,c,d,h;function p(){c=d=null;return h}return h={stream:function(e){return c&&d===e?c:c=a(f(d=e))},postclip:function(e){return arguments.length?(f=e,o=u=s=l=null,p()):f},clipExtent:function(e){return arguments.length?(f=e==null?(o=u=s=l=null,WN):IN(o=+e[0][0],u=+e[0][1],s=+e[1][0],l=+e[1][1]),p()):o==null?null:[[o,u],[s,l]]},scale:function(o){return arguments.length?(a=Bz((e=+o)*r,e*i,t,n),p()):e},translate:function(o){return arguments.length?(a=Bz(e*r,e*i,t=+o[0],n=+o[1]),p()):[t,n]},reflectX:function(o){return arguments.length?(a=Bz(e*(r=o?-1:1),e*i,t,n),p()):r<0},reflectY:function(o){return arguments.length?(a=Bz(e*r,e*(i=o?-1:1),t,n),p()):i<0},fitExtent:function(e,t){return GT(h,e,t)},fitSize:function(e,t){return VT(h,e,t)},fitWidth:function(e,t){return YT(h,e,t)},fitHeight:function(e,t){return XT(h,e,t)}}}function qz(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}qz.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(Oj(i)>mj&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function Wz(){return az(qz).scale(175.295)}function Hz(e,t){return[Dj(t)*Nj(e),Nj(t)]}Hz.invert=vz(Lj);function $z(){return az(Hz).scale(249.5).clipAngle(90+mj)}function Gz(e,t){var n=Dj(t),r=1+Dj(e)*n;return[n*Nj(e)/r,Nj(t)/r]}Gz.invert=vz((function(e){return 2*Aj(e)}));function Vz(){return az(Gz).scale(250).clipAngle(142)}function Yz(e,t){return[jj(Rj((xj+t)/2)),-e]}Yz.invert=function(e,t){return[-t,2*Aj(Mj(e))-xj]};function Xz(){var e=wz(Yz),t=e.center,n=e.rotate;e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])};return n([0,0,90]).scale(159.155)}var Jz=Math.abs;var Zz=Math.cos;var Qz=Math.sin;var Kz=1e-6;var eR=Math.PI;var tR=eR/2;var nR=iR(2);function rR(e){return e>1?tR:e<-1?-tR:Math.asin(e)}function iR(e){return e>0?Math.sqrt(e):0}function aR(e,t){var n=e*Qz(t),r=30,i;do{t-=i=(t+Qz(t)-n)/(1+Zz(t))}while(Jz(i)>Kz&&--r>0);return t/2}function oR(e,t,n){function r(r,i){return[e*r*Zz(i=aR(n,i)),t*Qz(i)]}r.invert=function(r,i){return i=rR(i/t),[r/(e*Zz(i)),rR((2*i+Qz(2*i))/n)]};return r}var uR=oR(nR/tR,nR,eR);function sR(){return az(uR).scale(169.529)}var lR=qT();var fR=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function cR(e,t){return function n(){var r=t();r.type=e;r.path=qT().projection(r);r.copy=r.copy||function(){var e=n();fR.forEach((function(t){if(r[t])e[t](r[t]())}));e.path.pointRadius(r.path.pointRadius());return e};return r}}function dR(e,t){if(!e||typeof e!=="string"){throw new Error("Projection type must be a name string.")}e=e.toLowerCase();if(arguments.length>1){pR[e]=cR(e,t);return this}else{return pR[e]||null}}function hR(e){return e&&e.path||lR}var pR={albers:cz,albersusa:hz,azimuthalequalarea:mz,azimuthalequidistant:bz,conicconformal:Oz,conicequalarea:fz,conicequidistant:Cz,equalEarth:Pz,equirectangular:Sz,gnomonic:Iz,identity:Uz,mercator:_z,mollweide:sR,naturalEarth1:Wz,orthographic:$z,stereographic:Vz,transversemercator:Xz};for(var vR in pR){dR(vR,pR[vR])}function gR(e){af.call(this,null,e)}gR.Definition={type:"GeoPath",metadata:{modifies:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"path"}]};var mR=aa(gR,af);mR.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||fi,a=e.as||"path",o=n.SOURCE;function u(e){e[a]=r(i(e))}if(!r||e.modified()){this.value=r=hR(e.projection);n.materialize().reflow()}else{o=i===fi||t.modified(i.fields)?n.ADD_MOD:n.ADD}var s=yR(r,e.pointRadius);n.visit(o,u);r.pointRadius(s);return n.modifies(a)};function yR(e,t){var n=e.pointRadius();e.context(null);if(t!=null){e.pointRadius(t)}return n}function bR(e){af.call(this,null,e)}bR.Definition={type:"GeoPoint",metadata:{modifies:true},params:[{name:"projection",type:"projection",required:true},{name:"fields",type:"field",array:true,required:true,length:2},{name:"as",type:"string",array:true,length:2,default:["x","y"]}]};var xR=aa(bR,af);xR.transform=function(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],u=a[1],s;function l(e){var t=n([r(e),i(e)]);if(t){e[o]=t[0];e[u]=t[1]}else{e[o]=undefined;e[u]=undefined}}if(e.modified()){t=t.materialize().reflow(true).visit(t.SOURCE,l)}else{s=t.modified(r.fields)||t.modified(i.fields);t.visit(s?t.ADD_MOD:t.ADD,l)}return t.modifies(a)};function _R(e){af.call(this,null,e)}_R.Definition={type:"GeoShape",metadata:{modifies:true,nomod:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"shape"}]};var wR=aa(_R,af);wR.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;if(!r||e.modified()){this.value=r=kR(hR(e.projection),e.field||ui("datum"),e.pointRadius);n.materialize().reflow();a=n.SOURCE}n.visit(a,(function(e){e[i]=r}));return n.modifies(i)};function kR(e,t,n){var r=n==null?function(n){return e(t(n))}:function(r){var i=e.pointRadius(),a=e.pointRadius(n)(t(r));e.pointRadius(i);return a};r.context=function(t){e.context(t);return r};return r}function ER(e){af.call(this,[],e);this.generator=qN()}ER.Definition={type:"Graticule",metadata:{changes:true,generates:true},params:[{name:"extent",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMajor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMinor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"step",type:"number",array:true,length:2},{name:"stepMajor",type:"number",array:true,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:true,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};var OR=aa(ER,af);OR.transform=function(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified()){for(var a in e){if(Vi(r[a])){r[a](e[a])}}}i=r();if(n.length){t.mod.push(Ra(n[0],i))}else{t.add.push(Na(i))}n[0]=i;return t};function AR(e){af.call(this,null,e)}AR.Definition={type:"heatmap",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:true},{name:"opacity",type:"number",expr:true},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};var SR=aa(AR,af);SR.transform=function(e,t){if(!t.changed()&&!e.modified()){return t.StopPropagation}var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||fi,a=CR(e.opacity,e),o=DR(e.color,e),u=e.as||"image",s={$x:0,$y:0,$value:0,$max:r?Rf(n.map((function(e){return Rf(i(e).values)}))):0};n.forEach((function(e){var t=i(e);var n=Zi({},e,s);if(!r)n.$max=Rf(t.values||[]);e[u]=jR(t,n,o.dep?o:Xi(o(n)),a.dep?a:Xi(a(n)))}));return t.reflow(true).modifies(u)};function DR(e,t){var n;if(Vi(e)){n=function(n){return YE(e(n,t))};n.dep=MR(e)}else{n=Xi(YE(e||"#888"))}return n}function CR(e,t){var n;if(Vi(e)){n=function(n){return e(n,t)};n.dep=MR(e)}else if(e){n=Xi(e)}else{n=function(e){return e.$value/e.$max||0};n.dep=true}return n}function MR(e){if(!Vi(e))return false;var t=ka(ei(e));return t.$x||t.$y||t.$value||t.$max}function jR(e,t,n,r){var i=e.width,a=e.height,o=e.x1||0,u=e.y1||0,s=e.x2||i,l=e.y2||a,f=e.values,c=f?function(e){return f[e]}:ci,d=ag(s-o,l-u),h=d.getContext("2d"),p=h.getImageData(0,0,s-o,l-u),v=p.data;for(var g=u,m=0;g<l;++g){t.$y=g-u;for(var y=o,b=g*i;y<s;++y,m+=4){t.$x=y-o;t.$value=c(y+b);var x=n(t);v[m+0]=x.r;v[m+1]=x.g;v[m+2]=x.b;v[m+3]=~~(255*r(t))}}h.putImageData(p,0,0);return d}function FR(e){af.call(this,null,e);this.modified(true)}var NR=aa(FR,af);NR.transform=function(e,t){var n=this.value;if(!n||e.modified("type")){this.value=n=zR(e.type);fR.forEach((function(t){if(e[t]!=null)RR(n,t,e[t])}))}else{fR.forEach((function(t){if(e.modified(t))RR(n,t,e[t])}))}if(e.pointRadius!=null)n.path.pointRadius(e.pointRadius);if(e.fit)TR(n,e);return t.fork(t.NO_SOURCE|t.NO_FIELDS)};function TR(e,t){var n=PR(t.fit);t.extent?e.fitExtent(t.extent,n):t.size?e.fitSize(t.size,n):0}function zR(e){var t=dR((e||"mercator").toLowerCase());if(!t)ti("Unrecognized projection type: "+e);return t()}function RR(e,t,n){if(Vi(e[t]))e[t](n)}function PR(e){e=$i(e);return e.length===1?e[0]:{type:lj,features:e.reduce((function(e,t){return e.concat(LR(t))}),[])}}function LR(e){return e.type===lj?e.features:$i(e).filter((function(e){return e!=null})).map((function(e){return e.type===sj?e:{type:sj,geometry:e}}))}var IR=Object.freeze({__proto__:null,contour:oj,geojson:cj,geopath:gR,geopoint:bR,geoshape:_R,graticule:ER,heatmap:AR,isocontour:$M,kde2d:tj,projection:FR});function BR(e,t){var n;if(e==null)e=0;if(t==null)t=0;function r(){var r,i=n.length,a,o=0,u=0;for(r=0;r<i;++r){a=n[r],o+=a.x,u+=a.y}for(o=o/i-e,u=u/i-t,r=0;r<i;++r){a=n[r],a.x-=o,a.y-=u}}r.initialize=function(e){n=e};r.x=function(t){return arguments.length?(e=+t,r):e};r.y=function(e){return arguments.length?(t=+e,r):t};return r}function UR(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return qR(this.cover(t,n),t,n,e)}function qR(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},u=e._x0,s=e._y0,l=e._x1,f=e._y1,c,d,h,p,v,g,m,y;if(!a)return e._root=o,e;while(a.length){if(v=t>=(c=(u+l)/2))u=c;else l=c;if(g=n>=(d=(s+f)/2))s=d;else f=d;if(i=a,!(a=a[m=g<<1|v]))return i[m]=o,e}h=+e._x.call(null,a.data);p=+e._y.call(null,a.data);if(t===h&&n===p)return o.next=a,i?i[m]=o:e._root=o,e;do{i=i?i[m]=new Array(4):e._root=new Array(4);if(v=t>=(c=(u+l)/2))u=c;else l=c;if(g=n>=(d=(s+f)/2))s=d;else f=d}while((m=g<<1|v)===(y=(p>=d)<<1|h>=c));return i[y]=a,i[m]=o,e}function WR(e){var t,n,r=e.length,i,a,o=new Array(r),u=new Array(r),s=Infinity,l=Infinity,f=-Infinity,c=-Infinity;for(n=0;n<r;++n){if(isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t)))continue;o[n]=i;u[n]=a;if(i<s)s=i;if(i>f)f=i;if(a<l)l=a;if(a>c)c=a}if(s>f||l>c)return this;this.cover(s,l).cover(f,c);for(n=0;n<r;++n){qR(this,o[n],u[n],e[n])}return this}function HR(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n)){i=(n=Math.floor(e))+1;a=(r=Math.floor(t))+1}else{var o=i-n,u=this._root,s,l;while(n>e||e>=i||r>t||t>=a){l=(t<r)<<1|e<n;s=new Array(4),s[l]=u,u=s,o*=2;switch(l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}}if(this._root&&this._root.length)this._root=u}this._x0=n;this._y0=r;this._x1=i;this._y1=a;return this}function $R(){var e=[];this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}));return e}function GR(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]}function VR(e,t,n,r,i){this.node=e;this.x0=t;this.y0=n;this.x1=r;this.y1=i}function YR(e,t,n){var r,i=this._x0,a=this._y0,o,u,s,l,f=this._x1,c=this._y1,d=[],h=this._root,p,v;if(h)d.push(new VR(h,i,a,f,c));if(n==null)n=Infinity;else{i=e-n,a=t-n;f=e+n,c=t+n;n*=n}while(p=d.pop()){if(!(h=p.node)||(o=p.x0)>f||(u=p.y0)>c||(s=p.x1)<i||(l=p.y1)<a)continue;if(h.length){var g=(o+s)/2,m=(u+l)/2;d.push(new VR(h[3],g,m,s,l),new VR(h[2],o,m,g,l),new VR(h[1],g,u,s,m),new VR(h[0],o,u,g,m));if(v=(t>=m)<<1|e>=g){p=d[d.length-1];d[d.length-1]=d[d.length-1-v];d[d.length-1-v]=p}}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=y*y+b*b;if(x<n){var _=Math.sqrt(n=x);i=e-_,a=t-_;f=e+_,c=t+_;r=h.data}}}return r}function XR(e){if(isNaN(f=+this._x.call(null,e))||isNaN(c=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,u=this._y0,s=this._x1,l=this._y1,f,c,d,h,p,v,g,m;if(!n)return this;if(n.length)while(true){if(p=f>=(d=(o+s)/2))o=d;else s=d;if(v=c>=(h=(u+l)/2))u=h;else l=h;if(!(t=n,n=n[g=v<<1|p]))return this;if(!n.length)break;if(t[g+1&3]||t[g+2&3]||t[g+3&3])r=t,m=g}while(n.data!==e)if(!(i=n,n=n.next))return this;if(a=n.next)delete n.next;if(i)return a?i.next=a:delete i.next,this;if(!t)return this._root=a,this;a?t[g]=a:delete t[g];if((n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length){if(r)r[m]=n;else this._root=n}return this}function JR(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function ZR(){return this._root}function QR(){var e=0;this.visit((function(t){if(!t.length)do{++e}while(t=t.next)}));return e}function KR(e){var t=[],n,r=this._root,i,a,o,u,s;if(r)t.push(new VR(r,this._x0,this._y0,this._x1,this._y1));while(n=t.pop()){if(!e(r=n.node,a=n.x0,o=n.y0,u=n.x1,s=n.y1)&&r.length){var l=(a+u)/2,f=(o+s)/2;if(i=r[3])t.push(new VR(i,l,f,u,s));if(i=r[2])t.push(new VR(i,a,f,l,s));if(i=r[1])t.push(new VR(i,l,o,u,f));if(i=r[0])t.push(new VR(i,a,o,l,f))}}return this}function eP(e){var t=[],n=[],r;if(this._root)t.push(new VR(this._root,this._x0,this._y0,this._x1,this._y1));while(r=t.pop()){var i=r.node;if(i.length){var a,o=r.x0,u=r.y0,s=r.x1,l=r.y1,f=(o+s)/2,c=(u+l)/2;if(a=i[0])t.push(new VR(a,o,u,f,c));if(a=i[1])t.push(new VR(a,f,u,s,c));if(a=i[2])t.push(new VR(a,o,c,f,l));if(a=i[3])t.push(new VR(a,f,c,s,l))}n.push(r)}while(r=n.pop()){e(r.node,r.x0,r.y0,r.x1,r.y1)}return this}function tP(e){return e[0]}function nP(e){return arguments.length?(this._x=e,this):this._x}function rP(e){return e[1]}function iP(e){return arguments.length?(this._y=e,this):this._y}function aP(e,t,n){var r=new oP(t==null?tP:t,n==null?rP:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function oP(e,t,n,r,i,a){this._x=e;this._y=t;this._x0=n;this._y0=r;this._x1=i;this._y1=a;this._root=undefined}function uP(e){var t={data:e.data},n=t;while(e=e.next)n=n.next={data:e.data};return t}var sP=aP.prototype=oP.prototype;sP.copy=function(){var e=new oP(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=uP(t),e;n=[{source:t,target:e._root=new Array(4)}];while(t=n.pop()){for(var i=0;i<4;++i){if(r=t.source[i]){if(r.length)n.push({source:r,target:t.target[i]=new Array(4)});else t.target[i]=uP(r)}}}return e};sP.add=UR;sP.addAll=WR;sP.cover=HR;sP.data=$R;sP.extent=GR;sP.find=YR;sP.remove=XR;sP.removeAll=JR;sP.root=ZR;sP.size=QR;sP.visit=KR;sP.visitAfter=eP;sP.x=nP;sP.y=iP;function lP(e){return function(){return e}}function fP(){return(Math.random()-.5)*1e-6}function cP(e){return e.x+e.vx}function dP(e){return e.y+e.vy}function hP(e){var t,n,r=1,i=1;if(typeof e!=="function")e=lP(e==null?1:+e);function a(){var e,a=t.length,u,s,l,f,c,d;for(var h=0;h<i;++h){u=aP(t,cP,dP).visitAfter(o);for(e=0;e<a;++e){s=t[e];c=n[s.index],d=c*c;l=s.x+s.vx;f=s.y+s.vy;u.visit(p)}}function p(e,t,n,i,a){var o=e.data,u=e.r,h=c+u;if(o){if(o.index>s.index){var p=l-o.x-o.vx,v=f-o.y-o.vy,g=p*p+v*v;if(g<h*h){if(p===0)p=fP(),g+=p*p;if(v===0)v=fP(),g+=v*v;g=(h-(g=Math.sqrt(g)))/g*r;s.vx+=(p*=g)*(h=(u*=u)/(d+u));s.vy+=(v*=g)*h;o.vx-=p*(h=1-h);o.vy-=v*h}}return}return t>l+h||i<l-h||n>f+h||a<f-h}}function o(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t){if(e[t]&&e[t].r>e.r){e.r=e[t].r}}}function u(){if(!t)return;var r,i=t.length,a;n=new Array(i);for(r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}a.initialize=function(e){t=e;u()};a.iterations=function(e){return arguments.length?(i=+e,a):i};a.strength=function(e){return arguments.length?(r=+e,a):r};a.radius=function(t){return arguments.length?(e=typeof t==="function"?t:lP(+t),u(),a):e};return a}function pP(e){return e.index}function vP(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function gP(e){var t=pP,n=f,r,i=lP(30),a,o,u,s,l=1;if(e==null)e=[];function f(e){return 1/Math.min(u[e.source.index],u[e.target.index])}function c(t){for(var n=0,i=e.length;n<l;++n){for(var o=0,u,f,c,d,h,p,v;o<i;++o){u=e[o],f=u.source,c=u.target;d=c.x+c.vx-f.x-f.vx||fP();h=c.y+c.vy-f.y-f.vy||fP();p=Math.sqrt(d*d+h*h);p=(p-a[o])/p*t*r[o];d*=p,h*=p;c.vx-=d*(v=s[o]);c.vy-=h*v;f.vx+=d*(v=1-v);f.vy+=h*v}}}function d(){if(!o)return;var n,i=o.length,l=e.length,f=new Map(o.map((function(e,n){return[t(e,n,o),e]}))),c;for(n=0,u=new Array(i);n<l;++n){c=e[n],c.index=n;if(typeof c.source!=="object")c.source=vP(f,c.source);if(typeof c.target!=="object")c.target=vP(f,c.target);u[c.source.index]=(u[c.source.index]||0)+1;u[c.target.index]=(u[c.target.index]||0)+1}for(n=0,s=new Array(l);n<l;++n){c=e[n],s[n]=u[c.source.index]/(u[c.source.index]+u[c.target.index])}r=new Array(l),h();a=new Array(l),p()}function h(){if(!o)return;for(var t=0,i=e.length;t<i;++t){r[t]=+n(e[t],t,e)}}function p(){if(!o)return;for(var t=0,n=e.length;t<n;++t){a[t]=+i(e[t],t,e)}}c.initialize=function(e){o=e;d()};c.links=function(t){return arguments.length?(e=t,d(),c):e};c.id=function(e){return arguments.length?(t=e,c):t};c.iterations=function(e){return arguments.length?(l=+e,c):l};c.strength=function(e){return arguments.length?(n=typeof e==="function"?e:lP(+e),h(),c):n};c.distance=function(e){return arguments.length?(i=typeof e==="function"?e:lP(+e),p(),c):i};return c}var mP={value:function(){}};function yP(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new bP(n)}function bP(e){this._=e}function xP(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0)n=e.slice(r+1),e=e.slice(0,r);if(e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}bP.prototype=yP.prototype={constructor:bP,on:function(e,t){var n=this._,r=xP(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){while(++a<o)if((i=(e=r[a]).type)&&(i=_P(n[i],e.name)))return i;return}if(t!=null&&typeof t!=="function")throw new Error("invalid callback: "+t);while(++a<o){if(i=(e=r[a]).type)n[i]=wP(n[i],e.name,t);else if(t==null)for(i in n)n[i]=wP(n[i],e.name,null)}return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new bP(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function _P(e,t){for(var n=0,r=e.length,i;n<r;++n){if((i=e[n]).name===t){return i.value}}}function wP(e,t,n){for(var r=0,i=e.length;r<i;++r){if(e[r].name===t){e[r]=mP,e=e.slice(0,r).concat(e.slice(r+1));break}}if(n!=null)e.push({name:t,value:n});return e}var kP=0,EP=0,OP=0,AP=1e3,SP,DP,CP=0,MP=0,jP=0,FP=typeof performance==="object"&&performance.now?performance:Date,NP=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function TP(){return MP||(NP(zP),MP=FP.now()+jP)}function zP(){MP=0}function RP(){this._call=this._time=this._next=null}RP.prototype=PP.prototype={constructor:RP,restart:function(e,t,n){if(typeof e!=="function")throw new TypeError("callback is not a function");n=(n==null?TP():+n)+(t==null?0:+t);if(!this._next&&DP!==this){if(DP)DP._next=this;else SP=this;DP=this}this._call=e;this._time=n;qP()},stop:function(){if(this._call){this._call=null;this._time=Infinity;qP()}}};function PP(e,t,n){var r=new RP;r.restart(e,t,n);return r}function LP(){TP();++kP;var e=SP,t;while(e){if((t=MP-e._time)>=0)e._call.call(null,t);e=e._next}--kP}function IP(){MP=(CP=FP.now())+jP;kP=EP=0;try{LP()}finally{kP=0;UP();MP=0}}function BP(){var e=FP.now(),t=e-CP;if(t>AP)jP-=t,CP=e}function UP(){var e,t=SP,n,r=Infinity;while(t){if(t._call){if(r>t._time)r=t._time;e=t,t=t._next}else{n=t._next,t._next=null;t=e?e._next=n:SP=n}}DP=e;qP(r)}function qP(e){if(kP)return;if(EP)EP=clearTimeout(EP);var t=e-MP;if(t>24){if(e<Infinity)EP=setTimeout(IP,e-FP.now()-jP);if(OP)OP=clearInterval(OP)}else{if(!OP)CP=FP.now(),OP=setInterval(BP,AP);kP=1,NP(IP)}}function WP(e,t,n){var r=new RP,i=t;if(t==null)return r.restart(e,t,n),r;t=+t,n=n==null?TP():+n;r.restart((function a(o){o+=i;r.restart(a,i+=t,n);e(o)}),t,n);return r}function HP(e){return e.x}function $P(e){return e.y}var GP=10,VP=Math.PI*(3-Math.sqrt(5));function YP(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,u=new Map,s=PP(f),l=yP("tick","end");if(e==null)e=[];function f(){c();l.call("tick",t);if(n<r){s.stop();l.call("end",t)}}function c(r){var s,l=e.length,f;if(r===undefined)r=1;for(var c=0;c<r;++c){n+=(a-n)*i;u.forEach((function(e){e(n)}));for(s=0;s<l;++s){f=e[s];if(f.fx==null)f.x+=f.vx*=o;else f.x=f.fx,f.vx=0;if(f.fy==null)f.y+=f.vy*=o;else f.y=f.fy,f.vy=0}}return t}function d(){for(var t=0,n=e.length,r;t<n;++t){r=e[t],r.index=t;if(r.fx!=null)r.x=r.fx;if(r.fy!=null)r.y=r.fy;if(isNaN(r.x)||isNaN(r.y)){var i=GP*Math.sqrt(t),a=t*VP;r.x=i*Math.cos(a);r.y=i*Math.sin(a)}if(isNaN(r.vx)||isNaN(r.vy)){r.vx=r.vy=0}}}function h(t){if(t.initialize)t.initialize(e);return t}d();return t={tick:c,restart:function(){return s.restart(f),t},stop:function(){return s.stop(),t},nodes:function(n){return arguments.length?(e=n,d(),u.forEach(h),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(a=+e,t):a},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},force:function(e,n){return arguments.length>1?(n==null?u.delete(e):u.set(e,h(n)),t):u.get(e)},find:function(t,n,r){var i=0,a=e.length,o,u,s,l,f;if(r==null)r=Infinity;else r*=r;for(i=0;i<a;++i){l=e[i];o=t-l.x;u=n-l.y;s=o*o+u*u;if(s<r)f=l,r=s}return f},on:function(e,n){return arguments.length>1?(l.on(e,n),t):l.on(e)}}}function XP(){var e,t,n,r=lP(-30),i,a=1,o=Infinity,u=.81;function s(r){var i,a=e.length,o=aP(e,HP,$P).visitAfter(f);for(n=r,i=0;i<a;++i)t=e[i],o.visit(c)}function l(){if(!e)return;var t,n=e.length,a;i=new Array(n);for(t=0;t<n;++t)a=e[t],i[a.index]=+r(a,t,e)}function f(e){var t=0,n,r,a=0,o,u,s;if(e.length){for(o=u=s=0;s<4;++s){if((n=e[s])&&(r=Math.abs(n.value))){t+=n.value,a+=r,o+=r*n.x,u+=r*n.y}}e.x=o/a;e.y=u/a}else{n=e;n.x=n.data.x;n.y=n.data.y;do{t+=i[n.data.index]}while(n=n.next)}e.value=t}function c(e,r,s,l){if(!e.value)return true;var f=e.x-t.x,c=e.y-t.y,d=l-r,h=f*f+c*c;if(d*d/u<h){if(h<o){if(f===0)f=fP(),h+=f*f;if(c===0)c=fP(),h+=c*c;if(h<a)h=Math.sqrt(a*h);t.vx+=f*e.value*n/h;t.vy+=c*e.value*n/h}return true}else if(e.length||h>=o)return;if(e.data!==t||e.next){if(f===0)f=fP(),h+=f*f;if(c===0)c=fP(),h+=c*c;if(h<a)h=Math.sqrt(a*h)}do{if(e.data!==t){d=i[e.data.index]*n/h;t.vx+=f*d;t.vy+=c*d}}while(e=e.next)}s.initialize=function(t){e=t;l()};s.strength=function(e){return arguments.length?(r=typeof e==="function"?e:lP(+e),l(),s):r};s.distanceMin=function(e){return arguments.length?(a=e*e,s):Math.sqrt(a)};s.distanceMax=function(e){return arguments.length?(o=e*e,s):Math.sqrt(o)};s.theta=function(e){return arguments.length?(u=e*e,s):Math.sqrt(u)};return s}function JP(e){var t=lP(.1),n,r,i;if(typeof e!=="function")e=lP(e==null?0:+e);function a(e){for(var t=0,a=n.length,o;t<a;++t){o=n[t],o.vx+=(i[t]-o.x)*r[t]*e}}function o(){if(!n)return;var a,o=n.length;r=new Array(o);i=new Array(o);for(a=0;a<o;++a){r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}a.initialize=function(e){n=e;o()};a.strength=function(e){return arguments.length?(t=typeof e==="function"?e:lP(+e),o(),a):t};a.x=function(t){return arguments.length?(e=typeof t==="function"?t:lP(+t),o(),a):e};return a}function ZP(e){var t=lP(.1),n,r,i;if(typeof e!=="function")e=lP(e==null?0:+e);function a(e){for(var t=0,a=n.length,o;t<a;++t){o=n[t],o.vy+=(i[t]-o.y)*r[t]*e}}function o(){if(!n)return;var a,o=n.length;r=new Array(o);i=new Array(o);for(a=0;a<o;++a){r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}a.initialize=function(e){n=e;o()};a.strength=function(e){return arguments.length?(t=typeof e==="function"?e:lP(+e),o(),a):t};a.y=function(t){return arguments.length?(e=typeof t==="function"?t:lP(+t),o(),a):e};return a}var QP={center:BR,collide:hP,nbody:XP,link:gP,x:JP,y:ZP};var KP="forces",eL=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],tL=["static","iterations"],nL=["x","y","vx","vy"];function rL(e){af.call(this,null,e)}rL.Definition={type:"Force",metadata:{modifies:true},params:[{name:"static",type:"boolean",default:false},{name:"restart",type:"boolean",default:false},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:true,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:true},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:true},{name:"strength",type:"number",expr:true},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:true,modify:false,default:nL}]};var iL=aa(rL,af);iL.transform=function(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(eL),a=e.iterations||300;if(!n){this.value=n=oL(t.source,e);n.on("tick",aL(t.dataflow,this));if(!e.static){r=true;n.tick()}t.modifies("index")}else{if(r){t.modifies("index");n.nodes(t.source)}if(i||t.changed(t.MOD)){uL(n,e,0,t)}}if(i||r||e.modified(tL)||t.changed()&&e.restart){n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a));if(e.static){for(n.stop();--a>=0;)n.tick()}else{if(n.stopped())n.restart();if(!r)return t.StopPropagation}}return this.finish(e,t)};iL.finish=function(e,t){var n=t.dataflow;for(var r=this._argops,i=0,a=r.length,o;i<a;++i){o=r[i];if(o.name!==KP||o.op._argval.force!=="link"){continue}for(var u=o.op._argops,s=0,l=u.length,f;s<l;++s){if(u[s].name==="links"&&(f=u[s].op.source)){n.pulse(f,n.changeset().reflow());break}}}return t.reflow(e.modified()).modifies(nL)};function aL(e,t){return function(){e.touch(t).run()}}function oL(e,t){var n=YP(e),r=false,i=n.stop,a=n.restart;n.stopped=function(){return r};n.restart=function(){r=false;return a()};n.stop=function(){r=true;return i()};return uL(n,t,true).on("end",(function(){r=true}))}function uL(e,t,n,r){var i=$i(t.forces),a,o,u,s;for(a=0,o=eL.length;a<o;++a){u=eL[a];if(u!==KP&&t.modified(u))e[u](t[u])}for(a=0,o=i.length;a<o;++a){s=KP+a;u=n||t.modified(KP,a)?lL(i[a]):r&&sL(i[a],r)?e.force(s):null;if(u)e.force(s,u)}for(o=e.numForces||0;a<o;++a){e.force(KP+a,null)}e.numForces=i.length;return e}function sL(e,t){var n,r;for(n in e){if(Vi(r=e[n])&&t.modified(ei(r)))return 1}return 0}function lL(e){var t,n;if(!ta(QP,e.force)){ti("Unrecognized force: "+e.force)}t=QP[e.force]();for(n in e){if(Vi(t[n]))fL(t[n],e[n],e)}return t}function fL(e,t,n){e(Vi(t)?function(e){return t(e,n)}:t)}var cL=Object.freeze({__proto__:null,force:rL});function dL(e,t,n){var r={};e.each((function(e){var i=e.data;if(n(i))r[t(i)]=e}));e.lookup=r;return e}function hL(e,t){return e.parent===t.parent?1:2}function pL(e){return e.reduce(vL,0)/e.length}function vL(e,t){return e+t.x}function gL(e){return 1+e.reduce(mL,0)}function mL(e,t){return Math.max(e,t.y)}function yL(e){var t;while(t=e.children)e=t[0];return e}function bL(e){var t;while(t=e.children)e=t[t.length-1];return e}function xL(){var e=hL,t=1,n=1,r=false;function i(i){var a,o=0;i.eachAfter((function(t){var n=t.children;if(n){t.x=pL(n);t.y=gL(n)}else{t.x=a?o+=e(t,a):0;t.y=0;a=t}}));var u=yL(i),s=bL(i),l=u.x-e(u,s)/2,f=s.x+e(s,u)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t;e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-l)/(f-l)*t;e.y=(1-(i.y?e.y/i.y:1))*n})}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i}function _L(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else while(--r>=0)t+=n[r].value;e.value=t}function wL(){return this.eachAfter(_L)}function kL(e){var t=this,n,r=[t],i,a,o;do{n=r.reverse(),r=[];while(t=n.pop()){e(t),i=t.children;if(i)for(a=0,o=i.length;a<o;++a){r.push(i[a])}}}while(r.length);return this}function EL(e){var t=this,n=[t],r,i;while(t=n.pop()){e(t),r=t.children;if(r)for(i=r.length-1;i>=0;--i){n.push(r[i])}}return this}function OL(e){var t=this,n=[t],r=[],i,a,o;while(t=n.pop()){r.push(t),i=t.children;if(i)for(a=0,o=i.length;a<o;++a){n.push(i[a])}}while(t=r.pop()){e(t)}return this}function AL(e){return this.eachAfter((function(t){var n=+e(t.data)||0,r=t.children,i=r&&r.length;while(--i>=0)n+=r[i].value;t.value=n}))}function SL(e){return this.eachBefore((function(t){if(t.children){t.children.sort(e)}}))}function DL(e){var t=this,n=CL(t,e),r=[t];while(t!==n){t=t.parent;r.push(t)}var i=r.length;while(e!==n){r.splice(i,0,e);e=e.parent}return r}function CL(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop();t=r.pop();while(e===t){i=e;e=n.pop();t=r.pop()}return i}function ML(){var e=this,t=[e];while(e=e.parent){t.push(e)}return t}function jL(){var e=[];this.each((function(t){e.push(t)}));return e}function FL(){var e=[];this.eachBefore((function(t){if(!t.children){e.push(t)}}));return e}function NL(){var e=this,t=[];e.each((function(n){if(n!==e){t.push({source:n.parent,target:n})}}));return t}function TL(e,t){var n=new IL(e),r=+e.value&&(n.value=e.value),i,a=[n],o,u,s,l;if(t==null)t=RL;while(i=a.pop()){if(r)i.value=+i.data.value;if((u=t(i.data))&&(l=u.length)){i.children=new Array(l);for(s=l-1;s>=0;--s){a.push(o=i.children[s]=new IL(u[s]));o.parent=i;o.depth=i.depth+1}}}return n.eachBefore(LL)}function zL(){return TL(this).eachBefore(PL)}function RL(e){return e.children}function PL(e){e.data=e.data.data}function LL(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function IL(e){this.data=e;this.depth=this.height=0;this.parent=null}IL.prototype=TL.prototype={constructor:IL,count:wL,each:kL,eachAfter:OL,eachBefore:EL,sum:AL,sort:SL,path:DL,ancestors:ML,descendants:jL,leaves:FL,links:NL,copy:zL};var BL=Array.prototype.slice;function UL(e){var t=e.length,n,r;while(t){r=Math.random()*t--|0;n=e[t];e[t]=e[r];e[r]=n}return e}function qL(e){var t=0,n=(e=UL(BL.call(e))).length,r=[],i,a;while(t<n){i=e[t];if(a&&$L(a,i))++t;else a=VL(r=WL(r,i)),t=0}return a}function WL(e,t){var n,r;if(GL(t,e))return[t];for(n=0;n<e.length;++n){if(HL(t,e[n])&&GL(XL(e[n],t),e)){return[e[n],t]}}for(n=0;n<e.length-1;++n){for(r=n+1;r<e.length;++r){if(HL(XL(e[n],e[r]),t)&&HL(XL(e[n],t),e[r])&&HL(XL(e[r],t),e[n])&&GL(JL(e[n],e[r],t),e)){return[e[n],e[r],t]}}}throw new Error}function HL(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function $L(e,t){var n=e.r-t.r+1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function GL(e,t){for(var n=0;n<t.length;++n){if(!$L(e,t[n])){return false}}return true}function VL(e){switch(e.length){case 1:return YL(e[0]);case 2:return XL(e[0],e[1]);case 3:return JL(e[0],e[1],e[2])}}function YL(e){return{x:e.x,y:e.y,r:e.r}}function XL(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,u=t.r,s=a-n,l=o-r,f=u-i,c=Math.sqrt(s*s+l*l);return{x:(n+a+s/c*f)/2,y:(r+o+l/c*f)/2,r:(c+i+u)/2}}function JL(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,u=t.y,s=t.r,l=n.x,f=n.y,c=n.r,d=r-o,h=r-l,p=i-u,v=i-f,g=s-a,m=c-a,y=r*r+i*i-a*a,b=y-o*o-u*u+s*s,x=y-l*l-f*f+c*c,_=h*p-d*v,w=(p*x-v*b)/(_*2)-r,k=(v*g-p*m)/_,E=(h*b-d*x)/(_*2)-i,O=(d*m-h*g)/_,A=k*k+O*O-1,S=2*(a+w*k+E*O),D=w*w+E*E-a*a,C=-(A?(S+Math.sqrt(S*S-4*A*D))/(2*A):D/S);return{x:r+w+k*C,y:i+E+O*C,r:C}}function ZL(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,u,s,l=r*r+o*o;if(l){a=t.r+n.r,a*=a;s=e.r+n.r,s*=s;if(a>s){i=(l+s-a)/(2*l);u=Math.sqrt(Math.max(0,s/l-i*i));n.x=e.x-i*r-u*o;n.y=e.y-i*o+u*r}else{i=(l+a-s)/(2*l);u=Math.sqrt(Math.max(0,a/l-i*i));n.x=t.x+i*r-u*o;n.y=t.y+i*o+u*r}}else{n.x=t.x+n.r;n.y=t.y}}function QL(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function KL(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function eI(e){this._=e;this.next=null;this.previous=null}function tI(e){if(!(i=e.length))return 0;var t,n,r,i,a,o,u,s,l,f,c;t=e[0],t.x=0,t.y=0;if(!(i>1))return t.r;n=e[1],t.x=-n.r,n.x=t.r,n.y=0;if(!(i>2))return t.r+n.r;ZL(n,t,r=e[2]);t=new eI(t),n=new eI(n),r=new eI(r);t.next=r.previous=n;n.next=t.previous=r;r.next=n.previous=t;e:for(u=3;u<i;++u){ZL(t._,n._,r=e[u]),r=new eI(r);s=n.next,l=t.previous,f=n._.r,c=t._.r;do{if(f<=c){if(QL(s._,r._)){n=s,t.next=n,n.previous=t,--u;continue e}f+=s._.r,s=s.next}else{if(QL(l._,r._)){t=l,t.next=n,n.previous=t,--u;continue e}c+=l._.r,l=l.previous}}while(s!==l.next);r.previous=t,r.next=n,t.next=n.previous=n=r;a=KL(t);while((r=r.next)!==n){if((o=KL(r))<a){t=r,a=o}}n=t.next}t=[n._],r=n;while((r=r.next)!==n)t.push(r._);r=qL(t);for(u=0;u<i;++u)t=e[u],t.x-=r.x,t.y-=r.y;return r.r}function nI(e){return e==null?null:rI(e)}function rI(e){if(typeof e!=="function")throw new Error;return e}function iI(){return 0}function aI(e){return function(){return e}}function oI(e){return Math.sqrt(e.value)}function uI(){var e=null,t=1,n=1,r=iI;function i(i){i.x=t/2,i.y=n/2;if(e){i.eachBefore(sI(e)).eachAfter(lI(r,.5)).eachBefore(fI(1))}else{i.eachBefore(sI(oI)).eachAfter(lI(iI,1)).eachAfter(lI(r,i.r/Math.min(t,n))).eachBefore(fI(Math.min(t,n)/(2*i.r)))}return i}i.radius=function(t){return arguments.length?(e=nI(t),i):e};i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]};i.padding=function(e){return arguments.length?(r=typeof e==="function"?e:aI(+e),i):r};return i}function sI(e){return function(t){if(!t.children){t.r=Math.max(0,+e(t)||0)}}}function lI(e,t){return function(n){if(r=n.children){var r,i,a=r.length,o=e(n)*t||0,u;if(o)for(i=0;i<a;++i)r[i].r+=o;u=tI(r);if(o)for(i=0;i<a;++i)r[i].r-=o;n.r=u+o}}}function fI(e){return function(t){var n=t.parent;t.r*=e;if(n){t.x=n.x+e*t.x;t.y=n.y+e*t.y}}}function cI(e){e.x0=Math.round(e.x0);e.y0=Math.round(e.y0);e.x1=Math.round(e.x1);e.y1=Math.round(e.y1)}function dI(e,t,n,r,i){var a=e.children,o,u=-1,s=a.length,l=e.value&&(r-t)/e.value;while(++u<s){o=a[u],o.y0=n,o.y1=i;o.x0=t,o.x1=t+=o.value*l}}function hI(){var e=1,t=1,n=0,r=false;function i(i){var o=i.height+1;i.x0=i.y0=n;i.x1=e;i.y1=t/o;i.eachBefore(a(t,o));if(r)i.eachBefore(cI);return i}function a(e,t){return function(r){if(r.children){dI(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t)}var i=r.x0,a=r.y0,o=r.x1-n,u=r.y1-n;if(o<i)i=o=(i+o)/2;if(u<a)a=u=(a+u)/2;r.x0=i;r.y0=a;r.x1=o;r.y1=u}}i.round=function(e){return arguments.length?(r=!!e,i):r};i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]};i.padding=function(e){return arguments.length?(n=+e,i):n};return i}var pI="$",vI={depth:-1},gI={};function mI(e){return e.id}function yI(e){return e.parentId}function bI(){var e=mI,t=yI;function n(n){var r,i,a=n.length,o,u,s,l=new Array(a),f,c,d={};for(i=0;i<a;++i){r=n[i],s=l[i]=new IL(r);if((f=e(r,i,n))!=null&&(f+="")){c=pI+(s.id=f);d[c]=c in d?gI:s}}for(i=0;i<a;++i){s=l[i],f=t(n[i],i,n);if(f==null||!(f+="")){if(o)throw new Error("multiple roots");o=s}else{u=d[pI+f];if(!u)throw new Error("missing: "+f);if(u===gI)throw new Error("ambiguous: "+f);if(u.children)u.children.push(s);else u.children=[s];s.parent=u}}if(!o)throw new Error("no root");o.parent=vI;o.eachBefore((function(e){e.depth=e.parent.depth+1;--a})).eachBefore(LL);o.parent=null;if(a>0)throw new Error("cycle");return o}n.id=function(t){return arguments.length?(e=rI(t),n):e};n.parentId=function(e){return arguments.length?(t=rI(e),n):t};return n}function xI(e,t){return e.parent===t.parent?1:2}function _I(e){var t=e.children;return t?t[0]:e.t}function wI(e){var t=e.children;return t?t[t.length-1]:e.t}function kI(e,t,n){var r=n/(t.i-e.i);t.c-=r;t.s+=n;e.c+=r;t.z+=n;t.m+=n}function EI(e){var t=0,n=0,r=e.children,i=r.length,a;while(--i>=0){a=r[i];a.z+=t;a.m+=t;t+=a.s+(n+=a.c)}}function OI(e,t,n){return e.a.parent===t.parent?e.a:n}function AI(e,t){this._=e;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=t}AI.prototype=Object.create(IL.prototype);function SI(e){var t=new AI(e,0),n,r=[t],i,a,o,u;while(n=r.pop()){if(a=n._.children){n.children=new Array(u=a.length);for(o=u-1;o>=0;--o){r.push(i=n.children[o]=new AI(a[o],o));i.parent=n}}}(t.parent=new AI(null,0)).children=[t];return t}function DI(){var e=xI,t=1,n=1,r=null;function i(i){var u=SI(i);u.eachAfter(a),u.parent.m=-u.z;u.eachBefore(o);if(r)i.eachBefore(s);else{var l=i,f=i,c=i;i.eachBefore((function(e){if(e.x<l.x)l=e;if(e.x>f.x)f=e;if(e.depth>c.depth)c=e}));var d=l===f?1:e(l,f)/2,h=d-l.x,p=t/(f.x+d+h),v=n/(c.depth||1);i.eachBefore((function(e){e.x=(e.x+h)*p;e.y=e.depth*v}))}return i}function a(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){EI(t);var a=(n[0].z+n[n.length-1].z)/2;if(i){t.z=i.z+e(t._,i._);t.m=t.z-a}else{t.z=a}}else if(i){t.z=i.z+e(t._,i._)}t.parent.A=u(t,i,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function u(t,n,r){if(n){var i=t,a=t,o=n,u=i.parent.children[0],s=i.m,l=a.m,f=o.m,c=u.m,d;while(o=wI(o),i=_I(i),o&&i){u=_I(u);a=wI(a);a.a=t;d=o.z+f-i.z-s+e(o._,i._);if(d>0){kI(OI(o,t,r),t,d);s+=d;l+=d}f+=o.m;s+=i.m;c+=u.m;l+=a.m}if(o&&!wI(a)){a.t=o;a.m+=f-l}if(i&&!_I(u)){u.t=i;u.m+=s-c;r=t}}return r}function s(e){e.x*=t;e.y=e.depth*n}i.separation=function(t){return arguments.length?(e=t,i):e};i.size=function(e){return arguments.length?(r=false,t=+e[0],n=+e[1],i):r?null:[t,n]};i.nodeSize=function(e){return arguments.length?(r=true,t=+e[0],n=+e[1],i):r?[t,n]:null};return i}function CI(e,t,n,r,i){var a=e.children,o,u=-1,s=a.length,l=e.value&&(i-n)/e.value;while(++u<s){o=a[u],o.x0=t,o.x1=r;o.y0=n,o.y1=n+=o.value*l}}var MI=(1+Math.sqrt(5))/2;function jI(e,t,n,r,i,a){var o=[],u=t.children,s,l,f=0,c=0,d=u.length,h,p,v=t.value,g,m,y,b,x,_,w;while(f<d){h=i-n,p=a-r;do{g=u[c++].value}while(!g&&c<d);m=y=g;_=Math.max(p/h,h/p)/(v*e);w=g*g*_;x=Math.max(y/w,w/m);for(;c<d;++c){g+=l=u[c].value;if(l<m)m=l;if(l>y)y=l;w=g*g*_;b=Math.max(y/w,w/m);if(b>x){g-=l;break}x=b}o.push(s={value:g,dice:h<p,children:u.slice(f,c)});if(s.dice)dI(s,n,r,i,v?r+=p*g/v:a);else CI(s,n,r,v?n+=h*g/v:i,a);v-=g,f=c}return o}var FI=function e(t){function n(e,n,r,i,a){jI(t,e,n,r,i,a)}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(MI);function NI(){var e=FI,t=false,n=1,r=1,i=[0],a=iI,o=iI,u=iI,s=iI,l=iI;function f(e){e.x0=e.y0=0;e.x1=n;e.y1=r;e.eachBefore(c);i=[0];if(t)e.eachBefore(cI);return e}function c(t){var n=i[t.depth],r=t.x0+n,f=t.y0+n,c=t.x1-n,d=t.y1-n;if(c<r)r=c=(r+c)/2;if(d<f)f=d=(f+d)/2;t.x0=r;t.y0=f;t.x1=c;t.y1=d;if(t.children){n=i[t.depth+1]=a(t)/2;r+=l(t)-n;f+=o(t)-n;c-=u(t)-n;d-=s(t)-n;if(c<r)r=c=(r+c)/2;if(d<f)f=d=(f+d)/2;e(t,r,f,c,d)}}f.round=function(e){return arguments.length?(t=!!e,f):t};f.size=function(e){return arguments.length?(n=+e[0],r=+e[1],f):[n,r]};f.tile=function(t){return arguments.length?(e=rI(t),f):e};f.padding=function(e){return arguments.length?f.paddingInner(e).paddingOuter(e):f.paddingInner()};f.paddingInner=function(e){return arguments.length?(a=typeof e==="function"?e:aI(+e),f):a};f.paddingOuter=function(e){return arguments.length?f.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):f.paddingTop()};f.paddingTop=function(e){return arguments.length?(o=typeof e==="function"?e:aI(+e),f):o};f.paddingRight=function(e){return arguments.length?(u=typeof e==="function"?e:aI(+e),f):u};f.paddingBottom=function(e){return arguments.length?(s=typeof e==="function"?e:aI(+e),f):s};f.paddingLeft=function(e){return arguments.length?(l=typeof e==="function"?e:aI(+e),f):l};return f}function TI(e,t,n,r,i){var a=e.children,o,u=a.length,s,l=new Array(u+1);for(l[0]=s=o=0;o<u;++o){l[o+1]=s+=a[o].value}f(0,u,e.value,t,n,r,i);function f(e,t,n,r,i,o,u){if(e>=t-1){var s=a[e];s.x0=r,s.y0=i;s.x1=o,s.y1=u;return}var c=l[e],d=n/2+c,h=e+1,p=t-1;while(h<p){var v=h+p>>>1;if(l[v]<d)h=v+1;else p=v}if(d-l[h-1]<l[h]-d&&e+1<h)--h;var g=l[h]-c,m=n-g;if(o-r>u-i){var y=(r*m+o*g)/n;f(e,h,g,r,i,y,u);f(h,t,m,y,i,o,u)}else{var b=(i*m+u*g)/n;f(e,h,g,r,i,o,b);f(h,t,m,r,b,o,u)}}}function zI(e,t,n,r,i){(e.depth&1?CI:dI)(e,t,n,r,i)}var RI=function e(t){function n(e,n,r,i,a){if((o=e._squarify)&&o.ratio===t){var o,u,s,l,f=-1,c,d=o.length,h=e.value;while(++f<d){u=o[f],s=u.children;for(l=u.value=0,c=s.length;l<c;++l)u.value+=s[l].value;if(u.dice)dI(u,n,r,i,r+=(a-r)*u.value/h);else CI(u,n,r,n+=(i-n)*u.value/h,a);h-=u.value}}else{e._squarify=o=jI(t,e,n,r,i,a);o.ratio=t}}n.ratio=function(t){return e((t=+t)>1?t:1)};return n}(MI);function PI(e){af.call(this,null,e)}PI.Definition={type:"Nest",metadata:{treesource:true,changes:true},params:[{name:"keys",type:"field",array:true},{name:"generate",type:"boolean"}]};var LI=aa(PI,af);function II(e){return e.values}LI.transform=function(e,t){if(!t.source){ti("Nest transform requires an upstream data source.")}var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;if(!a||r||t.changed()){if(a){a.each((function(e){if(e.children&&Ma(e.data)){i.rem.push(e.data)}}))}this.value=a=TL({values:$i(e.keys).reduce((function(e,t){e.key(t);return e}),BI()).entries(i.source)},II);if(n){a.each((function(e){if(e.children){e=Na(e.data);i.add.push(e);i.source.push(e)}}))}dL(a,ja,ja)}i.source.root=a;return i};function BI(){var e=[],t;function n(t,r){if(r>=e.length){return t}var i=-1,a=t.length,o=e[r++],u,s,l={},f,c={};while(++i<a){u=o(s=t[i])+"";if(f=l[u]){f.push(s)}else{l[u]=[s]}}for(u in l){c[u]=n(l[u],r)}return c}function r(t,n){if(++n>e.length)return t;var i=[],a;for(a in t){i.push({key:a,values:r(t[a],n)})}return i}return t={entries:function(e){return r(n(e,0),0)},key:function(n){e.push(n);return t}}}function UI(e){af.call(this,null,e)}var qI=aa(UI,af);qI.transform=function(e,t){if(!t.source||!t.source.root){ti(this.constructor.name+" transform requires a backing tree data source.")}var n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;if(e.field)i.sum(e.field);else i.count();if(e.sort)i.sort(Pa(e.sort,(function(e){return e.data})));WI(n,this.params,e);if(n.separation){n.separation(e.separation!==false?$I:di)}try{this.value=n(i)}catch(o){ti(o)}i.each((function(e){HI(e,r,a)}));return t.reflow(e.modified()).modifies(a).modifies("leaf")};function WI(e,t,n){for(var r,i=0,a=t.length;i<a;++i){r=t[i];if(r in n)e[r](n[r])}}function HI(e,t,n){var r=e.data;for(var i=0,a=t.length-1;i<a;++i){r[n[i]]=e[t[i]]}r[n[a]]=e.children?e.children.length:0}function $I(e,t){return e.parent===t.parent?1:2}var GI=["x","y","r","depth","children"];function VI(e){UI.call(this,e)}VI.Definition={type:"Pack",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:GI.length,default:GI}]};var YI=aa(VI,UI);YI.layout=uI;YI.params=["radius","size","padding"];YI.fields=GI;var XI=["x0","y0","x1","y1","depth","children"];function JI(e){UI.call(this,e)}JI.Definition={type:"Partition",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:XI.length,default:XI}]};var ZI=aa(JI,UI);ZI.layout=hI;ZI.params=["size","round","padding"];ZI.fields=XI;function QI(e){af.call(this,null,e)}QI.Definition={type:"Stratify",metadata:{treesource:true},params:[{name:"key",type:"field",required:true},{name:"parentKey",type:"field",required:true}]};var KI=aa(QI,af);KI.transform=function(e,t){if(!t.source){ti("Stratify transform requires an upstream data source.")}var n=this.value,r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!this.value||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);i.source=i.source.slice();if(a){if(i.source.length){n=dL(bI().id(e.key).parentId(e.parentKey)(i.source),e.key,hi)}else{n=dL(bI()([{}]),e.key,e.key)}}i.source.root=this.value=n;return i};var eB={tidy:DI,cluster:xL};var tB=["x","y","depth","children"];function nB(e){UI.call(this,e)}nB.Definition={type:"Tree",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:true,length:2},{name:"nodeSize",type:"number",array:true,length:2},{name:"separation",type:"boolean",default:true},{name:"as",type:"string",array:true,length:tB.length,default:tB}]};var rB=aa(nB,UI);rB.layout=function(e){var t=e||"tidy";if(ta(eB,t))return eB[t]();else ti("Unrecognized Tree layout method: "+t)};rB.params=["size","nodeSize"];rB.fields=tB;function iB(e){af.call(this,[],e)}iB.Definition={type:"TreeLinks",metadata:{tree:true,generates:true,changes:true},params:[]};var aB=aa(iB,af);aB.transform=function(e,t){var n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};if(!r)ti("TreeLinks transform requires a tree data source.");if(t.changed(t.ADD_REM)){i.rem=n;t.visit(t.SOURCE,(function(e){a[ja(e)]=1}));r.each((function(e){var t=e.data,n=e.parent&&e.parent.data;if(n&&a[ja(t)]&&a[ja(n)]){i.add.push(Na({source:n,target:t}))}}));this.value=i.add}else if(t.changed(t.MOD)){t.visit(t.MOD,(function(e){a[ja(e)]=1}));n.forEach((function(e){if(a[ja(e.source)]||a[ja(e.target)]){i.mod.push(e)}}))}return i};var oB={binary:TI,dice:dI,slice:CI,slicedice:zI,squarify:FI,resquarify:RI};var uB=["x0","y0","x1","y1","depth","children"];function sB(e){UI.call(this,e)}sB.Definition={type:"Treemap",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:uB.length,default:uB}]};var lB=aa(sB,UI);lB.layout=function(){var e=NI();e.ratio=function(t){var n=e.tile();if(n.ratio)e.tile(n.ratio(t))};e.method=function(t){if(ta(oB,t))e.tile(oB[t]);else ti("Unrecognized Treemap layout method: "+t)};return e};lB.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"];lB.fields=uB;var fB=Object.freeze({__proto__:null,nest:PI,pack:VI,partition:JI,stratify:QI,tree:nB,treelinks:iB,treemap:sB});function cB(e,t){var n=[],r=function(e){return e(u)},i,a,o,u,s,l;if(t==null){n.push(e)}else{for(i={},a=0,o=e.length;a<o;++a){u=e[a];s=t.map(r);l=i[s];if(!l){i[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function dB(e){af.call(this,null,e)}dB.Definition={type:"Loess",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:true}]};var hB=aa(dB,af);hB.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=cB(r,e.groupby),a=(e.groupby||[]).map(Kr),o=a.length,u=e.as||[Kr(e.x),Kr(e.y)],s=[];i.forEach((function(t){Bc(t,e.x,e.y,e.bandwidth||.3).forEach((function(e){var n={};for(var r=0;r<o;++r){n[a[r]]=t.dims[r]}n[u[0]]=e[0];n[u[1]]=e[1];s.push(Na(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=s}return n};var pB={linear:Mc,log:jc,exp:Fc,pow:Nc,quad:Tc,poly:zc};function vB(e,t){return e==="poly"?t:e==="quad"?2:1}function gB(e){af.call(this,null,e)}gB.Definition={type:"Regression",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"method",type:"string",default:"linear",values:Object.keys(pB)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:true,length:2},{name:"params",type:"boolean",default:false},{name:"as",type:"string",array:true}]};var mB=aa(gB,af);mB.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,i=cB(r,e.groupby),a=(e.groupby||[]).map(Kr),o=e.method||"linear",u=e.order||3,s=vB(o,u),l=e.as||[Kr(e.x),Kr(e.y)],f=pB[o],c=[];var d=e.extent;if(!ta(pB,o)){ti("Invalid regression method: "+o)}if(d!=null){if(o==="log"&&d[0]<=0){t.dataflow.warn("Ignoring extent with values <= 0 for log regression.");d=null}}i.forEach((function(n){var r=n.length;if(r<=s){t.dataflow.warn("Skipping regression with more parameters than data points.");return}var i=f(n,e.x,e.y,u);if(e.params){c.push(Na({keys:n.dims,coef:i.coef,rSquared:i.rSquared}));return}var h=d||Qi(n,e.x),p=function(e){var t={};for(var r=0;r<a.length;++r){t[a[r]]=n.dims[r]}t[l[0]]=e[0];t[l[1]]=e[1];c.push(Na(t))};if(o==="linear"){h.forEach((function(e){return p([e,i.predict(e)])}))}else{$c(i.predict,h,25,200).forEach(p)}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=c}return n};var yB=Object.freeze({__proto__:null,loess:dB,regression:gB});var bB=Math.pow(2,-52);var xB=new Uint32Array(512);var _B=function(){function e(e){var t=e.length>>1;if(t>0&&typeof e[0]!=="number")throw new Error("Expected coords to contain numbers.");this.coords=e;var n=Math.max(2*t-5,0);this._triangles=new Uint32Array(n*3);this._halfedges=new Int32Array(n*3);this._hashSize=Math.ceil(Math.sqrt(t));this._hullPrev=new Uint32Array(t);this._hullNext=new Uint32Array(t);this._hullTri=new Uint32Array(t);this._hullHash=new Int32Array(this._hashSize).fill(-1);this._ids=new Uint32Array(t);this._dists=new Float64Array(t);this.update()}e.from=function(t,n,r){if(n===void 0){n=jB}if(r===void 0){r=FB}var i=t.length;var a=new Float64Array(i*2);for(var o=0;o<i;o++){var u=t[o];a[2*o]=n(u);a[2*o+1]=r(u)}return new e(a)};e.prototype.update=function(){var e=this,t=e.coords,n=e._hullPrev,r=e._hullNext,i=e._hullTri,a=e._hullHash;var o=t.length>>1;var u=Infinity;var s=Infinity;var l=-Infinity;var f=-Infinity;for(var c=0;c<o;c++){var d=t[2*c];var h=t[2*c+1];if(d<u)u=d;if(h<s)s=h;if(d>l)l=d;if(h>f)f=h;this._ids[c]=c}var p=(u+l)/2;var v=(s+f)/2;var g=Infinity;var m,y,b;for(var c=0;c<o;c++){var x=kB(p,v,t[2*c],t[2*c+1]);if(x<g){m=c;g=x}}var _=t[2*m];var w=t[2*m+1];g=Infinity;for(var c=0;c<o;c++){if(c===m)continue;var x=kB(_,w,t[2*c],t[2*c+1]);if(x<g&&x>0){y=c;g=x}}var k=t[2*y];var E=t[2*y+1];var O=Infinity;for(var c=0;c<o;c++){if(c===m||c===y)continue;var A=SB(_,w,k,E,t[2*c],t[2*c+1]);if(A<O){b=c;O=A}}var S=t[2*b];var D=t[2*b+1];if(O===Infinity){for(var c=0;c<o;c++){this._dists[c]=t[2*c]-t[0]||t[2*c+1]-t[1]}CB(this._ids,this._dists,0,o-1);var C=new Uint32Array(o);var M=0;for(var c=0,j=-Infinity;c<o;c++){var F=this._ids[c];if(this._dists[F]>j){C[M++]=F;j=this._dists[F]}}this.hull=C.subarray(0,M);this.triangles=new Uint32Array(0);this.halfedges=new Uint32Array(0);return}if(OB(_,w,k,E,S,D)){var c=y;var N=k;var T=E;y=b;k=S;E=D;b=c;S=N;D=T}var z=DB(_,w,k,E,S,D);this._cx=z.x;this._cy=z.y;for(var c=0;c<o;c++){this._dists[c]=kB(t[2*c],t[2*c+1],z.x,z.y)}CB(this._ids,this._dists,0,o-1);this._hullStart=m;var R=3;r[m]=n[b]=y;r[y]=n[m]=b;r[b]=n[y]=m;i[m]=0;i[y]=1;i[b]=2;a.fill(-1);a[this._hashKey(_,w)]=m;a[this._hashKey(k,E)]=y;a[this._hashKey(S,D)]=b;this.trianglesLen=0;this._addTriangle(m,y,b,-1,-1,-1);for(var P=0,L=void 0,I=void 0;P<this._ids.length;P++){var c=this._ids[P];var B=t[2*c];var U=t[2*c+1];if(P>0&&Math.abs(B-L)<=bB&&Math.abs(U-I)<=bB)continue;L=B;I=U;if(c===m||c===y||c===b)continue;var q=0;for(var M=0,W=this._hashKey(B,U);M<this._hashSize;M++){q=a[(W+M)%this._hashSize];if(q!==-1&&q!==r[q])break}q=n[q];var H=q,$=void 0;while($=r[H],!OB(B,U,t[2*H],t[2*H+1],t[2*$],t[2*$+1])){H=$;if(H===q){H=-1;break}}if(H===-1)continue;var G=this._addTriangle(H,c,r[H],-1,-1,i[H]);i[c]=this._legalize(G+2);i[H]=G;R++;var V=r[H];while($=r[V],OB(B,U,t[2*V],t[2*V+1],t[2*$],t[2*$+1])){G=this._addTriangle(V,c,$,i[c],-1,i[V]);i[c]=this._legalize(G+2);r[V]=V;R--;V=$}if(H===q){while($=n[H],OB(B,U,t[2*$],t[2*$+1],t[2*H],t[2*H+1])){G=this._addTriangle($,c,H,-1,i[H],i[$]);this._legalize(G+2);i[$]=G;r[H]=H;R--;H=$}}this._hullStart=n[c]=H;r[H]=n[V]=c;r[c]=V;a[this._hashKey(B,U)]=c;a[this._hashKey(t[2*H],t[2*H+1])]=H}this.hull=new Uint32Array(R);for(var c=0,H=this._hullStart;c<R;c++){this.hull[c]=H;H=r[H]}this.triangles=this._triangles.subarray(0,this.trianglesLen);this.halfedges=this._halfedges.subarray(0,this.trianglesLen)};e.prototype._hashKey=function(e,t){return Math.floor(wB(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize};e.prototype._legalize=function(e){var t=this,n=t._triangles,r=t._halfedges,i=t.coords;var a=0;var o=0;while(true){var u=r[e];var s=e-e%3;o=s+(e+2)%3;if(u===-1){if(a===0)break;e=xB[--a];continue}var l=u-u%3;var f=s+(e+1)%3;var c=l+(u+2)%3;var d=n[o];var h=n[e];var p=n[f];var v=n[c];var g=AB(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*v],i[2*v+1]);if(g){n[e]=v;n[u]=d;var m=r[c];if(m===-1){var y=this._hullStart;do{if(this._hullTri[y]===c){this._hullTri[y]=e;break}y=this._hullPrev[y]}while(y!==this._hullStart)}this._link(e,m);this._link(u,r[o]);this._link(o,c);var b=l+(u+1)%3;if(a<xB.length){xB[a++]=b}}else{if(a===0)break;e=xB[--a]}}return o};e.prototype._link=function(e,t){this._halfedges[e]=t;if(t!==-1)this._halfedges[t]=e};e.prototype._addTriangle=function(e,t,n,r,i,a){var o=this.trianglesLen;this._triangles[o]=e;this._triangles[o+1]=t;this._triangles[o+2]=n;this._link(o,r);this._link(o+1,i);this._link(o+2,a);this.trianglesLen+=3;return o};return e}();function wB(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function kB(e,t,n,r){var i=e-n;var a=t-r;return i*i+a*a}function EB(e,t,n,r,i,a){var o=(r-t)*(i-e);var u=(n-e)*(a-t);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function OB(e,t,n,r,i,a){var o=EB(i,a,e,t,n,r)||EB(e,t,n,r,i,a)||EB(n,r,i,a,e,t);return o<0}function AB(e,t,n,r,i,a,o,u){var s=e-o;var l=t-u;var f=n-o;var c=r-u;var d=i-o;var h=a-u;var p=s*s+l*l;var v=f*f+c*c;var g=d*d+h*h;return s*(c*g-v*h)-l*(f*g-v*d)+p*(f*h-c*d)<0}function SB(e,t,n,r,i,a){var o=n-e;var u=r-t;var s=i-e;var l=a-t;var f=o*o+u*u;var c=s*s+l*l;var d=.5/(o*l-u*s);var h=(l*f-u*c)*d;var p=(o*c-s*f)*d;return h*h+p*p}function DB(e,t,n,r,i,a){var o=n-e;var u=r-t;var s=i-e;var l=a-t;var f=o*o+u*u;var c=s*s+l*l;var d=.5/(o*l-u*s);var h=e+(l*f-u*c)*d;var p=t+(o*c-s*f)*d;return{x:h,y:p}}function CB(e,t,n,r){if(r-n<=20){for(var i=n+1;i<=r;i++){var a=e[i];var o=t[a];var u=i-1;while(u>=n&&t[e[u]]>o)e[u+1]=e[u--];e[u+1]=a}}else{var s=n+r>>1;var i=n+1;var u=r;MB(e,s,i);if(t[e[n]]>t[e[r]])MB(e,n,r);if(t[e[i]]>t[e[r]])MB(e,i,r);if(t[e[n]]>t[e[i]])MB(e,n,i);var l=e[i];var o=t[l];while(true){do{i++}while(t[e[i]]<o);do{u--}while(t[e[u]]>o);if(u<i)break;MB(e,i,u)}e[n+1]=e[u];e[u]=l;if(r-i+1>=u-n){CB(e,t,i,r);CB(e,t,n,u-1)}else{CB(e,t,n,u-1);CB(e,t,i,r)}}}function MB(e,t,n){var r=e[t];e[t]=e[n];e[n]=r}function jB(e){return e[0]}function FB(e){return e[1]}var NB=1e-6;var TB=function(){function e(){this._x0=this._y0=this._x1=this._y1=null;this._=""}e.prototype.moveTo=function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)};e.prototype.closePath=function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}};e.prototype.lineTo=function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)};e.prototype.arc=function(e,t,n){e=+e,t=+t,n=+n;var r=e+n;var i=t;if(n<0)throw new Error("negative radius");if(this._x1===null)this._+="M"+r+","+i;else if(Math.abs(this._x1-r)>NB||Math.abs(this._y1-i)>NB)this._+="L"+r+","+i;if(!n)return;this._+="A"+n+","+n+",0,1,1,"+(e-n)+","+t+"A"+n+","+n+",0,1,1,"+(this._x1=r)+","+(this._y1=i)};e.prototype.rect=function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"};e.prototype.value=function(){return this._||null};return e}();var zB=function(){function e(){this._=[]}e.prototype.moveTo=function(e,t){this._.push([e,t])};e.prototype.closePath=function(){this._.push(this._[0].slice())};e.prototype.lineTo=function(e,t){this._.push([e,t])};e.prototype.value=function(){return this._.length?this._:null};return e}();var RB=function(){function e(e,t){var n=t===void 0?[0,0,960,500]:t,r=n[0],i=n[1],a=n[2],o=n[3];if(!((a=+a)>=(r=+r))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e;this._circumcenters=new Float64Array(e.points.length*2);this.vectors=new Float64Array(e.points.length*2);this.xmax=a,this.xmin=r;this.ymax=o,this.ymin=i;this._init()}e.prototype.update=function(){this.delaunay.update();this._init();return this};e.prototype._init=function(){var e=this,t=e.delaunay,n=t.points,r=t.hull,i=t.triangles,a=e.vectors;var o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(var u=0,s=0,l=i.length,f,c;u<l;u+=3,s+=2){var d=i[u]*2;var h=i[u+1]*2;var p=i[u+2]*2;var v=n[d];var g=n[d+1];var m=n[h];var y=n[h+1];var b=n[p];var x=n[p+1];var _=m-v;var w=y-g;var k=b-v;var E=x-g;var O=_*_+w*w;var A=k*k+E*E;var S=(_*E-w*k)*2;if(!S){f=(v+b)/2-1e8*E;c=(g+x)/2+1e8*k}else if(Math.abs(S)<1e-8){f=(v+b)/2;c=(g+x)/2}else{var D=1/S;f=v+(E*O-w*A)*D;c=g+(_*A-k*O)*D}o[s]=f;o[s+1]=c}var C=r[r.length-1];var M,j=C*4;var F,N=n[2*C];var T,z=n[2*C+1];a.fill(0);for(var u=0;u<r.length;++u){C=r[u];M=j,F=N,T=z;j=C*4,N=n[2*C],z=n[2*C+1];a[M+2]=a[j]=T-z;a[M+3]=a[j+1]=N-F}};e.prototype.render=function(e){var t=e==null?e=new TB:undefined;var n=this,r=n.delaunay,i=r.halfedges,a=r.inedges,o=r.hull,u=n.circumcenters,s=n.vectors;if(o.length<=1)return null;for(var l=0,f=i.length;l<f;++l){var c=i[l];if(c<l)continue;var d=Math.floor(l/3)*2;var h=Math.floor(c/3)*2;var p=u[d];var v=u[d+1];var g=u[h];var m=u[h+1];this._renderSegment(p,v,g,m,e)}var y,b=o[o.length-1];for(var l=0;l<o.length;++l){y=b,b=o[l];var x=Math.floor(a[b]/3)*2;var _=u[x];var w=u[x+1];var k=y*4;var E=this._project(_,w,s[k+2],s[k+3]);if(E)this._renderSegment(_,w,E[0],E[1],e)}return t&&t.value()};e.prototype.renderBounds=function(e){var t=e==null?e=new TB:undefined;e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin);return t&&t.value()};e.prototype.renderCell=function(e,t){var n=t==null?t=new TB:undefined;var r=this._clip(e);if(r===null)return;t.moveTo(r[0],r[1]);var i=r.length;while(r[0]===r[i-2]&&r[1]===r[i-1]&&i>1)i-=2;for(var a=2;a<i;a+=2){if(r[a]!==r[a-2]||r[a+1]!==r[a-1])t.lineTo(r[a],r[a+1])}t.closePath();return n&&n.value()};e.prototype.cellPolygons=function(){var e,t,n,r;return __generator(this,(function(i){switch(i.label){case 0:e=this.delaunay.points;t=0,n=e.length/2;i.label=1;case 1:if(!(t<n))return[3,4];r=this.cellPolygon(t);if(!r)return[3,3];return[4,r];case 2:i.sent();i.label=3;case 3:++t;return[3,1];case 4:return[2]}}))};e.prototype.cellPolygon=function(e){var t=new zB;this.renderCell(e,t);return t.value()};e.prototype._renderSegment=function(e,t,n,r,i){var a;var o=this._regioncode(e,t);var u=this._regioncode(n,r);if(o===0&&u===0){i.moveTo(e,t);i.lineTo(n,r)}else if(a=this._clipSegment(e,t,n,r,o,u)){i.moveTo(a[0],a[1]);i.lineTo(a[2],a[3])}};e.prototype.contains=function(e,t,n){if((t=+t,t!==t)||(n=+n,n!==n))return false;return this.delaunay._step(e,t,n)===e};e.prototype.neighbors=function(e){var t,n,r,i,a,o,u,s,l;return __generator(this,(function(f){switch(f.label){case 0:t=this._clip(e);if(!t)return[3,8];n=0,r=this.delaunay.neighbors(e);f.label=1;case 1:if(!(n<r.length))return[3,8];i=r[n];a=this._clip(i);if(!a)return[3,7];o=0,u=t.length;f.label=2;case 2:if(!(o<u))return[3,7];s=0,l=a.length;f.label=3;case 3:if(!(s<l))return[3,6];if(!(t[o]==a[s]&&t[o+1]==a[s+1]&&t[(o+2)%u]==a[(s+l-2)%l]&&t[(o+3)%u]==a[(s+l-1)%l]))return[3,5];return[4,i];case 4:f.sent();return[3,7];case 5:s+=2;return[3,3];case 6:o+=2;return[3,2];case 7:n++;return[3,1];case 8:return[2]}}))};e.prototype._cell=function(e){var t=this,n=t.circumcenters,r=t.delaunay,i=r.inedges,a=r.halfedges,o=r.triangles;var u=i[e];if(u===-1)return null;var s=[];var l=u;do{var f=Math.floor(l/3);s.push(n[f*2],n[f*2+1]);l=l%3===2?l-2:l+1;if(o[l]!==e)break;l=a[l]}while(l!==u&&l!==-1);return s};e.prototype._clip=function(e){if(e===0&&this.delaunay.hull.length===1){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}var t=this._cell(e);if(t===null)return null;var n=this.vectors;var r=e*4;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)};e.prototype._clipFinite=function(e,t){var n=t.length;var r=null;var i,a,o=t[n-2],u=t[n-1];var s,l=this._regioncode(o,u);var f,c;for(var d=0;d<n;d+=2){i=o,a=u,o=t[d],u=t[d+1];s=l,l=this._regioncode(o,u);if(s===0&&l===0){f=c,c=0;if(r)r.push(o,u);else r=[o,u]}else{var h=void 0,p=void 0,v=void 0,g=void 0,m=void 0;if(s===0){if((h=this._clipSegment(i,a,o,u,s,l))===null)continue;p=h[0],v=h[1],g=h[2],m=h[3]}else{if((h=this._clipSegment(o,u,i,a,l,s))===null)continue;g=h[0],m=h[1],p=h[2],v=h[3];f=c,c=this._edgecode(p,v);if(f&&c)this._edge(e,f,c,r,r.length);if(r)r.push(p,v);else r=[p,v]}f=c,c=this._edgecode(g,m);if(f&&c)this._edge(e,f,c,r,r.length);if(r)r.push(g,m);else r=[g,m]}}if(r){f=c,c=this._edgecode(r[0],r[1]);if(f&&c)this._edge(e,f,c,r,r.length)}else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}return r};e.prototype._clipSegment=function(e,t,n,r,i,a){while(true){if(i===0&&a===0)return[e,t,n,r];if(i&a)return null;var o=void 0,u=void 0,s=i||a;if(s&8)o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax;else if(s&4)o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin;else if(s&2)u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax;else u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin;if(i)e=o,t=u,i=this._regioncode(e,t);else n=o,r=u,a=this._regioncode(n,r)}};e.prototype._clipInfinite=function(e,t,n,r,i,a){var o=Array.from(t),u;if(u=this._project(o[0],o[1],n,r))o.unshift(u[0],u[1]);if(u=this._project(o[o.length-2],o[o.length-1],i,a))o.push(u[0],u[1]);if(o=this._clipFinite(e,o)){for(var s=0,l=o.length,f=void 0,c=this._edgecode(o[l-2],o[l-1]);s<l;s+=2){f=c,c=this._edgecode(o[s],o[s+1]);if(f&&c)s=this._edge(e,f,c,o,s),l=o.length}}else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]}return o};e.prototype._edge=function(e,t,n,r,i){while(t!==n){var a=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,a=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,a=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,a=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,a=this.xmin,o=this.ymin;break}if((r[i]!==a||r[i+1]!==o)&&this.contains(e,a,o)){r.splice(i,0,a,o),i+=2}}if(r.length>4){for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,l=(u+4)%r.length;if(r[u]===r[s]&&r[s]===r[l]||r[u+1]===r[s+1]&&r[s+1]===r[l+1])r.splice(s,2),u-=2}}return i};e.prototype._project=function(e,t,n,r){var i=Infinity,a,o,u;if(r<0){if(t<=this.ymin)return null;if((a=(this.ymin-t)/r)<i)u=this.ymin,o=e+(i=a)*n}else if(r>0){if(t>=this.ymax)return null;if((a=(this.ymax-t)/r)<i)u=this.ymax,o=e+(i=a)*n}if(n>0){if(e>=this.xmax)return null;if((a=(this.xmax-e)/n)<i)o=this.xmax,u=t+(i=a)*r}else if(n<0){if(e<=this.xmin)return null;if((a=(this.xmin-e)/n)<i)o=this.xmin,u=t+(i=a)*r}return[o,u]};e.prototype._edgecode=function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)};e.prototype._regioncode=function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)};return e}();var PB=2*Math.PI;function LB(e){return e[0]}function IB(e){return e[1]}function BB(e){var t=e.triangles,n=e.coords;for(var r=0;r<t.length;r+=3){var i=2*t[r],a=2*t[r+1],o=2*t[r+2],u=(n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1]);if(u>1e-10)return false}return true}function UB(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var qB=function(){function e(e){this._delaunator=new _B(e);this.inedges=new Int32Array(e.length/2);this._hullIndex=new Int32Array(e.length/2);this.points=this._delaunator.coords;this._init()}e.from=function(t,n,r,i){if(n===void 0){n=LB}if(r===void 0){r=IB}return new e("length"in t?WB(t,n,r,i):Float64Array.from(HB(t,n,r,i)))};e.prototype.update=function(){this._delaunator.update();this._init();return this};e.prototype._init=function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&BB(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));var n=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],a=1e-8*Math.sqrt(Math.pow(i[3]-i[1],2)+Math.pow(i[2]-i[0],2));for(var o=0,u=t.length/2;o<u;++o){var s=UB(t[2*o],t[2*o+1],a);t[2*o]=s[0];t[2*o+1]=s[1]}this._delaunator=new _B(t)}else{delete this.collinear}var l=this.halfedges=this._delaunator.halfedges;var f=this.hull=this._delaunator.hull;var c=this.triangles=this._delaunator.triangles;var d=this.inedges.fill(-1);var h=this._hullIndex.fill(-1);for(var n=0,u=l.length;n<u;++n){var s=c[n%3===2?n-2:n+1];if(l[n]===-1||d[s]===-1)d[s]=n}for(var o=0,u=f.length;o<u;++o){h[f[o]]=o}if(f.length<=2&&f.length>0){this.triangles=new Int32Array(3).fill(-1);this.halfedges=new Int32Array(3).fill(-1);this.triangles[0]=f[0];this.triangles[1]=f[1];this.triangles[2]=f[1];d[f[0]]=1;if(f.length===2)d[f[1]]=0}};e.prototype.voronoi=function(e){return new RB(this,e)};e.prototype.neighbors=function(e){var t,n,r,i,a,o,u,s,l,f,c,d;return __generator(this,(function(h){switch(h.label){case 0:t=this,n=t.inedges,r=t.hull,i=t._hullIndex,a=t.halfedges,o=t.triangles,u=t.collinear;if(!u)return[3,5];s=u.indexOf(e);if(!(s>0))return[3,2];return[4,u[s-1]];case 1:h.sent();h.label=2;case 2:if(!(s<u.length-1))return[3,4];return[4,u[s+1]];case 3:h.sent();h.label=4;case 4:return[2];case 5:l=n[e];if(l===-1)return[2];f=l,c=-1;h.label=6;case 6:return[4,c=o[f]];case 7:h.sent();f=f%3===2?f-2:f+1;if(o[f]!==e)return[2];f=a[f];if(!(f===-1))return[3,10];d=r[(i[e]+1)%r.length];if(!(d!==c))return[3,9];return[4,d];case 8:h.sent();h.label=9;case 9:return[2];case 10:if(f!==l)return[3,6];h.label=11;case 11:return[2]}}))};e.prototype.find=function(e,t,n){if(n===void 0){n=0}if((e=+e,e!==e)||(t=+t,t!==t))return-1;var r=n;var i;while((i=this._step(n,e,t))>=0&&i!==n&&i!==r)n=i;return i};e.prototype._step=function(e,t,n){var r=this,i=r.inedges,a=r.hull,o=r._hullIndex,u=r.halfedges,s=r.triangles,l=r.points;if(i[e]===-1||!l.length)return(e+1)%(l.length>>1);var f=e;var c=Math.pow(t-l[e*2],2)+Math.pow(n-l[e*2+1],2);var d=i[e];var h=d;do{var p=s[h];var v=Math.pow(t-l[p*2],2)+Math.pow(n-l[p*2+1],2);if(v<c)c=v,f=p;h=h%3===2?h-2:h+1;if(s[h]!==e)break;h=u[h];if(h===-1){h=a[(o[e]+1)%a.length];if(h!==p){if(Math.pow(t-l[h*2],2)+Math.pow(n-l[h*2+1],2)<c)return h}break}}while(h!==d);return f};e.prototype.render=function(e){var t=e==null?e=new TB:undefined;var n=this,r=n.points,i=n.halfedges,a=n.triangles;for(var o=0,u=i.length;o<u;++o){var s=i[o];if(s<o)continue;var l=a[o]*2;var f=a[s]*2;e.moveTo(r[l],r[l+1]);e.lineTo(r[f],r[f+1])}this.renderHull(e);return t&&t.value()};e.prototype.renderPoints=function(e,t){if(t===void 0){t=2}var n=e==null?e=new TB:undefined;var r=this.points;for(var i=0,a=r.length;i<a;i+=2){var o=r[i],u=r[i+1];e.moveTo(o+t,u);e.arc(o,u,t,0,PB)}return n&&n.value()};e.prototype.renderHull=function(e){var t=e==null?e=new TB:undefined;var n=this,r=n.hull,i=n.points;var a=r[0]*2,o=r.length;e.moveTo(i[a],i[a+1]);for(var u=1;u<o;++u){var s=2*r[u];e.lineTo(i[s],i[s+1])}e.closePath();return t&&t.value()};e.prototype.hullPolygon=function(){var e=new zB;this.renderHull(e);return e.value()};e.prototype.renderTriangle=function(e,t){var n=t==null?t=new TB:undefined;var r=this,i=r.points,a=r.triangles;var o=a[e*=3]*2;var u=a[e+1]*2;var s=a[e+2]*2;t.moveTo(i[o],i[o+1]);t.lineTo(i[u],i[u+1]);t.lineTo(i[s],i[s+1]);t.closePath();return n&&n.value()};e.prototype.trianglePolygons=function(){var e,t,n;return __generator(this,(function(r){switch(r.label){case 0:e=this.triangles;t=0,n=e.length/3;r.label=1;case 1:if(!(t<n))return[3,4];return[4,this.trianglePolygon(t)];case 2:r.sent();r.label=3;case 3:++t;return[3,1];case 4:return[2]}}))};e.prototype.trianglePolygon=function(e){var t=new zB;this.renderTriangle(e,t);return t.value()};return e}();function WB(e,t,n,r){var i=e.length;var a=new Float64Array(i*2);for(var o=0;o<i;++o){var u=e[o];a[o*2]=t.call(r,u,o,e);a[o*2+1]=n.call(r,u,o,e)}return a}function HB(e,t,n,r){var i,a,o,u;return __generator(this,(function(s){switch(s.label){case 0:i=0;a=0,o=e;s.label=1;case 1:if(!(a<o.length))return[3,5];u=o[a];return[4,t.call(r,u,i,e)];case 2:s.sent();return[4,n.call(r,u,i,e)];case 3:s.sent();++i;s.label=4;case 4:a++;return[3,1];case 5:return[2]}}))}function $B(e){af.call(this,null,e)}$B.Definition={type:"Voronoi",metadata:{modifies:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"size",type:"number",array:true,length:2},{name:"extent",type:"array",array:true,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:true,length:2}},{name:"as",type:"string",default:"path"}]};var GB=aa($B,af);var VB=[-1e5,-1e5,1e5,1e5];GB.transform=function(e,t){var n=e.as||"path",r=t.source;if(!r||!r.length)return t;var i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:VB;var a=this.value=qB.from(r,e.x,e.y).voronoi(i);for(var o=0,u=r.length;o<u;++o){var s=a.cellPolygon(o);r[o][n]=s?YB(s):null}return t.reflow(e.modified()).modifies(n)};function YB(e){var t=e[0][0],n=e[0][1];var r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var XB=Object.freeze({__proto__:null,voronoi:$B});var JB=Math.PI/180,ZB=1<<11>>5,QB=1<<11;function KB(){var e=[256,256],t,n,r,i,a,o,u,s=iU,l=[],f=Math.random,c={};c.layout=function(){var s=d(ag()),c=oU((e[0]>>5)*e[1]),p=null,v=l.length,g=-1,m=[],y=l.map((function(e){return{text:t(e),font:n(e),style:i(e),weight:a(e),rotate:o(e),size:~~(r(e)+1e-14),padding:u(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:false,sprite:null,datum:e}})).sort((function(e,t){return t.size-e.size}));while(++g<v){var b=y[g];b.x=e[0]*(f()+.5)>>1;b.y=e[1]*(f()+.5)>>1;eU(s,b,y,g);if(b.hasText&&h(c,b,p)){m.push(b);if(p)nU(p,b);else p=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}];b.x-=e[0]>>1;b.y-=e[1]>>1}}return m};function d(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(ZB<<5)/t;e.height=QB/t;var n=e.getContext("2d");n.fillStyle=n.strokeStyle="red";n.textAlign="center";return{context:n,ratio:t}}function h(t,n,r){var i=n.x,a=n.y,o=Math.sqrt(e[0]*e[0]+e[1]*e[1]),u=s(e),l=f()<.5?1:-1,c=-l,d,h,p;while(d=u(c+=l)){h=~~d[0];p=~~d[1];if(Math.min(Math.abs(h),Math.abs(p))>=o)break;n.x=i+h;n.y=a+p;if(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>e[0]||n.y+n.y1>e[1])continue;if(!r||!tU(n,t,e[0])){if(!r||rU(n,r)){var v=n.sprite,g=n.width>>5,m=e[0]>>5,y=n.x-(g<<4),b=y&127,x=32-b,_=n.y1-n.y0,w=(n.y+n.y0)*m+(y>>5),k;for(var E=0;E<_;E++){k=0;for(var O=0;O<=g;O++){t[w+O]|=k<<x|(O<g?(k=v[E*g+O])>>>b:0)}w+=m}n.sprite=null;return true}}}return false}c.words=function(e){if(arguments.length){l=e;return c}else{return l}};c.size=function(t){if(arguments.length){e=[+t[0],+t[1]];return c}else{return e}};c.font=function(e){if(arguments.length){n=uU(e);return c}else{return n}};c.fontStyle=function(e){if(arguments.length){i=uU(e);return c}else{return i}};c.fontWeight=function(e){if(arguments.length){a=uU(e);return c}else{return a}};c.rotate=function(e){if(arguments.length){o=uU(e);return c}else{return o}};c.text=function(e){if(arguments.length){t=uU(e);return c}else{return t}};c.spiral=function(e){if(arguments.length){s=sU[e]||e;return c}else{return s}};c.fontSize=function(e){if(arguments.length){r=uU(e);return c}else{return r}};c.padding=function(e){if(arguments.length){u=uU(e);return c}else{return u}};c.random=function(e){if(arguments.length){f=e;return c}else{return f}};return c}function eU(e,t,n,r){if(t.sprite)return;var i=e.context,a=e.ratio;i.clearRect(0,0,(ZB<<5)/a,QB/a);var o=0,u=0,s=0,l=n.length,f,c,d,h,p;--r;while(++r<l){t=n[r];i.save();i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font;f=i.measureText(t.text+"m").width*a;d=t.size<<1;if(t.rotate){var v=Math.sin(t.rotate*JB),g=Math.cos(t.rotate*JB),m=f*g,y=f*v,b=d*g,x=d*v;f=Math.max(Math.abs(m+x),Math.abs(m-x))+31>>5<<5;d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else{f=f+31>>5<<5}if(d>s)s=d;if(o+f>=ZB<<5){o=0;u+=s;s=0}if(u+d>=QB)break;i.translate((o+(f>>1))/a,(u+(d>>1))/a);if(t.rotate)i.rotate(t.rotate*JB);i.fillText(t.text,0,0);if(t.padding){i.lineWidth=2*t.padding;i.strokeText(t.text,0,0)}i.restore();t.width=f;t.height=d;t.xoff=o;t.yoff=u;t.x1=f>>1;t.y1=d>>1;t.x0=-t.x1;t.y0=-t.y1;t.hasText=true;o+=f}var _=i.getImageData(0,0,(ZB<<5)/a,QB/a).data,w=[];while(--r>=0){t=n[r];if(!t.hasText)continue;f=t.width;c=f>>5;d=t.y1-t.y0;for(h=0;h<d*c;h++)w[h]=0;o=t.xoff;if(o==null)return;u=t.yoff;var k=0,E=-1;for(p=0;p<d;p++){for(h=0;h<f;h++){var O=c*p+(h>>5),A=_[(u+p)*(ZB<<5)+(o+h)<<2]?1<<31-h%32:0;w[O]|=A;k|=A}if(k)E=p;else{t.y0++;d--;p--;u++}}t.y1=t.y0+E;t.sprite=w.slice(0,(t.y1-t.y0)*c)}}function tU(e,t,n){n>>=5;var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,u=32-o,s=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),f;for(var c=0;c<s;c++){f=0;for(var d=0;d<=i;d++){if((f<<u|(d<i?(f=r[c*i+d])>>>o:0))&t[l+d])return true}l+=n}return false}function nU(e,t){var n=e[0],r=e[1];if(t.x+t.x0<n.x)n.x=t.x+t.x0;if(t.y+t.y0<n.y)n.y=t.y+t.y0;if(t.x+t.x1>r.x)r.x=t.x+t.x1;if(t.y+t.y1>r.y)r.y=t.y+t.y1}function rU(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function iU(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function aU(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function oU(e){var t=[],n=-1;while(++n<e)t[n]=0;return t}function uU(e){return typeof e==="function"?e:function(){return e}}var sU={archimedean:iU,rectangular:aU};var lU=["x","y","font","fontSize","fontStyle","fontWeight","angle"];var fU=["text","font","rotate","fontSize","fontStyle","fontWeight"];function cU(e){af.call(this,KB(),e)}cU.Definition={type:"Wordcloud",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2},{name:"font",type:"string",expr:true,default:"sans-serif"},{name:"fontStyle",type:"string",expr:true,default:"normal"},{name:"fontWeight",type:"string",expr:true,default:"normal"},{name:"fontSize",type:"number",expr:true,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:true,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:true},{name:"as",type:"string",array:true,length:7,default:lU}]};var dU=aa(cU,af);dU.transform=function(e,t){if(e.size&&!(e.size[0]&&e.size[1])){ti("Wordcloud size dimensions must be non-zero.")}function n(n){var r=e[n];return Vi(r)&&t.modified(r.fields)}var r=e.modified();if(!(r||t.changed(t.ADD_REM)||fU.some(n)))return;var i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||lU,u=e.fontSize||14,s;Vi(u)?s=e.fontSizeRange:u=Xi(u);if(s){var l=u,f=FD("sqrt")().domain(Qi(i,l)).range(s);u=function(e){return f(l(e))}}i.forEach((function(e){e[o[0]]=NaN;e[o[1]]=NaN;e[o[3]]=0}));var c=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(Qf).layout();var d=a.size(),h=d[0]>>1,p=d[1]>>1,v=0,g=c.length,m,y;for(;v<g;++v){m=c[v];y=m.datum;y[o[0]]=m.x+h;y[o[1]]=m.y+p;y[o[2]]=m.font;y[o[3]]=m.size;y[o[4]]=m.style;y[o[5]]=m.weight;y[o[6]]=m.rotate}return t.reflow(r).modifies(o)};var hU=Object.freeze({__proto__:null,wordcloud:cU});function pU(e){return new Uint8Array(e)}function vU(e){return new Uint16Array(e)}function gU(e){return new Uint32Array(e)}function mU(){var e=8,t=[],n=gU(0),r=bU(0,e),i=bU(0,e);return{data:function(){return t},seen:function(){return n=yU(n,t.length)},add:function(e){for(var n=0,r=t.length,i=e.length,a;n<i;++n){a=e[n];a._index=r++;t.push(a)}},remove:function(e,n){var a=t.length,o=Array(a-e),u=t,s,l,f;for(l=0;!n[l]&&l<a;++l){o[l]=t[l];u[l]=l}for(f=l;l<a;++l){s=t[l];if(!n[l]){u[l]=f;r[f]=r[l];i[f]=i[l];o[f]=s;s._index=f++}else{u[l]=-1}r[l]=0}t=o;return u},size:function(){return t.length},curr:function(){return r},prev:function(){return i},reset:function(e){i[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){var a=r.length;if(t>a||n>e){e=Math.max(n,e);r=bU(t,e,r);i=bU(t,e)}}}}function yU(e,t,n){if(e.length>=t)return e;n=n||new e.constructor(t);n.set(e);return n}function bU(e,t,n){var r=(t<257?pU:t<65537?vU:gU)(e);if(n)r.set(n);return r}function xU(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n=this,i=n.bisect(n.range,e.value),a=e.index,o=i[0],u=i[1],s=a.length,l;for(l=0;l<o;++l)t[a[l]]|=r;for(l=u;l<s;++l)t[a[l]]|=r;return n}}}function _U(){var e=gU(0),t=[],n=0;function r(r,i,a){if(!i.length)return[];var o=n,u=i.length,s=Array(u),l=gU(u),f,c,d;for(d=0;d<u;++d){s[d]=r(i[d]);l[d]=d}s=wU(s,l);if(o){f=t;c=e;t=Array(o+u);e=gU(o+u);kU(a,f,c,o,s,l,u,t,e)}else{if(a>0)for(d=0;d<u;++d){l[d]+=a}t=s;e=l}n=o+u;return{index:l,value:s}}function i(r,i){var a=n,o,u,s;for(u=0;!i[e[u]]&&u<a;++u);for(s=u;u<a;++u){if(!i[o=e[u]]){e[s]=o;t[s]=t[u];++s}}n=a-r}function a(t){for(var r=0,i=n;r<i;++r){e[r]=t[e[r]]}}function o(e,r){var i;if(r){i=r.length}else{r=t;i=n}return[Af(r,e[0],0,i),Of(r,e[1],0,i)]}return{insert:r,remove:i,bisect:o,reindex:a,index:function(){return e},size:function(){return n}}}function wU(e,t){e.sort.call(t,(function(t,n){var r=e[t],i=e[n];return r<i?-1:r>i?1:0}));return Gf(e,t)}function kU(e,t,n,r,i,a,o,u,s){var l=0,f=0,c;for(c=0;l<r&&f<o;++c){if(t[l]<i[f]){u[c]=t[l];s[c]=n[l++]}else{u[c]=i[f];s[c]=a[f++]+e}}for(;l<r;++l,++c){u[c]=t[l];s[c]=n[l]}for(;f<o;++f,++c){u[c]=i[f];s[c]=a[f]+e}}function EU(e){af.call(this,mU(),e);this._indices=null;this._dims=null}EU.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:true,required:true},{name:"query",type:"array",array:true,required:true,content:{type:"number",array:true,length:2}}]};var OU=aa(EU,af);OU.transform=function(e,t){if(!this._dims){return this.init(e,t)}else{var n=e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}));return n?this.reinit(e,t):this.eval(e,t)}};OU.init=function(e,t){var n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length,u=0,s,l;for(;u<o;++u){s=n[u].fname;l=i[s]||(i[s]=_U());a.push(xU(l,u,r[u]))}return this.eval(e,t)};OU.reinit=function(e,t){var n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,u=this.value,s=u.curr(),l=u.prev(),f=u.all(),c=n.rem=n.add,d=n.mod,h=i.length,p={},v,g,m,y,b,x,_,w,k;l.set(s);if(t.rem.length){b=this.remove(e,t,n)}if(t.add.length){u.add(t.add)}if(t.mod.length){x={};for(y=t.mod,_=0,w=y.length;_<w;++_){x[y[_]._index]=1}}for(_=0;_<h;++_){k=r[_];if(!o[_]||e.modified("fields",_)||t.modified(k.fields)){m=k.fname;if(!(v=p[m])){a[m]=g=_U();p[m]=v=g.insert(k,t.source,0)}o[_]=xU(g,_,i[_]).onAdd(v,s)}}for(_=0,w=u.data().length;_<w;++_){if(b[_]){continue}else if(l[_]!==s[_]){c.push(_)}else if(x[_]&&s[_]!==f){d.push(_)}}u.mask=(1<<h)-1;return n};OU.eval=function(e,t){var n=t.materialize().fork(),r=this._dims.length,i=0;if(t.rem.length){this.remove(e,t,n);i|=(1<<r)-1}if(e.modified("query")&&!e.modified("fields")){i|=this.update(e,t,n)}if(t.add.length){this.insert(e,t,n);i|=(1<<r)-1}if(t.mod.length){this.modify(t,n);i|=(1<<r)-1}this.value.mask=i;return n};OU.insert=function(e,t,n){var r=t.add,i=this.value,a=this._dims,o=this._indices,u=e.fields,s={},l=n.add,f=i.size(),c=f+r.length,d=a.length,h,p,v;i.resize(c,d);i.add(r);var g=i.curr(),m=i.prev(),y=i.all();for(h=0;h<d;++h){p=u[h].fname;v=s[p]||(s[p]=o[p].insert(u[h],r,f));a[h].onAdd(v,g)}for(;f<c;++f){m[f]=y;if(g[f]!==y)l.push(f)}};OU.modify=function(e,t){var n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod,u,s,l;for(u=0,s=o.length;u<s;++u){l=o[u]._index;if(i[l]!==a)n.push(l)}};OU.remove=function(e,t,n){var r=this._indices,i=this.value,a=i.curr(),o=i.prev(),u=i.all(),s={},l=n.rem,f=t.rem,c,d,h,p;for(c=0,d=f.length;c<d;++c){h=f[c]._index;s[h]=1;o[h]=p=a[h];a[h]=u;if(p!==u)l.push(h)}for(h in r){r[h].remove(d,s)}this.reindex(t,d,s);return s};OU.reindex=function(e,t,n){var r=this._indices,i=this.value;e.runAfter((function(){var e=i.remove(t,n);for(var a in r)r[a].reindex(e)}))};OU.update=function(e,t,n){var r=this._dims,i=e.query,a=t.stamp,o=r.length,u=0,s,l;n.filters=0;for(l=0;l<o;++l){if(e.modified("query",l)){s=l;++u}}if(u===1){u=r[s].one;this.incrementOne(r[s],i[s],n.add,n.rem)}else{for(l=0,u=0;l<o;++l){if(!e.modified("query",l))continue;u|=r[l].one;this.incrementAll(r[l],i[l],a,n.add);n.rem=n.add}}return u};OU.incrementAll=function(e,t,n,r){var i=this.value,a=i.seen(),o=i.curr(),u=i.prev(),s=e.index(),l=e.bisect(e.range),f=e.bisect(t),c=f[0],d=f[1],h=l[0],p=l[1],v=e.one,g,m,y;if(c<h){for(g=c,m=Math.min(h,d);g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}else if(c>h){for(g=h,m=Math.min(c,p);g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}if(d>p){for(g=Math.max(c,p),m=d;g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}else if(d<p){for(g=Math.max(h,d),m=p;g<m;++g){y=s[g];if(a[y]!==n){u[y]=o[y];a[y]=n;r.push(y)}o[y]^=v}}e.range=t.slice()};OU.incrementOne=function(e,t,n,r){var i=this.value,a=i.curr(),o=e.index(),u=e.bisect(e.range),s=e.bisect(t),l=s[0],f=s[1],c=u[0],d=u[1],h=e.one,p,v,g;if(l<c){for(p=l,v=Math.min(c,f);p<v;++p){g=o[p];a[g]^=h;n.push(g)}}else if(l>c){for(p=c,v=Math.min(l,d);p<v;++p){g=o[p];a[g]^=h;r.push(g)}}if(f>d){for(p=Math.max(l,d),v=f;p<v;++p){g=o[p];a[g]^=h;n.push(g)}}else if(f<d){for(p=Math.max(c,f),v=d;p<v;++p){g=o[p];a[g]^=h;r.push(g)}}e.range=t.slice()};function AU(e){af.call(this,null,e)}AU.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:true,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:true,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};var SU=aa(AU,af);SU.transform=function(e,t){var n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)===0)return t.StopPropagation;var a=t.fork(t.ALL),o=r.data(),u=r.curr(),s=r.prev(),l=function(e){return!(u[e]&n)?o[e]:null};a.filter(a.MOD,l);if(!(i&i-1)){a.filter(a.ADD,l);a.filter(a.REM,(function(e){return(u[e]&n)===i?o[e]:null}))}else{a.filter(a.ADD,(function(e){var t=u[e]&n,r=!t&&t^s[e]&n;return r?o[e]:null}));a.filter(a.REM,(function(e){var t=u[e]&n,r=t&&!(t^(t^s[e]&n));return r?o[e]:null}))}return a.filter(a.SOURCE,(function(e){return l(e._index)}))};var DU=Object.freeze({__proto__:null,crossfilter:EU,resolvefilter:AU});var CU="5.10.1";function MU(e){var t=e.container();if(t){t.setAttribute("role","figure");jU(t,e.description())}}function jU(e,t){if(e)t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t)}function FU(e){e.add(null,(function(t){e._background=t.bg;e._resize=1;return t.bg}),{bg:e._signals.background})}var NU="default";function TU(e){var t=e._signals.cursor;if(!t){e._signals.cursor=t=e.add({user:NU,item:null})}e.on(e.events("view","mousemove"),t,(function(e,n){var r=t.value,i=r?ai(r)?r:r.user:NU,a=n.item&&n.item.cursor||null;return r&&i===r.user&&a==r.item?r:{user:i,item:a}}));e.add(null,(function(e){var t=e.cursor,n=this.value;if(!ai(t)){n=t.item;t=t.user}zU(t&&t!==NU?t:n||t);return n}),{cursor:t})}function zU(e){if(typeof document!=="undefined"&&document.body){document.body.style.cursor=e}}function RU(e,t){var n=e._runtime.data;if(!ta(n,t)){ti("Unrecognized data set: "+t)}return n[t]}function PU(e,t){return arguments.length<2?RU(this,e).values.value:LU.call(this,e,Ia().remove(hi).insert(t))}function LU(e,t){if(!La(t)){ti("Second argument to changes must be a changeset.")}var n=RU(this,e);n.modified=true;return this.pulse(n.input,t)}function IU(e,t){return LU.call(this,e,Ia().insert(t))}function BU(e,t){return LU.call(this,e,Ia().remove(t))}function UU(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function qU(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function WU(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function HU(e){var t=WU(e),n=UU(e),r=qU(e);e._renderer.background(e.background());e._renderer.resize(n,r,t);e._handler.origin(t);e._resizeListeners.forEach((function(t){try{t(n,r)}catch(ti){e.error(ti)}}))}function $U(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,u;if(i){u=WU(e);o=t.changedTouches?t.changedTouches[0]:t;a=C_(o,i);a[0]-=u[0];a[1]-=u[1]}t.dataflow=e;t.item=n;t.vega=GU(e,n,a);return t}function GU(e,t,n){var r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(e){var n=r,i;if(e)for(i=t;i;i=i.mark.group){if(i.mark.name===e){n=i;break}}return n&&n.mark&&n.mark.interactive?n:{}}function a(e){if(!e)return n;if(ai(e))e=i(e);var t=n.slice();while(e){t[0]-=e.x||0;t[1]-=e.y||0;e=e.mark&&e.mark.group}return t}return{view:Xi(e),item:Xi(t||{}),group:i,xy:a,x:function(e){return a(e)[0]},y:function(e){return a(e)[1]}}}var VU="view",YU="timer",XU="window",JU={trap:false};function ZU(e){var t=Zi({defaults:{}},e);var n=function(e,t){t.forEach((function(t){if(ri(e[t]))e[t]=ka(e[t])}))};n(t.defaults,["prevent","allow"]);n(t,["view","window","selector"]);return t}function QU(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===false||i===true?false:r===true||i===false?true:r?r[t]:i?!i[t]:e.preventDefault()}function KU(e,t,n){var r=e._eventConfig&&e._eventConfig[t];if(r===false||ii(r)&&!r[n]){e.warn("Blocked "+t+" "+n+" event listener.");return false}return true}function eq(e,t,n){var r=this,i=new eo(n),a=function(n,a){r.runAsync(null,(function(){if(e===VU&&QU(r,t)){n.preventDefault()}i.receive($U(r,n,a))}))},o;if(e===YU){if(KU(r,"timer",t)){r.timer(a,t)}}else if(e===VU){if(KU(r,"view",t)){r.addEventListener(t,a,JU)}}else{if(e===XU){if(KU(r,"window",t)&&typeof window!=="undefined"){o=[window]}}else if(typeof document!=="undefined"){if(KU(r,"selector",t)){o=document.querySelectorAll(e)}}if(!o){r.warn("Can not resolve event source: "+e)}else{for(var u=0,s=o.length;u<s;++u){o[u].addEventListener(t,a)}r._eventListeners.push({type:t,sources:o,handler:a})}}return i}function tq(e){return e.item}function nq(e){return e.item.mark.source}function rq(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function iq(e,t){e=[e||"hover"];t=[t||"update",e[0]];this.on(this.events("view","mouseover",tq),nq,rq(e));this.on(this.events("view","mouseout",tq),nq,rq(t));return this}function aq(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;r=t.length;while(--r>=0){t[r].stop()}r=n.length;while(--r>=0){a=n[r];i=a.sources.length;while(--i>=0){a.sources[i].removeEventListener(a.type,a.handler)}}if(e){e.call(this,this._handler,null,null,null)}return this}function oq(e,t,n){var r=document.createElement(e);for(var i in t)r.setAttribute(i,t[i]);if(n!=null)r.textContent=n;return r}var uq="vega-bind",sq="vega-bind-name",lq="vega-bind-radio",fq="vega-option-";function cq(e,t,n){if(!t)return;var r=n.param,i=n.state;if(!i){i=n.state={elements:null,active:false,set:null,update:function(t){if(t!==e.signal(r.signal)){e.runAsync(null,(function(){i.source=true;e.signal(r.signal,t)}))}}};if(r.debounce){i.update=Ji(r.debounce,i.update)}}dq(i,t,r,e.signal(r.signal));if(!i.active){e.on(e._signals[r.signal],null,(function(){i.source?i.source=false:i.set(e.signal(r.signal))}));i.active=true}return i}function dq(e,t,n,r){var i=oq("div",{class:uq});i.appendChild(oq("span",{class:sq},n.name||n.signal));t.appendChild(i);var a=hq;switch(n.input){case"checkbox":a=pq;break;case"select":a=vq;break;case"radio":a=gq;break;case"range":a=mq;break}a(e,i,n,r)}function hq(e,t,n,r){var i=oq("input");for(var a in n){if(a!=="signal"&&a!=="element"){i.setAttribute(a==="input"?"type":a,n[a])}}i.setAttribute("name",n.signal);i.value=r;t.appendChild(i);i.addEventListener("input",(function(){e.update(i.value)}));e.elements=[i];e.set=function(e){i.value=e}}function pq(e,t,n,r){var i={type:"checkbox",name:n.signal};if(r)i.checked=true;var a=oq("input",i);t.appendChild(a);a.addEventListener("change",(function(){e.update(a.checked)}));e.elements=[a];e.set=function(e){a.checked=!!e||null}}function vq(e,t,n,r){var i=oq("select",{name:n.signal}),a=n.labels||[];n.options.forEach((function(e,t){var n={value:e};if(yq(e,r))n.selected=true;i.appendChild(oq("option",n,(a[t]||e)+""))}));t.appendChild(i);i.addEventListener("change",(function(){e.update(n.options[i.selectedIndex])}));e.elements=[i];e.set=function(e){for(var t=0,r=n.options.length;t<r;++t){if(yq(n.options[t],e)){i.selectedIndex=t;return}}}}function gq(e,t,n,r){var i=oq("span",{class:lq}),a=n.labels||[];t.appendChild(i);e.elements=n.options.map((function(t,o){var u=fq+n.signal+"-"+t;var s={id:u,type:"radio",name:n.signal,value:t};if(yq(t,r))s.checked=true;var l=oq("input",s);l.addEventListener("change",(function(){e.update(t)}));i.appendChild(l);i.appendChild(oq("label",{for:u},(a[o]||t)+""));return l}));e.set=function(t){var n=e.elements,r=0,i=n.length;for(;r<i;++r){if(yq(n[r].value,t))n[r].checked=true}}}function mq(e,t,n,r){r=r!==undefined?r:(+n.max+ +n.min)/2;var i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||zf(a,i,100);var u=oq("input",{type:"range",name:n.signal,min:a,max:i,step:o});u.value=r;var s=oq("label",{},+r);t.appendChild(u);t.appendChild(s);function l(){s.textContent=u.value;e.update(+u.value)}u.addEventListener("input",l);u.addEventListener("change",l);e.elements=[u];e.set=function(e){u.value=e;s.textContent=e}}function yq(e,t){return e===t||e+""===t+""}function bq(e,t,n,r,i,a){t=t||new r(e.loader());return t.initialize(n,UU(e),qU(e),WU(e),i,a).background(e.background())}function xq(e,t){return!t?null:function(){try{t.apply(this,arguments)}catch(ti){e.error(ti)}}}function _q(e,t,n,r){var i=new r(e.loader(),xq(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,WU(e),e);if(t){t.handlers().forEach((function(e){i.on(e.type,e.handler)}))}return i}function wq(e,t){var n=this,r=n._renderType,i=n._eventConfig.bind,a=Pw(r);e=n._el=e?kq(n,e):null;MU(n);if(!a)n.error("Unrecognized renderer type: "+r);var o=a.handler||B_,u=e?a.renderer:a.headless;n._renderer=!u?null:bq(n,n._renderer,e,u);n._handler=_q(n,n._handler,e,o);n._redraw=true;if(e&&i!=="none"){t=t?n._elBind=kq(n,t):e.appendChild(oq("div",{class:"vega-bindings"}));n._bind.forEach((function(e){if(e.param.element&&i!=="container"){e.element=kq(n,e.param.element)}}));n._bind.forEach((function(e){cq(n,e.element||t,e)}))}return n}function kq(e,t){if(typeof t==="string"){if(typeof document!=="undefined"){t=document.querySelector(t);if(!t){e.error("Signal bind element not found: "+t);return null}}else{e.error("DOM document instance not found.");return null}}if(t){try{t.innerHTML=""}catch(n){t=null;e.error(n)}}return t}var Eq=function(e){return+e||0};var Oq=function(e){return{top:e,bottom:e,left:e,right:e}};function Aq(e){return ii(e)?{top:Eq(e.top),bottom:Eq(e.bottom),left:Eq(e.left),right:Eq(e.right)}:Oq(Eq(e))}function Sq(e,t,n,r){return Je(this,void 0,void 0,(function(){var i,a;return __generator(this,(function(o){switch(o.label){case 0:i=Pw(t),a=i&&i.headless;if(!a)ti("Unrecognized renderer type: "+t);return[4,e.runAsync()];case 1:o.sent();return[2,bq(e,null,null,a,n,r).renderAsync(e._scenegraph.root)]}}))}))}function Dq(e,t){return Je(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:if(e!==zw.Canvas&&e!==zw.SVG&&e!==zw.PNG){ti("Unrecognized image type: "+e)}return[4,Sq(this,e,t)];case 1:n=r.sent();return[2,e===zw.SVG?Cq(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")]}}))}))}function Cq(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function Mq(e,t){return Je(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return[4,Sq(this,zw.Canvas,e,t)];case 1:n=r.sent();return[2,n.canvas()]}}))}))}function jq(e){return Je(this,void 0,void 0,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return[4,Sq(this,zw.SVG,e)];case 1:t=n.sent();return[2,t.svg()]}}))}))}var Fq="RawCode";var Nq="Literal";var Tq="Property";var zq="Identifier";var Rq="ArrayExpression";var Pq="BinaryExpression";var Lq="CallExpression";var Iq="ConditionalExpression";var Bq="LogicalExpression";var Uq="MemberExpression";var qq="ObjectExpression";var Wq="UnaryExpression";function Hq(e){this.type=e}Hq.prototype.visit=function(e){var t=this,n,r,i;if(e(t))return 1;for(n=$q(t),r=0,i=n.length;r<i;++r){if(n[r].visit(e))return 1}};function $q(e){switch(e.type){case Rq:return e.elements;case Pq:case Bq:return[e.left,e.right];case Lq:var t=e.arguments.slice();t.unshift(e.callee);return t;case Iq:return[e.test,e.consequent,e.alternate];case Uq:return[e.object,e.property];case qq:return e.properties;case Tq:return[e.key,e.value];case Wq:return[e.argument];case zq:case Nq:case Fq:default:return[]}}var Gq,Vq,Yq,Xq,Jq;var Zq=1,Qq=2,Kq=3,eW=4,tW=5,nW=6,rW=7,iW=8,aW=9;Gq={};Gq[Zq]="Boolean";Gq[Qq]="<end>";Gq[Kq]="Identifier";Gq[eW]="Keyword";Gq[tW]="Null";Gq[nW]="Numeric";Gq[rW]="Punctuator";Gq[iW]="String";Gq[aW]="RegularExpression";var oW="ArrayExpression",uW="BinaryExpression",sW="CallExpression",lW="ConditionalExpression",fW="Identifier",cW="Literal",dW="LogicalExpression",hW="MemberExpression",pW="ObjectExpression",vW="Property",gW="UnaryExpression";var mW="Unexpected token %0",yW="Unexpected number",bW="Unexpected string",xW="Unexpected identifier",_W="Unexpected reserved word",wW="Unexpected end of input",kW="Invalid regular expression",EW="Invalid regular expression: missing /",OW="Octal literals are not allowed in strict mode.",AW="Duplicate data property in object literal not allowed in strict mode";var SW="ILLEGAL",DW="Disabled.";var CW=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),MW=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function jW(e,t){if(!e){throw new Error("ASSERT: "+t)}}function FW(e){return e>=48&&e<=57}function NW(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function TW(e){return"01234567".indexOf(e)>=0}function zW(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function RW(e){return e===10||e===13||e===8232||e===8233}function PW(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&CW.test(String.fromCharCode(e))}function LW(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&MW.test(String.fromCharCode(e))}var IW={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function BW(){var e;while(Yq<Xq){e=Vq.charCodeAt(Yq);if(zW(e)||RW(e)){++Yq}else{break}}}function UW(e){var t,n,r,i=0;n=e==="u"?4:2;for(t=0;t<n;++t){if(Yq<Xq&&NW(Vq[Yq])){r=Vq[Yq++];i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())}else{vH({},mW,SW)}}return String.fromCharCode(i)}function qW(){var e,t,n,r;e=Vq[Yq];t=0;if(e==="}"){vH({},mW,SW)}while(Yq<Xq){e=Vq[Yq++];if(!NW(e)){break}t=t*16+"0123456789abcdef".indexOf(e.toLowerCase())}if(t>1114111||e!=="}"){vH({},mW,SW)}if(t<=65535){return String.fromCharCode(t)}n=(t-65536>>10)+55296;r=(t-65536&1023)+56320;return String.fromCharCode(n,r)}function WW(){var e,t;e=Vq.charCodeAt(Yq++);t=String.fromCharCode(e);if(e===92){if(Vq.charCodeAt(Yq)!==117){vH({},mW,SW)}++Yq;e=UW("u");if(!e||e==="\\"||!PW(e.charCodeAt(0))){vH({},mW,SW)}t=e}while(Yq<Xq){e=Vq.charCodeAt(Yq);if(!LW(e)){break}++Yq;t+=String.fromCharCode(e);if(e===92){t=t.substr(0,t.length-1);if(Vq.charCodeAt(Yq)!==117){vH({},mW,SW)}++Yq;e=UW("u");if(!e||e==="\\"||!LW(e.charCodeAt(0))){vH({},mW,SW)}t+=e}}return t}function HW(){var e,t;e=Yq++;while(Yq<Xq){t=Vq.charCodeAt(Yq);if(t===92){Yq=e;return WW()}if(LW(t)){++Yq}else{break}}return Vq.slice(e,Yq)}function $W(){var e,t,n;e=Yq;t=Vq.charCodeAt(Yq)===92?WW():HW();if(t.length===1){n=Kq}else if(IW.hasOwnProperty(t)){n=eW}else if(t==="null"){n=tW}else if(t==="true"||t==="false"){n=Zq}else{n=Kq}return{type:n,value:t,start:e,end:Yq}}function GW(){var e=Yq,t=Vq.charCodeAt(Yq),n,r=Vq[Yq],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:++Yq;return{type:rW,value:String.fromCharCode(t),start:e,end:Yq};default:n=Vq.charCodeAt(Yq+1);if(n===61){switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:Yq+=2;return{type:rW,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:Yq};case 33:case 61:Yq+=2;if(Vq.charCodeAt(Yq)===61){++Yq}return{type:rW,value:Vq.slice(e,Yq),start:e,end:Yq}}}}o=Vq.substr(Yq,4);if(o===">>>="){Yq+=4;return{type:rW,value:o,start:e,end:Yq}}a=o.substr(0,3);if(a===">>>"||a==="<<="||a===">>="){Yq+=3;return{type:rW,value:a,start:e,end:Yq}}i=a.substr(0,2);if(r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>"){Yq+=2;return{type:rW,value:i,start:e,end:Yq}}if("<>=!+-*%&|^/".indexOf(r)>=0){++Yq;return{type:rW,value:r,start:e,end:Yq}}vH({},mW,SW)}function VW(e){var t="";while(Yq<Xq){if(!NW(Vq[Yq])){break}t+=Vq[Yq++]}if(t.length===0){vH({},mW,SW)}if(PW(Vq.charCodeAt(Yq))){vH({},mW,SW)}return{type:nW,value:parseInt("0x"+t,16),start:e,end:Yq}}function YW(e){var t="0"+Vq[Yq++];while(Yq<Xq){if(!TW(Vq[Yq])){break}t+=Vq[Yq++]}if(PW(Vq.charCodeAt(Yq))||FW(Vq.charCodeAt(Yq))){vH({},mW,SW)}return{type:nW,value:parseInt(t,8),octal:true,start:e,end:Yq}}function XW(){var e,t,n;n=Vq[Yq];jW(FW(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point");t=Yq;e="";if(n!=="."){e=Vq[Yq++];n=Vq[Yq];if(e==="0"){if(n==="x"||n==="X"){++Yq;return VW(t)}if(TW(n)){return YW(t)}if(n&&FW(n.charCodeAt(0))){vH({},mW,SW)}}while(FW(Vq.charCodeAt(Yq))){e+=Vq[Yq++]}n=Vq[Yq]}if(n==="."){e+=Vq[Yq++];while(FW(Vq.charCodeAt(Yq))){e+=Vq[Yq++]}n=Vq[Yq]}if(n==="e"||n==="E"){e+=Vq[Yq++];n=Vq[Yq];if(n==="+"||n==="-"){e+=Vq[Yq++]}if(FW(Vq.charCodeAt(Yq))){while(FW(Vq.charCodeAt(Yq))){e+=Vq[Yq++]}}else{vH({},mW,SW)}}if(PW(Vq.charCodeAt(Yq))){vH({},mW,SW)}return{type:nW,value:parseFloat(e),start:t,end:Yq}}function JW(){var e="",t,n,r,i,a=false;t=Vq[Yq];jW(t==="'"||t==='"',"String literal must starts with a quote");n=Yq;++Yq;while(Yq<Xq){r=Vq[Yq++];if(r===t){t="";break}else if(r==="\\"){r=Vq[Yq++];if(!r||!RW(r.charCodeAt(0))){switch(r){case"u":case"x":if(Vq[Yq]==="{"){++Yq;e+=qW()}else{e+=UW(r)}break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:if(TW(r)){i="01234567".indexOf(r);if(i!==0){a=true}if(Yq<Xq&&TW(Vq[Yq])){a=true;i=i*8+"01234567".indexOf(Vq[Yq++]);if("0123".indexOf(r)>=0&&Yq<Xq&&TW(Vq[Yq])){i=i*8+"01234567".indexOf(Vq[Yq++])}}e+=String.fromCharCode(i)}else{e+=r}break}}else{if(r==="\r"&&Vq[Yq]==="\n"){++Yq}}}else if(RW(r.charCodeAt(0))){break}else{e+=r}}if(t!==""){vH({},mW,SW)}return{type:iW,value:e,octal:a,start:n,end:Yq}}function ZW(e,t){var n=e;if(t.indexOf("u")>=0){n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111){return"x"}vH({},kW)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x")}try{return new RegExp(e,t)}catch(r){return null}}function QW(){var e,t,n,r,i;e=Vq[Yq];jW(e==="/","Regular expression literal must start with a slash");t=Vq[Yq++];n=false;r=false;while(Yq<Xq){e=Vq[Yq++];t+=e;if(e==="\\"){e=Vq[Yq++];if(RW(e.charCodeAt(0))){vH({},EW)}t+=e}else if(RW(e.charCodeAt(0))){vH({},EW)}else if(n){if(e==="]"){n=false}}else{if(e==="/"){r=true;break}else if(e==="["){n=true}}}if(!r){vH({},EW)}i=t.substr(1,t.length-2);return{value:i,literal:t}}function KW(){var e,t,n;t="";n="";while(Yq<Xq){e=Vq[Yq];if(!LW(e.charCodeAt(0))){break}++Yq;if(e==="\\"&&Yq<Xq){vH({},mW,SW)}else{n+=e;t+=e}}if(n.search(/[^gimuy]/g)>=0){vH({},kW,n)}return{value:n,literal:t}}function eH(){var e,t,n,r;Jq=null;BW();e=Yq;t=QW();n=KW();r=ZW(t.value,n.value);return{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:Yq}}function tH(e){return e.type===Kq||e.type===eW||e.type===Zq||e.type===tW}function nH(){var e;BW();if(Yq>=Xq){return{type:Qq,start:Yq,end:Yq}}e=Vq.charCodeAt(Yq);if(PW(e)){return $W()}if(e===40||e===41||e===59){return GW()}if(e===39||e===34){return JW()}if(e===46){if(FW(Vq.charCodeAt(Yq+1))){return XW()}return GW()}if(FW(e)){return XW()}return GW()}function rH(){var e;e=Jq;Yq=e.end;Jq=nH();Yq=e.end;return e}function iH(){var e;e=Yq;Jq=nH();Yq=e}function aH(e){var t=new Hq(oW);t.elements=e;return t}function oH(e,t,n){var r=new Hq(e==="||"||e==="&&"?dW:uW);r.operator=e;r.left=t;r.right=n;return r}function uH(e,t){var n=new Hq(sW);n.callee=e;n.arguments=t;return n}function sH(e,t,n){var r=new Hq(lW);r.test=e;r.consequent=t;r.alternate=n;return r}function lH(e){var t=new Hq(fW);t.name=e;return t}function fH(e){var t=new Hq(cW);t.value=e.value;t.raw=Vq.slice(e.start,e.end);if(e.regex){if(t.raw==="//"){t.raw="/(?:)/"}t.regex=e.regex}return t}function cH(e,t,n){var r=new Hq(hW);r.computed=e==="[";r.object=t;r.property=n;if(!r.computed)n.member=true;return r}function dH(e){var t=new Hq(pW);t.properties=e;return t}function hH(e,t,n){var r=new Hq(vW);r.key=t;r.value=n;r.kind=e;return r}function pH(e,t){var n=new Hq(gW);n.operator=e;n.argument=t;n.prefix=true;return n}function vH(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(function(e,t){jW(t<r.length,"Message reference must be in range");return r[t]}));n=new Error(i);n.index=Yq;n.description=i;throw n}function gH(e){if(e.type===Qq){vH(e,wW)}if(e.type===nW){vH(e,yW)}if(e.type===iW){vH(e,bW)}if(e.type===Kq){vH(e,xW)}if(e.type===eW){vH(e,_W)}vH(e,mW,e.value)}function mH(e){var t=rH();if(t.type!==rW||t.value!==e){gH(t)}}function yH(e){return Jq.type===rW&&Jq.value===e}function bH(e){return Jq.type===eW&&Jq.value===e}function xH(){var e=[];Yq=Jq.start;mH("[");while(!yH("]")){if(yH(",")){rH();e.push(null)}else{e.push(RH());if(!yH("]")){mH(",")}}}rH();return aH(e)}function _H(){var e;Yq=Jq.start;e=rH();if(e.type===iW||e.type===nW){if(e.octal){vH(e,OW)}return fH(e)}return lH(e.value)}function wH(){var e,t,n,r;Yq=Jq.start;e=Jq;if(e.type===Kq){n=_H();mH(":");r=RH();return hH("init",n,r)}if(e.type===Qq||e.type===rW){gH(e)}else{t=_H();mH(":");r=RH();return hH("init",t,r)}}function kH(){var e=[],t,n,r,i={},a=String;Yq=Jq.start;mH("{");while(!yH("}")){t=wH();if(t.key.type===fW){n=t.key.name}else{n=a(t.key.value)}r="$"+n;if(Object.prototype.hasOwnProperty.call(i,r)){vH({},AW)}else{i[r]=true}e.push(t);if(!yH("}")){mH(",")}}mH("}");return dH(e)}function EH(){var e;mH("(");e=PH();mH(")");return e}var OH={if:1,this:1};function AH(){var e,t,n;if(yH("(")){return EH()}if(yH("[")){return xH()}if(yH("{")){return kH()}e=Jq.type;Yq=Jq.start;if(e===Kq||OH[Jq.value]){n=lH(rH().value)}else if(e===iW||e===nW){if(Jq.octal){vH(Jq,OW)}n=fH(rH())}else if(e===eW){throw new Error(DW)}else if(e===Zq){t=rH();t.value=t.value==="true";n=fH(t)}else if(e===tW){t=rH();t.value=null;n=fH(t)}else if(yH("/")||yH("/=")){n=fH(eH());iH()}else{gH(rH())}return n}function SH(){var e=[];mH("(");if(!yH(")")){while(Yq<Xq){e.push(RH());if(yH(")")){break}mH(",")}}mH(")");return e}function DH(){var e;Yq=Jq.start;e=rH();if(!tH(e)){gH(e)}return lH(e.value)}function CH(){mH(".");return DH()}function MH(){var e;mH("[");e=PH();mH("]");return e}function jH(){var e,t,n;e=AH();for(;;){if(yH(".")){n=CH();e=cH(".",e,n)}else if(yH("(")){t=SH();e=uH(e,t)}else if(yH("[")){n=MH();e=cH("[",e,n)}else{break}}return e}function FH(){var e=jH();if(Jq.type===rW){if(yH("++")||yH("--")){throw new Error(DW)}}return e}function NH(){var e,t;if(Jq.type!==rW&&Jq.type!==eW){t=FH()}else if(yH("++")||yH("--")){throw new Error(DW)}else if(yH("+")||yH("-")||yH("~")||yH("!")){e=rH();t=NH();t=pH(e.value,t)}else if(bH("delete")||bH("void")||bH("typeof")){throw new Error(DW)}else{t=FH()}return t}function TH(e){var t=0;if(e.type!==rW&&e.type!==eW){return 0}switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function zH(){var e,t,n,r,i,a,o,u,s,l;e=Jq;s=NH();r=Jq;i=TH(r);if(i===0){return s}r.prec=i;rH();t=[e,Jq];o=NH();a=[s,r,o];while((i=TH(Jq))>0){while(a.length>2&&i<=a[a.length-2].prec){o=a.pop();u=a.pop().value;s=a.pop();t.pop();n=oH(u,s,o);a.push(n)}r=rH();r.prec=i;a.push(r);t.push(Jq);n=NH();a.push(n)}l=a.length-1;n=a[l];t.pop();while(l>1){t.pop();n=oH(a[l-1].value,a[l-2],n);l-=2}return n}function RH(){var e,t,n;e=zH();if(yH("?")){rH();t=RH();mH(":");n=RH();e=sH(e,t,n)}return e}function PH(){var e=RH();if(yH(",")){throw new Error(DW)}return e}function LH(e){Vq=e;Yq=0;Xq=Vq.length;Jq=null;iH();var t=PH();if(Jq.type!==Qq){throw new Error("Unexpect token after expression.")}return t}var IH={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function BH(e){function t(t,n,r,i){var a=e(n[0]);if(r){a=r+"("+a+")";if(r.lastIndexOf("new ",0)===0)a="("+a+")"}return a+"."+t+(i<0?"":i===0?"()":"("+n.slice(1).map(e).join(",")+")")}function n(e,n,r){return function(i){return t(e,i,n,r)}}var r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){if(t.length<3)ti("Missing arguments to clamp function.");if(t.length>3)ti("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),replace:n("replace",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(t){if(t.length<3)ti("Missing arguments to if function.");if(t.length>3)ti("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function UH(e){var t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function qH(e){e=e||{};var t=e.whitelist?ka(e.whitelist):{},n=e.blacklist?ka(e.blacklist):{},r=e.constants||IH,i=(e.functions||BH)(c),a=e.globalvar,o=e.fieldvar,u={},s={},l=0;var f=Vi(a)?a:function(e){return a+'["'+e+'"]'};function c(e){if(ai(e))return e;var t=d[e.type];if(t==null)ti("Unsupported type: "+e.type);return t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var i=e.name;if(l>0){return i}else if(ta(n,i)){return ti("Illegal identifier: "+i)}else if(ta(r,i)){return r[i]}else if(ta(t,i)){return i}else{u[i]=1;return f(i)}},MemberExpression:function(e){var t=!e.computed;var n=c(e.object);if(t)l+=1;var r=c(e.property);if(n===o){s[UH(r)]=1}if(t)l-=1;return n+(t?"."+r:"["+r+"]")},CallExpression:function(e){if(e.callee.type!=="Identifier"){ti("Illegal callee type: "+e.callee.type)}var t=e.callee.name;var n=e.arguments;var r=ta(i,t)&&i[t];if(!r)ti("Unrecognized function: "+t);return Vi(r)?r(n):r+"("+n.map(c).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(c).join(",")+"]"},BinaryExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+c(e.argument)+")"},ConditionalExpression:function(e){return"("+c(e.test)+"?"+c(e.consequent)+":"+c(e.alternate)+")"},LogicalExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(c).join(",")+"}"},Property:function(e){l+=1;var t=c(e.key);l-=1;return t+":"+c(e.value)}};function h(e){var t={code:c(e),globals:Object.keys(u),fields:Object.keys(s)};u={};s={};return t}h.functions=i;h.constants=r;return h}var WH="intersect";var HH="union";var $H="vlMulti";var GH="or";var VH="and";var YH="E",XH="R",JH="R-E",ZH="R-LE",QH="R-RE",KH="index:unit";function e$(e,t){var n=t.fields,r=t.values,i=n.length,a=0,o,u;for(;a<i;++a){u=n[a];u.getter=ui.getter||ui(u.field);o=u.getter(e);if(sa(o))o=Si(o);if(sa(r[a]))r[a]=Si(r[a]);if(sa(r[a][0]))r[a]=r[a].map(Si);if(u.type===YH){if(ri(r[a])?r[a].indexOf(o)<0:o!==r[a]){return false}}else{if(u.type===XH){if(!oa(o,r[a]))return false}else if(u.type===QH){if(!oa(o,r[a],true,false))return false}else if(u.type===JH){if(!oa(o,r[a],false,false))return false}else if(u.type===ZH){if(!oa(o,r[a],false,true))return false}}}return true}function t$(e,t,n){var r=this.context.data[e],i=r?r.values.value:[],a=r?r[KH]&&r[KH].value:undefined,o=n===WH,u=i.length,s=0,l,f,c,d,h;for(;s<u;++s){l=i[s];if(a&&o){f=f||{};c=f[d=l.unit]||0;if(c===-1)continue;h=e$(t,l);f[d]=h?-1:++c;if(h&&a.size===1)return true;if(!h&&c===a.get(d).count)return false}else{h=e$(t,l);if(o^h)return h}}return u&&o}function n$(e,t,n){var r,i;var a=this.context.data[e],o=a?a.values.value:[],u={},s={},l={},f,c,d,h,p,v,g,m,y,b=o.length,x=0,_,w;for(;x<b;++x){f=o[x];h=f.unit;c=f.fields;d=f.values;for(_=0,w=c.length;_<w;++_){p=c[_];v=u[p.field]||(u[p.field]={});g=v[h]||(v[h]=[]);l[p.field]=m=p.type.charAt(0);y=r$[m+"_union"];v[h]=y(g,$i(d[_]))}if(n){g=s[h]||(s[h]=[]);g.push($i(d).reduce((function(e,t,n){return e[c[n].field]=t,e}),{}))}}t=t||HH;Object.keys(u).forEach((function(e){u[e]=Object.keys(u[e]).map((function(t){return u[e][t]})).reduce((function(n,r){return n===undefined?r:r$[l[e]+"_"+t](n,r)}))}));o=Object.keys(s);if(n&&o.length){u[$H]=t===HH?(r={},r[GH]=o.reduce((function(e,t){return e.push.apply(e,s[t]),e}),[]),r):(i={},i[VH]=o.map((function(e){var t;return t={},t[GH]=s[e],t})),i)}return u}var r$={E_union:function(e,t){if(!e.length)return t;var n=0,r=t.length;for(;n<r;++n)if(e.indexOf(t[n])<0)e.push(t[n]);return e},E_intersect:function(e,t){return!e.length?t:e.filter((function(e){return t.indexOf(e)>=0}))},R_union:function(e,t){var n=Si(t[0]),r=Si(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(e[0]>n)e[0]=n;if(e[1]<r)e[1]=r;return e},R_intersect:function(e,t){var n=Si(t[0]),r=Si(t[1]);if(n>r){n=t[1];r=t[0]}if(!e.length)return[n,r];if(r<e[0]||e[1]<n){return[]}else{if(e[0]<n)e[0]=n;if(e[1]>r)e[1]=r}return e}};var i$=":",a$="@";function o$(e,t,n,r){if(t[0].type!==Nq)ti("First argument to selection functions must be a string literal.");var i=t[0].value,a=t.length>=2&&Ai(t).value,o="unit",u=a$+o,s=i$+i;if(a===WH&&!ta(r,u)){r[u]=n.getData(i).indataRef(n,o)}if(!ta(r,s)){r[s]=n.getData(i).tuplesRef()}}function u$(e){var t=e/255;if(t<=.03928){return t/12.92}return Math.pow((t+.055)/1.055,2.4)}function s$(e){var t=YE(e),n=u$(t.r),r=u$(t.g),i=u$(t.b);return.2126*n+.7152*r+.0722*i}function l$(e,t){var n=s$(e),r=s$(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function f$(e){var t=this.context.data[e];return t?t.values.value:[]}function c$(e,t,n){var r=this.context.data[e]["index:"+t],i=r?r.value.get(n):undefined;return i?i.count:i}function d$(e,t){var n=this.context.dataflow,r=this.context.data[e],i=r.input;n.pulse(i,n.changeset().remove(hi).insert(t));return 1}function h$(e,t,n){if(e){var r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==undefined?n:e}var p$={};function v$(e,t,n){var r=e+":"+n,i=p$[r];if(!i||i[0]!==t){p$[r]=i=[t,t(n)]}return i[1]}function g$(e,t){return v$("format",yS,t)(e)}function m$(e,t){return v$("timeFormat",Op,t)(e)}function y$(e,t){return v$("utcFormat",Ap,t)(e)}function b$(e,t){return v$("timeParse",rl,t)(e)}function x$(e,t){return v$("utcParse",al,t)(e)}var _$=new Date(2e3,0,1);function w$(e,t,n){if(!Number.isInteger(e)||!Number.isInteger(t))return"";_$.setYear(2e3);_$.setMonth(e);_$.setDate(t);return m$(_$,n)}function k$(e){return w$(e,1,"%B")}function E$(e){return w$(e,1,"%b")}function O$(e){return w$(0,2+e,"%A")}function A$(e){return w$(0,2+e,"%a")}function S$(e,t){var n;return Vi(e)?e:ai(e)?(n=t.scales[e])&&n.value:undefined}function D$(e,t){var n=S$(e,(t||this).context);return n&&n.range?n.range():[]}function C$(e,t){var n=S$(e,(t||this).context);return n?n.domain():[]}function M$(e,t){var n=S$(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function j$(e,t,n){return Jk(e||0,t||0,n||0)}function F$(e,t){var n=S$(e,(t||this).context);return n?n.copy():undefined}function N$(e,t,n){var r=S$(e,(n||this).context);return r&&t!==undefined?r(t):undefined}function T$(e,t,n){var r=S$(e,(n||this).context);return!r?undefined:ri(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t)}function z$(e,t){return function(n,r,i){if(n){var a=S$(n,(i||this).context);return a&&a.path[e](r)}else{return t(r)}}}var R$=z$("area",iF);var P$=z$("bounds",TF);var L$=z$("centroid",sN);function I$(e){var t=this.context.group,n=false;if(t)while(e){if(e===t){n=true;break}e=e.mark.group}return n}function B$(e,t,n){if(!e)return[];var r=e[0],i=e[1],a=(new Xv).set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return Lw(o,a,U$(t))}function U$(e){var t=null;if(e){var n=$i(e.marktype),r=$i(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}function q$(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function W$(){return q$(this.context.dataflow,"warn",arguments)}function H$(){return q$(this.context.dataflow,"info",arguments)}function $$(){return q$(this.context.dataflow,"debug",arguments)}function G$(){var e=[].slice.call(arguments);e.unshift({});return Zi.apply(null,e)}function V$(e,t){return e===t||e!==e&&t!==t?true:ri(e)?ri(t)&&e.length===t.length?Y$(e,t):false:ii(e)&&ii(t)?X$(e,t):false}function Y$(e,t){for(var n=0,r=e.length;n<r;++n){if(!V$(e[n],t[n]))return false}return true}function X$(e,t){for(var n in e){if(!V$(e[n],t[n]))return false}return true}function J$(e){return function(t){return X$(e,t)}}function Z$(e,t,n,r,i,a){var o=this.context.dataflow,u=this.context.data[e],s=u.input,l=u.changes,f=o.stamp(),c,d;if(o._trigger===false||!(s.value.length||t||r)){return 0}if(!l||l.stamp<f){u.changes=l=o.changeset();l.stamp=f;o.runAfter((function(){u.modified=true;o.pulse(s,l).run()}),true,1)}if(n){c=n===true?hi:ri(n)||Ma(n)?n:J$(n);l.remove(c)}if(t){l.insert(t)}if(r){c=J$(r);if(s.value.some(c)){l.remove(c)}else{l.insert(r)}}if(i){for(d in a){l.modify(i,d,a[d])}}return 1}function Q$(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function K$(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}function eG(e,t,n,r,i){e=S$(e,(i||this).context);var a=ng(t,n);var o=e.domain(),u=o[0],s=Ai(o),l=fi;if(!(s-u)){e=(e.interpolator?FD("sequential")().interpolator(e.interpolator()):FD("linear")().interpolate(e.interpolate()).range(e.range())).domain([u=0,s=1])}else{l=$D(e,u,s)}if(e.ticks){o=e.ticks(+r||15);if(u!==o[0])o.unshift(u);if(s!==Ai(o))o.push(s)}o.forEach((function(t){return a.stop(l(t),e(t))}));return a}function tG(e,t,n){var r=S$(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}function nG(e){var t=null;return function(n){return n?Qm(n,t=t||Im(e)):e}}var rG={};function iG(e){return e.data}function aG(e,t){var n=f$.call(t,e);return n.root&&n.root.lookup||rG}function oG(e,t,n){var r=aG(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(iG):undefined}function uG(e,t){var n=aG(e,this)[t];return n?n.ancestors().map(iG):undefined}var sG=typeof window!=="undefined"&&window||null;function lG(){return sG?sG.screen:{}}function fG(){return sG?[sG.innerWidth,sG.innerHeight]:[undefined,undefined]}function cG(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[undefined,undefined]}var dG=":";var hG="@";var pG="%";var vG="$";function gG(e,t,n,r){if(t[0].type!==Nq){ti("First argument to data functions must be a string literal.")}var i=t[0].value,a=dG+i;if(!ta(a,r)){try{r[a]=n.getData(i).tuplesRef()}catch(o){}}}function mG(e,t,n,r){if(t[0].type!==Nq)ti("First argument to indata must be a string literal.");if(t[1].type!==Nq)ti("Second argument to indata must be a string literal.");var i=t[0].value,a=t[1].value,o=hG+a;if(!ta(o,r)){r[o]=n.getData(i).indataRef(n,a)}}function yG(e,t,n,r){if(t[0].type===Nq){bG(n,r,t[0].value)}else if(t[0].type===zq){for(e in n.scales){bG(n,r,e)}}}function bG(e,t,n){var r=pG+n;if(!ta(t,r)){try{t[r]=e.scaleRef(n)}catch(i){}}}var xG={random:function(){return Qf()},cumulativeNormal:fc,cumulativeLogNormal:mc,cumulativeUniform:kc,densityNormal:lc,densityLogNormal:gc,densityUniform:wc,quantileNormal:cc,quantileLogNormal:yc,quantileUniform:Ec,sampleNormal:sc,sampleLogNormal:vc,sampleUniform:_c,isArray:ri,isBoolean:ua,isDate:sa,isDefined:function(e){return e!==undefined},isNumber:la,isObject:ii,isRegExp:fa,isString:ai,isTuple:Ma,isValid:function(e){return e!=null&&e===e},toBoolean:ba,toDate:_a,toNumber:Si,toString:wa,flush:ia,lerp:da,merge:G$,pad:ma,peek:Ai,span:ya,inrange:oa,truncate:Ea,rgb:YE,lab:vO,hcl:wO,hsl:tO,luminance:s$,contrast:l$,sequence:Cf,format:g$,utcFormat:y$,utcParse:x$,utcOffset:bp,utcSequence:wp,timeFormat:m$,timeParse:b$,timeOffset:yp,timeSequence:_p,timeUnitSpecifier:Ep,monthFormat:k$,monthAbbrevFormat:E$,dayFormat:O$,dayAbbrevFormat:A$,quarter:Wi,utcquarter:Hi,warn:W$,info:H$,debug:$$,extent:Qi,inScope:I$,intersect:B$,clampRange:Gi,pinchDistance:Q$,pinchAngle:K$,screen:lG,containerSize:cG,windowSize:fG,bandspace:j$,setdata:d$,pathShape:nG,panLinear:Ti,panLog:zi,panPow:Ri,panSymlog:Pi,zoomLinear:Ii,zoomLog:Bi,zoomPow:Ui,zoomSymlog:qi,encode:h$,modify:Z$};var _G=["view","item","group","xy","x","y"],wG="event.vega.",kG="this.",EG={};function OG(e){var t=BH(e);_G.forEach((function(e){return t[e]=wG+e}));for(var n in xG){t[n]=kG+n}return t}function AG(e,t,n){if(arguments.length===1){return xG[e]}xG[e]=t;if(n)EG[e]=n;if(DG)DG.functions[e]=kG+e;return this}AG("bandwidth",M$,yG);AG("copy",F$,yG);AG("domain",C$,yG);AG("range",D$,yG);AG("invert",T$,yG);AG("scale",N$,yG);AG("gradient",eG,yG);AG("geoArea",R$,yG);AG("geoBounds",P$,yG);AG("geoCentroid",L$,yG);AG("geoShape",tG,yG);AG("indata",c$,mG);AG("data",f$,gG);AG("treePath",oG,gG);AG("treeAncestors",uG,gG);AG("vlSelectionTest",t$,o$);AG("vlSelectionResolve",n$,o$);var SG={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+oi(vG+e)+"]"},functions:OG,constants:IH,visitors:EG};var DG=qH(SG);function CG(e,t,n){if(t[t.length-1]!==";"){t="return("+t+");"}var r=Function.apply(null,e.concat(t));return n&&n.functions?r.bind(n.functions):r}function MG(e,t){return CG(["_"],e,t)}function jG(e,t){return CG(["datum","_"],e,t)}function FG(e,t){return CG(["event"],e,t)}function NG(e,t){return CG(["_","event"],e,t)}function TG(e,t){return CG(["item","_"],e,t)}function zG(e,t,n){n=n||{};var r,i;for(r in e){i=e[r];n[r]=ri(i)?i.map((function(e){return RG(e,t,n)})):RG(i,t,n)}return n}function RG(e,t,n){if(!e||!ii(e))return e;for(var r=0,i=PG.length,a;r<i;++r){a=PG[r];if(ta(e,a.key)){return a.parse(e,t,n)}}return e}var PG=[{key:"$ref",parse:LG},{key:"$key",parse:BG},{key:"$expr",parse:IG},{key:"$field",parse:UG},{key:"$encode",parse:WG},{key:"$compare",parse:qG},{key:"$context",parse:HG},{key:"$subflow",parse:$G},{key:"$tupleid",parse:GG}];function LG(e,t){return t.get(e.$ref)||ti("Operator not defined: "+e.$ref)}function IG(e,t,n){if(e.$params){zG(e.$params,t,n)}var r="e:"+e.$expr+"_"+e.$name;return t.fn[r]||(t.fn[r]=Qr(jG(e.$expr,t),e.$fields,e.$name))}function BG(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=ca(e.$key,e.$flat))}function UG(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ui(e.$field,e.$name))}function qG(e,t){var n="c:"+e.$compare+"_"+e.$order,r=$i(e.$compare).map((function(e){return e&&e.$tupleid?ja:e}));return t.fn[n]||(t.fn[n]=Yi(r,e.$order))}function WG(e,t){var n=e.$encode,r={},i,a;for(i in n){a=n[i];r[i]=Qr(TG(a.$expr,t),a.$fields);r[i].output=a.$output}return r}function HG(e,t){return t}function $G(e,t){var n=e.$subflow;return function(e,r,i){var a=eV(n,t.fork()),o=a.get(n.operators[0].id),u=a.signals.parent;if(u)u.set(i);return o}}function GG(){return ja}function VG(e){return(e+"").toLowerCase()}function YG(e){return VG(e)==="operator"}function XG(e){return VG(e)==="collect"}function JG(e,t){if(YG(e.type)||!e.type){t.operator(e,e.update?MG(e.update,t):null)}else{t.transform(e,e.type)}}function ZG(e,t){if(e.params){var n=t.get(e.id);if(!n)ti("Invalid operator id: "+e.id);t.dataflow.connect(n,n.parameters(zG(e.params,t),e.react,e.initonly))}}function QG(e,t){var n=e.filter!=null?FG(e.filter,t):undefined,r=e.stream!=null?t.get(e.stream):undefined,i;if(e.source){r=t.events(e.source,e.type,n)}else if(e.merge){i=e.merge.map(t.get.bind(t));r=i[0].merge.apply(i[0],i.slice(1))}if(e.between){i=e.between.map(t.get.bind(t));r=r.between(i[0],i[1])}if(e.filter){r=r.filter(n)}if(e.throttle!=null){r=r.throttle(+e.throttle)}if(e.debounce!=null){r=r.debounce(+e.debounce)}if(r==null){ti("Invalid stream definition: "+JSON.stringify(e))}if(e.consume)r.consume(true);t.stream(e,r)}function KG(e,t){var n=ii(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=undefined;if(!r)ti("Source not defined: "+e.source);if(e.target&&e.target.$expr){i=FG(e.target.$expr,t)}else{i=t.get(e.target)}if(a&&a.$expr){if(a.$params){o=zG(a.$params,t)}a=NG(a.$expr,t)}t.update(e,r,i,a,o)}function eV(e,t){var n=e.operators||[];if(e.background){t.background=e.background}if(e.eventConfig){t.eventConfig=e.eventConfig}n.forEach((function(e){JG(e,t)}));n.forEach((function(e){ZG(e,t)}));(e.streams||[]).forEach((function(e){QG(e,t)}));(e.updates||[]).forEach((function(e){KG(e,t)}));return t.resolve()}var tV={skip:true};function nV(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((function(n){var i=t.signals[n];if(e.signals(n,i)){r[n]=i.value}}))}if(e.data){var i=n.data={};Object.keys(t.data).forEach((function(n){var r=t.data[n];if(e.data(n,r)){i[n]=r.input.value}}))}if(t.subcontext&&e.recurse!==false){n.subcontext=t.subcontext.map((function(t){return t.getState(e)}))}return n}function rV(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((function(e){n.update(t.signals[e],i[e],tV)}));Object.keys(r||{}).forEach((function(e){n.pulse(t.data[e].input,n.changeset().remove(hi).insert(r[e]))}));(e.subcontext||[]).forEach((function(e,n){var r=t.subcontext[n];if(r)r.setState(e)}))}function iV(e,t,n){return new aV(e,t,n)}function aV(e,t,n){this.dataflow=e;this.transforms=t;this.events=e.events.bind(e);this.signals={};this.scales={};this.nodes={};this.data={};this.fn={};if(n){this.functions=Object.create(n);this.functions.context=this}}function oV(e){this.dataflow=e.dataflow;this.transforms=e.transforms;this.functions=e.functions;this.events=e.events;this.signals=Object.create(e.signals);this.scales=Object.create(e.scales);this.nodes=Object.create(e.nodes);this.data=Object.create(e.data);this.fn=Object.create(e.fn);if(e.functions){this.functions=Object.create(e.functions);this.functions.context=this}}aV.prototype=oV.prototype={fork:function(){var e=new oV(this);(this.subcontext||(this.subcontext=[])).push(e);return e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,i;n.set(e.id,t);if(XG(e.type)&&(i=e.value)){if(i.$ingest){r.ingest(t,i.$ingest,i.$format)}else if(i.$request){r.preload(t,i.$request,i.$format)}else{r.pulse(t,r.changeset().insert(i))}}if(e.root){n.root=t}if(e.parent){var a=n.get(e.parent.$ref);if(a){r.connect(a,[t]);t.targets().add(a)}else{(n.unresolved=n.unresolved||[]).push((function(){a=n.get(e.parent.$ref);r.connect(a,[t]);t.targets().add(a)}))}}if(e.signal){n.signals[e.signal]=t}if(e.scale){n.scales[e.scale]=t}if(e.data){for(var o in e.data){i=n.data[o]||(n.data[o]={});e.data[o].forEach((function(e){i[e]=t}))}}},resolve:function(){(this.unresolved||[]).forEach((function(e){e()}));delete this.unresolved;return this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[VG(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},getState:nV,setState:rV};function uV(e,t,n){var r=n||xG;return eV(t,iV(e,uf,r))}function sV(e){var t=this._runtime.scales;if(!ta(t,e)){ti("Unrecognized scale or projection: "+e)}return t[e].value}var lV="width",fV="height",cV="padding",dV={skip:true};function hV(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===cV?r.left+r.right:0)}function pV(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===cV?r.top+r.bottom:0)}function vV(e){var t=e._signals,n=t[lV],r=t[fV],i=t[cV];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size;e._viewWidth=hV(e,t.size);a()}),{size:n});e._resizeHeight=e.add(null,(function(t){e._height=t.size;e._viewHeight=pV(e,t.size);a()}),{size:r});var o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1;e._resizeHeight.rank=r.rank+1;o.rank=i.rank+1}function gV(e,t,n,r,i,a){this.runAfter((function(o){var u=0;o._autosize=0;if(o.width()!==n){u=1;o.signal(lV,n,dV);o._resizeWidth.skip(true)}if(o.height()!==r){u=1;o.signal(fV,r,dV);o._resizeHeight.skip(true)}if(o._viewWidth!==e){o._resize=1;o._viewWidth=e}if(o._viewHeight!==t){o._resize=1;o._viewHeight=t}if(o._origin[0]!==i[0]||o._origin[1]!==i[1]){o._resize=1;o._origin=i}if(u)o.run("enter");if(a)o.runAfter((function(e){return e.resize()}))}),false,1)}function mV(e){return this._runtime.getState(e||{data:yV,signals:bV,recurse:true})}function yV(e,t){return t.modified&&ri(t.input.value)&&e.indexOf("_:vega:_")}function bV(e,t){return!(e==="parent"||t instanceof uf.proxy)}function xV(e){this.runAsync(null,(function(t){t._trigger=false;t._runtime.setState(e)}),(function(e){e._trigger=true}));return this}function _V(e,t){function n(t){e({timestamp:Date.now(),elapsed:t})}this._timers.push(WP(n,t))}function wV(e,t,n,r){var i=e.element();if(i)i.setAttribute("title",kV(r))}function kV(e){return e==null?"":ri(e)?OV(e):ii(e)&&!sa(e)?EV(e):e+""}function EV(e){return Object.keys(e).map((function(t){var n=e[t];return t+": "+(ri(n)?OV(n):AV(n))})).join("\n")}function OV(e){return"["+e.map(AV).join(", ")+"]"}function AV(e){return ri(e)?"[…]":ii(e)&&!sa(e)?"{…}":e}function SV(e,t){var n=this;t=t||{};tf.call(n);if(t.loader)n.loader(t.loader);if(t.logger)n.logger(t.logger);if(t.logLevel!=null)n.logLevel(t.logLevel);n._el=null;n._elBind=null;n._renderType=t.renderer||zw.Canvas;n._scenegraph=new __;var r=n._scenegraph.root;n._renderer=null;n._tooltip=t.tooltip||wV,n._redraw=true;n._handler=(new B_).scene(r);n._preventDefault=false;n._timers=[];n._eventListeners=[];n._resizeListeners=[];n._eventConfig=ZU(e.eventConfig);var i=uV(n,e,t.functions);n._runtime=i;n._signals=i.signals;n._bind=(e.bindings||[]).map((function(e){return{state:null,param:Zi({},e)}}));if(i.root)i.root.set(r);r.source=i.data.root.input;n.pulse(i.data.root.input,n.changeset().insert(r.items));n._width=n.width();n._height=n.height();n._viewWidth=hV(n,n._width);n._viewHeight=pV(n,n._height);n._origin=[0,0];n._resize=0;n._autosize=1;vV(n);FU(n);TU(n);n.description(e.description);if(t.hover)n.hover();if(t.container)n.initialize(t.container,t.bind)}var DV=aa(SV,tf);DV.evaluate=function(e,t,n){return Je(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:return[4,tf.prototype.evaluate.call(this,e,t)];case 1:i.sent();if(!(this._redraw||this._resize))return[3,6];i.label=2;case 2:i.trys.push([2,5,,6]);if(!this._renderer)return[3,4];if(this._resize){this._resize=0;HU(this)}return[4,this._renderer.renderAsync(this._scenegraph.root)];case 3:i.sent();i.label=4;case 4:this._redraw=false;return[3,6];case 5:r=i.sent();this.error(r);return[3,6];case 6:if(n)Sa(this,n);return[2,this]}}))}))};DV.dirty=function(e){this._redraw=true;this._renderer&&this._renderer.dirty(e)};DV.description=function(e){if(arguments.length){var t=e!=null?e+"":null;if(t!==this._desc)jU(this._el,this._desc=t);return this}return this._desc};DV.container=function(){return this._el};DV.scenegraph=function(){return this._scenegraph};DV.origin=function(){return this._origin.slice()};function CV(e,t){return ta(e._signals,t)?e._signals[t]:ti("Unrecognized signal name: "+oi(t))}DV.signal=function(e,t,n){var r=CV(this,e);return arguments.length===1?r.value:this.update(r,t,n)};DV.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")};DV.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")};DV.padding=function(e){return arguments.length?this.signal("padding",Aq(e)):Aq(this.signal("padding"))};DV.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")};DV.background=function(e){return arguments.length?this.signal("background",e):this.signal("background")};DV.renderer=function(e){if(!arguments.length)return this._renderType;if(!Pw(e))ti("Unrecognized renderer type: "+e);if(e!==this._renderType){this._renderType=e;this._resetRenderer()}return this};DV.tooltip=function(e){if(!arguments.length)return this._tooltip;if(e!==this._tooltip){this._tooltip=e;this._resetRenderer()}return this};DV.loader=function(e){if(!arguments.length)return this._loader;if(e!==this._loader){tf.prototype.loader.call(this,e);this._resetRenderer()}return this};DV.resize=function(){this._autosize=1;return this.touch(CV(this,"autosize"))};DV._resetRenderer=function(){if(this._renderer){this._renderer=null;this.initialize(this._el,this._elBind)}};DV._resizeView=gV;DV.addEventListener=function(e,t,n){var r=t;if(!(n&&n.trap===false)){r=xq(this,t);r.raw=t}this._handler.on(e,r);return this};DV.removeEventListener=function(e,t){var n=this._handler.handlers(e),r=n.length,i,a;while(--r>=0){a=n[r].type;i=n[r].handler;if(e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}}return this};DV.addResizeListener=function(e){var t=this._resizeListeners;if(t.indexOf(e)<0){t.push(e)}return this};DV.removeResizeListener=function(e){var t=this._resizeListeners,n=t.indexOf(e);if(n>=0){t.splice(n,1)}return this};function MV(e,t){var n=e._targets||[],r=n.filter((function(e){var n=e._update;return n&&n.handler===t}));return r.length?r[0]:null}function jV(e,t,n,r){var i=MV(n,r);if(!i){i=xq(this,(function(){r(t,n.value)}));i.handler=r;e.on(n,null,i)}return e}function FV(e,t,n){var r=MV(t,n);if(r)t._targets.remove(r);return e}DV.addSignalListener=function(e,t){return jV(this,e,CV(this,e),t)};DV.removeSignalListener=function(e,t){return FV(this,CV(this,e),t)};DV.addDataListener=function(e,t){return jV(this,e,RU(this,e).values,t)};DV.removeDataListener=function(e,t){return FV(this,RU(this,e).values,t)};DV.preventDefault=function(e){if(arguments.length){this._preventDefault=e;return this}else{return this._preventDefault}};DV.timer=_V;DV.events=eq;DV.finalize=aq;DV.hover=iq;DV.data=PU;DV.change=LU;DV.insert=IU;DV.remove=BU;DV.scale=sV;DV.initialize=wq;DV.toImageURL=Dq;DV.toCanvas=Mq;DV.toSVG=jq;DV.getState=mV;DV.setState=xV;function NV(e){return ii(e)?e:{type:e||"pad"}}var TV=function(e){return+e||0};var zV=function(e){return{top:e,bottom:e,left:e,right:e}};function RV(e){return!ii(e)?zV(TV(e)):e.signal?e:{top:TV(e.top),bottom:TV(e.bottom),left:TV(e.left),right:TV(e.right)}}var PV="outer",LV=["value","update","init","react","bind"];function IV(e,t){ti(e+' for "outer" push: '+oi(t))}function BV(e,t){var n=e.name;if(e.push===PV){if(!t.signals[n])IV("No prior signal definition",n);LV.forEach((function(t){if(e[t]!==undefined)IV("Invalid property ",t)}))}else{var r=t.addSignal(n,e.value);if(e.react===false)r.react=false;if(e.bind)t.addBinding(n,e.bind)}}function UV(e,t,n){var r={},i,a;try{e=ai(e)?e:oi(e)+"";i=LH(e)}catch(o){ti("Expression parse error: "+e)}i.visit((function e(n){if(n.type!==Lq)return;var i=n.callee.name,a=SG.visitors[i];if(a)a(i,n.arguments,t,r)}));a=DG(i);a.globals.forEach((function(e){var n=vG+e;if(!ta(r,n)&&t.getSignal(e)){r[n]=t.signalRef(e)}}));return{$expr:n?n+"return("+a.code+");":a.code,$fields:a.fields,$params:r}}function qV(e,t,n,r){this.id=-1;this.type=e;this.value=t;this.params=n;if(r)this.parent=r}function WV(e,t,n,r){return new qV(e,t,n,r)}function HV(e,t){return WV("operator",e,t)}function $V(e){var t={$ref:e.id};if(e.id<0)(e.refs=e.refs||[]).push(t);return t}function GV(e,t){return t?{$field:e,$name:t}:{$field:e}}var VV=GV("key");function YV(e,t){return{$compare:e,$order:t}}function XV(e,t){var n={$key:e};if(t)n.$flat=true;return n}var JV="ascending";var ZV="descending";function QV(e){return!ii(e)?"":(e.order===ZV?"-":"+")+KV(e.op,e.field)}function KV(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var eY="scope";var tY="view";function nY(e){return e&&e.signal}function rY(e){return e&&e.expr}function iY(e){if(nY(e))return true;if(ii(e))for(var t in e){if(iY(e[t]))return true}return false}function aY(e,t){return e!=null?e:t}function oY(e){return e&&e.signal||e}var uY="timer";function sY(e,t){var n=e.merge?fY:e.stream?cY:e.type?dY:ti("Invalid stream specification: "+oi(e));return n(e,t)}function lY(e){return e===eY?tY:e||tY}function fY(e,t){var n=e.merge.map((function(e){return sY(e,t)})),r=hY({merge:n},e,t);return t.addStream(r).id}function cY(e,t){var n=sY(e.stream,t),r=hY({stream:n},e,t);return t.addStream(r).id}function dY(e,t){var n,r;if(e.type===uY){n=t.event(uY,e.throttle);e={between:e.between,filter:e.filter}}else{n=t.event(lY(e.source),e.type)}r=hY({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function hY(e,t,n){var r=t.between;if(r){if(r.length!==2){ti('Stream "between" parameter must have 2 entries: '+oi(t))}e.between=[sY(r[0],n),sY(r[1],n)]}r=t.filter?[].concat(t.filter):[];if(t.marktype||t.markname||t.markrole){r.push(pY(t.marktype,t.markname,t.markrole))}if(t.source===eY){r.push("inScope(event.item)")}if(r.length){e.filter=UV("("+r.join(")&&(")+")").$expr}if((r=t.throttle)!=null){e.throttle=+r}if((r=t.debounce)!=null){e.debounce=+r}if(t.consume){e.consume=true}return e}function pY(e,t,n){var r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}function vY(e,t,n){AY=t||gY;SY=n||DY;return jY(e.trim()).map(FY)}var gY="view",mY="[",yY="]",bY="{",xY="}",_Y=":",wY=",",kY="@",EY=">",OY=/[[\]{}]/,AY,SY,DY={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function CY(e){return SY[e]}function MY(e,t,n,r,i){var a=0,o=e.length,u;for(;t<o;++t){u=e[t];if(!a&&u===n)return t;else if(i&&i.indexOf(u)>=0)--a;else if(r&&r.indexOf(u)>=0)++a}return t}function jY(e){var t=[],n=0,r=e.length,i=0;while(i<r){i=MY(e,i,wY,mY+bY,yY+xY);t.push(e.substring(n,i).trim());n=++i}if(t.length===0){throw"Empty event selector: "+e}return t}function FY(e){return e[0]==="["?NY(e):TY(e)}function NY(e){var t=e.length,n=1,r,i;n=MY(e,n,yY,mY,yY);if(n===t){throw"Empty between selector: "+e}r=jY(e.substring(1,n));if(r.length!==2){throw"Between selector must have two elements: "+e}e=e.slice(n+1).trim();if(e[0]!==EY){throw"Expected '>' after between selector: "+e}r=r.map(FY);i=FY(e.slice(1).trim());if(i.between){return{between:r,stream:i}}else{i.between=r}return i}function TY(e){var t={source:AY},n=[],r=[0,0],i=0,a=0,o=e.length,u=0,s,l;if(e[o-1]===xY){u=e.lastIndexOf(bY);if(u>=0){try{r=zY(e.substring(u+1,o-1))}catch(f){throw"Invalid throttle specification: "+e}e=e.slice(0,u).trim();o=e.length}else throw"Unmatched right brace: "+e;u=0}if(!o)throw e;if(e[0]===kY)i=++u;s=MY(e,u,_Y);if(s<o){n.push(e.substring(a,s).trim());a=u=++s}u=MY(e,u,mY);if(u===o){n.push(e.substring(a,o).trim())}else{n.push(e.substring(a,u).trim());l=[];a=++u;if(a===o)throw"Unmatched left bracket: "+e}while(u<o){u=MY(e,u,yY);if(u===o)throw"Unmatched left bracket: "+e;l.push(e.substring(a,u).trim());if(u<o-1&&e[++u]!==mY)throw"Expected left bracket: "+e;a=++u}if(!(o=n.length)||OY.test(n[o-1])){throw"Invalid event selector: "+e}if(o>1){t.type=n[1];if(i){t.markname=n[0].slice(1)}else if(CY(n[0])){t.marktype=n[0]}else{t.source=n[0]}}else{t.type=n[0]}if(t.type.slice(-1)==="!"){t.consume=true;t.type=t.type.slice(0,-1)}if(l!=null)t.filter=l;if(r[0])t.throttle=r[0];if(r[1])t.debounce=r[1];return t}function zY(e){var t=e.split(wY);if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}var RY="var datum=event.item&&event.item.datum;";function PY(e,t,n){var r=e.events,i=e.update,a=e.encode,o=[],u={target:n};if(!r){ti("Signal update missing events specification.")}if(ai(r)){r=vY(r,t.isSubscope()?eY:tY)}r=$i(r).filter((function(e){return e.signal||e.scale?(o.push(e),0):1}));if(o.length>1){o=[IY(o)]}if(r.length){o.push(r.length>1?{merge:r}:r[0])}if(a!=null){if(i)ti("Signal encode and update are mutually exclusive.");i="encode(item(),"+oi(a)+")"}u.update=ai(i)?UV(i,t,RY):i.expr!=null?UV(i.expr,t,RY):i.value!=null?i.value:i.signal!=null?{$expr:"_.value",$params:{value:t.signalRef(i.signal)}}:ti("Invalid signal update specification.");if(e.force){u.options={force:true}}o.forEach((function(e){t.addUpdate(Zi(LY(e,t),u))}))}function LY(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):sY(e,t)}}function IY(e){return{signal:"["+e.map((function(e){return e.scale?'scale("'+e.scale+'")':e.signal}))+"]"}}function BY(e,t){var n=t.getSignal(e.name),r=e.update;if(e.init){if(r){ti("Signals can not include both init and update expressions.")}else{r=e.init;n.initonly=true}}if(r){r=UV(r,t);n.update=r.$expr;n.params=r.$params}if(e.on){e.on.forEach((function(e){PY(e,t,n.id)}))}}function UY(e){return function(t,n,r){return WV(e,n,t||undefined,r)}}var qY=UY("aggregate");var WY=UY("axisticks");var HY=UY("bound");var $Y=UY("collect");var GY=UY("compare");var VY=UY("datajoin");var YY=UY("encode");var XY=UY("expression");var JY=UY("facet");var ZY=UY("field");var QY=UY("key");var KY=UY("legendentries");var eX=UY("load");var tX=UY("mark");var nX=UY("multiextent");var rX=UY("multivalues");var iX=UY("overlap");var aX=UY("params");var oX=UY("prefacet");var uX=UY("projection");var sX=UY("proxy");var lX=UY("relay");var fX=UY("render");var cX=UY("scale");var dX=UY("sieve");var hX=UY("sortitems");var pX=UY("viewlayout");var vX=UY("values");var gX=0;var mX={min:"min",max:"max",count:"sum"};function yX(e,t){var n=e.type||"linear";if(!ND(n)){ti("Unrecognized scale type: "+oi(n))}t.addScale(e.name,{type:n,domain:undefined})}function bX(e,t){var n=t.getScale(e.name).params,r;n.domain=kX(e.domain,e,t);if(e.range!=null){n.range=zX(e,t,n)}if(e.interpolate!=null){TX(e.interpolate,n)}if(e.nice!=null){n.nice=NX(e.nice)}if(e.bins!=null){n.bins=FX(e.bins,t)}for(r in e){if(ta(n,r)||r==="name")continue;n[r]=xX(e[r],t)}}function xX(e,t){return!ii(e)?e:e.signal?t.signalRef(e.signal):ti("Unsupported object: "+oi(e))}function _X(e,t){return e.signal?t.signalRef(e.signal):e.map((function(e){return xX(e,t)}))}function wX(e){ti("Can not find data set: "+oi(e))}function kX(e,t,n){if(!e){if(t.domainMin!=null||t.domainMax!=null){ti("No scale domain defined for domainMin/domainMax to override.")}return}return e.signal?n.signalRef(e.signal):(ri(e)?EX:e.fields?AX:OX)(e,t,n)}function EX(e,t,n){return e.map((function(e){return xX(e,n)}))}function OX(e,t,n){var r=n.getData(e.data);if(!r)wX(e.data);return RD(t.type)?r.valuesRef(n,e.field,CX(e.sort,false)):BD(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function AX(e,t,n){var r=e.data,i=e.fields.reduce((function(e,t){t=ai(t)?{data:r,field:t}:ri(t)||t.signal?SX(t,n):t;e.push(t);return e}),[]);return(RD(t.type)?DX:BD(t.type)?MX:jX)(e,n,i)}function SX(e,t){var n="_:vega:_"+gX++,r=$Y({});if(ri(e)){r.value={$ingest:e}}else if(e.signal){var i="setdata("+oi(n)+","+e.signal+")";r.params.input=t.signalRef(i)}t.addDataPipeline(n,[r,dX({})]);return{data:n,field:"data"}}function DX(e,t,n){var r=CX(e.sort,true),i,a,o,u,s;i=n.map((function(e){var n=t.getData(e.data);if(!n)wX(e.data);return n.countsRef(t,e.field,r)}));a={groupby:VV,pulse:i};if(r){o=r.op||"count";s=r.field?KV(o,r.field):"count";a.ops=[mX[o]];a.fields=[t.fieldRef(s)];a.as=[s]}o=t.add(qY(a));u=t.add($Y({pulse:$V(o)}));s=t.add(vX({field:VV,sort:t.sortRef(r),pulse:$V(u)}));return $V(s)}function CX(e,t){if(e){if(!e.field&&!e.op){if(ii(e))e.field="key";else e={field:"key"}}else if(!e.field&&e.op!=="count"){ti("No field provided for sort aggregate op: "+e.op)}else if(t&&e.field){if(e.op&&!mX[e.op]){ti("Multiple domain scales can not be sorted using "+e.op)}}}return e}function MX(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);if(!n)wX(e.data);return n.domainRef(t,e.field)}));return $V(t.add(rX({values:r})))}function jX(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);if(!n)wX(e.data);return n.extentRef(t,e.field)}));return $V(t.add(nX({extents:r})))}function FX(e,t){return e.signal||ri(e)?_X(e,t):t.objectProperty(e)}function NX(e){return ii(e)?{interval:xX(e.interval),step:xX(e.step)}:xX(e)}function TX(e,t){t.interpolate=xX(e.type||e);if(e.gamma!=null){t.interpolateGamma=xX(e.gamma)}}function zX(e,t,n){var r=e.range,i=t.config.range;if(r.signal){return t.signalRef(r.signal)}else if(ai(r)){if(i&&ta(i,r)){e=Zi({},e,{range:i[r]});return zX(e,t,n)}else if(r==="width"){r=[0,{signal:"width"}]}else if(r==="height"){r=RD(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]}else{ti("Unrecognized scale range value: "+oi(r))}}else if(r.scheme){n.scheme=ri(r.scheme)?_X(r.scheme,t):xX(r.scheme,t);if(r.extent)n.schemeExtent=_X(r.extent,t);if(r.count)n.schemeCount=xX(r.count,t);return}else if(r.step){n.rangeStep=xX(r.step,t);return}else if(RD(e.type)&&!ri(r)){return kX(r,e,t)}else if(!ri(r)){ti("Unsupported range type: "+oi(r))}return r.map((function(e){return(ri(e)?_X:xX)(e,t)}))}function RX(e,t){var n=t.config.projection||{},r={};for(var i in e){if(i==="name")continue;r[i]=PX(e[i],i,t)}for(i in n){if(r[i]==null){r[i]=PX(n[i],i,t)}}t.addProjection(e.name,r)}function PX(e,t,n){return ri(e)?e.map((function(e){return PX(e,t,n)})):!ii(e)?e:e.signal?n.signalRef(e.signal):t==="fit"?e:ti("Unsupported parameter object: "+oi(e))}var LX="top";var IX="left";var BX="right";var UX="bottom";var qX="center";var WX="vertical";var HX="start";var $X="middle";var GX="end";var VX="index";var YX="label";var XX="offset";var JX="perc";var ZX="perc2";var QX="size";var KX="value";var eJ="guide-label";var tJ="guide-title";var nJ="group-title";var rJ="group-subtitle";var iJ="symbol";var aJ="gradient";var oJ="discrete";var uJ=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"];var sJ={name:1,style:1,interactive:1};var lJ={value:0};var fJ={value:1};var cJ=ka(["rule"]),dJ=ka(["group","image","rect"]);function hJ(e,t){var n="";if(cJ[t])return n;if(e.x2){if(e.x){if(dJ[t]){n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"}n+="o.width=o.x2-o.x;"}else{n+="o.x=o.x2-(o.width||0);"}}if(e.xc){n+="o.x=o.xc-(o.width||0)/2;"}if(e.y2){if(e.y){if(dJ[t]){n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"}n+="o.height=o.y2-o.y;"}else{n+="o.y=o.y2-(o.height||0);"}}if(e.yc){n+="o.y=o.yc-(o.height||0)/2;"}return n}function pJ(e,t,n,r){function i(e,i,a,o){var u=kJ(null,i,t,n,r),s=kJ(null,a,t,n,r),l=kJ(null,o,t,n,r);return"this."+e+"("+[u,s,l].join(",")+").toString()"}return e.c?i("hcl",e.h,e.c,e.l):e.h||e.s?i("hsl",e.h,e.s,e.l):e.l||e.a?i("lab",e.l,e.a,e.b):e.r||e.g||e.b?i("rgb",e.r,e.g,e.b):null}function vJ(e,t,n,r){var i=UV(e,t);i.$fields.forEach((function(e){r[e]=1}));Zi(n,i.$params);return i.$expr}function gJ(e,t,n,r){return mJ(ii(e)?e:{datum:e},t,n,r)}function mJ(e,t,n,r){var i,a,o;if(e.signal){i="datum";o=vJ(e.signal,t,n,r)}else if(e.group||e.parent){a=Math.max(1,e.level||1);i="item";while(a-- >0){i+=".mark.group"}if(e.parent){o=e.parent;i+=".datum"}else{o=e.group}}else if(e.datum){i="datum";o=e.datum}else{ti("Invalid field reference: "+oi(e))}if(!e.signal){if(ai(o)){r[o]=1;o=ni(o).map(oi).join("][")}else{o=mJ(o,t,n,r)}}return i+"["+o+"]"}function yJ(e,t,n,r){return ii(e)?"("+kJ(null,e,t,n,r)+")":e}function bJ(e,t,n,r,i){var a=_J(e.scale,n,r,i),o,u,s;if(e.range!=null){o=+e.range;u=a+".range()";t=o===0?u+"[0]":"($="+u+","+(o===1?"$[$.length-1]":"$[0]+"+o+"*($[$.length-1]-$[0])")+")"}else{if(t!==undefined)t=a+"("+t+")";if(e.band&&(s=xJ(e.scale,n))){u=a+".bandwidth";if(e.band.signal){o=u+"()*"+yJ(e.band,n,r,i)}else{o=+e.band;o=u+"()"+(o===1?"":"*"+o)}if(s<0)o="("+u+"?"+o+":0)";t=(t?t+"+":"")+o;if(e.extra){t="(datum.extra?"+a+"(datum.extra.value):"+t+")"}}if(t==null)t="0"}return t}function xJ(e,t){if(!ai(e))return-1;var n=t.scaleType(e);return n==="band"||n==="point"?1:0}function _J(e,t,n,r){var i;if(ai(e)){i=pG+e;if(!ta(n,i)){n[i]=t.scaleRef(e)}i=oi(i)}else{for(i in t.scales){n[pG+i]=t.scaleRef(i)}i=oi(pG)+"+"+(e.signal?"("+vJ(e.signal,t,n,r)+")":gJ(e,t,n,r))}return"_["+i+"]"}function wJ(e,t,n,r){return"this.gradient("+_J(e.gradient,t,n,r)+","+oi(e.start)+","+oi(e.stop)+","+oi(e.count)+")"}function kJ(e,t,n,r,i){if(t.gradient!=null){return wJ(t,n,r,i)}var a=t.signal?vJ(t.signal,n,r,i):t.color?pJ(t.color,n,r,i):t.field!=null?gJ(t.field,n,r,i):t.value!==undefined?oi(t.value):undefined;if(t.scale!=null){a=bJ(t,a,n,r,i)}if(a===undefined){a=null}if(t.exponent!=null){a="Math.pow("+a+","+yJ(t.exponent,n,r,i)+")"}if(t.mult!=null){a+="*"+yJ(t.mult,n,r,i)}if(t.offset!=null){a+="+"+yJ(t.offset,n,r,i)}if(t.round){a="Math.round("+a+")"}return a}function EJ(e,t,n){var r=e+"["+oi(t)+"]";return"$="+n+";if("+r+"!==$)"+r+"=$,m=1;"}function OJ(e,t,n,r,i){var a="";t.forEach((function(t){var o=kJ(e,t,n,r,i);a+=t.test?vJ(t.test,n,r,i)+"?"+o+":":o}));if(Ai(a)===":"){a+="null"}return EJ("o",e,a)}function AJ(e,t,n,r){var i={},a="var o=item,datum=o.datum,m=0,$;",o,u,s;for(o in e){u=e[o];if(ri(u)){a+=OJ(o,u,r,n,i)}else{s=kJ(o,u,r,n,i);a+=EJ("o",o,s)}}a+=hJ(e,t);a+="return m;";return{$expr:a,$fields:Object.keys(i),$output:Object.keys(e)}}var SJ="mark";var DJ="frame";var CJ="scope";var MJ="axis";var jJ="axis-domain";var FJ="axis-grid";var NJ="axis-label";var TJ="axis-tick";var zJ="axis-title";var RJ="legend";var PJ="legend-band";var LJ="legend-entry";var IJ="legend-gradient";var BJ="legend-label";var UJ="legend-symbol";var qJ="legend-title";var WJ="title";var HJ="title-text";var $J="title-subtitle";function GJ(e){return ii(e)&&!ri(e)?Zi({},e):{value:e}}function VJ(e,t,n,r){if(n!=null){if(ii(n)&&!ri(n)){e.update[t]=n}else{e[r||"enter"][t]={value:n}}return 1}else{return 0}}function YJ(e,t,n){for(var r in t){VJ(e,r,t[r])}for(var i in n){VJ(e,i,n[i],"update")}}function XJ(e,t,n){for(var r in t){if(n&&ta(n,r))continue;e[r]=Zi(e[r]||{},t[r])}return e}function JJ(e,t,n,r,i,a){var o,u;a=a||{};a.encoders={$encode:o={}};e=ZJ(e,t,n,r,i.config);for(u in e){o[u]=AJ(e[u],t,a,i)}return a}function ZJ(e,t,n,r,i){var a={},o={},u,s,l,f;s="lineBreak";if(t==="text"&&i[s]!=null&&!KJ(s,e)){QJ(a,s,i[s])}if(n=="legend"||String(n).startsWith("axis")){n=null}f=n===DJ?i.group:n===SJ?Zi({},i.mark,i[t]):null;for(s in f){l=KJ(s,e)||(s==="fill"||s==="stroke")&&(KJ("fill",e)||KJ("stroke",e));if(!l)QJ(a,s,f[s])}$i(r).forEach((function(t){var n=i.style&&i.style[t];for(var r in n){if(!KJ(r,e)){QJ(a,r,n[r])}}}));e=Zi({},e);for(s in a){f=a[s];if(f.signal){(u=u||{})[s]=f}else{o[s]=f}}e.enter=Zi(o,e.enter);if(u)e.update=Zi(u,e.update);return e}function QJ(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}function KJ(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function eZ(e,t,n,r,i,a,o){return{type:e,name:o?o.name:undefined,role:t,style:o&&o.style||n,key:r,from:i,interactive:!!(o&&o.interactive),encode:XJ(a,o,sJ)}}function tZ(e,t){var n=function(n,r){return aY(e[n],aY(t[n],r))};n.isVertical=function(n){return WX===aY(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))};n.gradientLength=function(){return aY(e.gradientLength,t.gradientLength||t.gradientWidth)};n.gradientThickness=function(){return aY(e.gradientThickness,t.gradientThickness||t.gradientHeight)};n.entryColumns=function(){return aY(e.columns,aY(t.columns,+n.isVertical(true)))};return n}function nZ(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function rZ(e,t,n){var r=t.config.style[n];return r&&r[e]}function iZ(e,t,n){return'item.anchor === "'+HX+'" ? '+e+' : item.anchor === "'+GX+'" ? '+t+" : "+n}var aZ=iZ(oi(IX),oi(BX),oi(qX));function oZ(e){var t=e("tickBand"),n=e("tickOffset"),r,i;if(!t){r=e("bandPosition");i=e("tickExtra")}else if(t.signal){r={signal:"("+t.signal+")==='extent'?1:0.5"};i={signal:"("+t.signal+")==='extent'?true:false"};if(!ii(n)){n={signal:"("+t.signal+")==='extent'?0:"+n}}}else if(t==="extent"){r=1;i=true;n=0}else{r=.5;i=false}return{extra:i,band:r,offset:n}}function uZ(e,t){return!t?e:!e?t:!ii(e)?{value:e,offset:t}:__assign(__assign({},e),{offset:uZ(e.offset,t)})}var sZ="group";var lZ="rect";var fZ="rule";var cZ="symbol";var dZ="text";function hZ(e,t,n,r){var i=tZ(e,n),a=i.isVertical(),o=i.gradientThickness(),u=i.gradientLength(),s,l,f,c,d,h;if(a){f=[0,1];c=[0,0];d=o;h=u}else{f=[0,0];c=[1,0];d=u;h=o}s={enter:l={opacity:lJ,x:lJ,y:lJ,width:GJ(d),height:GJ(h)},update:Zi({},l,{opacity:fJ,fill:{gradient:t,start:f,stop:c}}),exit:{opacity:lJ}};YJ(s,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")});return eZ(lZ,IJ,null,undefined,undefined,s,r)}function pZ(e,t,n,r,i){var a=tZ(e,n),o=a.isVertical(),u=a.gradientThickness(),s=a.gradientLength(),l,f,c,d,h,p,v="";o?(c="y",h="y2",d="x",p="width",v="1-"):(c="x",h="x2",d="y",p="height");f={opacity:lJ,fill:{scale:t,field:KX}};f[c]={signal:v+"datum."+JX,mult:s};f[d]=lJ;f[h]={signal:v+"datum."+ZX,mult:s};f[p]=GJ(u);l={enter:f,update:Zi({},f,{opacity:fJ}),exit:{opacity:lJ}};YJ(l,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")});return eZ(lZ,PJ,null,KX,i,l,r)}var vZ="datum."+JX+'<=0?"'+IX+'":datum.'+JX+'>=1?"'+BX+'":"'+qX+'"',gZ="datum."+JX+'<=0?"'+UX+'":datum.'+JX+'>=1?"'+LX+'":"'+$X+'"';function mZ(e,t,n,r){var i=tZ(e,t),a=i.isVertical(),o=GJ(i.gradientThickness()),u=i.gradientLength(),s=i("labelOverlap"),l=i("labelSeparation"),f,c,d,h,p,v="";f={enter:c={opacity:lJ},update:d={opacity:fJ,text:{field:YX}},exit:{opacity:lJ}};YJ(f,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:aY(e.labelLimit,t.gradientLabelLimit)});if(a){c.align={value:"left"};c.baseline=d.baseline={signal:gZ};h="y";p="x";v="1-"}else{c.align=d.align={signal:vZ};c.baseline={value:"top"};h="x";p="y"}c[h]=d[h]={signal:v+"datum."+JX,mult:u};c[p]=d[p]=o;o.offset=aY(e.labelOffset,t.gradientLabelOffset)||0;e=eZ(dZ,BJ,eJ,KX,r,f,n);if(s){e.overlap={separation:l,method:s,order:"datum."+VX}}return e}function yZ(e,t,n,r,i,a,o,u){return{type:sZ,name:n,role:e,style:t,from:r,interactive:i||false,encode:a,marks:o,layout:u}}function bZ(e,t,n,r,i){var a=tZ(e,t),o=n.entries,u=!!(o&&o.interactive),s=o?o.name:undefined,l=a("clipHeight"),f=a("symbolOffset"),c={data:"value"},d={},h="("+i+") ? datum."+XX+" : datum."+QX,p=l?GJ(l):{field:QX},v="datum."+VX,g="max(1, "+i+")",m,y,b,x,_,w,k;p.mult=.5;d={enter:m={opacity:lJ,x:{signal:h,mult:.5,offset:f},y:p},update:y={opacity:fJ,x:m.x,y:m.y},exit:{opacity:lJ}};var E=null,O=null;if(!e.fill){E=t.symbolBaseFillColor;O=t.symbolBaseStrokeColor}YJ(d,{fill:a("symbolFillColor",E),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",O),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")});uJ.forEach((function(t){if(e[t]){y[t]=m[t]={scale:e[t],field:KX}}}));x=eZ(cZ,UJ,null,KX,c,d,n.symbols);if(l)x.clip=true;b=GJ(f);b.offset=a("labelOffset");d={enter:m={opacity:lJ,x:{signal:h,offset:b},y:p},update:y={opacity:fJ,text:{field:YX},x:m.x,y:m.y},exit:{opacity:lJ}};YJ(d,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});_=eZ(dZ,BJ,eJ,KX,c,d,n.labels);d={enter:{noBound:{value:!l},width:lJ,height:l?GJ(l):lJ,opacity:lJ},exit:{opacity:lJ},update:y={opacity:fJ,row:{signal:null},column:{signal:null}}};if(a.isVertical(true)){w="ceil(item.mark.items.length / "+g+")";y.row.signal=v+"%"+w;y.column.signal="floor("+v+" / "+w+")";k={field:["row",v]}}else{y.row.signal="floor("+v+" / "+g+")";y.column.signal=v+" % "+g;k={field:v}}y.column.signal="("+i+")?"+y.column.signal+":"+v;r={facet:{data:r,name:"value",groupby:VX}};e=yZ(CJ,null,s,r,u,XJ(d,o,sJ),[x,_]);e.sort=k;return e}function xZ(e,t){var n=tZ(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:true,column:false},padding:{row:n("rowPadding"),column:n("columnPadding")}}}var _Z='item.orient === "left"',wZ='item.orient === "right"',kZ="("+_Z+" || "+wZ+")",EZ="datum.vgrad && "+kZ,OZ=iZ('"top"','"bottom"','"middle"'),AZ=iZ('"right"','"left"','"center"'),SZ="datum.vgrad && "+wZ+" ? ("+AZ+") : ("+kZ+" && !(datum.vgrad && "+_Z+')) ? "left" : '+aZ,DZ="item._anchor || ("+kZ+' ? "middle" : "start")',CZ=EZ+" ? ("+_Z+" ? -90 : 90) : 0",MZ=kZ+" ? (datum.vgrad ? ("+wZ+' ? "bottom" : "top") : '+OZ+') : "top"';function jZ(e,t,n,r){var i=tZ(e,t),a;a={enter:{opacity:lJ},update:{opacity:fJ,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:lJ}};YJ(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:DZ},angle:{signal:CZ},align:{signal:SZ},baseline:{signal:MZ},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")});return eZ(dZ,qJ,tJ,null,r,a,n)}function FZ(e,t){var n;if(ii(e)){if(e.signal){n=e.signal}else if(e.path){n="pathShape("+NZ(e.path)+")"}else if(e.sphere){n="geoShape("+NZ(e.sphere)+', {type: "Sphere"})'}}return n?t.signalRef(n):!!e}function NZ(e){return ii(e)&&e.signal?e.signal:oi(e)}function TZ(e){var t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===sZ?CJ:t||SJ}function zZ(e){return{marktype:e.type,name:e.name||undefined,role:e.role||TZ(e),zindex:+e.zindex||undefined}}function RZ(e,t){return e&&e.signal?t.signalRef(e.signal):e===false?false:true}function PZ(e,t){var n=sf(e.type);if(!n)ti("Unrecognized transform type: "+oi(e.type));var r=WV(n.type.toLowerCase(),null,LZ(n,e,t));if(e.signal)t.addSignal(e.signal,t.proxy(r));r.metadata=n.metadata||{};return r}function LZ(e,t,n){var r={},i,a,o;for(a=0,o=e.params.length;a<o;++a){i=e.params[a];r[i.name]=IZ(i,t,n)}return r}function IZ(e,t,n){var r=e.type,i=t[e.name];if(r==="index"){return UZ(e,t,n)}else if(i===undefined){if(e.required){ti("Missing required "+oi(t.type)+" parameter: "+oi(e.name))}return}else if(r==="param"){return qZ(e,t,n)}else if(r==="projection"){return n.projectionRef(t[e.name])}return e.array&&!nY(i)?i.map((function(t){return BZ(e,t,n)})):BZ(e,i,n)}function BZ(e,t,n){var r=e.type;if(nY(t)){return VZ(r)?ti("Expression references can not be signals."):YZ(r)?n.fieldRef(t):XZ(r)?n.compareRef(t):n.signalRef(t.signal)}else{var i=e.expr||YZ(r);return i&&HZ(t)?n.exprRef(t.expr,t.as):i&&$Z(t)?GV(t.field,t.as):VZ(r)?UV(t,n):GZ(r)?$V(n.getData(t).values):YZ(r)?GV(t):XZ(r)?n.compareRef(t):t}}function UZ(e,t,n){if(!ai(t.from)){ti('Lookup "from" parameter must be a string literal.')}return n.getData(t.from).lookupRef(n,t.key)}function qZ(e,t,n){var r=t[e.name];if(e.array){if(!ri(r)){ti("Expected an array of sub-parameters. Instead: "+oi(r))}return r.map((function(t){return WZ(e,t,n)}))}else{return WZ(e,r,n)}}function WZ(e,t,n){var r,i,a,o,u;for(o=0,u=e.params.length;o<u;++o){i=e.params[o];for(a in i.key){if(i.key[a]!==t[a]){i=null;break}}if(i)break}if(!i)ti("Unsupported parameter: "+oi(t));r=Zi(LZ(i,t,n),i.key);return $V(n.add(aX(r)))}function HZ(e){return e&&e.expr}function $Z(e){return e&&e.field}function GZ(e){return e==="data"}function VZ(e){return e==="expr"}function YZ(e){return e==="field"}function XZ(e){return e==="compare"}function JZ(e,t,n){var r,i,a,o,u;if(!e){o=$V(n.add($Y(null,[{}])))}else if(r=e.facet){if(!t)ti("Only group marks can be faceted.");if(r.field!=null){o=u=ZZ(r,n)}else{if(!e.data){a=PZ(Zi({type:"aggregate",groupby:$i(r.groupby)},r.aggregate),n);a.params.key=n.keyRef(r.groupby);a.params.pulse=ZZ(r,n);o=u=$V(n.add(a))}else{u=$V(n.getData(e.data).aggregate)}i=n.keyRef(r.groupby,true)}}if(!o){o=ZZ(e,n)}return{key:i,pulse:o,parent:u}}function ZZ(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:$V(t.getData(e.data).output)}function QZ(e,t,n,r,i){this.scope=e;this.input=t;this.output=n;this.values=r;this.aggregate=i;this.index={}}QZ.fromEntries=function(e,t){var n=t.length,r=1,i=t[0],a=t[n-1],o=t[n-2],u=null;if(i&&i.type==="load"){i=t[1]}e.add(t[0]);for(;r<n;++r){t[r].params.pulse=$V(t[r-1]);e.add(t[r]);if(t[r].type==="aggregate")u=t[r]}return new QZ(e,i,o,a,u)};var KZ=QZ.prototype;KZ.countsRef=function(e,t,n){var r=this,i=r.counts||(r.counts={}),a=eQ(t),o,u,s;if(a!=null){e=r.scope;o=i[a]}if(!o){s={groupby:e.fieldRef(t,"key"),pulse:$V(r.output)};if(n&&n.field)tQ(e,s,n);u=e.add(qY(s));o=e.add($Y({pulse:$V(u)}));o={agg:u,ref:$V(o)};if(a!=null)i[a]=o}else if(n&&n.field){tQ(e,o.agg.params,n)}return o.ref};function eQ(e){return ai(e)?e:null}function tQ(e,t,n){var r=KV(n.op,n.field),i;if(t.ops){for(var a=0,o=t.as.length;a<o;++a){if(t.as[a]===r)return}}else{t.ops=["count"];t.fields=[null];t.as=["count"]}if(n.op){t.ops.push((i=n.op.signal)?e.signalRef(i):n.op);t.fields.push(e.fieldRef(n.field));t.as.push(r)}}function nQ(e,t,n,r,i,a,o){var u=t[n]||(t[n]={}),s=QV(a),l=eQ(i),f,c;if(l!=null){e=t.scope;l=l+(s?"|"+s:"");f=u[l]}if(!f){var d=a?{field:VV,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:$V(t.output)};if(s)d.sort=e.sortRef(a);c=e.add(WV(r,undefined,d));if(o)t.index[i]=c;f=$V(c);if(l!=null)u[l]=f}return f}KZ.tuplesRef=function(){return $V(this.values)};KZ.extentRef=function(e,t){return nQ(e,this,"extent","extent",t,false)};KZ.domainRef=function(e,t){return nQ(e,this,"domain","values",t,false)};KZ.valuesRef=function(e,t,n){return nQ(e,this,"vals","values",t,n||true)};KZ.lookupRef=function(e,t){return nQ(e,this,"lookup","tupleindex",t,false)};KZ.indataRef=function(e,t){return nQ(e,this,"indata","tupleindex",t,true,true)};function rQ(e,t,n){var r=e.from.facet,i=r.name,a=ZZ(r,t),o,u,s,l;if(!r.name){ti("Facet must have a name: "+oi(r))}if(!r.data){ti("Facet must reference a data set: "+oi(r))}if(r.field){l=t.add(oX({field:t.fieldRef(r.field),pulse:a}))}else if(r.groupby){l=t.add(JY({key:t.keyRef(r.groupby),group:$V(t.proxy(n.parent)),pulse:a}))}else{ti("Facet must specify groupby or field: "+oi(r))}o=t.fork();u=o.add($Y());s=o.add(dX({pulse:$V(u)}));o.addData(i,new QZ(o,u,u,s));o.addSignal("parent",null);l.params.subflow={$subflow:zQ(e,o).toRuntime()}}function iQ(e,t,n){var r=t.add(oX({pulse:n.pulse})),i=t.fork();i.add(dX());i.addSignal("parent",null);r.params.subflow={$subflow:zQ(e,i).toRuntime()}}function aQ(e,t,n){var r=e.remove,i=e.insert,a=e.toggle,o=e.modify,u=e.values,s=t.add(HV()),l,f;l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,u].map((function(e){return e==null?"null":e})).join(",")+"),0)";f=UV(l,t);s.update=f.$expr;s.params=f.$params}function oQ(e,t){var n=TZ(e),r=e.type===sZ,i=e.from&&e.from.facet,a=e.layout||n===CJ||n===DJ,o=n===SJ||a||i,u=e.overlap,s,l,f,c,d,h,p,v,g,m,y,b,x,_;f=JZ(e.from,r,t);l=t.add(VY({key:f.key||(e.key?GV(e.key):undefined),pulse:f.pulse,clean:!r}));m=$V(l);l=c=t.add($Y({pulse:m}));l=t.add(tX({markdef:zZ(e),interactive:RZ(e.interactive,t),clip:FZ(e.clip,t),context:{$context:true},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:$V(l)}));y=$V(l);l=d=t.add(YY(JJ(e.encode,e.type,n,e.style,t,{mod:false,pulse:y})));l.params.parent=t.encode();if(e.transform){e.transform.forEach((function(e){var n=PZ(e,t),r=n.metadata;if(r.generates||r.changes){ti("Mark transforms should not generate new data.")}if(!r.nomod)d.params.mod=true;n.params.pulse=$V(l);t.add(l=n)}))}if(e.sort){l=t.add(hX({sort:t.compareRef(e.sort),pulse:$V(l)}))}b=$V(l);if(i||a){a=t.add(pX({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:b}));x=$V(a)}h=t.add(HY({mark:y,pulse:x||b}));_=$V(h);if(r){if(o){s=t.operators;s.pop();if(a)s.pop()}t.pushState(b,x||_,m);i?rQ(e,t,f):o?iQ(e,t,f):zQ(e,t);t.popState();if(o){if(a)s.push(a);s.push(h)}}if(u){_=uQ(u,_,t)}p=t.add(fX({pulse:_}));v=t.add(dX({pulse:$V(p)},undefined,t.parent()));if(e.name!=null){g=e.name;t.addData(g,new QZ(t,c,p,v));if(e.on)e.on.forEach((function(e){if(e.insert||e.remove||e.toggle){ti("Marks only support modify triggers.")}aQ(e,t,g)}))}}function uQ(e,t,n){var r=e.method,i=e.bound,a=e.separation,o;var u={separation:nY(a)?n.signalRef(a.signal):a,method:nY(r)?n.signalRef(r.signal):r,pulse:t};if(e.order){u.sort=n.compareRef({field:e.order})}if(i){o=i.tolerance;u.boundTolerance=nY(o)?n.signalRef(o.signal):+o;u.boundScale=n.scaleRef(i.scale);u.boundOrient=i.orient}return $V(n.add(iX(u)))}function sQ(e,t){var n=t.config.legend,r=e.encode||{},i=r.legend||{},a=i.name||undefined,o=i.interactive,u=i.style,s=tZ(e,n),l,f,c,d,h,p,v,g,m;var y=uJ.reduce((function(t,n){return t||e[n]}),0);if(!y)ti("Missing valid scale for legend.");h=lQ(e,t.scaleType(y));p={title:e.title!=null,type:h,vgrad:h!=="symbol"&&s.isVertical()};v=$V(t.add($Y(null,[p])));i=XJ(cQ(s,n),i,sJ);l={enter:{x:{value:0},y:{value:0}}};g=$V(t.add(KY(c={type:h,scale:t.scaleRef(y),count:t.objectProperty(s("tickCount")),limit:t.property(s("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));if(h===aJ){d=[hZ(e,y,n,r.gradient),mZ(e,n,r.labels,g)];c.count=c.count||t.signalRef("max(2,2*floor(("+oY(s.gradientLength())+")/100))")}else if(h===oJ){d=[pZ(e,y,n,r.gradient,g),mZ(e,n,r.labels,g)]}else{f=xZ(e,n);d=[bZ(e,n,r,g,oY(f.columns))];c.size=dQ(e,t,d[0].marks)}d=[yZ(LJ,null,null,v,o,l,d,f)];if(p.title){d.push(jZ(e,n,r.title,v))}m=yZ(RJ,u,a,v,o,i,d);if(e.zindex)m.zindex=e.zindex;return oQ(m,t)}function lQ(e,t){var n=e.type||iJ;if(!e.type&&fQ(e)===1&&(e.fill||e.stroke)){n=zD(t)?aJ:PD(t)?oJ:iJ}return n!==aJ?n:PD(t)?oJ:aJ}function fQ(e){return uJ.reduce((function(t,n){return t+(e[n]?1:0)}),0)}function cQ(e,t){var n={enter:{},update:{}};YJ(n,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:t.strokeWidth,strokeDash:t.strokeDash,x:e("legendX"),y:e("legendY")});return n}function dQ(e,t,n){var r=oY(hQ("size",e,n)),i=oY(hQ("strokeWidth",e,n)),a=oY(pQ(n[1].encode,t,eJ));return UV("max(ceil(sqrt("+r+")+"+i+"),"+a+")",t)}function hQ(e,t,n){return t[e]?'scale("'+t[e]+'",datum)':nZ(e,n[0].encode)}function pQ(e,t,n){return nZ("fontSize",e)||rZ("fontSize",t,n)}var vQ='item.orient==="'+IX+'"?-90:item.orient==="'+BX+'"?90:0';function gQ(e,t){e=ai(e)?{text:e}:e;var n=tZ(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||undefined,o=i.interactive,u=i.style,s=[],l,f;l=$V(t.add($Y(null,[{}])));s.push(bQ(e,n,mQ(e),l));if(e.subtitle){s.push(xQ(e,n,r.subtitle,l))}f=yZ(WJ,u,a,l,o,yQ(n,i),s);if(e.zindex)f.zindex=e.zindex;return oQ(f,t)}function mQ(e){var t=e.encode;return t&&t.title||Zi({name:e.name,interactive:e.interactive,style:e.style},t)}function yQ(e,t){var n={enter:{},update:{}};YJ(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:aZ},angle:{signal:vQ},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")});return XJ(n,t,sJ)}function bQ(e,t,n,r){var i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};YJ(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")});return eZ(dZ,HJ,nJ,null,r,o,n)}function xQ(e,t,n,r){var i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};YJ(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")});return eZ(dZ,$J,rJ,null,r,o,n)}function _Q(e,t){var n=[];if(e.transform){e.transform.forEach((function(e){n.push(PZ(e,t))}))}if(e.on){e.on.forEach((function(n){aQ(n,t,e.name)}))}t.addDataPipeline(e.name,wQ(e,t,n))}function wQ(e,t,n){var r=[],i=null,a=false,o=false,u,s,l,f,c;if(e.values){if(iY(e.values)||iY(e.format)){r.push(EQ(t,e));r.push(i=kQ())}else{r.push(i=kQ({$ingest:e.values,$format:e.format}))}}else if(e.url){if(iY(e.url)||iY(e.format)){r.push(EQ(t,e));r.push(i=kQ())}else{r.push(i=kQ({$request:e.url,$format:e.format}))}}else if(e.source){i=u=$i(e.source).map((function(e){return $V(t.getData(e).output)}));r.push(null)}for(s=0,l=n.length;s<l;++s){f=n[s];c=f.metadata;if(!i&&!c.source){r.push(i=kQ())}r.push(f);if(c.generates)o=true;if(c.modifies&&!o)a=true;if(c.source)i=f;else if(c.changes)i=null}if(u){l=u.length-1;r[0]=lX({derive:a,pulse:l?u:u[0]});if(a||l){r.splice(1,0,kQ())}}if(!i)r.push(kQ());r.push(dX({}));return r}function kQ(e){var t=$Y({},e);t.metadata={source:true};return t}function EQ(e,t){return eX({url:t.url?e.property(t.url):undefined,async:t.async?e.property(t.async):undefined,values:t.values?e.property(t.values):undefined,format:e.objectProperty(t.format)})}function OQ(e,t){var n=t.config,r=e.orient,i=r===LX||r===UX?n.axisX:n.axisY,a=n["axis"+r[0].toUpperCase()+r.slice(1)],o=t.scaleType(e.scale)==="band"&&n.axisBand;return i||a||o?Zi({},n.axis,i,a,o):n.axis}function AQ(e,t,n,r){var i=tZ(e,t),a=e.orient,o,u,s,l,f,c;o={enter:u={opacity:lJ},update:s={opacity:fJ},exit:{opacity:lJ}};YJ(o,{stroke:i("domainColor"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});if(a===LX||a===UX){l="x";c="y"}else{l="y";c="x"}f=l+"2";u[c]=lJ;s[l]=u[l]=SQ(e,0);s[f]=u[f]=SQ(e,1);return eZ(fZ,jJ,null,null,r,o,n)}function SQ(e,t){return{scale:e.scale,range:t}}function DQ(e,t,n,r,i){var a=tZ(e,t),o=e.orient,u=e.gridScale,s=o===IX||o===LX?1:-1,l=CQ(e.offset,s),f,c,d,h,p,v,g,m,y;f={enter:c={opacity:lJ},update:h={opacity:fJ},exit:d={opacity:lJ}};YJ(f,{stroke:a("gridColor"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});p={scale:e.scale,field:KX,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")};if(o===LX||o===UX){v="x";g="y";y="height"}else{v="y";g="x";y="width"}m=g+"2";h[v]=c[v]=d[v]=p;if(u){h[g]=c[g]={scale:u,range:0,mult:s,offset:l};h[m]=c[m]={scale:u,range:1,mult:s,offset:l}}else{h[g]=c[g]={value:0,offset:l};h[m]=c[m]={signal:y,mult:s,offset:l}}return eZ(fZ,FJ,null,KX,r,f,n)}function CQ(e,t){if(t===1);else if(!ii(e)){e=t*(e||0)}else{var n=e=Zi({},e);while(n.mult!=null){if(!ii(n.mult)){n.mult*=t;return e}else{n=n.mult=Zi({},n.mult)}}n.mult=t}return e}function MQ(e,t,n,r,i,a){var o=tZ(e,t),u=e.orient,s=u===IX||u===LX?-1:1,l,f,c,d,h,p;l={enter:f={opacity:lJ},update:d={opacity:fJ},exit:c={opacity:lJ}};YJ(l,{stroke:o("tickColor"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});h=GJ(i);h.mult=s;p={scale:e.scale,field:KX,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};if(u===LX||u===UX){d.y=f.y=lJ;d.y2=f.y2=h;d.x=f.x=c.x=p}else{d.x=f.x=lJ;d.x2=f.x2=h;d.y=f.y=c.y=p}return eZ(fZ,TJ,null,KX,r,l,n)}function jQ(e,t,n,r,i){return{signal:'flush(range("'+e+'"), '+'scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function FQ(e,t,n,r,i,a){var o;var u=tZ(e,t),s=e.orient,l=s===IX||s===LX?-1:1,f=s===LX||s===UX,c=e.scale,d=oY(u("labelFlush")),h=oY(u("labelFlushOffset")),p=d===0||!!d,v=u("labelAlign"),g=u("labelBaseline"),m,y,b,x,_,w,k,E,O,A;b=GJ(i);b.mult=l;b.offset=GJ(u("labelPadding")||0);b.offset.mult=l;x={scale:c,field:KX,band:.5,offset:uZ(a.offset,u("labelOffset"))};if(f){_=v||(p?jQ(c,d,'"left"','"right"','"center"'):"center");w=g||(s===LX?"bottom":"top");k=!v}else{_=v||(s===BX?"left":"right");w=g||(p?jQ(c,d,'"top"','"bottom"','"middle"'):"middle");k=!g}k=k&&p&&h?jQ(c,d,"-("+h+")",h,0):null;m={enter:y={opacity:lJ,x:f?x:b,y:f?b:x},update:{opacity:fJ,text:{field:YX},x:y.x,y:y.y},exit:{opacity:lJ,x:y.x,y:y.y}};YJ(m,(o={},o[f?"dx":"dy"]=k,o.align=_,o.baseline=w,o.angle=u("labelAngle"),o.fill=u("labelColor"),o.fillOpacity=u("labelOpacity"),o.font=u("labelFont"),o.fontSize=u("labelFontSize"),o.fontWeight=u("labelFontWeight"),o.fontStyle=u("labelFontStyle"),o.limit=u("labelLimit"),o.lineHeight=u("labelLineHeight"),o));E=u("labelBound");O=u("labelOverlap");A=u("labelSeparation");e=eZ(dZ,NJ,eJ,KX,r,m,n);if(O||E){e.overlap={separation:A,method:O,order:"datum.index",bound:E?{scale:c,orient:s,tolerance:E}:null}}return e}function NQ(e,t,n,r){var i=tZ(e,t),a=e.orient,o=a===IX||a===LX?-1:1,u=a===LX||a===UX,s,l,f,c;s={enter:l={opacity:lJ,anchor:GJ(i("titleAnchor")),align:{signal:aZ}},update:f=Zi({},l,{opacity:fJ,text:GJ(e.title)}),exit:{opacity:lJ}};c={signal:'lerp(range("'+e.scale+'"), '+iZ(0,1,.5)+")"};if(u){f.x=c;l.angle={value:0};l.baseline={value:a===LX?"bottom":"top"}}else{f.y=c;l.angle={value:o*90};l.baseline={value:"bottom"}}YJ(s,{angle:i("titleAngle"),baseline:i("titleBaseline"),fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign")});!VJ(s,"x",i("titleX"),"update")&&!u&&!KJ("x",n)&&(s.enter.auto={value:true});!VJ(s,"y",i("titleY"),"update")&&u&&!KJ("y",n)&&(s.enter.auto={value:true});return eZ(dZ,zJ,tJ,null,r,s,n)}function TQ(e,t){var n=OQ(e,t),r=e.encode||{},i=r.axis||{},a=i.name||undefined,o=i.interactive,u=i.style,s=tZ(e,n),l=oZ(s),f,c,d,h,p,v;f={orient:e.orient,ticks:!!s("ticks"),labels:!!s("labels"),grid:!!s("grid"),domain:!!s("domain"),title:e.title!=null,translate:s("translate")};c=$V(t.add($Y({},[f])));i=XJ({update:{offset:GJ(s("offset")||0),position:GJ(aY(e.position,0)),titlePadding:GJ(s("titlePadding")),minExtent:GJ(s("minExtent")),maxExtent:GJ(s("maxExtent")),range:{signal:'abs(span(range("'+e.scale+'")))'}}},r.axis,sJ);d=$V(t.add(WY({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));v=[];if(f.grid){v.push(DQ(e,n,r.grid,d,l))}if(f.ticks){h=s("tickSize");v.push(MQ(e,n,r.ticks,d,h,l))}if(f.labels){h=f.ticks?h:0;v.push(FQ(e,n,r.labels,d,h,l))}if(f.domain){v.push(AQ(e,n,r.domain,c))}if(f.title){v.push(NQ(e,n,r.title,c))}p=yZ(MJ,u,a,c,o,i,v);if(e.zindex)p.zindex=e.zindex;return oQ(p,t)}function zQ(e,t,n){var r=$i(e.signals),i=$i(e.scales);if(!n)r.forEach((function(e){return BV(e,t)}));$i(e.projections).forEach((function(e){return RX(e,t)}));i.forEach((function(e){return yX(e,t)}));$i(e.data).forEach((function(e){return _Q(e,t)}));i.forEach((function(e){return bX(e,t)}));(n||r).forEach((function(e){return BY(e,t)}));$i(e.axes).forEach((function(e){return TQ(e,t)}));$i(e.marks).forEach((function(e){return oQ(e,t)}));$i(e.legends).forEach((function(e){return sQ(e,t)}));if(e.title)gQ(e.title,t);t.parseLambdas();return t}function RQ(e,t){var n=t.config,r,i,a,o,u,s;u=$V(t.root=t.add(HV()));s=LQ(e,n);s.forEach((function(e){return BV(e,t)}));t.description=e.description||n.description;t.eventConfig=n.events;t.legends=t.objectProperty(n.legend&&n.legend.layout);i=t.add($Y());a=XJ({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e.encode);a=t.add(YY(JJ(a,sZ,DJ,e.style,t,{pulse:$V(i)})));o=t.add(pX({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:u,pulse:$V(a)}));t.operators.pop();t.pushState($V(a),$V(o),null);zQ(e,t,s);t.operators.push(o);r=t.add(HY({mark:u,pulse:$V(o)}));r=t.add(fX({pulse:$V(r)}));r=t.add(dX({pulse:$V(r)}));t.addData("root",new QZ(t,i,i,r));return t}function PQ(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function LQ(e,t){var n=function(n){return aY(e[n],t[n])},r=[PQ("background",n("background")),PQ("autosize",NV(n("autosize"))),PQ("padding",RV(n("padding"))),PQ("width",n("width")||0),PQ("height",n("height")||0)],i=r.reduce((function(e,t){return e[t.name]=t,e}),{}),a={};$i(e.signals).forEach((function(e){if(ta(i,e.name)){e=Zi(i[e.name],e)}else{r.push(e)}a[e.name]=e}));$i(t.signals).forEach((function(e){if(!ta(a,e.name)&&!ta(i,e.name)){r.push(e)}}));return r}function IQ(e){this.config=e;this.bindings=[];this.field={};this.signals={};this.lambdas={};this.scales={};this.events={};this.data={};this.streams=[];this.updates=[];this.operators=[];this.eventConfig=null;this._id=0;this._subid=0;this._nextsub=[0];this._parent=[];this._encode=[];this._lookup=[];this._markpath=[]}function BQ(e){this.config=e.config;this.legends=e.legends;this.field=Object.create(e.field);this.signals=Object.create(e.signals);this.lambdas=Object.create(e.lambdas);this.scales=Object.create(e.scales);this.events=Object.create(e.events);this.data=Object.create(e.data);this.streams=[];this.updates=[];this.operators=[];this._id=0;this._subid=++e._nextsub[0];this._nextsub=e._nextsub;this._parent=e._parent.slice();this._encode=e._encode.slice();this._lookup=e._lookup.slice();this._markpath=e._markpath}var UQ=IQ.prototype=BQ.prototype;UQ.fork=function(){return new BQ(this)};UQ.isSubscope=function(){return this._subid>0};UQ.toRuntime=function(){this.finish();return{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}};UQ.id=function(){return(this._subid?this._subid+":":0)+this._id++};UQ.add=function(e){this.operators.push(e);e.id=this.id();if(e.refs){e.refs.forEach((function(t){t.$ref=e.id}));e.refs=null}return e};UQ.proxy=function(e){var t=e instanceof qV?$V(e):e;return this.add(sX({value:t}))};UQ.addStream=function(e){this.streams.push(e);e.id=this.id();return e};UQ.addUpdate=function(e){this.updates.push(e);return e};UQ.finish=function(){var e,t;if(this.root)this.root.root=true;for(e in this.signals){this.signals[e].signal=e}for(e in this.scales){this.scales[e].scale=e}function n(e,t,n){var r,i;if(e){r=e.data||(e.data={});i=r[t]||(r[t]=[]);i.push(n)}}for(e in this.data){t=this.data[e];n(t.input,e,"input");n(t.output,e,"output");n(t.values,e,"values");for(var r in t.index){n(t.index[r],e,"index:"+r)}}return this};UQ.pushState=function(e,t,n){this._encode.push($V(this.add(dX({pulse:e}))));this._parent.push(t);this._lookup.push(n?$V(this.proxy(n)):null);this._markpath.push(-1)};UQ.popState=function(){this._encode.pop();this._parent.pop();this._lookup.pop();this._markpath.pop()};UQ.parent=function(){return Ai(this._parent)};UQ.encode=function(){return Ai(this._encode)};UQ.lookup=function(){return Ai(this._lookup)};UQ.markpath=function(){var e=this._markpath;return++e[e.length-1]};UQ.fieldRef=function(e,t){if(ai(e))return GV(e,t);if(!e.signal){ti("Unsupported field reference: "+oi(e))}var n=e.signal,r=this.field[n],i;if(!r){i={name:this.signalRef(n)};if(t)i.as=t;this.field[n]=r=$V(this.add(ZY(i)))}return r};UQ.compareRef=function(e){function t(e){if(nY(e)){r=true;return n.signalRef(e.signal)}else if(rY(e)){r=true;return n.exprRef(e.expr)}else{return e}}var n=this,r=false,i=$i(e.field).map(t),a=$i(e.order).map(t);return r?$V(this.add(GY({fields:i,orders:a}))):YV(i,a)};UQ.keyRef=function(e,t){function n(e){if(nY(e)){i=true;return $V(r[e.signal])}else{return e}}var r=this.signals,i=false;e=$i(e).map(n);return i?$V(this.add(QY({fields:e,flat:t}))):XV(e,t)};UQ.sortRef=function(e){if(!e)return e;var t=KV(e.op,e.field),n=e.order||JV;return n.signal?$V(this.add(GY({fields:t,orders:this.signalRef(n.signal)}))):YV(t,n)};UQ.event=function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t});this.events[n]=r}return this.events[n]};UQ.hasOwnSignal=function(e){return ta(this.signals,e)};UQ.addSignal=function(e,t){if(this.hasOwnSignal(e)){ti("Duplicate signal name: "+oi(e))}var n=t instanceof qV?t:this.add(HV(t));return this.signals[e]=n};UQ.getSignal=function(e){if(!this.signals[e]){ti("Unrecognized signal name: "+oi(e))}return this.signals[e]};UQ.signalRef=function(e){if(this.signals[e]){return $V(this.signals[e])}else if(!ta(this.lambdas,e)){this.lambdas[e]=this.add(HV(null))}return $V(this.lambdas[e])};UQ.parseLambdas=function(){var e=Object.keys(this.lambdas);for(var t=0,n=e.length;t<n;++t){var r=e[t],i=UV(r,this),a=this.lambdas[r];a.params=i.$params;a.update=i.$expr}};UQ.property=function(e){return e&&e.signal?this.signalRef(e.signal):e};UQ.objectProperty=function(e){return!e||!ii(e)?e:this.signalRef(e.signal||qQ(e))};function qQ(e){return(ri(e)?WQ:HQ)(e)}function WQ(e){var t="[",n=0,r=e.length,i;for(;n<r;++n){i=e[n];t+=(n>0?",":"")+(ii(i)?i.signal||qQ(i):oi(i))}return t+"]"}function HQ(e){var t="{",n=0,r,i;for(r in e){i=e[r];t+=(++n>1?",":"")+oi(r)+":"+(ii(i)?i.signal||qQ(i):oi(i))}return t+"}"}UQ.exprRef=function(e,t){var n={expr:UV(e,this)};if(t)n.expr.$name=t;return $V(this.add(XY(n)))};UQ.addBinding=function(e,t){if(!this.bindings){ti("Nested signals do not support binding: "+oi(e))}this.bindings.push(Zi({signal:e},t))};UQ.addScaleProj=function(e,t){if(ta(this.scales,e)){ti("Duplicate scale or projection name: "+oi(e))}this.scales[e]=this.add(t)};UQ.addScale=function(e,t){this.addScaleProj(e,cX(t))};UQ.addProjection=function(e,t){this.addScaleProj(e,uX(t))};UQ.getScale=function(e){if(!this.scales[e]){ti("Unrecognized scale name: "+oi(e))}return this.scales[e]};UQ.projectionRef=UQ.scaleRef=function(e){return $V(this.getScale(e))};UQ.projectionType=UQ.scaleType=function(e){return this.getScale(e).params.type};UQ.addData=function(e,t){if(ta(this.data,e)){ti("Duplicate data set name: "+oi(e))}return this.data[e]=t};UQ.getData=function(e){if(!this.data[e]){ti("Undefined data set name: "+oi(e))}return this.data[e]};UQ.addDataPipeline=function(e,t){if(ta(this.data,e)){ti("Duplicate data set name: "+oi(e))}return this.addData(e,QZ.fromEntries(this,t))};var $Q="sans-serif",GQ=30,VQ=2,YQ="#4c78a8",XQ="#000",JQ="#888",ZQ="#ddd";function QQ(){return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:YQ},area:{fill:YQ},image:null,line:{stroke:YQ,strokeWidth:VQ},path:{stroke:YQ},rect:{fill:YQ},rule:{stroke:XQ},shape:{stroke:YQ},symbol:{fill:YQ,size:64},text:{fill:XQ,font:$Q,fontSize:11},trail:{fill:YQ,size:VQ},style:{"guide-label":{fill:XQ,font:$Q,fontSize:10},"guide-title":{fill:XQ,font:$Q,fontSize:11,fontWeight:"bold"},"group-title":{fill:XQ,font:$Q,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:XQ,font:$Q,fontSize:12},point:{size:GQ,strokeWidth:VQ,shape:"circle"},circle:{size:GQ,strokeWidth:VQ},square:{size:GQ,strokeWidth:VQ,shape:"square"},cell:{fill:"transparent",stroke:ZQ}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:true,domainWidth:1,domainColor:JQ,grid:false,gridWidth:1,gridColor:ZQ,labels:true,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:true,tickColor:JQ,tickOffset:0,tickRound:true,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:ZQ,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:true,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:JQ,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function KQ(e,t){if(!ii(e)){ti("Input Vega specification must be an object.")}t=ki(QQ(),t,e.config);return RQ(e,new IQ(t)).toRuntime()}Zi(uf,cv,Xk,TM,IR,cL,fB,yB,XB,hU,DU);var eK=Object.freeze({__proto__:null,version:CU,Dataflow:tf,EventStream:eo,Parameters:Ua,Pulse:Nl,MultiPulse:Ll,Operator:Ya,Transform:af,changeset:Ia,ingest:Na,isTuple:Ma,definition:sf,transform:lf,transforms:uf,tupleid:ja,scale:FD,scheme:KD,interpolate:GD,interpolateColors:WD,interpolateRange:qD,quantizeInterpolator:HD,projection:dR,View:SV,expressionFunction:AG,formatLocale:xS,timeFormatLocale:ol,parse:KQ,runtime:eV,runtimeContext:iV,bandwidthNRD:Jf,bin:Zf,bootstrapCI:ec,dotbin:tc,quantiles:Yf,quartiles:Xf,get random(){return Qf},setRandom:Kf,randomLCG:rc,randomInteger:ic,randomKDE:pc,randomLogNormal:bc,sampleLogNormal:vc,densityLogNormal:gc,cumulativeLogNormal:mc,quantileLogNormal:yc,randomMixture:xc,randomNormal:hc,sampleNormal:sc,densityNormal:lc,cumulativeNormal:fc,quantileNormal:cc,randomUniform:Oc,sampleUniform:_c,densityUniform:wc,cumulativeUniform:kc,quantileUniform:Ec,regressionLinear:Mc,regressionLog:jc,regressionExp:Fc,regressionPow:Nc,regressionQuad:Tc,regressionPoly:zc,regressionLoess:Bc,sampleCurve:$c,timeUnits:Zh,timeFloor:up,utcFloor:dp,timeUnitSpecifier:Ep,timeFormat:Op,utcFormat:Ap,timeInterval:vp,timeOffset:yp,timeSequence:_p,utcInterval:gp,utcOffset:bp,utcSequence:wp,timeBin:$p,accessor:Qr,accessorName:Kr,accessorFields:ei,id:li,identity:fi,zero:ci,one:di,truthy:hi,falsy:pi,logger:_i,None:gi,Error:mi,Warn:yi,Info:bi,Debug:xi,mergeConfig:ki,writeConfig:Ei,panLinear:Ti,panLog:zi,panPow:Ri,panSymlog:Pi,zoomLinear:Ii,zoomLog:Bi,zoomPow:Ui,zoomSymlog:qi,quarter:Wi,utcquarter:Hi,array:$i,clampRange:Gi,compare:Yi,constant:Xi,debounce:Ji,error:ti,extend:Zi,extent:Qi,extentIndex:Ki,fastmap:ra,field:ui,flush:ia,hasOwnProperty:ta,inherits:aa,inrange:oa,isArray:ri,isBoolean:ua,isDate:sa,isFunction:Vi,isNumber:la,isObject:ii,isRegExp:fa,isString:ai,key:ca,lerp:da,lruCache:pa,merge:va,pad:ma,peek:Ai,repeat:ga,span:ya,splitAccessPath:ni,stringValue:oi,toBoolean:ba,toDate:_a,toNumber:Si,toString:wa,toSet:ka,truncate:Ea,visitArray:Oa,loader:ll,read:ul,inferType:bo,inferTypes:xo,typeParsers:go,format:tu,formats:nu,responseType:ru,Bounds:Xv,Gradient:ng,GroupItem:ig,ResourceLoader:ug,Item:rg,Scenegraph:__,Handler:j_,Renderer:T_,CanvasHandler:B_,CanvasRenderer:V_,SVGHandler:ew,SVGRenderer:lw,SVGStringRenderer:Ew,RenderType:zw,renderModule:Pw,intersect:Lw,Marks:h_,boundClip:Hw,boundContext:nb,boundStroke:Jy,boundItem:p_,boundMark:g_,pathCurves:Rm,pathSymbols:ny,pathRectangle:dy,pathTrail:hy,pathParse:Im,pathRender:Qm,point:C_,domCreate:E_,domFind:O_,domChild:A_,domClear:S_,openTag:rw,closeTag:iw,font:t_,fontFamily:e_,fontSize:Gx,lineHeight:Vx,multiLineOffset:Jx,textMetrics:Bx,resetSVGClipId:Zb,sceneEqual:Gw,pathEqual:Vw,sceneToJSON:y_,sceneFromJSON:b_,intersectPath:hb,intersectPoint:pb,intersectRule:gb,intersectBoxLine:mb,sceneZOrder:Sb,sceneVisit:Db,scenePickVisit:Cb});var tK="vega-lite";var nK='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer';var rK="4.10.4";var iK=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"];var aK="https://vega.github.io/vega-lite/";var oK="Vega-Lite is a concise high-level language for interactive visualization.";var uK="build/vega-lite.js";var sK="build/vega-lite.min.js";var lK="build/vega-lite.min.js";var fK="build/src/index";var cK="build/src/index.d.ts";var dK={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"};var hK={test:"test"};var pK={changelog:"conventional-changelog -p angular",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint --ext .ts .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"};var vK={type:"git",url:"https://github.com/vega/vega-lite.git"};var gK="BSD-3-Clause";var mK={url:"https://github.com/vega/vega-lite/issues"};var yK={"@babel/cli":"^7.8.4","@babel/core":"^7.9.0","@babel/preset-env":"^7.9.5","@commitlint/cli":"^8.3.5","@commitlint/config-conventional":"^8.3.4","@rollup/plugin-commonjs":"11.1.0","@rollup/plugin-json":"^4.0.2","@rollup/plugin-node-resolve":"^7.1.3","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.1","@types/jest-environment-puppeteer":"^4.3.1","@types/mkdirp":"^1.0.0","@types/puppeteer":"^2.0.1","@typescript-eslint/eslint-plugin":"^2.27.0","@typescript-eslint/parser":"^2.27.0",ajv:"^6.12.0",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.6.5",concurrently:"^5.1.0","conventional-changelog-cli":"^2.0.31",d3:"^5.15.1",eslint:"^6.8.0","eslint-config-prettier":"^6.10.1","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^9.18.1","http-server":"^0.12.1",husky:"^4.2.5",jest:"^25.3.0","jest-puppeteer":"^4.4.0","lint-staged":"^10.1.3",mkdirp:"^1.0.4",prettier:"^2.0.4",puppeteer:"^2.1.1",rollup:"^2.6.1","rollup-plugin-sourcemaps":"^0.5.0","rollup-plugin-terser":"^5.3.0","svg2png-many":"^0.0.7",terser:"^4.6.11","ts-jest":"^25.3.1","ts-json-schema-generator":"^0.65.0",typescript:"~3.8.3","vega-cli":"^5.10.1","vega-datasets":"^1.30.2","vega-embed":"^6.5.2","vega-tooltip":"^0.22.1","vega-typings":"0.15.3","yaml-front-matter":"^4.1.0"};var bK={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~1.11.1","vega-event-selector":"~2.0.2","vega-expression":"~2.6.3","vega-util":"~1.13.1",yargs:"~15.3.1"};var xK={vega:"^5.9.2"};var _K={hooks:{"pre-commit":"lint-staged","commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}};var wK={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:false};var kK={name:tK,author:nK,version:rK,collaborators:iK,homepage:aK,description:oK,main:uK,unpkg:sK,jsdelivr:lK,module:fK,types:cK,bin:dK,directories:hK,scripts:pK,repository:vK,license:gK,bugs:mK,devDependencies:yK,dependencies:bK,peerDependencies:xK,husky:_K,"lint-staged":{"*.ts":["eslint --fix","git add"],"*.{md,css,yml}":["prettier --write","git add"]},jest:wK};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var EK=_e((function(e){var t=function(){function e(e,t){return t!=null&&e instanceof t}var t;try{t=Map}catch(f){t=function(){}}var n;try{n=Set}catch(f){n=function(){}}var r;try{r=Promise}catch(f){r=function(){}}function i(a,o,u,s,f){if(typeof o==="object"){u=o.depth;s=o.prototype;f=o.includeNonEnumerable;o=o.circular}var c=[];var d=[];var h=typeof Buffer!="undefined";if(typeof o=="undefined")o=true;if(typeof u=="undefined")u=Infinity;function p(a,u){if(a===null)return null;if(u===0)return a;var v;var g;if(typeof a!="object"){return a}if(e(a,t)){v=new t}else if(e(a,n)){v=new n}else if(e(a,r)){v=new r((function(e,t){a.then((function(t){e(p(t,u-1))}),(function(e){t(p(e,u-1))}))}))}else if(i.__isArray(a)){v=[]}else if(i.__isRegExp(a)){v=new RegExp(a.source,l(a));if(a.lastIndex)v.lastIndex=a.lastIndex}else if(i.__isDate(a)){v=new Date(a.getTime())}else if(h&&Buffer.isBuffer(a)){if(Buffer.allocUnsafe){v=Buffer.allocUnsafe(a.length)}else{v=new Buffer(a.length)}a.copy(v);return v}else if(e(a,Error)){v=Object.create(a)}else{if(typeof s=="undefined"){g=Object.getPrototypeOf(a);v=Object.create(g)}else{v=Object.create(s);g=s}}if(o){var m=c.indexOf(a);if(m!=-1){return d[m]}c.push(a);d.push(v)}if(e(a,t)){a.forEach((function(e,t){var n=p(t,u-1);var r=p(e,u-1);v.set(n,r)}))}if(e(a,n)){a.forEach((function(e){var t=p(e,u-1);v.add(t)}))}for(var y in a){var b;if(g){b=Object.getOwnPropertyDescriptor(g,y)}if(b&&b.set==null){continue}v[y]=p(a[y],u-1)}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(a);for(var y=0;y<x.length;y++){var _=x[y];var w=Object.getOwnPropertyDescriptor(a,_);if(w&&!w.enumerable&&!f){continue}v[_]=p(a[_],u-1);if(!w.enumerable){Object.defineProperty(v,_,{enumerable:false})}}}if(f){var k=Object.getOwnPropertyNames(a);for(var y=0;y<k.length;y++){var E=k[y];var w=Object.getOwnPropertyDescriptor(a,E);if(w&&w.enumerable){continue}v[E]=p(a[E],u-1);Object.defineProperty(v,E,{enumerable:false})}}return v}return p(a,u)}i.clonePrototype=function e(t){if(t===null)return null;var n=function(){};n.prototype=t;return new n};function a(e){return Object.prototype.toString.call(e)}i.__objToStr=a;function o(e){return typeof e==="object"&&a(e)==="[object Date]"}i.__isDate=o;function u(e){return typeof e==="object"&&a(e)==="[object Array]"}i.__isArray=u;function s(e){return typeof e==="object"&&a(e)==="[object RegExp]"}i.__isRegExp=s;function l(e){var t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";return t}i.__getRegExpFlags=l;return i}();if(e.exports){e.exports=t}}));var OK=function e(t,n){if(t===n)return true;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return false;var r,i,a;if(Array.isArray(t)){r=t.length;if(r!=n.length)return false;for(i=r;i--!==0;)if(!e(t[i],n[i]))return false;return true}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();a=Object.keys(t);r=a.length;if(r!==Object.keys(n).length)return false;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return false;for(i=r;i--!==0;){var o=a[i];if(!e(t[o],n[o]))return false}return true}return t!==t&&n!==n};var AK=function(e,t){if(!t)t={};if(typeof t==="function")t={cmp:t};var n=typeof t.cycles==="boolean"?t.cycles:false;var r=t.cmp&&function(e){return function(t){return function(n,r){var i={key:n,value:t[n]};var a={key:r,value:t[r]};return e(i,a)}}}(t.cmp);var i=[];return function e(t){if(t&&t.toJSON&&typeof t.toJSON==="function"){t=t.toJSON()}if(t===undefined)return;if(typeof t=="number")return isFinite(t)?""+t:"null";if(typeof t!=="object")return JSON.stringify(t);var a,o;if(Array.isArray(t)){o="[";for(a=0;a<t.length;a++){if(a)o+=",";o+=e(t[a])||"null"}return o+"]"}if(t===null)return"null";if(i.indexOf(t)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(t)-1;var s=Object.keys(t).sort(r&&r(t));o="";for(a=0;a<s.length;a++){var l=s[a];var f=e(t[l]);if(!f)continue;if(o)o+=",";o+=JSON.stringify(l)+":"+f}i.splice(u,1);return"{"+o+"}"}(e)};function SK(e){return!!e.or}function DK(e){return!!e.and}function CK(e){return!!e.not}function MK(e,t){if(CK(e)){MK(e.not,t)}else if(DK(e)){for(var n=0,r=e.and;n<r.length;n++){var i=r[n];MK(i,t)}}else if(SK(e)){for(var a=0,o=e.or;a<o.length;a++){var i=o[a];MK(i,t)}}else{t(e)}}function jK(e,t){if(CK(e)){return{not:jK(e.not,t)}}else if(DK(e)){return{and:e.and.map((function(e){return jK(e,t)}))}}else if(SK(e)){return{or:e.or.map((function(e){return jK(e,t)}))}}else{return t(e)}}var FK=OK;var NK=EK;function TK(e,t){var n={};for(var r=0,i=t;r<i.length;r++){var a=i[r];if(ta(e,a)){n[a]=e[a]}}return n}function zK(e,t){var n=Object.assign({},e);for(var r=0,i=t;r<i.length;r++){var a=i[r];delete n[a]}return n}Set.prototype["toJSON"]=function(){return"Set("+h(this).map((function(e){return AK(e)})).join(",")+")"};var RK=AK;function PK(e){if(la(e)){return e}var t=ai(e)?e:AK(e);if(t.length<250){return t}var n=0;for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);n=(n<<5)-n+i;n=n&n}return n}function LK(e){return e===false||e===null}function IK(e,t){return e.indexOf(t)>-1}function BK(e,t){var n=0;for(var r=0,i=e.entries();r<i.length;r++){var a=i[r],o=a[0],u=a[1];if(t(u,o,n++)){return true}}return false}function UK(e,t){var n=0;for(var r=0,i=e.entries();r<i.length;r++){var a=i[r],o=a[0],u=a[1];if(!t(u,o,n++)){return false}}return true}function qK(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var r=0,i=t;r<i.length;r++){var a=i[r];WK(e,a!==null&&a!==void 0?a:{})}return e}function WK(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Ei(e,i,t[i],true)}}function HK(e,t){var n=[];var r={};var i;for(var a=0,o=e;a<o.length;a++){var u=o[a];i=t(u);if(i in r){continue}r[i]=1;n.push(u)}return n}function $K(e,t){if(e.size!==t.size){return false}for(var n=0,r=e;n<r.length;n++){var i=r[n];if(!t.has(i)){return false}}return true}function GK(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.has(i)){return true}}return false}function VK(e){var t=new Set;var n=function(e){var n=ni(e);var r=n.map((function(e,t){return t===0?e:"["+e+"]"}));var i=r.map((function(e,t){return r.slice(0,t+1).join("")}));for(var a=0,o=i;a<o.length;a++){var u=o[a];t.add(u)}};for(var r=0,i=e;r<i.length;r++){var a=i[r];n(a)}return t}function YK(e,t){if(e===undefined||t===undefined){return true}return GK(VK(e),VK(t))}var XK=Object.keys;var JK=Object.values;function ZK(e){return e===true||e===false}function QK(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function KK(e,t){if(CK(e)){return"!("+KK(e.not,t)+")"}else if(DK(e)){return"("+e.and.map((function(e){return KK(e,t)})).join(") && (")+")"}else if(SK(e)){return"("+e.or.map((function(e){return KK(e,t)})).join(") || (")+")"}else{return t(e)}}function e0(e,t){if(t.length===0){return true}var n=t.shift();if(n in e&&e0(e[n],t)){delete e[n]}return XK(e).length===0}function t0(e){return e.charAt(0).toUpperCase()+e.substr(1)}function n0(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function r0(e,t){if(t===void 0){t="datum"}var n=ni(e);var r=[];for(var i=1;i<=n.length;i++){var a="["+n.slice(0,i).map(oi).join("][")+"]";r.push(""+t+a)}return r.join(" && ")}function i0(e,t){if(t===void 0){t="datum"}return t+"["+oi(ni(e).join("."))+"]"}function a0(e){return""+ni(e).map(n0).join("\\.")}function o0(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function u0(e){return""+ni(e).join(".")}function s0(e){if(!e){return 0}return ni(e).length}function l0(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i!==undefined){return i}}return undefined}var f0=42;function c0(e){var t=++f0;return e?String(e)+t:t}function d0(e){return h0(e)?e:"__"+e}function h0(e){return e.indexOf("__")===0}function p0(e){if(e===undefined){return undefined}return(e%360+360)%360}function v0(e){if(la(e)){return true}return!isNaN(e)&&!isNaN(parseFloat(e))}var g0={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function m0(e){return e&&e["condition"]}var y0=["domain","grid","labels","ticks","title"];var b0={grid:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",domain:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOpacity:"main",labelOffset:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"};var x0={orient:1,bandPosition:1,domain:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,values:1,translate:1,zindex:1};var _0=Object.assign(Object.assign({},x0),{style:1,labelExpr:1,encoding:1});function w0(e){return!!_0[e]}var k0="arc";var E0="area";var O0="bar";var A0="image";var S0="line";var D0="point";var C0="rect";var M0="rule";var j0="text";var F0="tick";var N0="trail";var T0="circle";var z0="square";var R0="geoshape";var P0={arc:1,area:1,bar:1,image:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function L0(e){return IK(["line","area","trail"],e)}function I0(e){return IK(["rect","bar","image","arc"],e)}var B0=XK(P0);function U0(e){return e["type"]}var q0=ka(B0);var W0=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"];var H0=["fill","fillOpacity"];var $0=h(W0,H0);var G0={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1};var V0=XK(G0);var Y0={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]};var X0={color:"#4c78a8",invalid:"filter",timeUnitBand:1};var J0={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};var Z0=5;var Q0={binSpacing:1,continuousBandSize:Z0,timeUnitBandPosition:.5};var K0={binSpacing:0,continuousBandSize:Z0,timeUnitBandPosition:.5};var e1={thickness:1};function t1(e){return U0(e)?e.type:e}function n1(e){return"mark"in e}var r1=function(){function e(e,t){this.name=e;this.run=t}e.prototype.hasMatchingType=function(e){if(n1(e)){return t1(e.mark)===this.name}return false};return e}();var i1={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};var a1={count:1,min:1,max:1};function o1(e){return!!e&&!!e["argmin"]}function u1(e){return!!e&&!!e["argmax"]}function s1(e){return ai(e)&&!!i1[e]}var l1=["count","valid","missing","distinct"];function f1(e){return ai(e)&&IK(l1,e)}function c1(e){return ai(e)&&IK(["min","max"],e)}var d1=["count","sum","distinct","valid","missing"];var h1=["mean","average","median","q1","q3","min","max"];var p1=ka(h1);var v1="row";var g1="column";var m1="facet";var y1="x";var b1="y";var x1="x2";var _1="y2";var w1="radius";var k1="radius2";var E1="theta";var O1="theta2";var A1="latitude";var S1="longitude";var D1="latitude2";var C1="longitude2";var M1="color";var j1="fill";var F1="stroke";var N1="shape";var T1="size";var z1="angle";var R1="opacity";var P1="fillOpacity";var L1="strokeOpacity";var I1="strokeWidth";var B1="strokeDash";var U1="text";var q1="order";var W1="detail";var H1="key";var $1="tooltip";var G1="href";var V1="url";var Y1={x:1,y:1,x2:1,y2:1};var X1={theta:1,theta2:1,radius:1,radius2:1};function J1(e){return e in X1}function Z1(e){switch(e){case A1:return"y";case D1:return"y2";case S1:return"x";case C1:return"x2"}}var Q1={longitude:1,longitude2:1,latitude:1,latitude2:1};function K1(e){return e in Q1}var e2=XK(Q1);var t2=Object.assign(Object.assign(Object.assign(Object.assign({},Y1),X1),Q1),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1});function n2(e){return e==="color"||e==="fill"||e==="stroke"}var r2={row:1,column:1,facet:1};var i2=XK(r2);var a2=Object.assign(Object.assign({},t2),r2);var o2=XK(a2);var u2=Xe(a2,["order","detail","tooltip"]);var s2=Xe(u2,["row","column","facet"]);function l2(e){return!!s2[e]}function f2(e){return!!a2[e]}var c2=["x2","y2","latitude2","longitude2","theta2","radius2"];function d2(e){var t=h2(e);return t!==e}function h2(e){switch(e){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude";case"theta2":return"theta";case"radius2":return"radius"}return e}function p2(e){if(J1(e)){switch(e){case E1:return"startAngle";case O1:return"endAngle";case w1:return"outerRadius";case k1:return"innerRadius"}}return e}function v2(e){switch(e){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2";case"theta":return"theta2";case"radius":return"radius2"}return undefined}function g2(e){switch(e){case"x":case"x2":return"width";case"y":case"y2":return"height"}return undefined}function m2(e){switch(e){case"x":return"xOffset";case"y":return"yOffset";case"x2":return"x2Offset";case"y2":return"y2Offset";case"theta":return"thetaOffset";case"radius":return"radiusOffset";case"theta2":return"theta2Offset";case"radius2":return"radius2Offset"}return undefined}var y2=Xe(t2,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]);var b2=XK(y2);var x2={x:1,y:1};var _2=XK(x2);function w2(e){return e in Y1}var k2={theta:1,radius:1};function E2(e){return e==="width"?"x":"y"}var O2=Xe(y2,["text","tooltip","href","url","detail","key","order"]);var A2=XK(O2);function S2(e){return!!y2[e]}function D2(e){switch(e){case M1:case j1:case F1:case T1:case N1:case R1:case I1:case B1:return true;case P1:case L1:case z1:return false}}var C2=Object.assign(Object.assign(Object.assign({},x2),k2),O2);var M2=XK(C2);function j2(e){return!!C2[e]}function F2(e,t){return z2(e)[t]}var N2={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"};var T2=Xe(N2,["geoshape"]);function z2(e){switch(e){case M1:case j1:case F1:case W1:case H1:case $1:case G1:case q1:case R1:case P1:case L1:case I1:case m1:case v1:case g1:return N2;case y1:case b1:case A1:case S1:return T2;case x1:case _1:case D1:case C1:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case T1:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case B1:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case N1:return{point:"always",geoshape:"always"};case U1:return{text:"always"};case z1:return{point:"always",square:"always",text:"always"};case V1:return{image:"always"};case E1:return{text:"always",arc:"always"};case w1:return{text:"always",arc:"always"};case O1:case k1:return{arc:"always"}}}function R2(e){switch(e){case y1:case b1:case E1:case w1:case T1:case z1:case I1:case R1:case P1:case L1:case x1:case _1:case O1:case k1:return undefined;case m1:case v1:case g1:case N1:case B1:case U1:case $1:case G1:case V1:return"discrete";case M1:case j1:case F1:return"flexible";case A1:case S1:case D1:case C1:case W1:case H1:case q1:return undefined}}function P2(e){if(ua(e)){e=w8(e,undefined)}return"bin"+XK(e).map((function(t){return U2(e[t])?QK("_"+t+"_"+Object.entries(e[t])):QK("_"+t+"_"+e[t])})).join("")}function L2(e){return e===true||B2(e)&&!e.binned}function I2(e){return e==="binned"||B2(e)&&e.binned===true}function B2(e){return ii(e)}function U2(e){return e===null||e===void 0?void 0:e["selection"]}function q2(e){switch(e){case v1:case g1:case T1:case M1:case j1:case F1:case I1:case R1:case P1:case L1:case N1:return 6;case B1:return 4;default:return 10}}function W2(e){return"Invalid specification "+JSON.stringify(e)+'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".'}var H2='Autosize "fit" only works for single views and layered views.';function $2(e){var t=e=="width"?"Width":"Height";return t+' "container" only works for single views and layered views.'}function G2(e){var t=e=="width"?"Width":"Height";var n=e=="width"?"x":"y";return t+' "container" only works well with autosize "fit" or "fit-'+n+'".'}function V2(e){return e?'Dropping "fit-'+e+'" because spec has discrete '+g2(e)+".":'Dropping "fit" because spec has discrete size.'}function Y2(e){return'Cannot project a selection on encoding channel "'+e+'", which has no field.'}function X2(e,t){return'Cannot project a selection on encoding channel "'+e+'" as it uses an aggregate function ("'+t+'").'}function J2(e){return'The "nearest" transform is not supported for '+e+" marks."}function Z2(e){return"Selection not supported for "+e+" yet."}function Q2(e){return'Cannot find a selection named "'+e+'".'}var K2="Scale bindings are currently only supported for scales with unbinned, continuous domains.";var e3="Legend bindings are only supported for selections over an individual field or encoding channel.";function t3(e){return'Cannot define and lookup the "'+e+'" selection in the same view. '+"Try moving the lookup into a second, layered view?"}function n3(e){return'Unknown repeated value "'+e+'".'}function r3(e){return'The "columns" property cannot be used when "'+e+'" has nested row/column.'}var i3="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function a3(e){return'Unrecognized parse "'+e+'".'}function o3(e,t,n){return'An ancestor parsed field "'+e+'" as '+n+" but a child wants to parse the field as "+t+"."}function u3(e){return"Ignoring an invalid transform: "+RK(e)+"."}var s3='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function l3(e){return"Layer's shared "+e.join(",")+" channel "+(e.length===1?"is":"are")+" overriden."}function f3(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection "+RK(t)+" is overridden by a child projection "+RK(n)+"."}var c3="Arc marks uses theta channel rather than angle, replacing angle with theta.";function d3(e,t,n){return"Channel "+e+" is a "+t+". Converted to {value: "+RK(n)+"}."}function h3(e){return'Invalid field type "'+e+'".'}function p3(e,t){return'Invalid field type "'+e+'" for aggregate: "'+t+'", using "quantitative" instead.'}function v3(e){return'Invalid aggregation operator "'+e+'".'}function g3(e,t){return'Missing type for channel "'+e+'", using "'+t+'" instead.'}function m3(e,t){var n=t.fill,r=t.stroke;return"Dropping color "+e+" as the plot also has "+(n&&r?"fill and stroke":n?"fill":"stroke")+"."}function y3(e,t){return"Dropping "+RK(e)+' from channel "'+t+'" since it does not contain any data field, datum, value, or signal.'}function b3(e,t,n){return e+"-encoding with type "+t+" is deprecated. Replacing with "+n+"-encoding."}var x3="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function _3(e,t,n){return e+' dropped as it is incompatible with "'+t+'"'+(n?" when "+n:"")+"."}function w3(e){return e+"-encoding is dropped as "+e+" is not a valid encoding channel."}function k3(e){return e+" encoding should be discrete (ordinal / nominal / binned)."}function E3(e){return"Facet encoding dropped as "+e.join(" and ")+" "+(e.length>1?"are":"is")+" also specified."}function O3(e,t){return'Using discrete channel "'+e+'" to encode "'+t+'" field can be misleading as it does not encode '+(t==="ordinal"?"order":"magnitude")+"."}function A3(e,t){var n=e&&t?"x2 and y2":e?"x2":"y2";return"Line mark is for continuous lines and thus cannot be used with "+n+". We will use the rule mark (line segments) instead."}function S3(e,t){return'Specified orient "'+e+'" overridden with "'+t+'".'}var D3="Custom domain scale cannot be unioned with default field-based domain.";var C3='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function M3(e){return'Cannot use the scale property "'+e+'" with non-color channel.'}function j3(e){return"Using unaggregated domain with raw field has no effect ("+RK(e)+")."}function F3(e){return'Unaggregated domain not applicable for "'+e+'" since it produces values outside the origin domain of the source data.'}function N3(e){return"Unaggregated domain is currently unsupported for log scale ("+RK(e)+")."}function T3(e){return'Cannot apply size to non-oriented mark "'+e+'".'}function z3(e,t,n){return'Channel "'+e+'" does not work with "'+t+'" scale. We are using "'+n+'" scale instead.'}function R3(e,t){return'FieldDef does not work with "'+e+'" scale. We are using "'+t+'" scale instead.'}function P3(e,t,n){return n+"-scale's \""+t+'" is dropped as it does not work with '+e+" scale."}function L3(e,t){return'Scale type "'+t+'" does not work with mark "'+e+'".'}function I3(e){return'The step for "'+e+'" is dropped because the '+(e==="width"?"x":"y")+" is continuous."}function B3(e,t,n,r){return"Conflicting "+t.toString()+' property "'+e.toString()+'" ('+RK(n)+" and "+RK(r)+"). Using "+RK(n)+"."}function U3(e,t,n,r){return"Conflicting "+t.toString()+' property "'+e.toString()+'" ('+RK(n)+" and "+RK(r)+"). Using the union of the two domains."}function q3(e){return'Setting the scale to be independent for "'+e+'" means we also have to set the guide (axis or legend) to be independent.'}function W3(e){return"Dropping sort property "+RK(e)+' as unioned domains only support boolean or op "count", "min", and "max".'}var H3="Unable to merge domains.";var $3="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";var G3="Invalid channel for axis.";function V3(e){return'Cannot stack "'+e+'" if there is already "'+e+'2".'}function Y3(e){return"Cannot stack non-linear scale ("+e+")."}function X3(e){return'Stacking is applied even though the aggregate function is non-summative ("'+e+'").'}function J3(e,t){return"Invalid "+e+": "+RK(t)+"."}function Z3(e){return'Time unit "'+e+'" is not supported. We are replacing it with '+o0(e,"day","date")+"."}function Q3(e){return"Dropping day from datetime "+RK(e)+" as day cannot be combined with other units."}function K3(e,t){return""+(t?"extent ":"")+(t&&e?"and ":"")+(e?"center ":"")+(t&&e?"are ":"is ")+"not needed when data are aggregated."}function e5(e,t,n){return e+" is not usually used with "+t+" for "+n+"."}function t5(e,t){return"Continuous axis should not have customized aggregation function "+e+"; "+t+" already agregates the axis."}function n5(e,t){return"Center is not needed to be specified in "+t+" when extent is "+e+"."}function r5(e){return"1D error band does not support "+e+"."}function i5(e){return"Channel "+e+' is required for "binned" bin.'}function a5(e){return"Domain for "+e+" is required for threshold scale."}var o5=Object.freeze({__proto__:null,invalidSpec:W2,FIT_NON_SINGLE:H2,containerSizeNonSingle:$2,containerSizeNotCompatibleWithAutosize:G2,droppingFit:V2,cannotProjectOnChannelWithoutField:Y2,cannotProjectAggregate:X2,nearestNotSupportForContinuous:J2,selectionNotSupported:Z2,selectionNotFound:Q2,SCALE_BINDINGS_CONTINUOUS:K2,LEGEND_BINDINGS_PROJECT_LENGTH:e3,noSameUnitLookup:t3,noSuchRepeatedValue:n3,columnsNotSupportByRowCol:r3,CONCAT_CANNOT_SHARE_AXIS:i3,unrecognizedParse:a3,differentParse:o3,invalidTransformIgnored:u3,NO_FIELDS_NEEDS_AS:s3,encodingOverridden:l3,projectionOverridden:f3,REPLACE_ANGLE_WITH_THETA:c3,primitiveChannelDef:d3,invalidFieldType:h3,invalidFieldTypeForCountAggregate:p3,invalidAggregate:v3,missingFieldType:g3,droppingColor:m3,emptyFieldDef:y3,latLongDeprecated:b3,LINE_WITH_VARYING_SIZE:x3,incompatibleChannel:_3,invalidEncodingChannel:w3,facetChannelShouldBeDiscrete:k3,facetChannelDropped:E3,discreteChannelCannotEncode:O3,lineWithRange:A3,orientOverridden:S3,CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN:D3,RANGE_STEP_DEPRECATED:C3,cannotUseScalePropertyWithNonColor:M3,unaggregateDomainHasNoEffectForRawField:j3,unaggregateDomainWithNonSharedDomainOp:F3,unaggregatedDomainWithLogScale:N3,cannotApplySizeToNonOrientedMark:T3,scaleTypeNotWorkWithChannel:z3,scaleTypeNotWorkWithFieldDef:R3,scalePropertyNotWorkWithScaleType:P3,scaleTypeNotWorkWithMark:L3,stepDropped:I3,mergeConflictingProperty:B3,mergeConflictingDomainProperty:U3,independentScaleMeansIndependentGuide:q3,domainSortDropped:W3,UNABLE_TO_MERGE_DOMAINS:H3,MORE_THAN_ONE_SORT:$3,INVALID_CHANNEL_FOR_AXIS:G3,cannotStackRangedMark:V3,cannotStackNonLinearScale:Y3,stackNonSummativeAggregate:X3,invalidTimeUnit:J3,dayReplacedWithDate:Z3,droppedDay:Q3,errorBarCenterAndExtentAreNotNeeded:K3,errorBarCenterIsUsedWithWrongExtent:e5,errorBarContinuousAxisHasCustomizedAggregate:t5,errorBarCenterIsNotNeeded:n5,errorBand1DNotSupport:r5,channelRequiredForBinned:i5,domainRequiredForThresholdScale:a5});var u5=o5;var s5=_i(yi);var l5=s5;function f5(e){l5=e;return l5}function c5(){l5=s5;return l5}function d5(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}l5.warn.apply(l5,e)}function h5(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}l5.debug.apply(l5,e)}function p5(e){if(e&&ii(e)){for(var t=0,n=D5;t<n.length;t++){var r=n[t];if(r in e){return true}}}return false}var v5=["january","february","march","april","may","june","july","august","september","october","november","december"];var g5=v5.map((function(e){return e.substr(0,3)}));var m5=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];var y5=m5.map((function(e){return e.substr(0,3)}));function b5(e){if(v0(e)){e=+e}if(la(e)){if(e>4){d5(u5.invalidTimeUnit("quarter",e))}return e-1}else{throw new Error(u5.invalidTimeUnit("quarter",e))}}function x5(e){if(v0(e)){e=+e}if(la(e)){return e-1}else{var t=e.toLowerCase();var n=v5.indexOf(t);if(n!==-1){return n}var r=t.substr(0,3);var i=g5.indexOf(r);if(i!==-1){return i}throw new Error(u5.invalidTimeUnit("month",e))}}function _5(e){if(v0(e)){e=+e}if(la(e)){return e%7}else{var t=e.toLowerCase();var n=m5.indexOf(t);if(n!==-1){return n}var r=t.substr(0,3);var i=y5.indexOf(r);if(i!==-1){return i}throw new Error(u5.invalidTimeUnit("day",e))}}function w5(e,t){var n=[];if(t&&e.day!==undefined){if(XK(e).length>1){d5(u5.droppedDay(e));e=NK(e);delete e.day}}if(e.year!==undefined){n.push(e.year)}else{n.push(2012)}if(e.month!==undefined){var r=t?x5(e.month):e.month;n.push(r)}else if(e.quarter!==undefined){var i=t?b5(e.quarter):e.quarter;n.push(la(i)?i*3:i+"*3")}else{n.push(0)}if(e.date!==undefined){n.push(e.date)}else if(e.day!==undefined){var a=t?_5(e.day):e.day;n.push(la(a)?a+1:a+"+1")}else{n.push(1)}for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var s=u[o];var l=e[s];n.push(typeof l==="undefined"?0:l)}return n}function k5(e){var t=w5(e,true);var n=t.join(", ");if(e.utc){return"utc("+n+")"}else{return"datetime("+n+")"}}function E5(e){var t=w5(e,false);var n=t.join(", ");if(e.utc){return"utc("+n+")"}else{return"datetime("+n+")"}}function O5(e){var t=w5(e,true);if(e.utc){return+new Date(Date.UTC.apply(Date,t))}else{return+new(Date.bind.apply(Date,h([void 0],t)))}}var A5;(function(e){e.YEAR="year";e.MONTH="month";e.DAY="day";e.DATE="date";e.HOURS="hours";e.MINUTES="minutes";e.SECONDS="seconds";e.MILLISECONDS="milliseconds";e.YEARMONTH="yearmonth";e.YEARMONTHDATE="yearmonthdate";e.YEARMONTHDATEHOURS="yearmonthdatehours";e.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes";e.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds";e.MONTHDATE="monthdate";e.MONTHDATEHOURS="monthdatehours";e.HOURSMINUTES="hoursminutes";e.HOURSMINUTESSECONDS="hoursminutesseconds";e.MINUTESSECONDS="minutesseconds";e.SECONDSMILLISECONDS="secondsmilliseconds";e.QUARTER="quarter";e.YEARQUARTER="yearquarter";e.QUARTERMONTH="quartermonth";e.YEARQUARTERMONTH="yearquartermonth";e.UTCYEAR="utcyear";e.UTCMONTH="utcmonth";e.UTCDAY="utcday";e.UTCDATE="utcdate";e.UTCHOURS="utchours";e.UTCMINUTES="utcminutes";e.UTCSECONDS="utcseconds";e.UTCMILLISECONDS="utcmilliseconds";e.UTCYEARMONTH="utcyearmonth";e.UTCYEARMONTHDATE="utcyearmonthdate";e.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours";e.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes";e.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds";e.UTCMONTHDATE="utcmonthdate";e.UTCMONTHDATEHOURS="utcmonthdatehours";e.UTCHOURSMINUTES="utchoursminutes";e.UTCHOURSMINUTESSECONDS="utchoursminutesseconds";e.UTCMINUTESSECONDS="utcminutesseconds";e.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds";e.UTCQUARTER="utcquarter";e.UTCYEARQUARTER="utcyearquarter";e.UTCQUARTERMONTH="utcquartermonth";e.UTCYEARQUARTERMONTH="utcyearquartermonth"})(A5||(A5={}));var S5={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};var D5=XK(S5);function C5(e){return!!S5[e]}var M5={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};var j5={yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,monthdatehours:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1};var F5={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utcmonthdatehours:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1};var N5=Object.assign(Object.assign({},M5),F5);function T5(e){return!!N5[e]}function z5(e){return e.substr(3)}var R5=Object.assign(Object.assign(Object.assign(Object.assign({},S5),M5),j5),F5);var P5={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function L5(e){return D5.reduce((function(t,n){if(I5(e,n)){return h(t,[n])}return t}),[])}function I5(e,t){var n=e.indexOf(t);return n>-1&&(t!==A5.SECONDS||n===0||e.charAt(n-1)!=="i")}function B5(e,t,n){var r=(n===void 0?{end:false}:n).end;var i=r0(t);var a=T5(e)?"utc":"";function o(e){if(e===A5.QUARTER){return"("+a+"quarter("+i+")-1)"}else{return""+a+e+"("+i+")"}}var u;var s=D5.reduce((function(t,n){if(I5(e,n)){t[n]=o(n);u=n}return t}),{});if(r){s[u]+="+1"}return E5(s)}function U5(e){if(!e){return undefined}var t=L5(e);return"timeUnitSpecifier("+AK(t)+", "+AK(P5)+")"}function q5(e,t,n){if(!e){return undefined}var r=U5(e);if(n||T5(e)){return"utcFormat("+t+", "+r+")"}else{return"timeFormat("+t+", "+r+")"}}function W5(e){if(!e){return undefined}var t;if(ai(e)){t={unit:H5(e)}}else if(ii(e)){t=Object.assign(Object.assign({},e),e.unit?{unit:H5(e.unit)}:{})}if(T5(t.unit)){t.utc=true;t.unit=z5(t.unit)}return t}function H5(e){if(e!=="day"&&e.indexOf("day")>=0){d5(u5.dayReplacedWithDate(e));return o0(e,"day","date")}return e}function $5(e){var t=W5(e),n=t.utc,r=Xe(t,["utc"]);if(r.unit){return(n?"utc":"")+XK(r).map((function(e){return QK(""+(e==="unit"?"":"_"+e+"_")+r[e])})).join("")}else{return(n?"utc":"")+"timeunit"+XK(r).map((function(e){return QK("_"+e+"_"+r[e])})).join("")}}function G5(e){return e&&!!e["signal"]}function V5(e){return!!e["step"]}function Y5(e){if(!ri(e)){return"fields"in e&&!("data"in e)}return false}function X5(e){if(!ri(e)){return"fields"in e&&"data"in e}return false}function J5(e){if(!ri(e)){return"field"in e&&"data"in e}return false}var Z5={blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1};var Q5=XK(Z5);var K5=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function e4(e){return e===null||e===void 0?void 0:e["selection"]}function t4(e){return e&&!!e.field&&e.equal!==undefined}function n4(e){return e&&!!e.field&&e.lt!==undefined}function r4(e){return e&&!!e.field&&e.lte!==undefined}function i4(e){return e&&!!e.field&&e.gt!==undefined}function a4(e){return e&&!!e.field&&e.gte!==undefined}function o4(e){if(e&&e.field){if(ri(e.range)&&e.range.length===2){return true}else if(G5(e.range)){return true}}return false}function u4(e){return e&&!!e.field&&(ri(e.oneOf)||ri(e.in))}function s4(e){return e&&!!e.field&&e.valid!==undefined}function l4(e){return u4(e)||t4(e)||o4(e)||n4(e)||i4(e)||r4(e)||a4(e)}function f4(e,t){return D8(e,{timeUnit:t,time:true})}function c4(e,t){return e.map((function(e){return f4(e,t)}))}function d4(e,t){if(t===void 0){t=true}var n;var r=e.field;var i=(n=W5(e.timeUnit))===null||n===void 0?void 0:n.unit;var a=i?"time("+B5(i,r)+")":t8(e,{expr:"datum"});if(t4(e)){return a+"==="+f4(e.equal,i)}else if(n4(e)){var o=e.lt;return a+"<"+f4(o,i)}else if(i4(e)){var u=e.gt;return a+">"+f4(u,i)}else if(r4(e)){var o=e.lte;return a+"<="+f4(o,i)}else if(a4(e)){var u=e.gte;return a+">="+f4(u,i)}else if(u4(e)){return"indexof(["+c4(e.oneOf,i).join(",")+"], "+a+") !== -1"}else if(s4(e)){return h4(a,e.valid)}else if(o4(e)){var s=e.range;var u=G5(s)?{signal:s.signal+"[0]"}:s[0];var o=G5(s)?{signal:s.signal+"[1]"}:s[1];if(u!==null&&o!==null&&t){return"inrange("+a+", ["+f4(u,i)+", "+f4(o,i)+"])"}var l=[];if(u!==null){l.push(a+" >= "+f4(u,i))}if(o!==null){l.push(a+" <= "+f4(o,i))}return l.length>0?l.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(e))}function h4(e,t){if(t===void 0){t=true}if(t){return"isValid("+e+") && isFinite(+"+e+")"}else{return"!isValid("+e+") || !isFinite(+"+e+")"}}function p4(e){var t;if(l4(e)&&e.timeUnit){return Object.assign(Object.assign({},e),{timeUnit:(t=W5(e.timeUnit))===null||t===void 0?void 0:t.unit})}return e}var v4={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1};var g4="quantitative";var m4="ordinal";var y4="temporal";var b4="nominal";var x4="geojson";function _4(e){if(e){e=e.toLowerCase();switch(e){case"q":case g4:return"quantitative";case"t":case y4:return"temporal";case"o":case m4:return"ordinal";case"n":case b4:return"nominal";case x4:return"geojson"}}return undefined}var w4;(function(e){e.LINEAR="linear";e.LOG="log";e.POW="pow";e.SQRT="sqrt";e.SYMLOG="symlog";e.IDENTITY="identity";e.SEQUENTIAL="sequential";e.TIME="time";e.UTC="utc";e.QUANTILE="quantile";e.QUANTIZE="quantize";e.THRESHOLD="threshold";e.BIN_ORDINAL="bin-ordinal";e.ORDINAL="ordinal";e.POINT="point";e.BAND="band"})(w4||(w4={}));var k4={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};var E4=XK(k4);function O4(e,t){var n=k4[e];var r=k4[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}var A4={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function S4(e){return A4[e]}var D4=["linear","log","pow","sqrt","symlog","time","utc"];var C4=ka(D4);var M4=["linear","log","pow","sqrt","symlog"];var j4=ka(M4);function F4(e){return e in j4}var N4=["quantile","quantize","threshold"];var T4=ka(N4);var z4=D4.concat(["quantile","quantize","threshold","sequential","identity"]);var R4=ka(z4);var P4=["ordinal","bin-ordinal","point","band"];var L4=ka(P4);function I4(e){return e in L4}function B4(e){return e in R4}function U4(e){return e in C4}function q4(e){return e in T4}var W4={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function H4(e){return!ai(e)&&!!e["name"]}function $4(e){return e===null||e===void 0?void 0:e["selection"]}function G4(e){return e&&e["unionWith"]}var V4={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1};var Y4=Xe(V4,["type","domain","range","scheme"]);var X4=XK(Y4);var J4=t6();function Z4(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return true;case"scheme":case"interpolate":return!IK(["point","band","identity"],e);case"bins":return!IK(["point","band","identity","ordinal"],e);case"round":return U4(e)||e==="band"||e==="point";case"padding":return U4(e)||IK(["point","band"],e);case"paddingOuter":case"align":return IK(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return U4(e);case"nice":return U4(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return B4(e)&&!IK(["log","time","utc","threshold","quantile"],e)}}function Q4(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":if(!n2(e)){return u5.cannotUseScalePropertyWithNonColor(e)}return undefined;case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return undefined}}function K4(e,t){if(IK([m4,b4],t)){return e===undefined||I4(e)}else if(t===y4){return IK([w4.TIME,w4.UTC,undefined],e)}else if(t===g4){return IK([w4.LOG,w4.POW,w4.SQRT,w4.SYMLOG,w4.QUANTILE,w4.QUANTIZE,w4.THRESHOLD,w4.LINEAR,undefined],e)}return true}function e6(e,t){if(!j2(e)){return false}switch(e){case y1:case b1:case E1:case w1:return U4(t)||IK(["band","point"],t);case T1:case I1:case R1:case P1:case L1:case z1:return U4(t)||q4(t)||IK(["band","point","ordinal"],t);case M1:case j1:case F1:return t!=="band";case B1:return t==="ordinal"||q4(t);case N1:return t==="ordinal"}}function t6(){var e;var t={};for(var n=0,r=o2;n<r.length;n++){var i=r[n];for(var a=0,o=XK(v4);a<o.length;a++){var u=o[a];for(var s=0,l=E4;s<l.length;s++){var f=l[s];var c=n6(i,u);if(e6(i,f)&&K4(f,u)){t[c]=(e=t[c])!==null&&e!==void 0?e:[];t[c].push(f)}}}}return t}function n6(e,t){return e+"_"+t}function r6(e){var t=e.channel,n=e.channelDef,r=e.markDef,i=e.scale,a=e.config;var o=f6(e);if(q6(n)&&!f1(n.aggregate)&&i&&U4(i.get("type"))&&i.get("zero")===false){return i6({fieldDef:n,channel:t,markDef:r,ref:o,config:a})}return o}function i6(e){var t=e.fieldDef,n=e.channel,r=e.markDef,i=e.ref,a=e.config;if(L0(r.type)){return i}var o=R8("invalid",r,a);if(o===null){return i}return[a6(t,n),i]}function a6(e,t){var n=o6(e,true);var r=h2(t);var i=r==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function o6(e,t){if(t===void 0){t=true}return h4(ai(e)?e:t8(e,{expr:"datum"}),!t)}function u6(e){var t=e.datum;if(p5(t)){return k5(t)}return""+JSON.stringify(t)}function s6(e,t,n,r){var i={};if(t){i.scale=t}if(H6(e)){var a=e.datum;if(p5(a)){i.signal=k5(a)}else{i.value=a}}else{i.field=t8(e,n)}if(r){var o=r.offset,u=r.band;if(o){i.offset=o}if(u){i.band=u}}return i}function l6(e){var t=e.scaleName,n=e.fieldOrDatumDef,r=e.fieldOrDatumDef2,i=e.offset,a=e.startSuffix,o=e.band,u=o===void 0?.5:o;var s=0<u&&u<1?"datum":undefined;var l=t8(n,{expr:s,suffix:a});var f=r!==undefined?t8(r,{expr:s}):t8(n,{suffix:"end",expr:s});var c={};if(u===0||u===1){c.scale=t;var d=u===0?l:f;c.field=d}else{var h=u+" * "+l+" + "+(1-u)+" * "+f;c.signal='scale("'+t+'", '+h+")"}if(i){c.offset=i}return c}function f6(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,f=e.defaultRef,c=e.band;var d;if(n){if(V6(n)){if(Y6(n)){c=c!==null&&c!==void 0?c:R6({channel:t,fieldDef:n,fieldDef2:r,markDef:i,stack:s,config:a,isMidPoint:true});var h=n.bin,p=n.timeUnit,v=n.type;if(L2(h)||c&&p&&v===y4){if(s&&s.impute){return s6(n,o,{binSuffix:"mid"},{offset:l})}if(c){return l6({scaleName:o,fieldOrDatumDef:n,band:c,offset:l})}return s6(n,o,M8(n,t)?{binSuffix:"range"}:{},{offset:l})}else if(I2(h)){if(q6(r)){return l6({scaleName:o,fieldOrDatumDef:n,fieldOrDatumDef2:r,band:c,offset:l})}else{var g=t===y1?x1:_1;d5(u5.channelRequiredForBinned(g))}}}var m=u===null||u===void 0?void 0:u.get("type");return s6(n,o,I4(m)?{binSuffix:"range"}:{},{offset:l,band:m==="band"?(d=c!==null&&c!==void 0?c:n.band)!==null&&d!==void 0?d:.5:undefined})}else if(X6(n)){var y=n.value;var b=l?{offset:l}:{};return Object.assign(Object.assign({},c6(t,y)),b)}else if(G5(n)){return n}}if(Vi(f)){f=f()}if(f){return Object.assign(Object.assign({},f),l?{offset:l}:{})}return f}function c6(e,t){if(IK(["x","x2"],e)&&t==="width"){return{field:{group:"width"}}}else if(IK(["y","y2"],e)&&t==="height"){return{field:{group:"height"}}}return N8(t)}var d6=" – ";var h6=new Set;function p6(e){h6=new Set(e)}function v6(e){return e&&e!=="number"&&e!=="time"&&h6.has(e)}function g6(e){var t=e.formatType,n=e.field,r=e.format;return t+"("+n+", "+JSON.stringify(r)+")"}function m6(e){var t=e.fieldOrDatumDef,n=e.format,r=e.formatType,i=e.expr,a=e.normalizeStack,o=e.config,u=e.field,s=e.omitNumberFormatAndEmptyTimeFormat,l=e.omitTimeFormatConfig,f=e.isUTCScale;var c,d;if(!u){if(q6(t)){if(a){u=t8(t,{expr:i,suffix:"end"})+"-"+t8(t,{expr:i,suffix:"start"})}else{u=t8(t,{expr:i})}}else{u=u6(t)}}f=f!==null&&f!==void 0?f:J6(t)&&((c=t.scale)===null||c===void 0?void 0:c.type)===w4.UTC;var h=l?null:o.timeFormat;if(v6(r)){if(q6(t)&&L2(t.bin)){var p=t8(t,{expr:i,binSuffix:"end"});return{signal:_6(u,p,n,r,o)}}return{signal:g6({formatType:r,format:n,field:u})}}else if(r){r=undefined}if(O8(t)){var v=w6(u,q6(t)?(d=W5(t.timeUnit))===null||d===void 0?void 0:d.unit:undefined,n,h,f,!s);return v?{signal:v}:undefined}else if(!s){n=y6(W6(t),n,o);if(q6(t)&&L2(t.bin)){var p=t8(t,{expr:i,binSuffix:"end"});return{signal:_6(u,p,n,r,o)}}else if(n||W6(t)==="quantitative"){return{signal:""+b6(u,n)}}else{return{signal:"isValid("+u+") ? "+u+' : ""+'+u}}}return undefined}function y6(e,t,n){if(ai(t)){return t}if(e===g4){return n.numberFormat}return undefined}function b6(e,t){return"format("+e+', "'+(t||"")+'")'}function x6(e,t,n,r){var i;if(v6(n)){return g6({formatType:n,field:e,format:t})}return b6(e,(i=ai(t)?t:undefined)!==null&&i!==void 0?i:r.numberFormat)}function _6(e,t,n,r,i){var a=x6(e,n,r,i);var o=x6(t,n,r,i);return h4(e,false)+' ? "null" : '+a+' + "'+d6+'" + '+o}function w6(e,t,n,r,i,a){if(a===void 0){a=false}if(!t||n){n=ai(n)?n:r;if(n||a){return(i?"utc":"time")+"Format("+e+", '"+n+"')"}else{return undefined}}else{return q5(t,e,i)}}var k6="min";var E6={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function O6(e){return!!E6[e]}function A6(e){return!!e&&!!e["encoding"]}function S6(e){return!!e&&(e["op"]==="count"||!!e["field"])}function D6(e){return!!e&&ri(e)}function C6(e){return"row"in e||"column"in e}function M6(e){return!!e&&"header"in e}function j6(e){return"facet"in e}function F6(e){return e["selection"]}function N6(e){return e&&!ai(e)&&"repeat"in e}function T6(e){var t=e.field,n=e.timeUnit,r=e.bin,i=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function z6(e){return Y6(e)&&"sort"in e}function R6(e){var t=e.channel,n=e.fieldDef,r=e.fieldDef2,i=e.markDef,a=e.stack,o=e.config,u=e.isMidPoint;if(V6(n)&&n.band!==undefined){return n.band}if(q6(n)){var s=n.timeUnit,l=n.bin;if(s&&!r){if(u){return P8("timeUnitBandPosition",i,o)}else{return I0(i.type)?P8("timeUnitBand",i,o):0}}else if(L2(l)){return I0(i.type)&&!u?1:.5}}if((a===null||a===void 0?void 0:a.fieldChannel)===t&&u){return.5}return undefined}function P6(e,t,n,r,i,a){if(L2(t.bin)||t.timeUnit&&Y6(t)&&t.type==="temporal"){return!!R6({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:a})}return false}function L6(e){return!!e&&"condition"in e}function I6(e){var t=e&&e["condition"];return!!t&&!ri(t)&&q6(t)}function B6(e){var t=e&&e["condition"];return!!t&&!ri(t)&&V6(t)}function U6(e){var t=e&&e["condition"];return!!t&&(ri(t)||X6(t))}function q6(e){return!!e&&(!!e["field"]||e["aggregate"]==="count")}function W6(e){return e&&e["type"]}function H6(e){return!!e&&"datum"in e}function $6(e){return Y6(e)&&r8(e)||G6(e)}function G6(e){return H6(e)&&la(e.datum)}function V6(e){return q6(e)||H6(e)}function Y6(e){return!!e&&("field"in e&&"type"in e||e["aggregate"]==="count")}function X6(e){return e&&"value"in e&&"value"in e}function J6(e){return!!e&&("scale"in e||"sort"in e)}function Z6(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Q6(e){return!!e&&"legend"in e}function K6(e){return!!e&&"format"in e}function e8(e){return"op"in e}function t8(e,t){if(t===void 0){t={}}var n,r,i;var a=e.field;var o=t.prefix;var u=t.suffix;var s="";if(i8(e)){a=d0("count")}else{var l=void 0;if(!t.nofn){if(e8(e)){l=e.op}else{var f=e.bin,c=e.aggregate,d=e.timeUnit;if(L2(f)){l=P2(f);u=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")}else if(c){if(u1(c)){s="."+a;a="argmax_"+c.argmax}else if(o1(c)){s="."+a;a="argmin_"+c.argmin}else{l=String(c)}}else if(d){l=$5(d);u=(!IK(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:"")}}}if(l){a=a?l+"_"+a:l}}if(u){a=a+"_"+u}if(o){a=o+"_"+a}if(t.forAs){return a}else if(t.expr){return i0(a,t.expr)+s}else{return a0(a)+s}}function n8(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return true;case"quantitative":return q6(e)&&!!e.bin;case"temporal":return false}throw new Error(u5.invalidFieldType(e.type))}function r8(e){return!n8(e)}function i8(e){return e.aggregate==="count"}function a8(e,t){var n;var r=e.field,i=e.bin,a=e.timeUnit,o=e.aggregate;if(o==="count"){return t.countTitle}else if(L2(i)){return r+" (binned)"}else if(a){var u=(n=W5(a))===null||n===void 0?void 0:n.unit;if(u){return r+" ("+L5(u).join("-")+")"}}else if(o){if(u1(o)){return r+" for max "+o.argmax}else if(o1(o)){return r+" for min "+o.argmin}else{return t0(o)+" of "+r}}return r}function o8(e){var t=e.aggregate,n=e.bin,r=e.timeUnit,i=e.field;if(u1(t)){return i+" for argmax("+t.argmax+")"}else if(o1(t)){return i+" for argmin("+t.argmin+")"}var a=W5(r);var o=t||(a===null||a===void 0?void 0:a.unit)||(a===null||a===void 0?void 0:a.maxbins)&&"timeunit"||L2(n)&&"bin";if(o){return o.toUpperCase()+"("+i+")"}else{return i}}var u8=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return o8(e);default:return a8(e,t)}};var s8=u8;function l8(e){s8=e}function f8(){l8(u8)}function c8(e,t,n){var r=n.allowDisabling,i=n.includeDefault,a=i===void 0?true:i;var o,u;var s=(o=d8(e))!==null&&o!==void 0?o:{};var l=s.title;if(!q6(e)){return l}var f=e;var c=a?h8(f,t):undefined;if(r){return l0(l,f.title,c)}else{return(u=l!==null&&l!==void 0?l:f.title)!==null&&u!==void 0?u:c}}function d8(e){if(Z6(e)&&e.axis){return e.axis}else if(Q6(e)&&e.legend){return e.legend}else if(M6(e)&&e.header){return e.header}return undefined}function h8(e,t){return s8(e,t)}function p8(e){var t;if(K6(e)){var n=e.format,r=e.formatType;return{format:n,formatType:r}}else{var i=(t=d8(e))!==null&&t!==void 0?t:{};var a=i.format,r=i.formatType;return{format:a,formatType:r}}}function v8(e,t){if(e.timeUnit){return"temporal"}if(L2(e.bin)){return"quantitative"}switch(R2(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function g8(e){if(q6(e)){return e}else if(I6(e)){return e.condition}return undefined}function m8(e){if(V6(e)){return e}else if(B6(e)){return e.condition}return undefined}function y8(e,t){if(ai(e)||la(e)||ua(e)){var n=ai(e)?"string":la(e)?"number":"boolean";d5(u5.primitiveChannelDef(t,n,e));return{value:e}}if(V6(e)){return b8(e,t)}else if(B6(e)){return Object.assign(Object.assign({},e),{condition:b8(e.condition,t)})}return e}function b8(e,t){if(q6(e)){return _8(e,t)}return x8(e)}function x8(e){var t=e["type"];if(t){return e}var n=e.datum;t=la(n)?"quantitative":ai(n)?"nominal":p5(n)?"temporal":undefined;return Object.assign(Object.assign({},e),{type:t})}function _8(e,t){var n=e.aggregate,r=e.timeUnit,i=e.bin,a=e.field;var o=Object.assign({},e);if(n&&!s1(n)&&!u1(n)&&!o1(n)){d5(u5.invalidAggregate(n));delete o.aggregate}if(r){o.timeUnit=W5(r)}if(a){o.field=""+a}if(L2(i)){o.bin=w8(i,t)}if(I2(i)&&!IK(_2,t)){d5("Channel "+t+' should not be used with "binned" bin.')}if(Y6(o)){var u=o.type;var s=_4(u);if(u!==s){o.type=s}if(u!=="quantitative"){if(f1(n)){d5(u5.invalidFieldTypeForCountAggregate(u,n));o.type="quantitative"}}}else if(!d2(t)){var l=v8(o,t);d5(u5.missingFieldType(t,l));o["type"]=l}if(Y6(o)){var f=E8(o,t),c=f.compatible,d=f.warning;if(!c){d5(d)}}if(z6(o)&&ai(o.sort)){var h=o.sort;if(O6(h)){return Object.assign(Object.assign({},o),{sort:{encoding:h}})}var p=h.substr(1);if(h.charAt(0)==="-"&&O6(p)){return Object.assign(Object.assign({},o),{sort:{encoding:p,order:"descending"}})}}if(M6(o)){var v=o.header;var g=v.orient,m=Xe(v,["orient"]);if(g){return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},m),{labelOrient:v.labelOrient||g,titleOrient:v.titleOrient||g})})}}return o}function w8(e,t){if(ua(e)){return{maxbins:q2(t)}}else if(e==="binned"){return{binned:true}}else if(!e.maxbins&&!e.step){return Object.assign(Object.assign({},e),{maxbins:q2(t)})}else{return e}}var k8={compatible:true};function E8(e,t){var n=e.type;if(n==="geojson"&&t!=="shape"){return{compatible:false,warning:"Channel "+t+" should not be used with a geojson data."}}switch(t){case"row":case"column":case"facet":if(r8(e)){return{compatible:false,warning:u5.facetChannelShouldBeDiscrete(t)}}return k8;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":case"url":case"angle":case"theta":case"radius":return k8;case"longitude":case"longitude2":case"latitude":case"latitude2":if(n!==g4){return{compatible:false,warning:"Channel "+t+" should be used with a quantitative field only, not "+e.type+" field."}}return k8;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"size":case"theta2":case"radius2":case"x2":case"y2":if(n==="nominal"&&!e["sort"]){return{compatible:false,warning:"Channel "+t+" should not be used with an unsorted discrete field."}}return k8;case"strokeDash":if(!IK(["ordinal","nominal"],e.type)){return{compatible:false,warning:"StrokeDash channel should be used with only discrete data."}}return k8;case"shape":if(!IK(["ordinal","nominal","geojson"],e.type)){return{compatible:false,warning:"Shape channel should be used with only either discrete or geojson data."}}return k8;case"order":if(e.type==="nominal"&&!("sort"in e)){return{compatible:false,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}return k8}}function O8(e){var t=d8(e);var n=t&&t.formatType||K6(e)&&e.formatType;return n==="time"||!n&&S8(e)}function A8(e){var t=d8(e);var n=t&&t.formatType||K6(e)&&e.formatType;return n&&v6(n)}function S8(e){return e&&(e["type"]==="temporal"||q6(e)&&!!e.timeUnit)}function D8(e,t){var n;var r=t.timeUnit,i=t.type,a=t.time,o=t.undefinedIfExprNotRequired;var u;var s=r&&((u=W5(r))===null||u===void 0?void 0:u.unit);var l;if(G5(e)){var f=e.signal;if(a&&!s&&i!=="temporal"){return a?"isDate("+f+") ? time("+f+") : "+f:f}else{l=f}}else if(p5(e)){l=k5(e)}else if(ai(e)||la(e)){if(s||i==="temporal"){l="datetime("+JSON.stringify(e)+")";if(C5(s)){if(la(e)&&e<1e4||ai(e)&&isNaN(Date.parse(e))){l=k5((n={},n[s]=e,n))}}}}if(l){return a?"time("+l+")":l}return o?undefined:JSON.stringify(e)}function C8(e,t){var n=e.type;return t.map((function(t){var r=D8(t,{timeUnit:q6(e)?e.timeUnit:undefined,type:n,undefinedIfExprNotRequired:true});if(r!==undefined){return{signal:r}}return t}))}function M8(e,t){if(!L2(e.bin)){console.warn("Only call this method for binned field defs.");return false}return j2(t)&&IK(["ordinal","nominal"],e.type)}function j8(e){var t=e.anchor,n=e.frame,r=e.offset,i=e.orient,a=e.color,o=e.subtitleColor,u=e.subtitleFont,s=e.subtitleFontSize,l=e.subtitleFontStyle,f=e.subtitleFontWeight,c=e.subtitleLineHeight,d=e.subtitlePadding,h=Xe(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]);var p=Object.assign(Object.assign({},h),a?{fill:a}:{});var v=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{});var g=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),u?{subtitleFont:u}:{}),s?{subtitleFontSize:s}:{}),l?{subtitleFontStyle:l}:{}),f?{subtitleFontWeight:f}:{}),c?{subtitleLineHeight:c}:{}),d?{subtitlePadding:d}:{});return{mark:p,nonMark:v,subtitle:g}}function F8(e){return ai(e)||ri(e)&&ai(e[0])}function N8(e){if(G5(e)){return e}return e!==undefined?{value:e}:undefined}function T8(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r];var o=P8(a,t.markDef,t.config);if(o!==undefined){e[a]={value:o}}}return e}function z8(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function R8(e,t,n,r){if(r===void 0){r={}}var i=r.vgChannel,a=r.ignoreVgConfig;if(i&&t[i]!==undefined){return t[i]}else if(t[e]!==undefined){return t[e]}else if(a&&(!i||i===e)){return undefined}return P8(e,t,n,r)}function P8(e,t,n,r){var i=(r===void 0?{}:r).vgChannel;return l0(i?L8(e,t,n.style):undefined,L8(e,t,n.style),i?n[t.type][i]:undefined,n[t.type][e],i?n.mark[i]:n.mark[e])}function L8(e,t,n){return I8(e,z8(t),n)}function I8(e,t,n){t=$i(t);var r;for(var i=0,a=t;i<a.length;i++){var o=a[i];var u=n[o];if(u&&u[e]!==undefined){r=u[e]}}return r}function B8(e,t){return $i(e).reduce((function(e,n){var r;e.field.push(t8(n,t));e.order.push((r=n.sort)!==null&&r!==void 0?r:"ascending");return e}),{field:[],order:[]})}function U8(e,t){var n=h(e);t.forEach((function(e){for(var t=0,r=n;t<r.length;t++){var i=r[t];if(FK(i,e)){return}}n.push(e)}));return n}function q8(e,t){if(FK(e,t)||!t){return e}else if(!e){return t}else{return h($i(e),$i(t)).join(", ")}}function W8(e,t){var n=e.value;var r=t.value;if(n==null||r===null){return{explicit:e.explicit,value:null}}else if((F8(n)||G5(n))&&(F8(r)||G5(r))){return{explicit:e.explicit,value:q8(n,r)}}else if(F8(n)||G5(n)){return{explicit:e.explicit,value:n}}else if(F8(r)||G5(r)){return{explicit:e.explicit,value:r}}else if(!F8(n)&&!G5(n)&&!F8(r)&&!G5(r)){return{explicit:e.explicit,value:U8(n,r)}}throw new Error("It should never reach here")}function H8(e,t){var n=e&&e[t];if(n){if(ri(n)){return BK(n,(function(e){return!!e.field}))}else{return q6(n)||I6(n)}}return false}function $8(e){return BK(o2,(function(t){if(H8(e,t)){var n=e[t];if(ri(n)){return BK(n,(function(e){return!!e.aggregate}))}else{var r=g8(n);return r&&!!r.aggregate}}return false}))}function G8(e,t){var n=[];var r=[];var i=[];var a=[];var o={};J8(e,(function(u,s){if(q6(u)){var l=u.field,f=u.aggregate,c=u.bin,d=u.timeUnit,h=Xe(u,["field","aggregate","bin","timeUnit"]);if(f||d||c){var p=d8(u);var v=p&&p.title;var g=t8(u,{forAs:true});var m=Object.assign(Object.assign(Object.assign({},v?[]:{title:c8(u,t,{allowDisabling:true})}),h),{field:g});if(f){var y=void 0;if(u1(f)){y="argmax";g=t8({op:"argmax",field:f.argmax},{forAs:true});m.field=g+"."+l}else if(o1(f)){y="argmin";g=t8({op:"argmin",field:f.argmin},{forAs:true});m.field=g+"."+l}else if(f!=="boxplot"&&f!=="errorbar"&&f!=="errorband"){y=f}if(y){var b={op:y,as:g};if(l){b.field=l}a.push(b)}}else{n.push(g);if(Y6(u)&&L2(c)){r.push({bin:c,field:l,as:g});n.push(t8(u,{binSuffix:"end"}));if(M8(u,s)){n.push(t8(u,{binSuffix:"range"}))}if(w2(s)){var x={field:g+"_end"};o[s+"2"]=x}m.bin="binned";if(!d2(s)){m["type"]="quantitative"}}else if(d){i.push({timeUnit:d,field:l,as:g});var _=Y6(u)&&u.type!==y4&&"time";if(_){if(s==="text"||s==="tooltip"){m["formatType"]=_}else if(S2(s)){m["legend"]=Object.assign({formatType:_},m["legend"])}else if(w2(s)){m["axis"]=Object.assign({formatType:_},m["axis"])}}}}o[s]=m}else{n.push(l);o[s]=e[s]}}else{o[s]=e[s]}}));return{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function V8(e,t,n){var r=F2(t,n);if(!r){return false}else if(r==="binned"){var i=e[t==="x2"?"x":"y"];if(q6(i)&&q6(e[t])&&I2(i.bin)){return true}else{return false}}return true}function Y8(e,t){var n=t.type;return XK(e).reduce((function(r,i){if(!f2(i)){d5(u5.invalidEncodingChannel(i));return r}var a=e[i];if(i==="angle"&&n==="arc"&&!e.theta){d5(u5.REPLACE_ANGLE_WITH_THETA);i=E1}if(!V8(e,i,n)){d5(u5.incompatibleChannel(i,n));return r}if(i==="size"&&n==="line"){var o=g8(e[i]);if(o===null||o===void 0?void 0:o.aggregate){d5(u5.LINE_WITH_VARYING_SIZE);return r}}if(i==="color"&&(t.filled?"fill"in e:"stroke"in e)){d5(u5.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e}));return r}if(i==="detail"||i==="order"&&!ri(a)&&!X6(a)||i==="tooltip"&&ri(a)){if(a){r[i]=$i(a).reduce((function(e,t){if(!q6(t)){d5(u5.emptyFieldDef(t,i))}else{e.push(_8(t,i))}return e}),[])}}else{if(i==="tooltip"&&a===null){r[i]=null}else if(!q6(a)&&!H6(a)&&!X6(a)&&!L6(a)&&!G5(a)){d5(u5.emptyFieldDef(a,i));return r}r[i]=y8(a,i)}return r}),{})}function X8(e){var t=[];for(var n=0,r=XK(e);n<r.length;n++){var i=r[n];if(H8(e,i)){var a=e[i];var o=$i(a);for(var u=0,s=o;u<s.length;u++){var l=s[u];if(q6(l)){t.push(l)}else if(I6(l)){t.push(l.condition)}}}}return t}function J8(e,t,n){if(!e){return}for(var r=0,i=XK(e);r<i.length;r++){var a=i[r];var o=e[a];if(ri(o)){for(var u=0,s=o;u<s.length;u++){var l=s[u];t.call(n,l,a)}}else{t.call(n,o,a)}}}function Z8(e,t,n,r){if(!e){return n}return XK(e).reduce((function(n,i){var a=e[i];if(ri(a)){return a.reduce((function(e,n){return t.call(r,e,n,i)}),n)}else{return t.call(r,n,a,i)}}),n)}function Q8(e,t){return XK(t).reduce((function(n,r){switch(r){case"x":case"y":case"href":case"url":case"x2":case"y2":case"theta":case"theta2":case"radius":case"radius2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":case"angle":case"tooltip":return n;case"order":if(e==="line"||e==="trail"){return n}case"detail":case"key":{var i=t[r];if(ri(i)||q6(i)){for(var a=0,o=$i(i);a<o.length;a++){var u=o[a];if(!u.aggregate){n.push(t8(u,{}))}}}return n}case"size":if(e==="trail"){return n}case"color":case"fill":case"stroke":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeDash":case"strokeWidth":{var u=g8(t[r]);if(u&&!u.aggregate){n.push(t8(u,{}))}return n}}}),[])}function K8(e){var t=e.tooltip,n=Xe(e,["tooltip"]);if(!t){return{filteredEncoding:e}}var r;var i;if(ri(t)){for(var a=0,o=t;a<o.length;a++){var u=o[a];if(u.aggregate){if(!r){r=[]}r.push(u)}else{if(!i){i=[]}i.push(u)}}if(r){n.tooltip=r}}else{if(t["aggregate"]){n.tooltip=t}else{i=t}}if(ri(i)&&i.length===1){i=i[0]}return{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function e9(e,t,n,r){if(r===void 0){r=true}if("tooltip"in n){return{tooltip:n.tooltip}}var i=e.map((function(e){var n=e.fieldPrefix,i=e.titlePrefix;var a=r?" of "+t.field:"";return{field:n+t.field,type:t.type,title:G5(i)?{signal:i+('"'+escape(a)+'"')}:i+a}}));return{tooltip:h(i,X8(n))}}function t9(e){var t=e.axis,n=e.title,r=e.field;return t&&t.title!==undefined?undefined:l0(n,r)}function n9(e,t,n,r,i){var a=n.scale,o=n.axis;return function(u){var s,l;var f=u.partName,c=u.mark,d=u.positionPrefix,h=u.endPositionPrefix,p=h===void 0?undefined:h,v=u.extraEncoding,g=v===void 0?{}:v;var m=t9(n);return r9(e,f,i,{mark:c,encoding:Object.assign(Object.assign(Object.assign((s={},s[t]=Object.assign(Object.assign(Object.assign({field:d+"_"+n.field,type:n.type},m!==undefined?{title:m}:{}),a!==undefined?{scale:a}:{}),o!==undefined?{axis:o}:{}),s),ai(p)?(l={},l[t+"2"]={field:p+"_"+n.field},l):{}),r),g)})}}function r9(e,t,n,r){var i=e.clip,a=e.color,o=e.opacity;var u=e.type;if(e[t]||e[t]===undefined&&n[t]){return[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),a?{color:a}:{}),o?{opacity:o}:{}),U0(r.mark)?r.mark:{type:r.mark}),{style:u+"-"+t}),ua(e[t])?{}:e[t])})]}return[]}function i9(e,t,n){var r=e.encoding;var i=t==="vertical"?"y":"x";var a=r[i];var o=r[i+"2"];var u=r[i+"Error"];var s=r[i+"Error2"];return{continuousAxisChannelDef:a9(a,n),continuousAxisChannelDef2:a9(o,n),continuousAxisChannelDefError:a9(u,n),continuousAxisChannelDefError2:a9(s,n),continuousAxis:i}}function a9(e,t){if(e&&e.aggregate){var n=e.aggregate,r=Xe(e,["aggregate"]);if(n!==t){d5(u5.errorBarContinuousAxisHasCustomizedAggregate(n,t))}return r}else{return e}}function o9(e,t){var n=e.mark,r=e.encoding;var i=r.x,a=r.y;if($6(i)){if($6(a)){var o=q6(i)&&i.aggregate;var u=q6(a)&&a.aggregate;if(!o&&u===t){return"vertical"}else if(!u&&o===t){return"horizontal"}else if(o===t&&u===t){throw new Error("Both x and y cannot have aggregate")}else{if(U0(n)&&n.orient){return n.orient}return"vertical"}}return"horizontal"}else if($6(a)){return"vertical"}else{throw new Error("Need a valid continuous axis for "+t+"s")}}var u9="boxplot";var s9={box:1,median:1,outliers:1,rule:1,ticks:1};var l9=XK(s9);var f9=new r1(u9,d9);function c9(e){if(la(e)){return"tukey"}return e}function d9(e,t){var n;var r=t.config;var i,a;var o=e.mark,u=e.encoding,s=e.selection,l=e.projection,f=Xe(e,["mark","encoding","selection","projection"]);var c=U0(o)?o:{type:o};if(s){d5(u5.selectionNotSupported("boxplot"))}var d=(i=c.extent)!==null&&i!==void 0?i:r.boxplot.extent;var p=R8("size",c,r);var v=c9(d);var g=p9(e,d,r),m=g.transform,y=g.continuousAxisChannelDef,b=g.continuousAxis,x=g.groupby,_=g.aggregate,w=g.encodingWithoutContinuousAxis,k=g.ticksOrient,E=g.boxOrient,O=g.customTooltipWithoutAggregatedField;var A=w.color,S=w.size,D=Xe(w,["color","size"]);var C=function(e){return n9(c,b,y,e,r.boxplot)};var M=C(D);var j=C(w);var F=C(Object.assign(Object.assign({},D),S?{size:S}:{}));var N=e9([{fieldPrefix:v==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:v==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],y,w);var T={type:"tick",color:"black",opacity:1,orient:k,invalid:null};var z=v==="min-max"?N:e9([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],y,w);var R=h(M({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:z}),M({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:z}),M({partName:"ticks",mark:T,positionPrefix:"lower_whisker",extraEncoding:z}),M({partName:"ticks",mark:T,positionPrefix:"upper_whisker",extraEncoding:z}));var P=h(v!=="tukey"?R:[],j({partName:"box",mark:Object.assign(Object.assign({type:"bar"},p?{size:p}:{}),{orient:E,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:N}),F({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},ii(r.boxplot.median)&&r.boxplot.median.color?{color:r.boxplot.median.color}:{}),p?{size:p}:{}),{orient:k}),positionPrefix:"mid_box",extraEncoding:N}));var L;if(v!=="min-max"){var I='datum["lower_box_'+y.field+'"]';var B='datum["upper_box_'+y.field+'"]';var U="("+B+" - "+I+")";var q=I+" - "+d+" * "+U;var W=B+" + "+d+" * "+U;var H='datum["'+y.field+'"]';var $={joinaggregate:h9(y.field),groupby:x};var G=undefined;if(v==="tukey"){G={transform:[{filter:"("+q+" <= "+H+") && ("+H+" <= "+W+")"},{aggregate:h([{op:"min",field:y.field,as:"lower_whisker_"+y.field},{op:"max",field:y.field,as:"upper_whisker_"+y.field},{op:"min",field:"lower_box_"+y.field,as:"lower_box_"+y.field},{op:"max",field:"upper_box_"+y.field,as:"upper_box_"+y.field}],_),groupby:x}],layer:R}}var V=Xe(D,["tooltip"]);var Y=y.scale,X=y.axis;var J=t9(y);var Z=r9(c,"outliers",r.boxplot,{transform:[{filter:"("+H+" < "+q+") || ("+H+" > "+W+")"}],mark:"point",encoding:Object.assign(Object.assign((n={},n[b]=Object.assign(Object.assign(Object.assign({field:y.field,type:y.type},J!==undefined?{title:J}:{}),Y!==undefined?{scale:Y}:{}),X!==undefined?{axis:X}:{}),n),V),O?{tooltip:O}:{})})[0];if(Z&&G){L={transform:[$],layer:[Z,G]}}else if(Z){L=Z;L.transform.unshift($)}else if(G){L=G;L.transform.unshift($)}}if(L){return Object.assign(Object.assign({},f),{layer:[L,{transform:m,layer:P}]})}return Object.assign(Object.assign({},f),{transform:((a=f.transform)!==null&&a!==void 0?a:[]).concat(m),layer:P})}function h9(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function p9(e,t,n){var r=o9(e,u9);var i=i9(e,r,u9),a=i.continuousAxisChannelDef,o=i.continuousAxis;var u=a.field;var s=c9(t);var l=h(h9(u),[{op:"median",field:u,as:"mid_box_"+u},{op:"min",field:u,as:(s==="min-max"?"lower_whisker_":"min_")+u},{op:"max",field:u,as:(s==="min-max"?"upper_whisker_":"max_")+u}]);var f=s==="min-max"||s==="tukey"?[]:[{calculate:'datum["upper_box_'+u+'"] - datum["lower_box_'+u+'"]',as:"iqr_"+u},{calculate:'min(datum["upper_box_'+u+'"] + datum["iqr_'+u+'"] * '+t+', datum["max_'+u+'"])',as:"upper_whisker_"+u},{calculate:'max(datum["lower_box_'+u+'"] - datum["iqr_'+u+'"] * '+t+', datum["min_'+u+'"])',as:"lower_whisker_"+u}];var c=e.encoding,d=o,p=Xe(c,[typeof d==="symbol"?d:d+""]);var v=K8(p),g=v.customTooltipWithoutAggregatedField,m=v.filteredEncoding;var y=G8(m,n),b=y.bins,x=y.timeUnits,_=y.aggregate,w=y.groupby,k=y.encoding;var E=r==="vertical"?"horizontal":"vertical";var O=r;var A=h(b,x,[{aggregate:h(_,l),groupby:w}],f);return{transform:A,groupby:w,aggregate:_,continuousAxisChannelDef:a,continuousAxis:o,encodingWithoutContinuousAxis:k,ticksOrient:E,boxOrient:O,customTooltipWithoutAggregatedField:g}}var v9="errorbar";var g9={ticks:1,rule:1};var m9=XK(g9);var y9=new r1(v9,b9);function b9(e,t){var n=t.config;var r=E9(e,v9,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.ticksOrient,l=r.markDef,f=r.outerSpec,c=r.tooltipEncoding;var d=n9(l,o,a,u,n.errorbar);var p={type:"tick",orient:s};var v=h(d({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:c}),d({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:c}),d({partName:"rule",mark:"rule",positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c}));return Object.assign(Object.assign(Object.assign({},f),{transform:i}),v.length>1?{layer:v}:Object.assign({},v[0]))}function x9(e,t){var n=e.encoding;if(_9(n)){return{orient:o9(e,t),inputType:"raw"}}var r=w9(n);var i=k9(n);var a=n.x;var o=n.y;if(r){if(i){throw new Error(t+" cannot be both type aggregated-upper-lower and aggregated-error")}var u=n.x2;var s=n.y2;if(V6(u)&&V6(s)){throw new Error(t+" cannot have both x2 and y2")}else if(V6(u)){if($6(a)){return{orient:"horizontal",inputType:"aggregated-upper-lower"}}else{throw new Error("Both x and x2 have to be quantitative in "+t)}}else if(V6(s)){if($6(o)){return{orient:"vertical",inputType:"aggregated-upper-lower"}}else{throw new Error("Both y and y2 have to be quantitative in "+t)}}throw new Error("No ranged axis")}else{var l=n.xError;var f=n.xError2;var c=n.yError;var d=n.yError2;if(V6(f)&&!V6(l)){throw new Error(t+" cannot have xError2 without xError")}if(V6(d)&&!V6(c)){throw new Error(t+" cannot have yError2 without yError")}if(V6(l)&&V6(c)){throw new Error(t+" cannot have both xError and yError with both are quantiative")}else if(V6(l)){if($6(a)){return{orient:"horizontal",inputType:"aggregated-error"}}else{throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}}else if(V6(c)){if($6(o)){return{orient:"vertical",inputType:"aggregated-error"}}else{throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}}throw new Error("No ranged axis")}}function _9(e){return(V6(e.x)||V6(e.y))&&!V6(e.x2)&&!V6(e.y2)&&!V6(e.xError)&&!V6(e.xError2)&&!V6(e.yError)&&!V6(e.yError2)}function w9(e){return V6(e.x2)||V6(e.y2)}function k9(e){return V6(e.xError)||V6(e.xError2)||V6(e.yError)||V6(e.yError2)}function E9(e,t,n){var r;var i=e.mark,a=e.encoding,o=e.selection,u=e.projection,s=Xe(e,["mark","encoding","selection","projection"]);var l=U0(i)?i:{type:i};if(o){d5(u5.selectionNotSupported(t))}var f=x9(e,t),c=f.orient,d=f.inputType;var p=i9(e,c,t),v=p.continuousAxisChannelDef,g=p.continuousAxisChannelDef2,m=p.continuousAxisChannelDefError,y=p.continuousAxisChannelDefError2,b=p.continuousAxis;var x=O9(l,v,g,m,y,d,t,n),_=x.errorBarSpecificAggregate,w=x.postAggregateCalculates,k=x.tooltipSummary,E=x.tooltipTitleWithFieldName;var O=a,A=b,S=b==="x"?"x2":"y2",D=b==="x"?"xError":"yError",C=b==="x"?"xError2":"yError2",M=Xe(O,[typeof A==="symbol"?A:A+"",typeof S==="symbol"?S:S+"",typeof D==="symbol"?D:D+"",typeof C==="symbol"?C:C+""]);var j=G8(M,n),F=j.bins,N=j.timeUnits,T=j.aggregate,z=j.groupby,R=j.encoding;var P=h(T,_);var L=d!=="raw"?[]:z;var I=e9(k,v,R,E);return{transform:h((r=s.transform)!==null&&r!==void 0?r:[],F,N,P.length===0?[]:[{aggregate:P,groupby:L}],w),groupby:L,continuousAxisChannelDef:v,continuousAxis:b,encodingWithoutContinuousAxis:R,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:s,tooltipEncoding:I}}function O9(e,t,n,r,i,a,o,u){var s=[];var l=[];var f=t.field;var c;var d=false;if(a==="raw"){var h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":u.errorbar.center;var p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!==(p==="iqr")){d5(u5.errorBarCenterIsUsedWithWrongExtent(h,p,o))}if(p==="stderr"||p==="stdev"){s=[{op:p,field:f,as:"extent_"+f},{op:h,field:f,as:"center_"+f}];l=[{calculate:'datum["center_'+f+'"] + datum["extent_'+f+'"]',as:"upper_"+f},{calculate:'datum["center_'+f+'"] - datum["extent_'+f+'"]',as:"lower_"+f}];c=[{fieldPrefix:"center_",titlePrefix:t0(h)},{fieldPrefix:"upper_",titlePrefix:A9(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:A9(h,p,"-")}];d=true}else{if(e.center&&e.extent){d5(u5.errorBarCenterIsNotNeeded(e.extent,o))}var v=void 0;var g=void 0;var m=void 0;if(p==="ci"){v="mean";g="ci0";m="ci1"}else{v="median";g="q1";m="q3"}s=[{op:g,field:f,as:"lower_"+f},{op:m,field:f,as:"upper_"+f},{op:v,field:f,as:"center_"+f}];c=[{fieldPrefix:"upper_",titlePrefix:c8({field:f,aggregate:m,type:"quantitative"},u,{allowDisabling:false})},{fieldPrefix:"lower_",titlePrefix:c8({field:f,aggregate:g,type:"quantitative"},u,{allowDisabling:false})},{fieldPrefix:"center_",titlePrefix:c8({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:false})}]}}else{if(e.center||e.extent){d5(u5.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent))}if(a==="aggregated-upper-lower"){c=[];l=[{calculate:'datum["'+n.field+'"]',as:"upper_"+f},{calculate:'datum["'+f+'"]',as:"lower_"+f}]}else if(a==="aggregated-error"){c=[{fieldPrefix:"",titlePrefix:f}];l=[{calculate:'datum["'+f+'"] + datum["'+r.field+'"]',as:"upper_"+f}];if(i){l.push({calculate:'datum["'+f+'"] + datum["'+i.field+'"]',as:"lower_"+f})}else{l.push({calculate:'datum["'+f+'"] - datum["'+r.field+'"]',as:"lower_"+f})}}for(var y=0,b=l;y<b.length;y++){var x=b[y];c.push({fieldPrefix:x.as.substring(0,6),titlePrefix:o0(o0(x.calculate,'datum["',""),'"]',"")})}}return{postAggregateCalculates:l,errorBarSpecificAggregate:s,tooltipSummary:c,tooltipTitleWithFieldName:d}}function A9(e,t,n){return t0(e)+" "+n+" "+t}var S9="errorband";var D9={band:1,borders:1};var C9=XK(D9);var M9=new r1(S9,j9);function j9(e,t){var n=t.config;var r=E9(e,S9,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.markDef,l=r.outerSpec,f=r.tooltipEncoding;var c=s;var d=n9(c,o,a,u,n.errorband);var p=e.encoding.x!==undefined&&e.encoding.y!==undefined;var v={type:p?"area":"rect"};var g={type:p?"line":"rule"};var m=Object.assign(Object.assign({},c.interpolate?{interpolate:c.interpolate}:{}),c.tension&&c.interpolate?{tension:c.tension}:{});if(p){v=Object.assign(Object.assign({},v),m);g=Object.assign(Object.assign({},g),m)}else if(c.interpolate){d5(u5.errorBand1DNotSupport("interpolate"))}else if(c.tension){d5(u5.errorBand1DNotSupport("tension"))}return Object.assign(Object.assign({},l),{transform:i,layer:h(d({partName:"band",mark:v,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f}),d({partName:"borders",mark:g,positionPrefix:"lower",extraEncoding:f}),d({partName:"borders",mark:g,positionPrefix:"upper",extraEncoding:f}))})}var F9={};function N9(e,t,n){var r=new r1(e,t);F9[e]={normalizer:r,parts:n}}function T9(){return XK(F9)}N9(u9,d9,l9);N9(v9,b9,m9);N9(S9,j9,C9);var z9=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"];var R9={size:1,shape:1,fill:1,stroke:1,strokeDash:1,strokeWidth:1,opacity:1};var P9=XK(R9);var L9={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}};var I9={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35};var B9={clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1};var U9="_vgsid_";var q9={single:{on:"click",fields:[U9],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[U9],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function W9(e){return!!e&&(e==="legend"||!!e.legend)}function H9(e){return W9(e)&&ii(e)}function $9(e){return V9(e)||Y9(e)||G9(e)}function G9(e){return"concat"in e}function V9(e){return"vconcat"in e}function Y9(e){return"hconcat"in e}function X9(e){return ii(e)&&e["step"]!==undefined}function J9(e){return e["view"]||e["width"]||e["height"]}var Z9=20;var Q9={align:1,bounds:1,center:1,columns:1,spacing:1};var K9=XK(Q9);function e7(e,t,n){var r,i;var a=n[t];var o={};var u=a.spacing,s=a.columns;if(u!==undefined){o.spacing=u}if(s!==undefined){if(j6(e)&&!C6(e.facet)||G9(e)){o.columns=s}}if(V9(e)){o.columns=1}for(var l=0,f=K9;l<f.length;l++){var c=f[l];if(e[c]!==undefined){if(c==="spacing"){var d=e[c];o[c]=la(d)?d:{row:(r=d.row)!==null&&r!==void 0?r:u,column:(i=d.column)!==null&&i!==void 0?i:u}}else{o[c]=e[c]}}}return o}function t7(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function n7(e,t){var n=r7(e,t);return X9(n)?n.step:i7}function r7(e,t){var n;var r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return l0(r,{step:e.step})}var i7=20;var a7={continuousWidth:200,continuousHeight:200,step:i7};var o7={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:a7,mark:X0,arc:{},area:{},bar:Q0,circle:{},geoshape:{},image:{},line:{},point:{},rect:K0,rule:{color:"black"},square:{},text:{color:"black"},tick:e1,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:true,ticks:false},errorband:{band:{opacity:.3},borders:false},scale:W4,projection:{},legend:I9,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:q9,style:{},title:{},facet:{spacing:Z9},concat:{spacing:Z9}};var u7=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"];var s7={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12};var l7={blue:u7[0],orange:u7[1],red:u7[2],teal:u7[3],green:u7[4],yellow:u7[5],purple:u7[6],pink:u7[7],brown:u7[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function f7(e){if(e===void 0){e={}}return{signals:[{name:"color",value:ii(e)?Object.assign(Object.assign({},l7),e):l7}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function c7(e){return{signals:[{name:"fontSize",value:ii(e)?Object.assign(Object.assign({},s7),e):s7}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function d7(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function h7(e){if(e===void 0){e={}}var t=e.color,n=e.font,r=e.fontSize,i=Xe(e,["color","font","fontSize"]);return ki({},o7,n?d7(n):{},t?f7(t):{},r?c7(r):{},i||{})}var p7=h(["view"],B0);var v7=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"];var g7=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},Y0);function m7(e){e=NK(e);for(var t=0,n=v7;t<n.length;t++){var r=n[t];delete e[r]}if(e.axis){for(var r in e.axis){if(m0(e.axis[r])){delete e.axis[r]}}}if(e.legend){for(var i=0,a=z9;i<a.length;i++){var r=a[i];delete e.legend[r]}}if(e.mark){for(var o=0,u=V0;o<u.length;o++){var r=u[o];delete e.mark[r]}}for(var s=0,l=p7;s<l.length;s++){var f=l[s];for(var c=0,d=V0;c<d.length;c++){var r=d[c];delete e[f][r]}var h=g7[f];if(h){for(var p=0,v=h;p<v.length;p++){var r=v[p];delete e[f][r]}}b7(e,f)}for(var g=0,m=T9();g<m.length;g++){var y=m[g];delete e[y]}y7(e);for(var r in e){if(ii(e[r])&&XK(e[r]).length===0){delete e[r]}}return XK(e).length>0?e:undefined}function y7(e){var t=j8(e.title),n=t.mark,r=t.subtitle;var i=Object.assign(Object.assign({},e.style["group-title"]),n);if(XK(i).length>0){e.style["group-title"]=i}if(XK(r).length>0){e.title=r}else{delete e.title}}function b7(e,t,n,r){var i=r?e[t][r]:e[t];if(t==="view"){n="cell"}var a=Object.assign(Object.assign({},i),e.style[n!==null&&n!==void 0?n:t]);if(XK(a).length>0){e.style[n!==null&&n!==void 0?n:t]=a}if(!r){delete e[t]}}function x7(e){return"layer"in e}function _7(e){return"repeat"in e}function w7(e){return!ri(e.repeat)&&e.repeat["layer"]}var k7=function(){function e(){}e.prototype.map=function(e,t){if(j6(e)){return this.mapFacet(e,t)}else if(_7(e)){return this.mapRepeat(e,t)}else if(Y9(e)){return this.mapHConcat(e,t)}else if(V9(e)){return this.mapVConcat(e,t)}else if(G9(e)){return this.mapConcat(e,t)}else{return this.mapLayerOrUnit(e,t)}};e.prototype.mapLayerOrUnit=function(e,t){if(x7(e)){return this.mapLayer(e,t)}else if(n1(e)){return this.mapUnit(e,t)}throw new Error(u5.invalidSpec(e))};e.prototype.mapLayer=function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map((function(e){return n.mapLayerOrUnit(e,t)}))})};e.prototype.mapHConcat=function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((function(e){return n.map(e,t)}))})};e.prototype.mapVConcat=function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((function(e){return n.map(e,t)}))})};e.prototype.mapConcat=function(e,t){var n=this;var r=e.concat,i=Xe(e,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map((function(e){return n.map(e,t)}))})};e.prototype.mapFacet=function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})};e.prototype.mapRepeat=function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})};return e}();var E7={zero:1,center:1,normalize:1};function O7(e){return!!E7[e]}var A7=[k0,O0,E0,M0,D0,T0,z0,S0,j0,F0];var S7=[O0,E0,k0];function D7(e,t,n){var r,i;var a=n==="x"?"y":"radius";var o=e[n];var u=e[a];if(q6(o)&&q6(u)){if(W6(o)==="quantitative"&&W6(u)==="quantitative"){if(o.stack){return n}else if(u.stack){return a}var s=q6(o)&&!!o.aggregate;var l=q6(u)&&!!u.aggregate;if(s!==l){return s?n:a}else{var f=(r=o.scale)===null||r===void 0?void 0:r.type;var c=(i=u.scale)===null||i===void 0?void 0:i.type;if(f&&f!=="linear"){return a}else if(c&&c!=="linear"){return n}}}else if(W6(o)==="quantitative"){return n}else if(W6(u)==="quantitative"){return a}}else if(W6(o)==="quantitative"){return n}else if(W6(u)==="quantitative"){return a}return undefined}function C7(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function M7(e,t,n){if(n===void 0){n={}}var r=U0(e)?e.type:e;if(!IK(A7,r)){return null}var i=D7(t,r,"x")||D7(t,r,"theta");if(!i){return null}var a=t[i];var o=q6(a)?t8(a,{}):undefined;var u=C7(i);var s=t[u];var l=q6(s)?t8(s,{}):undefined;if(l===o){l=undefined;s=undefined;u=undefined}var f=b2.reduce((function(e,n){if(n!=="tooltip"&&H8(t,n)){var r=t[n];for(var i=0,a=$i(r);i<a.length;i++){var o=a[i];var u=g8(o);if(u.aggregate){continue}var s=t8(u,{});if(!s||s!==l){e.push({channel:n,fieldDef:u})}}}return e}),[]);var c;if(a.stack!==undefined){if(ua(a.stack)){c=a.stack?"zero":null}else{c=a.stack}}else if(f.length>0&&IK(S7,r)){c="zero"}if(!c||!O7(c)){return null}if($8(t)&&f.length===0){return null}if(a.scale&&a.scale.type&&a.scale.type!==w4.LINEAR){if(n.disallowNonLinearStack){return null}else{d5(u5.cannotStackNonLinearScale(a.scale.type))}}if(V6(t[v2(i)])){if(a.stack!==undefined){d5(u5.cannotStackRangedMark(i))}return null}if(q6(a)&&a.aggregate&&!IK(d1,a.aggregate)){d5(u5.stackNonSummativeAggregate(a.aggregate))}return{groupbyChannel:s?u:undefined,groupbyField:l,fieldChannel:i,impute:a.impute===null?false:L0(r),stackBy:f,offset:c}}function j7(e){var t=Xe(e,["point","line"]);return XK(t).length>1?t:t.type}function F7(e){var t;for(var n=0,r=["line","area","rule","trail"];n<r.length;n++){var i=r[n];if(e[i]){e=Object.assign(Object.assign({},e),(t={},t[i]=zK(e[i],["point","line"]),t))}}return e}function N7(e,t,n){if(t===void 0){t={}}if(e.point==="transparent"){return{opacity:0}}else if(e.point){return ii(e.point)?e.point:{}}else if(e.point!==undefined){return null}else{if(t.point||n.shape){return ii(t.point)?t.point:{}}return undefined}}function T7(e,t){if(t===void 0){t={}}if(e.line){return e.line===true?{}:e.line}else if(e.line!==undefined){return null}else{if(t.line){return t.line===true?{}:t.line}return undefined}}var z7=function(){function e(){this.name="path-overlay"}e.prototype.hasMatchingType=function(e,t){if(n1(e)){var n=e.mark,r=e.encoding;var i=U0(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!N7(i,t[i.type],r);case"area":return!!N7(i,t[i.type],r)||!!T7(i,t[i.type])}}return false};e.prototype.run=function(e,t,n){var r;var i=t.config;var a=e.selection,o=e.projection,u=e.encoding,s=e.mark,l=Xe(e,["selection","projection","encoding","mark"]);var f=U0(s)?s:{type:s};var c=N7(f,i[f.type],u);var d=f.type==="area"&&T7(f,i[f.type]);var h=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:j7(Object.assign(Object.assign({},f.type==="area"&&f.opacity===undefined&&f.fillOpacity===undefined?{opacity:.7}:{}),f)),encoding:zK(u,["shape"])})];var p=M7(f,u);var v=u;if(p){var g=p.fieldChannel,m=p.offset;v=Object.assign(Object.assign({},u),(r={},r[g]=Object.assign(Object.assign({},u[g]),m?{stack:m}:{}),r))}if(d){h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},TK(f,["clip","interpolate","tension","tooltip"])),d),encoding:v}))}if(c){h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:true},TK(f,["clip","tooltip"])),c),encoding:v}))}return n(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},t),{config:F7(i)}))};return e}();var R7=function(){function e(){this.name="RangeStep"}e.prototype.hasMatchingType=function(e){var t;if(n1(e)&&e.encoding){for(var n=0,r=_2;n<r.length;n++){var i=r[n];var a=e.encoding[i];if(a&&V6(a)){if((t=a===null||a===void 0?void 0:a.scale)===null||t===void 0?void 0:t["rangeStep"]){return true}}}}return false};e.prototype.run=function(e){var t;var n;var r={};var i=Object.assign({},e.encoding);for(var a=0,o=_2;a<o.length;a++){var u=o[a];var s=g2(u);var l=i[u];if(l&&V6(l)){if((n=l===null||l===void 0?void 0:l.scale)===null||n===void 0?void 0:n["rangeStep"]){var f=l.scale,c=Xe(l,["scale"]);var d=f,h=Xe(d,["rangeStep"]);r[s]={step:f["rangeStep"]};d5(u5.RANGE_STEP_DEPRECATED);i=Object.assign(Object.assign({},i),(t={},t[u]=Object.assign(Object.assign({},c),XK(h).length>0?{scale:h}:{}),t))}}}return Object.assign(Object.assign(Object.assign({},r),e),{encoding:i})};return e}();function P7(e,t){if(!t){return e}if(C6(e)){return W7(e,t)}return B7(e,t)}function L7(e,t){if(!t){return e}return W7(e,t)}function I7(e,t,n){var r;var i=t[e];if(N6(i)){if(i.repeat in n){return Object.assign(Object.assign({},t),(r={},r[e]=n[i.repeat],r))}else{d5(u5.noSuchRepeatedValue(i.repeat));return undefined}}return t}function B7(e,t){e=I7("field",e,t);if(e===undefined){return undefined}else if(e===null){return null}if(z6(e)&&S6(e.sort)){var n=I7("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}function U7(e,t){if(q6(e)){return B7(e,t)}else{var n=I7("datum",e,t);if(n!==e&&!n.type){n.type="nominal"}return n}}function q7(e,t){if(V6(e)){var n=U7(e,t);if(n){return n}else if(L6(e)){return{condition:e.condition}}}else{if(B6(e)){var n=U7(e.condition,t);if(n){return Object.assign(Object.assign({},e),{condition:n})}else{var r=Xe(e,["condition"]);return r}}return e}return undefined}function W7(e,t){var n={};for(var r in e){if(ta(e,r)){var i=e[r];if(ri(i)){n[r]=i.map((function(e){return q7(e,t)})).filter((function(e){return e}))}else{var a=q7(i,t);if(a!==undefined){n[r]=a}}}}return n}var H7=function(){function e(){this.name="RuleForRangedLine"}e.prototype.hasMatchingType=function(e){if(n1(e)){var t=e.encoding,n=e.mark;if(n==="line"){for(var r=0,i=c2;r<i.length;r++){var a=i[r];var o=h2(a);var u=t[o];if(t[a]){if(q6(u)&&!I2(u.bin)||H6(u)){return true}}}}}return false};e.prototype.run=function(e,t,n){var r=e.encoding;d5(u5.lineWithRange(!!r.x2,!!r.y2));return n(Object.assign(Object.assign({},e),{mark:"rule"}),t)};return e}();var $7=function(e){Ze(t,e);function t(){var t=e.apply(this,arguments)||this;t.nonFacetUnitNormalizers=[f9,y9,M9,new z7,new H7,new R7];return t}t.prototype.map=function(t,n){if(n1(t)){var r=H8(t.encoding,v1);var i=H8(t.encoding,g1);var a=H8(t.encoding,m1);if(r||i||a){return this.mapFacetedUnit(t,n)}}return e.prototype.map.call(this,t,n)};t.prototype.mapUnit=function(e,t){var n=t.parentEncoding,r=t.parentProjection;var i=Object.assign(Object.assign({},e),{encoding:L7(e.encoding,t.repeater)});if(n||r){return this.mapUnitWithParentEncodingOrProjection(i,t)}var a=this.mapLayerOrUnit.bind(this);for(var o=0,u=this.nonFacetUnitNormalizers;o<u.length;o++){var s=u[o];if(s.hasMatchingType(i,t.config)){return s.run(i,t,a)}}return i};t.prototype.mapRepeat=function(e,t){if(w7(e)){return this.mapLayerRepeat(e,t)}else{return this.mapNonLayerRepeat(e,t)}};t.prototype.mapLayerRepeat=function(e,t){var n=this;var r=e.repeat,i=e.spec,a=Xe(e,["repeat","spec"]);var o=r.row,u=r.column,s=r.layer;var l=t.repeater,f=l===void 0?{}:l,c=t.repeaterPrefix,d=c===void 0?"":c;if(o||u){return this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),u?{column:u}:{}),spec:{repeat:{layer:s},spec:i}}),t)}else{return Object.assign(Object.assign({},a),{layer:s.map((function(e){var r=Object.assign(Object.assign({},f),{layer:e});var a=(i.name||"")+d+("child__layer_"+QK(e));var o=n.mapLayerOrUnit(i,Object.assign(Object.assign({},t),{repeater:r,repeaterPrefix:a}));o.name=a;return o}))})}};t.prototype.mapNonLayerRepeat=function(e,t){var n;var r=e.repeat,i=e.spec,a=e.data,o=Xe(e,["repeat","spec","data"]);if(!ri(r)&&e.columns){e=zK(e,["columns"]);d5(u5.columnsNotSupportByRowCol("repeat"))}var u=[];var s=t.repeater,l=s===void 0?{}:s,f=t.repeaterPrefix,c=f===void 0?"":f;var d=!ri(r)&&r.row||[l?l.row:null];var h=!ri(r)&&r.column||[l?l.column:null];var p=ri(r)&&r||[l?l.repeat:null];for(var v=0,g=p;v<g.length;v++){var m=g[v];for(var y=0,b=d;y<b.length;y++){var x=b[y];for(var _=0,w=h;_<w.length;_++){var k=w[_];var E={repeat:m,row:x,column:k,layer:l.layer};var O=(i.name||"")+c+"child__"+(ri(r)?""+QK(m):(r.row?"row_"+QK(x):"")+(r.column?"column_"+QK(k):""));var A=this.map(i,Object.assign(Object.assign({},t),{repeater:E,repeaterPrefix:O}));A.name=O;u.push(zK(A,["data"]))}}}var S=ri(r)?e.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(n=i.data)!==null&&n!==void 0?n:a,align:"all"},o),{columns:S,concat:u})};t.prototype.mapFacet=function(t,n){var r=t.facet;if(C6(r)&&t.columns){t=zK(t,["columns"]);d5(u5.columnsNotSupportByRowCol("facet"))}return e.prototype.mapFacet.call(this,t,n)};t.prototype.mapUnitWithParentEncodingOrProjection=function(e,t){var n=e.encoding,r=e.projection;var i=t.parentEncoding,a=t.parentProjection,o=t.config;var u=V7({parentProjection:a,projection:r});var s=G7({parentEncoding:i,encoding:L7(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})};t.prototype.mapFacetedUnit=function(e,t){var n=e.encoding,r=n.row,i=n.column,a=n.facet,o=Xe(n,["row","column","facet"]);var u=e.mark,s=e.width,l=e.projection,f=e.height,c=e.view,d=e.selection,h=e.encoding,p=Xe(e,["mark","width","projection","height","view","selection","encoding"]);var v=this.getFacetMappingAndLayout({row:r,column:i,facet:a},t),g=v.facetMapping,m=v.layout;var y=L7(o,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{width:s}:{}),f?{height:f}:{}),c?{view:c}:{}),l?{projection:l}:{}),{mark:u,encoding:y}),d?{selection:d}:{})}),t)};t.prototype.getFacetMappingAndLayout=function(e,t){var n;var r=e.row,i=e.column,a=e.facet;if(r||i){if(a){d5(u5.facetChannelDropped(h(r?[v1]:[],i?[g1]:[])))}var o={};var u={};for(var s=0,l=[v1,g1];s<l.length;s++){var f=l[s];var c=e[f];if(c){var d=Xe(c,["align","center","spacing","columns"]);o[f]=d;for(var p=0,v=["align","center","spacing"];p<v.length;p++){var g=v[p];if(c[g]!==undefined){u[g]=(n=u[g])!==null&&n!==void 0?n:{};u[g][f]=c[g]}}}}return{facetMapping:o,layout:u}}else{var m=a.align,y=a.center,b=a.spacing,x=a.columns,o=Xe(a,["align","center","spacing","columns"]);return{facetMapping:P7(o,t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},m?{align:m}:{}),y?{center:y}:{}),b?{spacing:b}:{}),x?{columns:x}:{})}}};t.prototype.mapLayer=function(t,n){var r=n.parentEncoding,i=n.parentProjection,a=Xe(n,["parentEncoding","parentProjection"]);var o=t.encoding,u=t.projection,s=Xe(t,["encoding","projection"]);var l=Object.assign(Object.assign({},a),{parentEncoding:G7({parentEncoding:r,encoding:o}),parentProjection:V7({parentProjection:i,projection:u})});return e.prototype.mapLayer.call(this,s,l)};return t}(k7);function G7(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=XK(t).reduce((function(e,t){if(n[t]){e.push(t)}return e}),[]);if(r.length>0){d5(u5.encodingOverridden(r))}}var i=Object.assign(Object.assign({},t!==null&&t!==void 0?t:{}),n!==null&&n!==void 0?n:{});return XK(i).length>0?i:undefined}function V7(e){var t=e.parentProjection,n=e.projection;if(t&&n){d5(u5.projectionOverridden({parentProjection:t,projection:n}))}return n!==null&&n!==void 0?n:t}function Y7(e,t){if(t===undefined){t=h7(e.config)}var n=J7(e,t);var r=e.width,i=e.height;var a=Q7(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}var X7=new $7;function J7(e,t){if(t===void 0){t={}}return X7.map(e,{config:t})}function Z7(e){return ai(e)?{type:e}:e!==null&&e!==void 0?e:{}}function Q7(e,t,n){var r=t.width,i=t.height;var a=n1(e)||x7(e);var o={};if(!a){if(r=="container"){d5(u5.containerSizeNonSingle("width"));r=undefined}if(i=="container"){d5(u5.containerSizeNonSingle("height"));i=undefined}}else{if(r=="container"&&i=="container"){o.type="fit";o.contains="padding"}else if(r=="container"){o.type="fit-x";o.contains="padding"}else if(i=="container"){o.type="fit-y";o.contains="padding"}}var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Z7(n.autosize):{}),Z7(e.autosize));if(u.type==="fit"&&!a){d5(u5.FIT_NON_SINGLE);u.type="pad"}if(r=="container"&&!(u.type=="fit"||u.type=="fit-x")){d5(u5.containerSizeNotCompatibleWithAutosize("width"))}if(i=="container"&&!(u.type=="fit"||u.type=="fit-y")){d5(u5.containerSizeNotCompatibleWithAutosize("height"))}if(FK(u,{type:"pad"})){return undefined}return u}function K7(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function eee(e){return e?"fit-"+E2(e):"fit"}var tee=["background","padding"];function nee(e){return tee.reduce((function(t,n){if(e&&e[n]!==undefined){t[n]=e[n]}return t}),{})}function ree(e){return"url"in e}function iee(e){return"values"in e}function aee(e){return"name"in e&&!ree(e)&&!iee(e)&&!oee(e)}function oee(e){return e&&(uee(e)||see(e)||lee(e))}function uee(e){return"sequence"in e}function see(e){return"sphere"in e}function lee(e){return"graticule"in e}var fee="main";var cee="raw";function dee(e){return"filter"in e}function hee(e){return(e===null||e===void 0?void 0:e["stop"])!==undefined}function pee(e){return"lookup"in e}function vee(e){return"data"in e}function gee(e){return"selection"in e}function mee(e){return"pivot"in e}function yee(e){return"density"in e}function bee(e){return"quantile"in e}function xee(e){return"regression"in e}function _ee(e){return"loess"in e}function wee(e){return"sample"in e}function kee(e){return"window"in e}function Eee(e){return"joinaggregate"in e}function Oee(e){return"flatten"in e}function Aee(e){return"calculate"in e}function See(e){return"bin"in e}function Dee(e){return"impute"in e}function Cee(e){return"timeUnit"in e}function Mee(e){return"aggregate"in e}function jee(e){return"stack"in e}function Fee(e){return"fold"in e}function Nee(e){return e.map((function(e){if(dee(e)){return{filter:jK(e.filter,p4)}}return e}))}function Tee(e,t,n,r){var i,a;var o=L6(t)&&t.condition;var u=r(t);if(o){var s=$i(o);var l=s.map((function(t){var n=r(t);var i=F6(t)?gne(e,t.selection):bne(e,t.test);return Object.assign({test:i},n)}));return i={},i[n]=h(l,u!==undefined?[u]:[]),i}else{return u!==undefined?(a={},a[n]=u,a):{}}}function zee(e,t,n){if(n===void 0){n={}}var r=t.markDef,i=t.encoding,a=t.config;var o=n.vgChannel;var u=n.defaultRef,s=n.defaultValue;if(u===undefined){s=s!==null&&s!==void 0?s:R8(e,r,a,{vgChannel:o,ignoreVgConfig:true});if(s!==undefined){u=N8(s)}}var l=i[e];return Tee(t,l,o!==null&&o!==void 0?o:e,(function(n){return f6({channel:e,channelDef:n,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:u})}))}function Ree(e,t){if(t===void 0){t={filled:undefined}}var n,r,i,a;var o=e.markDef,u=e.encoding,s=e.config;var l=o.type;var f=(n=t.filled)!==null&&n!==void 0?n:R8("filled",o,s);var c=IK(["bar","point","circle","square","geoshape"],l)?"transparent":undefined;var d=(i=(r=R8(f===true?"color":undefined,o,s,{vgChannel:"fill"}))!==null&&r!==void 0?r:s.mark[f===true&&"color"])!==null&&i!==void 0?i:c;var h=(a=R8(f===false?"color":undefined,o,s,{vgChannel:"stroke"}))!==null&&a!==void 0?a:s.mark[f===false&&"color"];var p=f?"fill":"stroke";var v=Object.assign(Object.assign({},d?{fill:N8(d)}:{}),h?{stroke:N8(h)}:{});if(o.color&&(f?o.fill:o.stroke)){d5(u5.droppingColor("property",{fill:"fill"in o,stroke:"stroke"in o}))}return Object.assign(Object.assign(Object.assign(Object.assign({},v),zee("color",e,{vgChannel:p,defaultValue:f?d:h})),zee("fill",e,{defaultValue:u.fill?d:undefined})),zee("stroke",e,{defaultValue:u.stroke?h:undefined}))}function Pee(e,t){if(t===void 0){t="text"}var n=e.encoding[t];return Tee(e,n,t,(function(t){return Lee(t,e.config)}))}function Lee(e,t,n){if(n===void 0){n="datum"}if(e){if(X6(e)){return{value:e.value}}if(Y6(e)){var r=p8(e),i=r.format,a=r.formatType;return m6({fieldOrDatumDef:e,format:i,formatType:a,expr:n,config:t})}if(G5(e)){return e}}return undefined}function Iee(e,t){if(t===void 0){t={}}var n=e.encoding,r=e.markDef,i=e.config;var a=n.tooltip;if(ri(a)){return{tooltip:Bee({tooltip:a},e.stack,i,t)}}else{return Tee(e,a,"tooltip",(function(a){var o=Lee(a,e.config,t.reactiveGeom?"datum.datum":"datum");if(o){return o}if(a===null){return undefined}var u=R8("tooltip",r,i);if(u===true){u={content:"encoding"}}if(ai(u)){return{value:u}}else if(ii(u)){if(u.content==="encoding"){return Bee(n,e.stack,i,t)}else{return{signal:"datum"}}}return undefined}))}}function Bee(e,t,n,r){var i=(r===void 0?{}:r).reactiveGeom;var a=[];var o={};var u={};var s=i?"datum.datum":"datum";var l=[];function f(r,i){var a=h2(i);var o=Y6(r)?r:Object.assign(Object.assign({},r),{type:e[a].type});var f=$i(c8(o,n,{allowDisabling:false})).join(", ");var c=Lee(o,n,s).signal;if(w2(i)){var d=i==="x"?"x2":"y2";var h=g8(e[d]);if(I2(o.bin)&&h){var p=t8(o,{expr:s});var v=t8(h,{expr:s});var g=p8(o),m=g.format,y=g.formatType;c=_6(p,v,m,y,n);u[d]=true}else if(t&&t.fieldChannel===i&&t.offset==="normalize"){var b=p8(o),x=b.format,y=b.formatType;c=m6({fieldOrDatumDef:o,format:x,formatType:y,expr:s,config:n,normalizeStack:true}).signal}}l.push({channel:i,key:f,value:c})}J8(e,(function(e,t){if(q6(e)){f(e,t)}else if(I6(e)){f(e.condition,t)}}));for(var c=0,d=l;c<d.length;c++){var h=d[c],p=h.channel,v=h.key,g=h.value;if(!u[p]&&!o[v]){a.push(oi(v)+": "+g);o[v]=true}}return a.length>0?{signal:"{"+a.join(", ")+"}"}:undefined}function Uee(e,t){var n=m2(e);var r=t[n];if(r){return r}return undefined}function qee(e,t,n){var r;var i=n.defaultPos,a=n.vgChannel,o=n.isMidPoint;var u=t.encoding,s=t.markDef,l=t.config,f=t.stack;var c=u[e];var d=u[v2(e)];var h=t.scaleName(e);var p=t.getScaleComponent(e);var v=Uee(e,s);var g=Hee({model:t,defaultPos:i,channel:e,scaleName:h,scale:p});var m=!c&&w2(e)&&(u.latitude||u.longitude)?{field:t.getName(e)}:Wee({channel:e,channelDef:c,channel2Def:d,markDef:s,config:l,isMidPoint:o,scaleName:h,scale:p,stack:f,offset:v,defaultRef:g});return m?(r={},r[a||e]=m,r):undefined}function Wee(e){var t=e.channel,n=e.channelDef,r=e.isMidPoint,i=e.scaleName,a=e.stack,o=e.offset,u=e.markDef,s=e.config;if(V6(n)&&a&&t===a.fieldChannel){if(q6(n)){var l=R6({channel:t,fieldDef:n,isMidPoint:r,markDef:u,stack:a,config:s});if(l!==undefined){return l6({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}}return s6(n,i,{suffix:"end"},{offset:o})}return r6(e)}function Hee(e){var t=e.model,n=e.defaultPos,r=e.channel,i=e.scaleName,a=e.scale;var o=t.markDef,u=t.config;return function(){var e=h2(r);var s=p2(r);var l=R8(r,o,u,{vgChannel:s});if(l!==undefined){return c6(r,l)}switch(n){case"zeroOrMin":case"zeroOrMax":if(i){var f=a.get("type");if(IK([w4.LOG,w4.TIME,w4.UTC],f));else{if(a.domainDefinitelyIncludesZero()){return{scale:i,value:0}}}}if(n==="zeroOrMin"){return e==="y"?{field:{group:"height"}}:{value:0}}else{switch(e){case"radius":return{signal:"min("+t.width.signal+","+t.height.signal+")/2"};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}}break;case"mid":{var c=t[g2(r)];return Object.assign(Object.assign({},c),{mult:.5})}}return undefined}}var $ee={left:"x",center:"xc",right:"x2"};var Gee={top:"y",middle:"yc",bottom:"y2"};function Vee(e,t,n,r){if(r===void 0){r="middle"}if(e==="radius"||e==="theta"){return p2(e)}var i=e==="x"?"align":"baseline";var a=R8(i,t,n);if(e==="x"){return $ee[a||(r==="top"?"left":"center")]}else{return Gee[a||r]}}function Yee(e,t,n){var r=n.defaultPos,i=n.defaultPos2,a=n.range;if(a){return Xee(e,t,{defaultPos:r,defaultPos2:i})}return qee(e,t,{defaultPos:r})}function Xee(e,t,n){var r=n.defaultPos,i=n.defaultPos2;var a=t.markDef,o=t.config;var u=v2(e);var s=g2(e);var l=Jee(t,i,u);var f=l[s]?Vee(e,a,o):p2(e);return Object.assign(Object.assign({},qee(e,t,{defaultPos:r,vgChannel:f})),l)}function Jee(e,t,n){var r,i,a,o;var u=e.encoding,s=e.mark,l=e.markDef,f=e.stack,c=e.config;var d=h2(n);var h=g2(n);var p=p2(n);var v=u[d];var g=e.scaleName(d);var m=e.getScaleComponent(d);var y=n in u||n in l?Uee(n,e.markDef):Uee(d,e.markDef);if(!v&&(n==="x2"||n==="y2")&&(u.latitude||u.longitude)){return r={},r[p]={field:e.getName(n)},r}var b=Zee({channel:n,channelDef:v,channel2Def:u[n],markDef:l,config:c,scaleName:g,scale:m,stack:f,offset:y,defaultRef:undefined});if(b!==undefined){return i={},i[p]=b,i}return Qee(n,l)||Qee(n,(a={},a[n]=L8(n,l,c.style),a[h]=L8(h,l,c.style),a))||Qee(n,c[s])||Qee(n,c.mark)||(o={},o[p]=Hee({model:e,defaultPos:t,channel:n,scaleName:g,scale:m})(),o)}function Zee(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,f=e.defaultRef;if(V6(n)&&s&&t.charAt(0)===s.fieldChannel.charAt(0)){return s6(n,o,{suffix:"start"},{offset:l})}return r6({channel:t,channelDef:r,scaleName:o,scale:u,stack:s,markDef:i,config:a,offset:l,defaultRef:f})}function Qee(e,t){var n,r,i;var a=g2(e);var o=p2(e);if(t[o]!==undefined){return n={},n[o]=c6(e,t[o]),n}else if(t[e]!==undefined){return r={},r[o]=c6(e,t[e]),r}else if(t[a]){return i={},i[a]=c6(e,t[a]),i}return undefined}function Kee(e,t,n){var r,i,a,o;var u=e.config,s=e.encoding,l=e.markDef,f=e.stack;var c=v2(t);var d=g2(t);var h=s[t];var p=s[c];var v=e.getScaleComponent(t);var g=v?v.get("type"):undefined;var m=e.scaleName(t);var y=l.orient;var b=(i=(r=s[d])!==null&&r!==void 0?r:s.size)!==null&&i!==void 0?i:R8("size",l,u,{vgChannel:d});var x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(q6(h)&&(L2(h.bin)||I2(h.bin)||h.timeUnit&&!p)&&!b&&!I4(g)){var _=R6({channel:t,fieldDef:h,stack:f,markDef:l,config:u});var w=(a=e.component.axes[t])===null||a===void 0?void 0:a[0];var k=(o=w===null||w===void 0?void 0:w.get("translate"))!==null&&o!==void 0?o:.5;return rte({fieldDef:h,fieldDef2:p,channel:t,markDef:l,scaleName:m,band:_,axisTranslate:k,spacing:w2(t)?R8("binSpacing",l,u):undefined,reverse:v.get("reverse"),config:u})}else if((V6(h)&&I4(g)||x)&&!p){return tte(n,h,t,e)}else{return Xee(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}}function ete(e,t,n,r,i,a){if(r){var o=r.get("type");if(o==="point"||o==="band"){if(i[e].discreteBandSize!==undefined){return{value:i[e].discreteBandSize}}if(o===w4.POINT){var u=r.get("range");if(V5(u)&&la(u.step)){return{value:u.step-2}}return{value:i7-2}}else{return{scale:n,band:a}}}else{return{value:i[e].continuousBandSize}}}var s=n7(i.view,t);var l=l0(i[e].discreteBandSize,s-2);return l!==undefined?{value:l}:undefined}function tte(e,t,n,r){var i,a,o;var u;var s=r.markDef,l=r.encoding,f=r.config,c=r.stack;var d=s.orient;var h=r.scaleName(n);var p=r.getScaleComponent(n);var v=g2(n);var g=v2(n);var m=d==="horizontal"&&n==="y"||d==="vertical"&&n==="x";var y=R8(m?"size":v,s,f,{vgChannel:v});var b;if(l.size||y!==undefined){if(m){b=zee("size",r,{vgChannel:v,defaultValue:y})}else{d5(u5.cannotApplySizeToNonOrientedMark(s.type))}}var x=(u=V6(t)?R6({channel:n,fieldDef:t,markDef:s,stack:c,config:f}):undefined)!==null&&u!==void 0?u:1;b=b||(i={},i[v]=ete(e,v,h,p,f,x),i);var _=(p===null||p===void 0?void 0:p.get("type"))!=="band"||!("band"in b[v]);var w=Vee(n,s,f,_?"middle":"top");var k=Uee(n,s);var E=r6({channel:n,channelDef:t,markDef:s,config:f,scaleName:h,scale:p,stack:c,offset:k,defaultRef:Hee({model:r,defaultPos:"mid",channel:n,scaleName:h,scale:p}),band:_?.5:(1-x)/2});if(v){return Object.assign((a={},a[w]=E,a),b)}else{var O=p2(g);var A=b[v];var S=k?Object.assign(Object.assign({},A),{offset:k}):A;return o={},o[w]=E,o[O]=ri(E)?[E[0],Object.assign(Object.assign({},E[1]),{offset:S})]:Object.assign(Object.assign({},E),{offset:S}),o}}function nte(e,t,n,r,i){if(J1(e)){return 0}var a=e==="x"||e==="y2"?-t/2:t/2;if(G5(n)){var o=G5(i)?i.signal:i?""+i:"";return{signal:n.signal+" ? "+(r-a)+(o?"-"+o:"")+" : "+(r+a)+(o?"+"+o:"")}}else{if(G5(i)){var u=r+(n?-a:a);return{signal:""+(u||"")+(n?" - ":u?" + ":"")+i.signal}}i=i||0;return r+(n?-i-a:+i+a)}}function rte(e){var t,n;var r=e.fieldDef,i=e.fieldDef2,a=e.channel,o=e.band,u=e.scaleName,s=e.markDef,l=e.spacing,f=l===void 0?0:l,c=e.axisTranslate,d=e.reverse,h=e.config;var p=v2(a);var v=p2(a);var g=p2(p);var m=Uee(a,s);if(L2(r.bin)||r.timeUnit){return t={},t[g]=ite({channel:a,fieldDef:r,scaleName:u,markDef:s,band:(1-o)/2,offset:nte(p,f,d,c,m),config:h}),t[v]=ite({channel:a,fieldDef:r,scaleName:u,markDef:s,band:1-(1-o)/2,offset:nte(a,f,d,c,m),config:h}),t}else if(I2(r.bin)&&q6(i)){return n={},n[g]=s6(r,u,{},{offset:nte(p,f,d,c,m)}),n[v]=s6(i,u,{},{offset:nte(a,f,d,c,m)}),n}else{d5(u5.channelRequiredForBinned(p));return undefined}}function ite(e){var t=e.channel,n=e.fieldDef,r=e.scaleName,i=e.markDef,a=e.band,o=e.offset,u=e.config;var s=l6({scaleName:r,fieldOrDatumDef:n,band:a,offset:o});return i6({fieldDef:n,channel:t,markDef:i,ref:s,config:u})}function ate(e,t){var n=t.color==="include"?Ree(e):{},r=n.fill,i=r===void 0?undefined:r,a=n.stroke,o=a===void 0?undefined:a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ute(e.markDef,t)),ote(e,"fill",i)),ote(e,"stroke",o)),zee("opacity",e)),zee("fillOpacity",e)),zee("strokeOpacity",e)),zee("strokeWidth",e)),zee("strokeDash",e)),Iee(e)),Pee(e,"href"))}function ote(e,t,n){var r,i;var a=e.config,o=e.mark,u=e.markDef;var s=R8("invalid",u,a);if(s==="hide"&&n&&!L0(o)){var l=ste(e,{invalid:true,channels:M2});if(l){return r={},r[t]=h([{test:l,value:null}],$i(n)),r}}return n?(i={},i[t]=n,i):{}}function ute(e,t){return Q5.reduce((function(n,r){if(e[r]!==undefined&&t[r]!=="ignore"){n[r]={value:e[r]}}return n}),{})}function ste(e,t){var n=t.invalid,r=n===void 0?false:n,i=t.channels;var a=i.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var i=r.get("type");var a=e.vgField(n,{expr:"datum"});if(a&&B4(i)){t[a]=true}}return t}),{});var o=XK(a);if(o.length>0){var u=r?"||":"&&";return o.map((function(e){return o6(e,r)})).join(" "+u+" ")}return undefined}function lte(e){var t=e.config,n=e.markDef;var r=R8("invalid",n,t);if(r){var i=fte(e,{channels:["x","y"]});if(i){return{defined:{signal:i}}}}return{}}function fte(e,t){var n=t.invalid,r=n===void 0?false:n,i=t.channels;var a=i.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var i=r.get("type");var a=e.vgField(n,{expr:"datum"});if(a&&B4(i)){t[a]=true}}return t}),{});var o=XK(a);if(o.length>0){var u=r?"||":"&&";return o.map((function(e){return o6(e,r)})).join(" "+u+" ")}return undefined}function cte(e,t){var n;if(t!==undefined){return n={},n[e]=N8(t),n}return undefined}var dte="voronoi";var hte={has:function(e){return e.type!=="interval"&&e.nearest},parse:function(e,t){if(t.events){for(var n=0,r=t.events;n<r.length;n++){var i=r[n];i.markname=e.getName(dte)}}},marks:function(e,t,n){var r=t.project.hasChannel,i=r.x,a=r.y;var o=e.mark;if(L0(o)){d5(u5.nearestNotSupportForContinuous(o));return n}var u={name:e.getName(dte),type:"path",interactive:true,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:true}},Iee(e,{reactiveGeom:true}))},transform:[{type:"voronoi",x:{expr:i||!a?"datum.datum.x || 0":"0"},y:{expr:a||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};var s=0;var l=false;n.forEach((function(t,n){var r;var i=(r=t.name)!==null&&r!==void 0?r:"";if(i===e.component.mark[0].name){s=n}else if(i.indexOf(dte)>=0){l=true}}));if(!l){n.splice(s+1,0,u)}return n}};var pte=function(){function e(e,t){this.debugName=t;this._children=[];this._parent=null;if(e){this.parent=e}}e.prototype.clone=function(){throw new Error("Cannot clone node")};Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){this._parent=e;if(e){e.addChild(this)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:true,configurable:true});e.prototype.numChildren=function(){return this._children.length};e.prototype.addChild=function(e,t){if(this._children.indexOf(e)>-1){console.warn("Attempt to add the same child twice.");return}if(t!==undefined){this._children.splice(t,0,e)}else{this._children.push(e)}};e.prototype.removeChild=function(e){var t=this._children.indexOf(e);this._children.splice(t,1);return t};e.prototype.remove=function(){var e=this._parent.removeChild(this);for(var t=0,n=this._children;t<n.length;t++){var r=n[t];r._parent=this._parent;this._parent.addChild(r,e++)}};e.prototype.insertAsParentOf=function(e){var t=e.parent;t.removeChild(this);this.parent=t;e.parent=this};e.prototype.swapWithParent=function(){var e=this._parent;var t=e.parent;for(var n=0,r=this._children;n<r.length;n++){var i=r[n];i.parent=e}this._children=[];e.removeChild(this);e.parent.removeChild(e);this.parent=t;e.parent=this};return e}();var vte=function(e){Ze(t,e);function t(t,n,r,i){var a=e.call(this,t,n)||this;a.type=r;a.refCounts=i;a._source=a._name=n;if(a.refCounts&&!(a._name in a.refCounts)){a.refCounts[a._name]=0}return a}t.prototype.clone=function(){var e=new this.constructor;e.debugName="clone_"+this.debugName;e._source=this._source;e._name="clone_"+this._name;e.type=this.type;e.refCounts=this.refCounts;e.refCounts[e._name]=0;return e};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){if(this._hash===undefined){this._hash="Output "+c0()}return this._hash};t.prototype.getSource=function(){this.refCounts[this._name]++;return this._source};t.prototype.isRequired=function(){return!!this.refCounts[this._name]};t.prototype.setSource=function(e){this._source=e};return t}(pte);var gte=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.formula=n;return r}t.prototype.clone=function(){return new t(null,NK(this.formula))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef((function(e,t,r){var i=t.field,a=t.timeUnit;var o=poe(n)?n.encoding[v2(r)]:undefined;var u=poe(n)&&P6(r,t,o,n.stack,n.markDef,n.config);if(a){var s=t8(t,{forAs:true});e[PK({as:s,field:i,timeUnit:a})]=Object.assign({as:s,field:i,timeUnit:a},u?{band:true}:{})}return e}),{});if(XK(r).length===0){return null}return new t(e,r)};t.makeFromTransform=function(e,n){var r;var i=Object.assign({},n),a=i.timeUnit,o=Xe(i,["timeUnit"]);var u=W5(a);var s=Object.assign(Object.assign({},o),{timeUnit:u});return new t(e,(r={},r[PK(s)]=s,r))};t.prototype.merge=function(e){this.formula=Object.assign({},this.formula);for(var t in e.formula){if(!this.formula[t]||e.formula[t].band){this.formula[t]=e.formula[t]}}for(var n=0,r=e.children;n<r.length;n++){var i=r[n];e.removeChild(i);i.parent=this}e.remove()};t.prototype.producedFields=function(){return new Set(JK(this.formula).map((function(e){return e.as})))};t.prototype.dependentFields=function(){return new Set(JK(this.formula).map((function(e){return e.field})))};t.prototype.hash=function(){return"TimeUnit "+PK(this.formula)};t.prototype.assemble=function(){var e=[];for(var t=0,n=JK(this.formula);t<n.length;t++){var r=n[t];var i=r.field,a=r.as,o=r.timeUnit;var u=W5(o),s=u.unit,l=u.utc,f=Xe(u,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:i,type:"timeunit"},s?{units:L5(s)}:{}),l?{timezone:"utc"}:{}),f),{as:[a,a+"_end"]}))}return e};return t}(pte);var mte="_tuple_fields";var yte=function(){function e(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}this.items=e;this.hasChannel={};this.hasField={}}return e}();var bte={has:function(){return true},parse:function(e,t,n){var r,i,a;var o=t.name;var u=(r=t.project)!==null&&r!==void 0?r:t.project=new yte;var s={};var l={};var f=new Set;var c=function(e,t){var n;var r=t==="visual"?e.channel:e.field;var i=QK(o+"_"+r);for(var a=1;f.has(i);a++){i=QK(o+"_"+r+"_"+a)}f.add(i);return n={},n[t]=i,n};if(!n.fields&&!n.encodings){var d=e.config.selection[n.type];if(n.init){for(var h=0,p=$i(n.init);h<p.length;h++){var v=p[h];for(var g=0,m=XK(v);g<m.length;g++){var y=m[g];if(l2(y)){(n.encodings||(n.encodings=[])).push(y)}else{if(n.type==="interval"){d5('Interval selections should be initialized using "x" and/or "y" keys.');n.encodings=d.encodings}else{(n.fields||(n.fields=[])).push(y)}}}}}else{n.encodings=d.encodings;n.fields=d.fields}}for(var b=0,x=(i=n.fields)!==null&&i!==void 0?i:[];b<x.length;b++){var _=x[b];var w={type:"E",field:_};w.signals=Object.assign({},c(w,"data"));u.items.push(w);u.hasField[_]=w}for(var k=0,E=(a=n.encodings)!==null&&a!==void 0?a:[];k<E.length;k++){var O=E[k];var A=e.fieldDef(O);if(A){var S=A.field;if(A.aggregate){d5(u5.cannotProjectAggregate(O,A.aggregate));continue}else if(!S){d5(u5.cannotProjectOnChannelWithoutField(O));continue}if(A.timeUnit){S=e.vgField(O);var D={timeUnit:A.timeUnit,as:S,field:A.field};l[PK(D)]=D}if(!s[S]){var C="E";if(t.type==="interval"){var M=e.getScaleComponent(O).get("type");if(B4(M)){C="R"}}else if(A.bin){C="R-RE"}var w={field:S,channel:O,type:C};w.signals=Object.assign(Object.assign({},c(w,"data")),c(w,"visual"));u.items.push(s[S]=w);u.hasField[S]=u.hasChannel[O]=s[S]}}else{d5(u5.cannotProjectOnChannelWithoutField(O))}}if(n.init){var j=function(e){return u.items.map((function(t){return e[t.channel]!==undefined?e[t.channel]:e[t.field]}))};if(n.type==="interval"){t.init=j(n.init)}else{var v=$i(n.init);t.init=v.map(j)}}if(XK(l).length>0){u.timeUnit=new gte(null,l)}},signals:function(e,t,n){var r=t.name+mte;var i=n.filter((function(e){return e.name===r}));return i.length>0?n:n.concat({name:r,value:t.project.items.map((function(e){var t=Xe(e,["signals","hasLegend"]);t.field=a0(t.field);return t}))})}};var xte={has:function(e){return e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!W9(e.bind)},parse:function(e,t,n,r){if(!r.on)delete t.events;if(!r.clear)delete t.clear},topLevelSignals:function(e,t,n){var r=t.name;var i=t.project;var a=t.bind;var o=t.init&&t.init[0];var u=hte.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";i.items.forEach((function(e,i){var s,l;var f=QK(r+"_"+e.field);var c=n.filter((function(e){return e.name===f}));if(!c.length){n.unshift(Object.assign(Object.assign({name:f},o?{init:Ite(o[i])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? "+u+"["+oi(e.field)+"] : null"}]:[],bind:(l=(s=a[e.field])!==null&&s!==void 0?s:a[e.channel])!==null&&l!==void 0?l:a}))}}));return n},signals:function(e,t,n){var r=t.name;var i=t.project;var a=n.filter((function(e){return e.name===r+rne}))[0];var o=r+mte;var u=i.items.map((function(e){return QK(r+"_"+e.field)}));var s=u.map((function(e){return e+" !== null"})).join(" && ");if(u.length){a.update=s+" ? {fields: "+o+", values: ["+u.join(", ")+"]} : null"}delete a.value;delete a.on;return n}};var _te="_toggle";var wte={has:function(e){return e.type==="multi"&&!!e.toggle},signals:function(e,t,n){return n.concat({name:t.name+_te,value:false,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+rne;var r=t.name+_te;return r+" ? null : "+n+", "+(t.resolve==="global"?r+" ? null : true, ":r+" ? null : {unit: "+lne(e)+"}, ")+(r+" ? "+n+" : null")}};var kte={has:function(e){return e.clear!==undefined&&e.clear!==false},parse:function(e,t,n){if(n.clear){t.clear=ai(n.clear)?vY(n.clear,"scope"):n.clear}},topLevelSignals:function(e,t,n){if(xte.has(t)){var r=function(e){var r=n.findIndex((function(n){return n.name===QK(t.name+"_"+e.field)}));if(r!==-1){n[r].on.push({events:t.clear,update:"null"})}};for(var i=0,a=t.project.items;i<a.length;i++){var o=a[i];r(o)}}return n},signals:function(e,t,n){function r(e,r){if(e!==-1&&n[e].on){n[e].on.push({events:t.clear,update:r})}}if(t.type==="interval"){var i=function(e){var t=n.findIndex((function(t){return t.name===e.signals.visual}));r(t,"[0, 0]");if(t===-1){var i=n.findIndex((function(t){return t.name===e.signals.data}));r(i,"null")}};for(var a=0,o=t.project.items;a<o.length;a++){var u=o[a];i(u)}}else{var s=n.findIndex((function(e){return e.name===t.name+rne}));r(s,"null");if(wte.has(t)){s=n.findIndex((function(e){return e.name===t.name+_te}));r(s,"false")}}return n}};var Ete={has:function(e){return e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales"},parse:function(e,t){var n=t.scales=[];for(var r=0,i=t.project.items;r<i.length;r++){var a=i[r];var o=a.channel;if(!j2(o)){continue}var u=e.getScaleComponent(o);var s=u?u.get("type"):undefined;if(!u||!B4(s)){d5(u5.SCALE_BINDINGS_CONTINUOUS);continue}var l={selection:t.name,field:a.field};u.set("selectionExtent",l,true);n.push(a)}},topLevelSignals:function(e,t,n){var r=t.scales.filter((function(e){return n.filter((function(t){return t.name===e.signals.data})).length===0}));if(!e.parent||Ate(e)||r.length===0){return n}var i=n.filter((function(e){return e.name===t.name}))[0];var a=i.update;if(a.indexOf(ane)>=0){i.update="{"+r.map((function(e){return oi(e.field)+": "+e.signals.data})).join(", ")+"}"}else{for(var o=0,u=r;o<u.length;o++){var s=u[o];var l=oi(s.field)+": "+s.signals.data;if(a.indexOf(l)<0){a=a.substring(0,a.length-1)+", "+l+"}"}}i.update=a}return n.concat(r.map((function(e){return{name:e.signals.data}})))},signals:function(e,t,n){if(e.parent&&!Ate(e)){var r=function(e){var t=n.filter((function(t){return t.name===e.signals.data}))[0];t.push="outer";delete t.value;delete t.update};for(var i=0,a=t.scales;i<a.length;i++){var o=a[i];r(o)}}return n}};function Ote(e,t){var n=oi(e.scaleName(t));return"domain("+n+")"}function Ate(e){var t;return e.parent&&moe(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:Ate(e.parent.parent))}var Ste={has:function(e){var t=e.resolve==="global"&&e.bind&&W9(e.bind);var n=e.project.items.length===1&&e.project.items[0].field!==U9;if(t&&!n){d5(u5.LEGEND_BINDINGS_PROJECT_LENGTH)}return t&&n},parse:function(e,t,n,r){var i;if(!r.on)delete t.events;if(!r.clear)delete t.clear;if(r.on||r.clear){var a='event.item && indexof(event.item.mark.role, "legend") < 0';for(var o=0,u=t.events;o<u.length;o++){var s=u[o];s.filter=$i((i=s.filter)!==null&&i!==void 0?i:[]);if(s.filter.indexOf(a)<0){s.filter.push(a)}}}var l=H9(t.bind)?t.bind.legend:"click";var f=ai(l)?vY(l,"view"):$i(l);t.bind={legend:{merge:f}}},topLevelSignals:function(e,t,n){var r=t.name;var i=H9(t.bind)&&t.bind.legend;var a=function(e){return function(t){var n=NK(t);n.markname=e;return n}};var o=function(e){if(!e.hasLegend)return"continue";var o=QK(e.field)+"_legend";var u=r+"_"+o;var s=n.filter((function(e){return e.name===u}));if(s.length===0){var l=i.merge.map(a(o+"_symbols")).concat(i.merge.map(a(o+"_labels"))).concat(i.merge.map(a(o+"_entries")));n.unshift(Object.assign(Object.assign({name:u},!t.init?{value:null}:{}),{on:[{events:l,update:"datum.value || item().items[0].items[0].datum.value",force:true},{events:i.merge,update:"!event.item || !datum ? null : "+u,force:true}]}))}};for(var u=0,s=t.project.items;u<s.length;u++){var l=s[u];o(l)}return n},signals:function(e,t,n){var r=t.name;var i=t.project;var a=n.find((function(e){return e.name===r+rne}));var o=r+mte;var u=i.items.filter((function(e){return e.hasLegend})).map((function(e){return QK(r+"_"+QK(e.field)+"_legend")}));var s=u.map((function(e){return e+" !== null"})).join(" && ");var l=s+" ? {fields: "+o+", values: ["+u.join(", ")+"]} : null";if(t.events&&u.length>0){a.on.push({events:u.map((function(e){return{signal:e}})),update:l})}else if(u.length>0){a.update=l;delete a.value;delete a.on}var f=n.find((function(e){return e.name===r+_te}));var c=H9(t.bind)&&t.bind.legend;if(f){if(!t.events)f.on[0].events=c;else f.on.push(Object.assign(Object.assign({},f.on[0]),{events:c}))}return n}};function Dte(e,t,n){var r;var i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;une(e,(function(e){var r,a;var o=(r=e.project.hasField[i])!==null&&r!==void 0?r:e.project.hasChannel[t];if(o&&Ste.has(e)){var u=(a=n.get("selections"))!==null&&a!==void 0?a:[];u.push(e.name);n.set("selections",u,false);o.hasLegend=true}}))}var Cte="_translate_anchor";var Mte="_translate_delta";var jte={has:function(e){return e.type==="interval"&&e.translate},signals:function(e,t,n){var r=t.name;var i=Ete.has(t);var a=r+Cte;var o=t.project.hasChannel,u=o.x,s=o.y;var l=vY(t.translate,"scope");if(!i){l=l.map((function(e){return e.between[0].markname=r+Yte,e}))}n.push({name:a,value:{},on:[{events:l.map((function(e){return e.between[0]})),update:"{x: x(unit), y: y(unit)"+(u!==undefined?", extent_x: "+(i?Ote(e,y1):"slice("+u.signals.visual+")"):"")+(s!==undefined?", extent_y: "+(i?Ote(e,b1):"slice("+s.signals.visual+")"):"")+"}"}]},{name:r+Mte,value:{},on:[{events:l,update:"{x: "+a+".x - x(unit), y: "+a+".y - y(unit)}"}]});if(u!==undefined){Fte(e,t,u,"width",n)}if(s!==undefined){Fte(e,t,s,"height",n)}return n}};function Fte(e,t,n,r,i){var a;var o=t.name;var u=o+Cte;var s=o+Mte;var l=n.channel;var f=Ete.has(t);var c=i.filter((function(e){return e.name===n.signals[f?"data":"visual"]}))[0];var d=e.getSizeSignalRef(r).signal;var h=e.getScaleComponent(l);var p=h.get("type");var v=f&&l===y1?"-":"";var g=u+".extent_"+l;var m=""+v+s+"."+l+" / "+(f?""+d:"span("+g+")");var y=!f?"panLinear":p==="log"?"panLog":p==="pow"?"panPow":"panLinear";var b=y+"("+g+", "+m+(f&&p==="pow"?", "+((a=h.get("exponent"))!==null&&a!==void 0?a:1):"")+")";c.on.push({events:{signal:s},update:f?b:"clampRange("+b+", 0, "+d+")"})}var Nte="_zoom_anchor";var Tte="_zoom_delta";var zte={has:function(e){return e.type==="interval"&&e.zoom},signals:function(e,t,n){var r=t.name;var i=Ete.has(t);var a=r+Tte;var o=t.project.hasChannel,u=o.x,s=o.y;var l=oi(e.scaleName(y1));var f=oi(e.scaleName(b1));var c=vY(t.zoom,"scope");if(!i){c=c.map((function(e){return e.markname=r+Yte,e}))}n.push({name:r+Nte,on:[{events:c,update:!i?"{x: x(unit), y: y(unit)}":"{"+[l?"x: invert("+l+", x(unit))":"",f?"y: invert("+f+", y(unit))":""].filter((function(e){return!!e})).join(", ")+"}"}]},{name:a,on:[{events:c,force:true,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]});if(u!==undefined){Rte(e,t,u,"width",n)}if(s!==undefined){Rte(e,t,s,"height",n)}return n}};function Rte(e,t,n,r,i){var a;var o=t.name;var u=n.channel;var s=Ete.has(t);var l=i.filter((function(e){return e.name===n.signals[s?"data":"visual"]}))[0];var f=e.getSizeSignalRef(r).signal;var c=e.getScaleComponent(u);var d=c.get("type");var h=s?Ote(e,u):l.name;var p=o+Tte;var v=""+o+Nte+"."+u;var g=!s?"zoomLinear":d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear";var m=g+"("+h+", "+v+", "+p+(s&&d==="pow"?", "+((a=c.get("exponent"))!==null&&a!==void 0?a:1):"")+")";l.on.push({events:{signal:p},update:s?m:"clampRange("+m+", 0, "+f+")"})}var Pte=[bte,wte,Ete,Ste,jte,zte,xte,hte,kte];function Lte(e,t){for(var n=0,r=Pte;n<r.length;n++){var i=r[n];if(i.has(e)){t(i)}}}function Ite(e,t,n){if(t===void 0){t=true}if(n===void 0){n=fi}if(ri(e)){var r=e.map((function(e){return Ite(e,t,n)}));return t?"["+r.join(", ")+"]":r}else if(p5(e)){if(t){return n(k5(e))}else{return n(O5(e))}}return t?n(JSON.stringify(e)):e}function Bte(e,t){une(e,(function(n,r){var i=n.name;var a=r.modifyExpr(e,n);t.push.apply(t,r.signals(e,n));Lte(n,(function(r){if(r.signals){t=r.signals(e,n,t)}if(r.modifyExpr){a=r.modifyExpr(e,n,a)}}));t.push({name:i+ine,on:[{events:{signal:n.name+rne},update:"modify("+oi(n.name+nne)+", "+a+")"}]})}));return Vte(t)}function Ute(e,t){if(e.component.selection&&XK(e.component.selection).length){var n=oi(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:vY("mousemove","scope"),update:"isTuple(facet) ? facet : group("+n+").datum"}]})}return Vte(t)}function qte(e,t){var n=false;une(e,(function(r,i){var a=r.name;var o=oi(a+nne);var u=t.filter((function(e){return e.name===a}));if(u.length===0){var s=r.resolve==="global"?"union":r.resolve;var l=r.type==="multi"?", true)":")";t.push({name:r.name,update:ane+"("+o+", "+oi(s)+l})}n=true;if(i.topLevelSignals){t=i.topLevelSignals(e,r,t)}Lte(r,(function(n){if(n.topLevelSignals){t=n.topLevelSignals(e,r,t)}}))}));if(n){var r=t.filter((function(e){return e.name==="unit"}));if(r.length===0){t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}}return Vte(t)}function Wte(e,t){var n=h(t);une(e,(function(t){var r={name:t.name+nne};if(t.init){var i=t.project.items.map((function(e){var t=Xe(e,["signals"]);return t}));var a=t.init.map((function(e){return Ite(e,false)}));r.values=t.type==="interval"?[{unit:lne(e,{escape:false}),fields:i,values:a}]:a.map((function(t){return{unit:lne(e,{escape:false}),fields:i,values:t}}))}var o=n.filter((function(e){return e.name===t.name+nne}));if(!o.length){n.push(r)}}));return n}function Hte(e,t){une(e,(function(n,r){t=r.marks?r.marks(e,n,t):t;Lte(n,(function(r){if(r.marks){t=r.marks(e,n,t)}}))}));return t}function $te(e,t){for(var n=0,r=e.children;n<r.length;n++){var i=r[n];if(poe(i)){t=Hte(i,t)}}return t}function Gte(e,t){var n=t.selection;var r=e.getSelectionComponent(n,QK(n));return{signal:mne(r,t)}}function Vte(e){return e.map((function(e){if(e.on&&!e.on.length)delete e.on;return e}))}var Yte="_brush";var Xte="_scale_trigger";var Jte={signals:function(e,t){var n=t.name;var r=n+mte;var i=Ete.has(t);var a=[];var o=[];var u=[];if(t.translate&&!i){var s="!event.item || event.item.mark.name !== "+oi(n+Yte);Qte(t,(function(e,t){var n;var r=$i((n=t.between[0].filter)!==null&&n!==void 0?n:t.between[0].filter=[]);if(r.indexOf(s)<0){r.push(s)}return e}))}t.project.items.forEach((function(n,r){var i=n.channel;if(i!==y1&&i!==b1){d5("Interval selections only support x and y encoding channels.");return}var s=t.init?t.init[r]:null;var l=Zte(e,t,n,s);var f=n.signals.data;var c=n.signals.visual;var d=oi(e.scaleName(i));var h=e.getScaleComponent(i).get("type");var p=B4(h)?"+":"";a.push.apply(a,l);o.push(f);u.push({scaleName:e.scaleName(i),expr:"(!isArray("+f+") || "+("("+p+"invert("+d+", "+c+")[0] === "+p+f+"[0] && ")+(p+"invert("+d+", "+c+")[1] === "+p+f+"[1]))")})}));if(!i){a.push({name:n+Xte,value:{},on:[{events:u.map((function(e){return{scale:e.scaleName}})),update:u.map((function(e){return e.expr})).join(" && ")+(" ? "+(n+Xte)+" : {}")}]})}var l=t.init;var f="unit: "+lne(e)+", fields: "+r+", values";return a.concat(Object.assign(Object.assign({name:n+rne},l?{init:"{"+f+": "+Ite(l)+"}"}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+(" ? {"+f+": ["+o+"]} : null")}]}))},modifyExpr:function(e,t){var n=t.name+rne;return n+", "+(t.resolve==="global"?"true":"{unit: "+lne(e)+"}")},marks:function(e,t,n){var r=t.name;var i=t.project.hasChannel,a=i.x,o=i.y;var u=a&&a.signals.visual;var s=o&&o.signals.visual;var l="data("+oi(t.name+nne)+")";if(Ete.has(t)){return n}var f={x:a!==undefined?{signal:u+"[0]"}:{value:0},y:o!==undefined?{signal:s+"[0]"}:{value:0},x2:a!==undefined?{signal:u+"[1]"}:{field:{group:"width"}},y2:o!==undefined?{signal:s+"[1]"}:{field:{group:"height"}}};if(t.resolve==="global"){for(var c=0,d=XK(f);c<d.length;c++){var p=d[c];f[p]=[Object.assign({test:l+".length && "+l+"[0].unit === "+lne(e)},f[p]),{value:0}]}}var v=t.mark,g=v.fill,m=v.fillOpacity,y=v.cursor,b=Xe(v,["fill","fillOpacity","cursor"]);var x=XK(b).reduce((function(e,t){e[t]=[{test:[a!==undefined&&u+"[0] !== "+u+"[1]",o!==undefined&&s+"[0] !== "+s+"[1]"].filter((function(e){return e})).join(" && "),value:b[t]},{value:null}];return e}),{});return h([{name:r+Yte+"_bg",type:"rect",clip:true,encode:{enter:{fill:{value:g},fillOpacity:{value:m}},update:f}}],n,[{name:r+Yte,type:"rect",clip:true,encode:{enter:Object.assign(Object.assign({},y?{cursor:{value:y}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},f),x)}}])}};function Zte(e,t,n,r){var i=n.channel;var a=n.signals.visual;var o=n.signals.data;var u=Ete.has(t);var s=oi(e.scaleName(i));var l=e.getScaleComponent(i);var f=l?l.get("type"):undefined;var c=function(e){return"scale("+s+", "+e+")"};var d=e.getSizeSignalRef(i===y1?"width":"height").signal;var p=i+"(unit)";var v=Qte(t,(function(e,t){return h(e,[{events:t.between[0],update:"["+p+", "+p+"]"},{events:t,update:"["+a+"[0], clamp("+p+", 0, "+d+")]"}])}));v.push({events:{signal:t.name+Xte},update:B4(f)?"["+c(o+"[0]")+", "+c(o+"[1]")+"]":"[0, 0]"});return u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:Ite(r,true,c)}:{value:[]}),{on:v}),Object.assign(Object.assign({name:o},r?{init:Ite(r)}:{}),{on:[{events:{signal:a},update:a+"[0] === "+a+"[1] ? null : invert("+s+", "+a+")"}]})]}function Qte(e,t){return e.events.reduce((function(e,n){if(!n.between){d5(n+" is not an ordered event stream for interval selections.");return e}return t(e,n)}),[])}function Kte(e,t){var n=t.name;var r=n+mte;var i=t.project;var a="(item().isVoronoi ? datum.datum : datum)";var o=i.items.map((function(t){var n=e.fieldDef(t.channel);return n&&n.bin?"["+a+"["+oi(e.vgField(t.channel,{}))+"], "+(a+"["+oi(e.vgField(t.channel,{binSuffix:"end"}))+"]]"):a+"["+oi(t.field)+"]"})).join(", ");var u="unit: "+lne(e)+", fields: "+r+", values";var s=t.events;return[{name:n+rne,on:s?[{events:s,update:"datum && item().mark.marktype !== 'group' ? {"+u+": ["+o+"]} : null",force:true}]:[]}]}var ene={signals:Kte,modifyExpr:function(e,t){var n=t.name+rne;return n+", "+(t.resolve==="global"?"null":"{unit: "+lne(e)+"}")}};var tne={signals:Kte,modifyExpr:function(e,t){var n=t.name+rne;return n+", "+(t.resolve==="global"?"true":"{unit: "+lne(e)+"}")}};var nne="_store";var rne="_tuple";var ine="_modify";var ane="vlSelectionResolve";var one={single:tne,multi:ene,interval:Jte};function une(e,t){var n=e.component.selection;if(n){for(var r=0,i=JK(n);r<i.length;r++){var a=i[r];var o=t(a,one[a.type]);if(o===true)break}}}function sne(e){var t=e.parent;while(t){if(voe(t)){break}t=t.parent}return t}function lne(e,t){var n=(t===void 0?{escape:true}:t).escape;var r=n?oi(e.name):e.name;var i=sne(e);if(i){var a=i.facet;for(var o=0,u=i2;o<u.length;o++){var s=u[o];if(a[s]){r+=" + '__facet_"+s+"_' + (facet["+oi(i.vgField(s))+"])"}}}return r}function fne(e){var t=false;une(e,(function(e){t=t||e.project.items.some((function(e){return e.field===U9}))}));return t}function cne(e){var t=[];if(e.type==="Identifier"){return[e.name]}if(e.type==="Literal"){return[e.value]}if(e.type==="MemberExpression"){t.push.apply(t,cne(e.object));t.push.apply(t,cne(e.property))}return t}function dne(e){if(e.object.type==="MemberExpression"){return dne(e.object)}return e.object.name==="datum"}function hne(e){var t=LH(e);var n=new Set;t.visit((function(e){if(e.type==="MemberExpression"&&dne(e)){n.add(cne(e).slice(1).join("."))}}));return n}var pne=function(e){Ze(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.model=n;i.filter=r;i.expr=bne(i.model,i.filter,i);i._dependentFields=hne(i.expr);return i}t.prototype.clone=function(){return new t(null,this.model,NK(this.filter))};t.prototype.dependentFields=function(){return this._dependentFields};t.prototype.producedFields=function(){return new Set};t.prototype.assemble=function(){return{type:"filter",expr:this.expr}};t.prototype.hash=function(){return"Filter "+this.expr};return t}(pte);function vne(e,t){var n;var r={};var i=e.config.selection;var a=function(a){var o=NK(t[a]);var u=i[o.type],s=Xe(u,["fields","encodings"]);for(var l in s){if(l==="encodings"&&o.fields||l==="fields"&&o.encodings){continue}if(l==="mark"){o[l]=Object.assign(Object.assign({},s[l]),o[l])}if(o[l]===undefined||o[l]===true){o[l]=(n=s[l])!==null&&n!==void 0?n:o[l]}}var f=QK(a);var c=r[f]=Object.assign(Object.assign({},o),{name:f,events:ai(o.on)?vY(o.on,"scope"):NK(o.on)});Lte(c,(function(n){if(n.has(c)&&n.parse){n.parse(e,c,o,t[a])}}))};for(var o=0,u=XK(t!==null&&t!==void 0?t:{});o<u.length;o++){var s=u[o];a(s)}return r}function gne(e,t,n,r){if(r===void 0){r="datum"}var i=[];function a(t){var a=QK(t);var o=e.getSelectionComponent(a,t);var u=oi(a+nne);if(o.project.timeUnit){var s=n!==null&&n!==void 0?n:e.component.data.raw;var l=o.project.timeUnit.clone();if(s.parent){l.insertAsParentOf(s)}else{s.parent=l}}if(o.empty!=="none"){i.push(u)}return"vlSelectionTest("+u+", "+r+(o.resolve==="global"?")":", "+oi(o.resolve)+")")}var o=KK(t,a);return(i.length?"!("+i.map((function(e){return"length(data("+e+"))"})).join(" || ")+") || ":"")+("("+o+")")}function mne(e,t){var n=t["encoding"];var r=t["field"];if(!n&&!r){r=e.project.items[0].field;if(e.project.items.length>1){d5('A "field" or "encoding" must be specified when using a selection as a scale domain. '+('Using "field": '+oi(r)+"."))}}else if(n&&!r){var i=e.project.items.filter((function(e){return e.channel===n}));if(!i.length||i.length>1){r=e.project.items[0].field;d5((!i.length?"No ":"Multiple ")+("matching "+oi(n)+" encoding found for selection "+oi(t.selection)+". ")+('Using "field": '+oi(r)+"."))}else{r=i[0].field}}return e.name+"["+oi(r)+"]"}function yne(e,t){une(e,(function(n){var r=n.name;var i=e.getName("lookup_"+r);e.component.data.outputNodes[i]=n.materialized=new vte(new pne(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)}))}function bne(e,t,n){return KK(t,(function(t){if(ai(t)){return t}else if(e4(t)){return gne(e,t.selection,n)}else{return d4(t)}}))}function xne(e,t){if(!e){return undefined}if(ri(e)&&!F8(e)){return e.map((function(e){return h8(e,t)})).join(", ")}return e}function _ne(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{};e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{};e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{};e.encode[t].update[n]=r}function wne(e){if(G5(e)){return e.signal}return oi(e.value)}function kne(e,t,n,r){if(r===void 0){r={header:false}}var i,a;var o=e.combine(),u=o.disable,s=o.orient,l=o.scale,f=o.labelExpr,c=o.title,d=o.zindex,p=Xe(o,["disable","orient","scale","labelExpr","title","zindex"]);if(u){return undefined}for(var v in p){var g=b0[v];var m=p[v];if(g&&g!==t&&g!=="both"){delete p[v]}else if(m0(m)){var y=m.condition,b=Xe(m,["condition"]);var x=$i(y);var _=g0[v];if(_){var w=_.vgProp,k=_.part;var E=h(x.map((function(e){var t=e.test,n=Xe(e,["test"]);return Object.assign({test:bne(null,t)},n)})),[b]);_ne(p,k,w,E);delete p[v]}else if(_===null){var O={signal:x.map((function(e){var t=e.test,n=Xe(e,["test"]);return bne(null,t)+" ? "+wne(n)+" : "})).join("")+wne(b)};p[v]=O}}else if(G5(m)){var _=g0[v];if(_){var w=_.vgProp,k=_.part;_ne(p,k,w,m);delete p[v]}}}if(t==="grid"){if(!p.grid){return undefined}if(p.encode){var A=p.encode.grid;p.encode=Object.assign({},A?{grid:A}:{});if(XK(p.encode).length===0){delete p.encode}}return Object.assign(Object.assign({scale:l,orient:s},p),{domain:false,labels:false,maxExtent:0,minExtent:0,ticks:false,zindex:l0(d,0)})}else{if(!r.header&&e.mainExtracted){return undefined}if(f!==undefined){var S=f;if(((a=(i=p.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&G5(p.encode.labels.update.text)){S=o0(f,"datum.label",p.encode.labels.update.text.signal)}_ne(p,"labels","text",{signal:S})}if(p.encode){for(var D=0,C=y0;D<C.length;D++){var k=C[D];if(!e.hasAxisPart(k)){delete p.encode[k]}}if(XK(p.encode).length===0){delete p.encode}}var M=xne(c,n);return Object.assign(Object.assign(Object.assign({scale:l,orient:s,grid:false},M?{title:M}:{}),p),{zindex:l0(d,0)})}}function Ene(e){var t=e.component.axes;var n=[];for(var r=0,i=_2;r<i.length;r++){var a=i[r];if(t[a]){for(var o=0,u=t[a];o<u.length;o++){var s=u[o];if(!s.get("disable")&&!s.get("gridScale")){var l=a==="x"?"height":"width";var f=e.getSizeSignalRef(l).signal;if(l!==f){n.push({name:l,update:f})}}}}}return n}function One(e,t){var n=e.x,r=n===void 0?[]:n,i=e.y,a=i===void 0?[]:i;return h(r.map((function(e){return kne(e,"grid",t)})),a.map((function(e){return kne(e,"grid",t)})),r.map((function(e){return kne(e,"main",t)})),a.map((function(e){return kne(e,"main",t)}))).filter((function(e){return e}))}var Ane={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"};var Sne={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"};var Dne=XK(Ane);var Cne=XK(Sne);function Mne(e,t){return Object.assign.apply(null,h([{}],e.map((function(e){return t[e]}))))}function jne(e,t,n,r){var i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:F4(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[];var a=e==="x"?"axisX":"axisY";var o="axis"+t0(n);var u=h(i,i.map((function(e){return a+e.substr(4)})));var s=["axis",o,a];return{vlOnlyAxisConfig:Mne(u,r),vgAxisConfig:Mne(s,r),axisConfigStyle:Fne(h(s,u),r)}}function Fne(e,t){var n;var r=[{}];for(var i=0,a=e;i<a.length;i++){var o=a[i];var u=(n=t[o])===null||n===void 0?void 0:n.style;if(u){u=$i(u);for(var s=0,l=u;s<l.length;s++){var f=l[s];r.push(t.style[f])}}}return Object.assign.apply(null,r)}function Nne(e,t,n,r){if(r===void 0){r={}}var i;var a=I8(e,n,t.style);if(a!==undefined){return{configFrom:"style",configValue:a}}for(var o=0,u=["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"];o<u.length;o++){var s=u[o];if(((i=r[s])===null||i===void 0?void 0:i[e])!==undefined){return{configFrom:s,configValue:r[s][e]}}}return{}}var Tne={scale:function(e){var t=e.model,n=e.channel;return t.scaleName(n)},format:function(e){var t=e.fieldOrDatumDef,n=e.axis,r=e.config;if(O8(t)||A8(t)){return undefined}return y6(t.type,n.format,r)},formatType:function(e){var t=e.fieldOrDatumDef,n=e.axis;if(O8(t)||A8(t)){return undefined}var r=n.formatType;if(r){if(G5(r)||r==="number"||r==="time"||r==="utc"){return r}}return undefined},grid:function(e){var t=e.fieldOrDatumDef,n=e.axis,r=e.scaleType;var i;if(q6(t)&&I2(t.bin)){return false}else{return(i=n.grid)!==null&&i!==void 0?i:zne(r,t)}},gridScale:function(e){var t=e.model,n=e.channel;return Rne(t,n)},labelAlign:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,i=e.channel;return t.labelAlign||Bne(n,r,i)},labelAngle:function(e){var t=e.labelAngle;return t},labelBaseline:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,i=e.channel;return t.labelBaseline||Lne(n,r,i)},labelFlush:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.channel;var i;return(i=t.labelFlush)!==null&&i!==void 0?i:Une(n.type,r)},labelOverlap:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.scaleType;var i;return(i=t.labelOverlap)!==null&&i!==void 0?i:qne(n.type,r)},orient:function(e){var t=e.orient;return t},tickCount:function(e){var t=e.channel,n=e.model,r=e.axis,i=e.fieldOrDatumDef,a=e.scaleType;var o;var u=t==="x"?"width":t==="y"?"height":undefined;var s=u?n.getSizeSignalRef(u):undefined;return(o=r.tickCount)!==null&&o!==void 0?o:Hne({fieldOrDatumDef:i,scaleType:a,size:s,values:r.values})},title:function(e){var t=e.axis,n=e.model,r=e.channel;if(t.title!==undefined){return t.title}var i=$ne(n,r);if(i!==undefined){return i}var a=n.typedFieldDef(r);var o=r==="x"?"x2":"y2";var u=n.fieldDef(o);return U8(a?[T6(a)]:[],q6(u)?[T6(u)]:[])},values:function(e){var t=e.axis,n=e.fieldOrDatumDef;return Gne(t,n)},zindex:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.mark;var i;return(i=t.zindex)!==null&&i!==void 0?i:Vne(r,n)}};function zne(e,t){return!I4(e)&&q6(t)&&!L2(t===null||t===void 0?void 0:t.bin)}function Rne(e,t){var n=t==="x"?"y":"x";if(e.getScaleComponent(n)){return e.scaleName(n)}return undefined}function Pne(e,t,n,r,i){if((t===null||t===void 0?void 0:t.labelAngle)!==undefined){return p0(t===null||t===void 0?void 0:t.labelAngle)}else{var a=Nne("labelAngle",e.config,t===null||t===void 0?void 0:t.style,i).configValue;if(a!==undefined){return p0(a)}else{if(n===y1&&IK([b4,m4],r.type)){return 270}return undefined}}}function Lne(e,t,n){n=n||(t==="top"||t==="bottom"?"x":"y");if(e!==undefined){if(n==="x"){return 45<e&&e<135||225<e&&e<315?"middle":(e<=45||315<=e)===(t==="top")?"bottom":"top"}else{return e<=45||315<=e||135<=e&&e<=225?"middle":(45<=e&&e<=135)===(t==="left")?"top":"bottom"}}return undefined}function Ine(e,t,n,r){if((e+n)%180===0){return"center"}else if((n<e&&e<180+n)===(t===r)){return"left"}return"right"}function Bne(e,t,n){n=n||(t==="top"||t==="bottom"?"x":"y");if(e!==undefined){if(n==="x"){return Ine(e,t,0,"bottom")}else{return Ine(e,t,90,"left")}}return undefined}function Une(e,t){if(t==="x"&&IK(["quantitative","temporal"],e)){return true}return undefined}function qne(e,t){if(e!=="nominal"){if(t==="log"){return"greedy"}return true}return undefined}function Wne(e){return e==="x"?"bottom":"left"}function Hne(e){var t=e.fieldOrDatumDef,n=e.scaleType,r=e.size,i=e.values;var a;if(!i&&!I4(n)&&n!=="log"){if(q6(t)){if(L2(t.bin)){return{signal:"ceil("+r.signal+"/10)"}}if(t.timeUnit&&IK(["month","hours","day","quarter"],(a=W5(t.timeUnit))===null||a===void 0?void 0:a.unit)){return undefined}}return{signal:"ceil("+r.signal+"/40)"}}return undefined}function $ne(e,t){var n=t==="x"?"x2":"y2";var r=e.fieldDef(t);var i=e.fieldDef(n);var a=r?r.title:undefined;var o=i?i.title:undefined;if(a&&o){return q8(a,o)}else if(a){return a}else if(o){return o}else if(a!==undefined){return a}else if(o!==undefined){return o}return undefined}function Gne(e,t){var n=e.values;if(ri(n)){return C8(t,n)}else if(G5(n)){return n}return undefined}function Vne(e,t){if(e==="rect"&&n8(t)){return 1}return 0}var Yne=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;r._dependentFields=hne(r.transform.calculate);return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.parseAllForSortIndex=function(e,n){n.forEachFieldDef((function(n,r){if(!J6(n)){return}if(D6(n.sort)){var i=n.field,a=n.timeUnit;var o=n.sort;var u=o.map((function(e,t){return d4({field:i,timeUnit:a,equal:e})+" ? "+t+" : "})).join("")+o.length;e=new t(e,{calculate:u,as:Xne(n,r,{forAs:true})})}}));return e};t.prototype.producedFields=function(){return new Set([this.transform.as])};t.prototype.dependentFields=function(){return this._dependentFields};t.prototype.assemble=function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}};t.prototype.hash=function(){return"Calculate "+PK(this.transform)};return t}(pte);function Xne(e,t,n){return t8(e,Object.assign({prefix:t,suffix:"sort_index"},n!==null&&n!==void 0?n:{}))}function Jne(e,t){if(IK(["top","bottom"],t)){return"column"}else if(IK(["left","right"],t)){return"row"}return e==="row"?"row":"column"}function Zne(e,t,n,r){var i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return l0(((t===null||t===void 0?void 0:t.header)||{})[e],i[e],n.header[e])}function Qne(e,t,n,r){var i={};for(var a=0,o=e;a<o.length;a++){var u=o[a];var s=Zne(u,t,n,r);if(s!==undefined){i[u]=s}}return i}var Kne=["row","column"];var ere=["header","footer"];function tre(e,t){var n=e.component.layoutHeaders[t].title;var r=e.config?e.config:undefined;var i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:undefined;var a=Qne(["titleAnchor","titleAngle","titleOrient"],i,r,t),o=a.titleAnchor,u=a.titleAngle,s=a.titleOrient;var l=Jne(t,s);var f=p0(u);return{name:t+"-title",type:"group",role:l+"-title",title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),rre(f,l)),nre(l,f,o)),cre(r,i,t,Dne,Ane))}}function nre(e,t,n){if(n===void 0){n="middle"}switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}var r=Bne(t,e==="row"?"left":"top");return r?{align:r}:{}}function rre(e,t){var n=Lne(e,t==="row"?"left":"top");return n?{baseline:n}:{}}function ire(e,t){var n=e.component.layoutHeaders[t];var r=[];for(var i=0,a=ere;i<a.length;i++){var o=a[i];if(n[o]){for(var u=0,s=n[o];u<s.length;u++){var l=s[u];var f=ure(e,t,o,n,l);if(f!=null){r.push(f)}}}}return r}function are(e,t){var n;var r=e.sort;if(S6(r)){return{field:t8(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}}else if(ri(r)){return{field:Xne(e,t,{expr:"datum"}),order:"ascending"}}else{return{field:t8(e,{expr:"datum"}),order:r!==null&&r!==void 0?r:"ascending"}}}function ore(e,t,n){var r=Qne(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),i=r.format,a=r.formatType,o=r.labelAngle,u=r.labelAnchor,s=r.labelOrient,l=r.labelExpr;var f=m6({fieldOrDatumDef:e,format:i,formatType:a,expr:"parent",config:n}).signal;var c=Jne(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?o0(o0(l,"datum.label",f),"datum.value",t8(e,{expr:"parent"})):f}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),rre(o,c)),nre(c,o,u)),cre(n,e,t,Cne,Sne))}function ure(e,t,n,r,i){var a;if(i){var o=null;var u=r.facetFieldDef;var s=e.config?e.config:undefined;if(u&&i.labels){var l=Qne(["labelOrient"],u,s,t).labelOrient;if(t==="row"&&!IK(["top","bottom"],l)||t==="column"&&!IK(["left","right"],l)){o=ore(u,t,s)}}var f=voe(e)&&!C6(e.facet);var c=i.axes;var d=(c===null||c===void 0?void 0:c.length)>0;if(o||d){var h=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(t+"_"+n),type:"group",role:t+"-"+n},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:are(u,t)}:{}),d&&f?{from:{data:e.getName("facet_domain_"+t)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:(a={},a[h]=i.sizeSignal,a)}}:{}),d?{axes:c}:{})}}return null}var sre={column:{start:0,end:1},row:{start:1,end:0}};function lre(e,t){return sre[t][e]}function fre(e,t){var n={};for(var r=0,i=i2;r<i.length;r++){var a=i[r];var o=e[a];if(o===null||o===void 0?void 0:o.facetFieldDef){var u=Qne(["titleAnchor","titleOrient"],o.facetFieldDef,t,a),s=u.titleAnchor,l=u.titleOrient;var f=Jne(a,l);var c=lre(s,f);if(c!==undefined){n[f]=c}}}return XK(n).length>0?n:undefined}function cre(e,t,n,r,i){var a={};for(var o=0,u=r;o<u.length;o++){var s=u[o];if(!i[s]){continue}var l=Zne(s,t,e,n);if(l!==undefined){a[i[s]]=l}}return a}function dre(e){return h(hre(e,"width"),hre(e,"height"),hre(e,"childWidth"),hre(e,"childHeight"))}function hre(e,t){var n=t==="width"?"x":"y";var r=e.component.layoutSize.get(t);if(!r||r==="merged"){return[]}var i=e.getSizeSignalRef(t).signal;if(r==="step"){var a=e.getScaleComponent(n);if(a){var o=a.get("type");var u=a.get("range");if(I4(o)&&V5(u)){var s=e.scaleName(n);if(voe(e.parent)){var l=e.parent.component.resolve;if(l.scale[n]==="independent"){return[pre(s,u)]}}return[pre(s,u),{name:i,update:vre(s,a,"domain('"+s+"').length")}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){var f=i.endsWith("width");var c=f?"containerSize()[0]":"containerSize()[1]";var d=t7(e.config.view,f?"width":"height");var h="isFinite("+c+") ? "+c+" : "+d;return[{name:i,init:h,on:[{update:h,events:"window:resize"}]}]}else{return[{name:i,value:r}]}}function pre(e,t){return{name:e+"_step",value:t.step}}function vre(e,t,n){var r=t.get("type");var i=t.get("padding");var a=l0(t.get("paddingOuter"),i);var o=t.get("paddingInner");o=r==="band"?o!==undefined?o:i:1;return"bandspace("+n+", "+o+", "+a+") * "+e+"_step"}function gre(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function mre(e,t){return XK(e).reduce((function(n,r){var i=e[r];return Object.assign(Object.assign({},n),Tee(t,i,r,(function(e){return G5(e)?e:{value:e.value}})))}),{})}function yre(e,t){if(moe(t)||voe(t)){return"shared"}else if(goe(t)){return IK(_2,e)?"independent":"shared"}throw new Error("invalid model type for resolve")}function bre(e,t){var n=e.scale[t];var r=IK(_2,t)?"axis":"legend";if(n==="independent"){if(e[r][t]==="shared"){d5(u5.independentScaleMeansIndependentGuide(t))}return"independent"}return e[r][t]||"shared"}var xre=function(){function e(e,t){if(e===void 0){e={}}if(t===void 0){t={}}this.explicit=e;this.implicit=t}e.prototype.clone=function(){return new e(NK(this.explicit),NK(this.implicit))};e.prototype.combine=function(){return Object.assign(Object.assign({},this.explicit),this.implicit)};e.prototype.get=function(e){return l0(this.explicit[e],this.implicit[e])};e.prototype.getWithExplicit=function(e){if(this.explicit[e]!==undefined){return{explicit:true,value:this.explicit[e]}}else if(this.implicit[e]!==undefined){return{explicit:false,value:this.implicit[e]}}return{explicit:false,value:undefined}};e.prototype.setWithExplicit=function(e,t){if(t.value!==undefined){this.set(e,t.value,t.explicit)}};e.prototype.set=function(e,t,n){delete this[n?"implicit":"explicit"][e];this[n?"explicit":"implicit"][e]=t;return this};e.prototype.copyKeyFromSplit=function(e,t){if(t.explicit[e]!==undefined){this.set(e,t.explicit[e],true)}else if(t.implicit[e]!==undefined){this.set(e,t.implicit[e],false)}};e.prototype.copyKeyFromObject=function(e,t){if(t[e]!==undefined){this.set(e,t[e],true)}};e.prototype.copyAll=function(e){for(var t=0,n=XK(e.combine());t<n.length;t++){var r=n[t];var i=e.getWithExplicit(r);this.setWithExplicit(r,i)}};return e}();function _re(e){return{explicit:true,value:e}}function wre(e){return{explicit:false,value:e}}function kre(e){return function(t,n,r,i){var a=e(t.value,n.value);if(a>0){return t}else if(a<0){return n}return Ere(t,n,r,i)}}function Ere(e,t,n,r){if(e.explicit&&t.explicit){d5(u5.mergeConflictingProperty(n,r,e.value,t.value))}return e}function Ore(e,t,n,r,i){if(i===void 0){i=Ere}if(e===undefined||e.value===undefined){return t}if(e.explicit&&!t.explicit){return e}else if(t.explicit&&!e.explicit){return t}else if(FK(e.value,t.value)){return e}else{return i(e,t,n,r)}}var Are=Object.assign(Object.assign({},B9),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1});var Sre=XK(Are);var Dre=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(xre);var Cre={symbols:Mre,gradient:jre,labels:Fre,entries:Nre};function Mre(e,t){var n=t.fieldOrDatumDef,r=t.model,i=t.channel,a=t.legendCmpt,o=t.legendType;var u,s,l,f,c;if(o!=="symbol"){return undefined}var d=r.markDef,h=r.encoding,p=r.config,v=r.mark;var g=d.filled&&v!=="trail";var m=Object.assign(Object.assign({},T8({},r,$0)),Ree(r,{filled:g}));var y=(u=Tre(h.opacity))!==null&&u!==void 0?u:d.opacity;if(m.fill){if(i==="fill"||g&&i===M1){delete m.fill}else{if(m.fill["field"]){if(a.get("symbolFillColor")){delete m.fill}else{m.fill=N8((s=p.legend.symbolBaseFillColor)!==null&&s!==void 0?s:"black");m.fillOpacity=N8(y!==null&&y!==void 0?y:1)}}else if(ri(m.fill)){var b=(c=(f=zre((l=h.fill)!==null&&l!==void 0?l:h.color))!==null&&f!==void 0?f:d.fill)!==null&&c!==void 0?c:g&&d.color;if(b){m.fill=N8(b)}}}}if(m.stroke){if(i==="stroke"||!g&&i===M1){delete m.stroke}else{if(m.stroke["field"]){delete m.stroke}else if(ri(m.stroke)){var x=l0(zre(h.stroke||h.color),d.stroke,g?d.color:undefined);if(x){m.stroke={value:x}}}}}if(i!==R1){var _=q6(n)&&Pre(r,a,n);if(_){m.opacity=[Object.assign({test:_},N8(y!==null&&y!==void 0?y:1)),N8(p.legend.unselectedOpacity)]}else if(y){m.opacity=N8(y)}}m=Object.assign(Object.assign({},m),e);return XK(m).length>0?m:undefined}function jre(e,t){var n=t.model,r=t.legendType;if(r!=="gradient"){return undefined}var i={};var a=Tre(n.encoding.opacity)||n.markDef.opacity;if(a){i.opacity=N8(a)}i=Object.assign(Object.assign({},i),e);return XK(i).length>0?i:undefined}function Fre(e,t){var n=t.fieldOrDatumDef,r=t.model,i=t.channel,a=t.legendCmpt;var o=r.legend(i)||{};var u=r.config;var s=q6(n)?Pre(r,a,n):undefined;var l=s?[{test:s,value:1},{value:u.legend.unselectedOpacity}]:undefined;var f=o.format,c=o.formatType;var d=m6({fieldOrDatumDef:n,format:f,formatType:c,field:"datum.value",config:u,isUTCScale:r.getScaleComponent(i).get("type")===w4.UTC,omitNumberFormatAndEmptyTimeFormat:true});var h=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),d?{text:d}:{}),e);return XK(h).length>0?h:undefined}function Nre(e,t){var n=t.legendCmpt;var r=n.get("selections");return(r===null||r===void 0?void 0:r.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function Tre(e){return Rre(e,(function(e,t){return Math.max(e,t.value)}))}function zre(e){return Rre(e,(function(e,t){return l0(e,t.value)}))}function Rre(e,t){if(U6(e)){return $i(e.condition).reduce(t,e.value)}else if(X6(e)){return e.value}return undefined}function Pre(e,t,n){var r=t.get("selections");if(!(r===null||r===void 0?void 0:r.length))return undefined;var i=oi(n.field);return r.map((function(e){var t=oi(QK(e)+nne);return"(!length(data("+t+")) || ("+e+"["+i+"] && indexof("+e+"["+i+"], datum.value) >= 0))"})).join(" || ")}var Lre={direction:function(e){var t=e.direction;return t},format:function(e){var t=e.fieldOrDatumDef,n=e.legend,r=e.config;if(O8(t)){return undefined}return y6(t.type,n.format,r)},formatType:function(e){var t=e.fieldOrDatumDef,n=e.legend;if(O8(t)){return undefined}var r=n.formatType;if(r){if(G5(r)||r==="number"||r==="time"||r==="utc"){return r}}return undefined},gradientLength:function(e){var t,n;var r=e.legend,i=e.legendConfig;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:$re(e)},labelOverlap:function(e){var t=e.legend,n=e.legendConfig,r=e.scaleType;var i,a;return(a=(i=t.labelOverlap)!==null&&i!==void 0?i:n.labelOverlap)!==null&&a!==void 0?a:Vre(r)},symbolType:function(e){var t=e.legend,n=e.markDef,r=e.channel,i=e.encoding;var a;return(a=t.symbolType)!==null&&a!==void 0?a:Bre(n.type,r,i.shape,n.shape)},title:function(e){var t=e.fieldOrDatumDef,n=e.config;return c8(t,n,{allowDisabling:true})},type:function(e){var t=e.legendType,n=e.scaleType,r=e.channel;if(n2(r)&&U4(n)){if(t==="gradient"){return undefined}}else if(t==="symbol"){return undefined}return t},values:function(e){var t=e.fieldOrDatumDef,n=e.legend;return Ire(n,t)}};function Ire(e,t){var n=e.values;if(ri(n)){return C8(t,n)}else if(G5(n)){return n}return undefined}function Bre(e,t,n,r){var i;if(t!=="shape"){var a=(i=zre(n))!==null&&i!==void 0?i:r;if(a){return a}}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function Ure(e){var t=e.legend;return l0(t.type,qre(e))}function qre(e){var t=e.channel,n=e.timeUnit,r=e.scaleType;if(n2(t)){if(IK(["quarter","month","day"],n)){return"symbol"}if(U4(r)){return"gradient"}}return"symbol"}function Wre(e){var t=e.legendConfig,n=e.legendType,r=e.orient,i=e.legend;var a,o;return(o=(a=i.direction)!==null&&a!==void 0?a:t[n?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:Hre(r,n)}function Hre(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case undefined:return undefined;default:return t==="gradient"?"horizontal":undefined}}function $re(e){var t=e.legendConfig,n=e.model,r=e.direction,i=e.orient,a=e.scaleType;var o=t.gradientHorizontalMaxLength,u=t.gradientHorizontalMinLength,s=t.gradientVerticalMaxLength,l=t.gradientVerticalMinLength;if(U4(a)){if(r==="horizontal"){if(i==="top"||i==="bottom"){return Gre(n,"width",u,o)}else{return u}}else{return Gre(n,"height",l,s)}}return undefined}function Gre(e,t,n,r){var i=e.getSizeSignalRef(t).signal;return{signal:"clamp("+i+", "+n+", "+r+")"}}function Vre(e){if(IK(["quantile","threshold","log"],e)){return"greedy"}return undefined}function Yre(e){if(poe(e)){e.component.legends=Xre(e)}else{e.component.legends=Kre(e)}}function Xre(e){var t=e.encoding;var n={};for(var r=0,i=h([M1],P9);r<i.length;r++){var a=i[r];var o=m8(t[a]);if(!o||!e.getScaleComponent(a)){continue}if(a===N1&&q6(o)&&o.type===x4){continue}n[a]=Qre(e,a)}return n}function Jre(e,t){var n;var r=e.scaleName(t);if(e.mark==="trail"){if(t==="color"){return{stroke:r}}else if(t==="size"){return{strokeWidth:r}}}if(t==="color"){return e.markDef.filled?{fill:r}:{stroke:r}}return n={},n[t]=r,n}function Zre(e,t,n,r){switch(t){case"disable":return n!==undefined;case"values":return!!(n===null||n===void 0?void 0:n.values);case"title":if(t==="title"&&e===(r===null||r===void 0?void 0:r.title)){return true}}return e===(n||{})[t]}function Qre(e,t){var n,r,i;var a=e.legend(t);var o=e.markDef,u=e.encoding,s=e.config;var l=s.legend;var f=new Dre({},Jre(e,t));Dte(e,t,f);if(a!==undefined&&!a||l.disable){f.set("disable",true,a!==undefined&&!a)}a=a||{};var c=e.getScaleComponent(t).get("type");var d=m8(u[t]);var h=q6(d)?(n=W5(d.timeUnit))===null||n===void 0?void 0:n.unit:undefined;var p=a.orient||s.legend.orient||"right";var v=Ure({legend:a,channel:t,timeUnit:h,scaleType:c});var g=Wre({legend:a,legendType:v,orient:p,legendConfig:l});var m={legend:a,channel:t,model:e,markDef:o,encoding:u,fieldOrDatumDef:d,legendConfig:l,config:s,scaleType:c,orient:p,legendType:v,direction:g};for(var y=0,b=Sre;y<b.length;y++){var x=b[y];var _=x in Lre?Lre[x](m):a[x];if(_!==undefined){var w=Zre(_,x,a,e.fieldDef(t));if(w||s.legend[x]===undefined){f.set(x,_,w)}}}var k=(r=a===null||a===void 0?void 0:a.encoding)!==null&&r!==void 0?r:{};var E=f.get("selections");var O={};var A={fieldOrDatumDef:d,model:e,channel:t,legendCmpt:f,legendType:v};for(var S=0,D=["labels","legend","title","symbols","gradient","entries"];S<D.length;S++){var C=D[S];var M=mre((i=k[C])!==null&&i!==void 0?i:{},e);var j=C in Cre?Cre[C](M,A):M;if(j!==undefined&&XK(j).length>0){O[C]=Object.assign(Object.assign(Object.assign({},(E===null||E===void 0?void 0:E.length)&&q6(d)?{name:QK(d.field)+"_legend_"+C}:{}),(E===null||E===void 0?void 0:E.length)?{interactive:!!E}:{}),{update:j})}}if(XK(O).length>0){f.set("encode",O,!!(a===null||a===void 0?void 0:a.encoding))}return f}function Kre(e){var t=e.component,n=t.legends,r=t.resolve;for(var i=0,a=e.children;i<a.length;i++){var o=a[i];Yre(o);for(var u=0,s=XK(o.component.legends);u<s.length;u++){var l=s[u];r.legend[l]=bre(e.component.resolve,l);if(r.legend[l]==="shared"){n[l]=eie(n[l],o.component.legends[l]);if(!n[l]){r.legend[l]="independent";delete n[l]}}}}for(var f=0,c=XK(n);f<c.length;f++){var l=c[f];for(var d=0,h=e.children;d<h.length;d++){var o=h[d];if(!o.component.legends[l]){continue}if(r.legend[l]==="shared"){delete o.component.legends[l]}}}return n}function eie(e,t){var n,r,i,a,o,u;if(!e){return t.clone()}var s=e.getWithExplicit("orient");var l=t.getWithExplicit("orient");if(s.explicit&&l.explicit&&s.value!==l.value){return undefined}var f=false;var c=function(n){var r=Ore(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(function(e,t){switch(n){case"symbolType":return tie(e,t);case"title":return W8(e,t);case"type":f=true;return wre("symbol")}return Ere(e,t,n,"legend")}));e.setWithExplicit(n,r)};for(var d=0,h=Sre;d<h.length;d++){var p=h[d];c(p)}if(f){if((i=(r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)!==null&&i!==void 0?i:{}){e0(e.implicit,["encode","gradient"])}if((u=(o=(a=e.explicit)===null||a===void 0?void 0:a.encode)===null||o===void 0?void 0:o.gradient)!==null&&u!==void 0?u:{}){e0(e.explicit,["encode","gradient"])}}return e}function tie(e,t){if(t.value==="circle"){return t}return e}function nie(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{};e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{};e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{};e.encode[t].update[n]=r}function rie(e){var t=e.component.legends;var n={};for(var r=0,i=XK(t);r<i.length;r++){var a=i[r];var o=e.getScaleComponent(a);var u=RK(o.get("domains"));if(n[u]){for(var s=0,l=n[u];s<l.length;s++){var f=l[s];var c=eie(f,t[a]);if(!c){n[u].push(t[a])}}}else{n[u]=[t[a].clone()]}}return JK(n).flat().map(iie).filter((function(e){return e!==undefined}))}function iie(e){var t,n,r,i;var a=e.combine(),o=a.disable,u=a.labelExpr,s=a.selections,l=Xe(a,["disable","labelExpr","selections"]);if(o){return undefined}if((t=l.encode)===null||t===void 0?void 0:t.symbols){var f=l.encode.symbols.update;if(f.fill&&f.fill["value"]!=="transparent"&&!f.stroke&&!l.stroke){f.stroke={value:"transparent"}}for(var c=0,d=P9;c<d.length;c++){var h=d[c];if(l[h]){delete f[h]}}}if(!l.title){delete l.title}if(u!==undefined){var p=u;if(((i=(r=(n=l.encode)===null||n===void 0?void 0:n.labels)===null||r===void 0?void 0:r.update)===null||i===void 0?void 0:i.text)&&G5(l.encode.labels.update.text)){p=o0(u,"datum.label",l.encode.labels.update.text.signal)}nie(l,"labels","text",{signal:p})}for(var v in l){var g=l[v];if(G5(g)){var m=L9[v];if(m){var y=m.vgProp,b=m.part;nie(l,b,y,g);delete l[v]}}}return l}function aie(e){if(moe(e)||goe(e)){return oie(e)}else{return uie(e)}}function oie(e){return e.children.reduce((function(e,t){return e.concat(t.assembleProjections())}),uie(e))}function uie(e){var t=e.component.projection;if(!t||t.merged){return[]}var n=t.combine();var r=n.name;if(!t.data){return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}else{var i={signal:"["+t.size.map((function(e){return e.signal})).join(", ")+"]"};var a=t.data.reduce((function(t,n){var r=G5(n)?n.signal:"data('"+e.lookupDataSource(n)+"')";if(!IK(t,r)){t.push(r)}return t}),[]);if(a.length<=0){throw new Error("Projection's fit didn't find any data sources")}return[Object.assign({name:r,size:i,fit:{signal:a.length>1?"["+a.join(", ")+"]":a[0]}},n)]}}var sie=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];var lie=function(e){Ze(t,e);function t(t,n,r,i){var a=e.call(this,Object.assign({},n),{name:t})||this;a.specifiedProjection=n;a.size=r;a.data=i;a.merged=false;return a}Object.defineProperty(t.prototype,"isFit",{get:function(){return!!this.data},enumerable:true,configurable:true});return t}(xre);function fie(e){e.component.projection=poe(e)?cie(e):pie(e)}function cie(e){var t;if(e.hasProjection){var n=e.specifiedProjection;var r=!(n&&(n.scale!=null||n.translate!=null));var i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:undefined;var a=r?die(e):undefined;return new lie(e.projectionName(true),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n!==null&&n!==void 0?n:{}),i,a)}return undefined}function die(e){var t=[];var n=e.encoding;for(var r=0,i=[[S1,A1],[C1,D1]];r<i.length;r++){var a=i[r];if(m8(n[a[0]])||m8(n[a[1]])){t.push({signal:e.getName("geojson_"+t.length)})}}if(e.channelHasField(N1)&&e.typedFieldDef(N1).type===x4){t.push({signal:e.getName("geojson_"+t.length)})}if(t.length===0){t.push(e.requestDataName(fee))}return t}function hie(e,t){var n=UK(sie,(function(n){if(!ta(e.explicit,n)&&!ta(t.explicit,n)){return true}if(ta(e.explicit,n)&&ta(t.explicit,n)&&RK(e.get(n))===RK(t.get(n))){return true}return false}));var r=RK(e.size)===RK(t.size);if(r){if(n){return e}else if(RK(e.explicit)===RK({})){return t}else if(RK(t.explicit)===RK({})){return e}}return null}function pie(e){var t;if(e.children.length===0){return undefined}var n;for(var r=0,i=e.children;r<i.length;r++){var a=i[r];fie(a)}var o=UK(e.children,(function(e){var t=e.component.projection;if(!t){return true}else if(!n){n=t;return true}else{var r=hie(n,t);if(r){n=r}return!!r}}));if(n&&o){var u=e.projectionName(true);var s=new lie(u,n.specifiedProjection,n.size,NK(n.data));for(var l=0,f=e.children;l<f.length;l++){var a=f[l];var c=a.component.projection;if(c){if(c.isFit){(t=s.data).push.apply(t,a.component.projection.data)}a.renameProjection(c.get("name"),u);c.merged=true}}return s}return undefined}function vie(e,t,n,r){var i,a;if(M8(t,n)){var o=poe(e)?(a=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&a!==void 0?a:{}:{};var u=t8(t,{expr:"datum"});var s=t8(t,{expr:"datum",binSuffix:"end"});return{formulaAs:t8(t,{binSuffix:"range",forAs:true}),formula:_6(u,s,o.format,o.formatType,r)}}return{}}function gie(e,t){return P2(e)+"_"+t}function mie(e,t){return{signal:e.getName(t+"_bins"),extentSignal:e.getName(t+"_extent")}}function yie(e,t,n){var r;var i=(r=w8(n,undefined))!==null&&r!==void 0?r:{};var a=gie(i,t);return e.getName(a+"_bins")}function bie(e){return"as"in e}function xie(e,t,n){var r;var i;if(bie(e)){r=ai(e.as)?[e.as,e.as+"_end"]:[e.as[0],e.as[1]]}else{r=[t8(e,{forAs:true}),t8(e,{binSuffix:"end",forAs:true})]}var a=Object.assign({},w8(t,undefined));var o=gie(a,e.field);var u=mie(n,o),s=u.signal,l=u.extentSignal;if(U2(a.extent)){var f=a.extent;var c=f.selection;i=mne(n.getSelectionComponent(QK(c),c),f);delete a.extent}var d=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),l?{extentSignal:l}:{}),i?{span:i}:{});return{key:o,binComponent:d}}var _ie=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.bins=n;return r}t.prototype.clone=function(){return new t(null,NK(this.bins))};t.makeFromEncoding=function(e,n){var r=n.reduceFieldDef((function(e,t,r){if(Y6(t)&&L2(t.bin)){var i=xie(t,t.bin,n),a=i.key,o=i.binComponent;e[a]=Object.assign(Object.assign(Object.assign({},o),e[a]),vie(n,t,r,n.config))}return e}),{});if(XK(r).length===0){return null}return new t(e,r)};t.makeFromTransform=function(e,n,r){var i;var a=xie(n,n.bin,r),o=a.key,u=a.binComponent;return new t(e,(i={},i[o]=u,i))};t.prototype.merge=function(e,t){for(var n=0,r=XK(e.bins);n<r.length;n++){var i=r[n];if(i in this.bins){t(e.bins[i].signal,this.bins[i].signal);this.bins[i].as=HK(h(this.bins[i].as,e.bins[i].as),PK)}else{this.bins[i]=e.bins[i]}}for(var a=0,o=e.children;a<o.length;a++){var u=o[a];e.removeChild(u);u.parent=this}e.remove()};t.prototype.producedFields=function(){return new Set(JK(this.bins).map((function(e){return e.as})).flat(2))};t.prototype.dependentFields=function(){return new Set(JK(this.bins).map((function(e){return e.field})))};t.prototype.hash=function(){return"Bin "+PK(this.bins)};t.prototype.assemble=function(){return JK(this.bins).flatMap((function(e){var t=[];var n=e.as,r=n[0],i=n.slice(1);var a=e.bin,o=a.extent,u=Xe(a,["extent"]);var s=Object.assign(Object.assign(Object.assign({type:"bin",field:a0(e.field),as:r,signal:e.signal},!U2(o)?{extent:o}:{extent:null}),e.span?{span:{signal:"span("+e.span+")"}}:{}),u);if(!o&&e.extentSignal){t.push({type:"extent",field:a0(e.field),signal:e.extentSignal});s.extent={signal:e.extentSignal}}t.push(s);for(var l=0,f=i;l<f.length;l++){var c=f[l];for(var d=0;d<2;d++){t.push({type:"formula",expr:t8({field:r[d]},{expr:"datum"}),as:c[d]})}}if(e.formula){t.push({type:"formula",expr:e.formula,as:e.formulaAs})}return t}))};return t}(pte);var wie=function(e){Ze(t,e);function t(t){var n=e.call(this,null)||this;t=t!==null&&t!==void 0?t:{name:"source"};var r;if(!oee(t)){r=t.format?Object.assign({},zK(t.format,["parse"])):{}}if(iee(t)){n._data={values:t.values}}else if(ree(t)){n._data={url:t.url};if(!r.type){var i=/(?:\.([^.]+))?$/.exec(t.url)[1];if(!IK(["json","csv","tsv","dsv","topojson"],i)){i="json"}r.type=i}}else if(see(t)){n._data={values:[{type:"Sphere"}]}}else if(aee(t)||oee(t)){n._data={}}n._generator=oee(t);if(t.name){n._name=t.name}if(r&&XK(r).length>0){n._data.format=r}return n}t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return undefined};Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});t.prototype.hasName=function(){return!!this._name};Object.defineProperty(t.prototype,"isGenerator",{get:function(){return this._generator},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dataName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parent",{set:function(e){throw new Error("Source nodes have to be roots.")},enumerable:true,configurable:true});t.prototype.remove=function(){throw new Error("Source nodes are roots and cannot be removed.")};t.prototype.hash=function(){throw new Error("Cannot hash sources")};t.prototype.assemble=function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})};return t}(pte);function kie(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];for(var i=0,a=r.children;i<a.length;i++){var o=a[i];if(o.parent!==r){console.error("Dataflow graph is inconsistent.",r,o);return false}}if(!kie(r.children)){return false}}return true}var Eie=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.params=n;return r}t.prototype.clone=function(){return new t(null,this.params)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return undefined};t.prototype.hash=function(){return"Graticule "+PK(this.params)};t.prototype.assemble=function(){return Object.assign({type:"graticule"},this.params===true?{}:this.params)};return t}(pte);var Oie=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.params=n;return r}t.prototype.clone=function(){return new t(null,this.params)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){var e;return new Set([(e=this.params.as)!==null&&e!==void 0?e:"data"])};t.prototype.hash=function(){return"Hash "+PK(this.params)};t.prototype.assemble=function(){return Object.assign({type:"sequence"},this.params)};return t}(pte);function Aie(e){return e instanceof wie||e instanceof Eie||e instanceof Oie}var Sie=function(){function e(){this._mutated=false}e.prototype.setMutated=function(){this._mutated=true};Object.defineProperty(e.prototype,"mutatedFlag",{get:function(){return this._mutated},enumerable:true,configurable:true});return e}();var Die=function(e){Ze(t,e);function t(){var t=e.call(this)||this;t._continue=false;return t}t.prototype.setContinue=function(){this._continue=true};Object.defineProperty(t.prototype,"continueFlag",{get:function(){return this._continue},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"flags",{get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(e){var t=e.continueFlag,n=e.mutatedFlag;if(t){this.setContinue()}if(n){this.setMutated()}},enumerable:true,configurable:true});t.prototype.reset=function(){};t.prototype.optimizeNextFromLeaves=function(e){if(Aie(e)){return false}var t=e.parent;var n=this.run(e).continueFlag;if(n){this.optimizeNextFromLeaves(t)}return this.mutatedFlag};return t}(Sie);var Cie=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Sie);function Mie(e,t,n,r){var i=poe(r)?r.encoding[v2(t)]:undefined;if(Y6(n)&&poe(r)&&P6(t,n,i,r.stack,r.markDef,r.config)){e.add(t8(n,{}));e.add(t8(n,{suffix:"end"}));if(n.bin&&M8(n,t)){e.add(t8(n,{binSuffix:"range"}))}}else if(K1(t)){var a=Z1(t);e.add(r.getName(a))}else{e.add(t8(n))}return e}function jie(e,t){var n;var r;for(var i=0,a=XK(t);i<a.length;i++){var o=a[i];var u=t[o];for(var s=0,l=XK(u);s<l.length;s++){var f=l[s];if(o in e){e[o][f]=new Set(h((r=e[o][f])!==null&&r!==void 0?r:[],u[f]))}else{e[o]=(n={},n[f]=u[f],n)}}}}var Fie=function(e){Ze(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.dimensions=n;i.measures=r;return i}t.prototype.clone=function(){return new t(null,new Set(this.dimensions),NK(this.measures))};Object.defineProperty(t.prototype,"groupBy",{get:function(){return this.dimensions},enumerable:true,configurable:true});t.makeFromEncoding=function(e,n){var r=false;n.forEachFieldDef((function(e){if(e.aggregate){r=true}}));var i={};var a=new Set;if(!r){return null}n.forEachFieldDef((function(e,t){var r,o,u,s;var l=e.aggregate,f=e.field;if(l){if(l==="count"){i["*"]=(r=i["*"])!==null&&r!==void 0?r:{};i["*"]["count"]=new Set([t8(e,{forAs:true})])}else{if(o1(l)||u1(l)){var c=o1(l)?"argmin":"argmax";var d=l[c];i[d]=(o=i[d])!==null&&o!==void 0?o:{};i[d][c]=new Set([t8({op:c,field:d},{forAs:true})])}else{i[f]=(u=i[f])!==null&&u!==void 0?u:{};i[f][l]=new Set([t8(e,{forAs:true})])}if(j2(t)&&n.scaleDomain(t)==="unaggregated"){i[f]=(s=i[f])!==null&&s!==void 0?s:{};i[f]["min"]=new Set([t8({field:f,aggregate:"min"},{forAs:true})]);i[f]["max"]=new Set([t8({field:f,aggregate:"max"},{forAs:true})])}}}else{Mie(a,t,e,n)}}));if(a.size+XK(i).length===0){return null}return new t(e,a,i)};t.makeFromTransform=function(e,n){var r,i,a;var o=new Set;var u={};for(var s=0,l=n.aggregate;s<l.length;s++){var f=l[s];var c=f.op,d=f.field,h=f.as;if(c){if(c==="count"){u["*"]=(r=u["*"])!==null&&r!==void 0?r:{};u["*"]["count"]=new Set([h?h:t8(f,{forAs:true})])}else{u[d]=(i=u[d])!==null&&i!==void 0?i:{};u[d][c]=new Set([h?h:t8(f,{forAs:true})])}}}for(var p=0,v=(a=n.groupby)!==null&&a!==void 0?a:[];p<v.length;p++){var f=v[p];o.add(f)}if(o.size+XK(u).length===0){return null}return new t(e,o,u)};t.prototype.merge=function(e){if($K(this.dimensions,e.dimensions)){jie(this.measures,e.measures);return true}else{h5("different dimensions, cannot merge");return false}};t.prototype.addDimensions=function(e){e.forEach(this.dimensions.add,this.dimensions)};t.prototype.dependentFields=function(){return new Set(h(this.dimensions,XK(this.measures)))};t.prototype.producedFields=function(){var e=new Set;for(var t=0,n=XK(this.measures);t<n.length;t++){var r=n[t];for(var i=0,a=XK(this.measures[r]);i<a.length;i++){var o=a[i];var u=this.measures[r][o];if(u.size===0){e.add(o+"_"+r)}else{u.forEach(e.add,e)}}}return e};t.prototype.hash=function(){return"Aggregate "+PK({dimensions:this.dimensions,measures:this.measures})};t.prototype.assemble=function(){var e=[];var t=[];var n=[];for(var r=0,i=XK(this.measures);r<i.length;r++){var a=i[r];for(var o=0,u=XK(this.measures[a]);o<u.length;o++){var s=u[o];for(var l=0,f=this.measures[a][s];l<f.length;l++){var c=f[l];n.push(c);e.push(s);t.push(a==="*"?null:a0(a))}}}var d={type:"aggregate",groupby:h(this.dimensions).map(a0),ops:e,fields:t,as:n};return d};return t}(pte);var Nie=function(e){Ze(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.model=n;a.name=r;a.data=i;for(var o=0,u=i2;o<u.length;o++){var s=u[o];var l=n.facet[s];if(l){var f=l.bin,c=l.sort;a[s]=Object.assign({name:n.getName(s+"_domain"),fields:h([t8(l)],L2(f)?[t8(l,{binSuffix:"end"})]:[])},S6(c)?{sortField:c}:ri(c)?{sortIndexField:Xne(l,s)}:{})}}a.childModel=n.child;return a}t.prototype.hash=function(){var e="Facet";for(var t=0,n=i2;t<n.length;t++){var r=n[t];if(this[r]){e+=" "+r.charAt(0)+":"+PK(this[r])}}return e};Object.defineProperty(t.prototype,"fields",{get:function(){var e;var t=[];for(var n=0,r=i2;n<r.length;n++){var i=r[n];if((e=this[i])===null||e===void 0?void 0:e.fields){t.push.apply(t,this[i].fields)}}return t},enumerable:true,configurable:true});t.prototype.dependentFields=function(){var e=new Set(this.fields);for(var t=0,n=i2;t<n.length;t++){var r=n[t];if(this[r]){if(this[r].sortField){e.add(this[r].sortField.field)}if(this[r].sortIndexField){e.add(this[r].sortIndexField)}}}return e};t.prototype.producedFields=function(){return new Set};t.prototype.getSource=function(){return this.name};t.prototype.getChildIndependentFieldsWithStep=function(){var e={};for(var t=0,n=["x","y"];t<n.length;t++){var r=n[t];var i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type");var o=i.get("range");if(I4(a)&&V5(o)){var u=Cae(this.childModel,r);var s=Dae(u);if(s){e[r]=s}else{d5("Unknown field for "+r+". Cannot calculate view size.")}}}}return e};t.prototype.assembleRowColumnHeaderData=function(e,t,n){var r={row:"y",column:"x"}[e];var i=[];var a=[];var o=[];if(n&&n[r]){if(t){i.push("distinct_"+n[r]);a.push("max")}else{i.push(n[r]);a.push("distinct")}o.push("distinct_"+n[r])}var u=this[e],s=u.sortField,l=u.sortIndexField;if(s){var f=s.op,c=f===void 0?k6:f,d=s.field;i.push(d);a.push(c);o.push(t8(s,{forAs:true}))}else if(l){i.push(l);a.push("max");o.push(l)}return{name:this[e].name,source:t!==null&&t!==void 0?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},i.length?{fields:i,ops:a,as:o}:{})]}};t.prototype.assembleFacetHeaderData=function(e){var t,n;var r=this.model.layout.columns;var i=this.model.component.layoutHeaders;var a=[];var o={};for(var u=0,s=Kne;u<s.length;u++){var l=s[u];for(var f=0,c=ere;f<c.length;f++){var d=c[f];var h=(t=i[l]&&i[l][d])!==null&&t!==void 0?t:[];for(var p=0,v=h;p<v.length;p++){var g=v[p];if(((n=g.axes)===null||n===void 0?void 0:n.length)>0){o[l]=true;break}}}if(o[l]){var m='length(data("'+this.facet.name+'"))';var y=l==="row"?r?{signal:"ceil("+m+" / "+r+")"}:1:r?{signal:"min("+m+", "+r+")"}:{signal:m};a.push({name:this.facet.name+"_"+l,transform:[{type:"sequence",start:0,stop:y}]})}}var b=o.row,x=o.column;if(b||x){a.unshift(this.assembleRowColumnHeaderData("facet",null,e))}return a};t.prototype.assemble=function(){var e,t;var n=[];var r=null;var i=this.getChildIndependentFieldsWithStep();var a=this,o=a.column,u=a.row,s=a.facet;if(o&&u&&(i.x||i.y)){r="cross_"+this.column.name+"_"+this.row.name;var l=[].concat((e=i.x)!==null&&e!==void 0?e:[],(t=i.y)!==null&&t!==void 0?t:[]);var f=l.map((function(){return"distinct"}));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:f}]})}for(var c=0,d=[g1,v1];c<d.length;c++){var h=d[c];if(this[h]){n.push(this.assembleRowColumnHeaderData(h,r,i))}}if(s){var p=this.assembleFacetHeaderData(i);if(p){n.push.apply(n,p)}}return n};return t}(pte);function Tie(e){if(e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'){return e.slice(1,-1)}return e}function zie(e,t){var n=r0(e);if(t==="number"){return"toNumber("+n+")"}else if(t==="boolean"){return"toBoolean("+n+")"}else if(t==="string"){return"toString("+n+")"}else if(t==="date"){return"toDate("+n+")"}else if(t==="flatten"){return n}else if(t.indexOf("date:")===0){var r=Tie(t.slice(5,t.length));return"timeParse("+n+",'"+r+"')"}else if(t.indexOf("utc:")===0){var r=Tie(t.slice(4,t.length));return"utcParse("+n+",'"+r+"')"}else{d5(u5.unrecognizedParse(t));return null}}function Rie(e){var t={};MK(e.filter,(function(e){var n;if(l4(e)){var r=null;if(t4(e)){r=e.equal}else if(o4(e)){r=e.range[0]}else if(u4(e)){r=((n=e.oneOf)!==null&&n!==void 0?n:e["in"])[0]}if(r){if(p5(r)){t[e.field]="date"}else if(la(r)){t[e.field]="number"}else if(ai(r)){t[e.field]="string"}}if(e.timeUnit){t[e.field]="date"}}}));return t}function Pie(e){var t={};function n(e){if(O8(e)){t[e.field]="date"}else if(e.type==="quantitative"&&c1(e.aggregate)){t[e.field]="number"}else if(s0(e.field)>1){if(!(e.field in t)){t[e.field]="flatten"}}else if(J6(e)&&S6(e.sort)&&s0(e.sort.field)>1){if(!(e.sort.field in t)){t[e.sort.field]="flatten"}}}if(poe(e)||voe(e)){e.forEachFieldDef((function(t,r){if(Y6(t)){n(t)}else{var i=h2(r);var a=e.fieldDef(i);n(Object.assign(Object.assign({},t),{type:a.type}))}}))}if(poe(e)){var r=e.mark,i=e.markDef,a=e.encoding;if(L0(r)&&!e.encoding.order){var o=i.orient==="horizontal"?"y":"x";var u=a[o];if(q6(u)&&u.type==="quantitative"&&!(u.field in t)){t[u.field]="number"}}}return t}function Lie(e){var t={};if(poe(e)&&e.component.selection){for(var n=0,r=XK(e.component.selection);n<r.length;n++){var i=r[n];var a=e.component.selection[i];for(var o=0,u=a.project.items;o<u.length;o++){var s=u[o];if(!s.channel&&s0(s.field)>1){t[s.field]="flatten"}}}}return t}var Iie=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r._parse=n;return r}t.prototype.clone=function(){return new t(null,NK(this._parse))};t.prototype.hash=function(){return"Parse "+PK(this._parse)};t.makeExplicit=function(e,t,n){var r={};var i=t.data;if(!oee(i)&&i&&i.format&&i.format.parse){r=i.format.parse}return this.makeWithAncestors(e,r,{},n)};t.makeWithAncestors=function(e,n,r,i){for(var a=0,o=XK(r);a<o.length;a++){var u=o[a];var s=i.getWithExplicit(u);if(s.value!==undefined){if(s.explicit||s.value===r[u]||s.value==="derived"||r[u]==="flatten"){delete r[u]}else{d5(u5.differentParse(u,r[u],s.value))}}}for(var l=0,f=XK(n);l<f.length;l++){var c=f[l];var s=i.get(c);if(s!==undefined){if(s===n[c]){delete n[c]}else{d5(u5.differentParse(c,n[c],s))}}}var d=new xre(n,r);i.copyAll(d);var h={};for(var p=0,v=XK(d.combine());p<v.length;p++){var g=v[p];var m=d.get(g);if(m!==null){h[g]=m}}if(XK(h).length===0||i.parseNothing){return null}return new t(e,h)};Object.defineProperty(t.prototype,"parse",{get:function(){return this._parse},enumerable:true,configurable:true});t.prototype.merge=function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse);e.remove()};t.prototype.assembleFormatParse=function(){var e={};for(var t=0,n=XK(this._parse);t<n.length;t++){var r=n[t];var i=this._parse[r];if(s0(r)===1){e[r]=i}}return e};t.prototype.producedFields=function(){return new Set(XK(this._parse))};t.prototype.dependentFields=function(){return new Set(XK(this._parse))};t.prototype.assembleTransforms=function(e){var t=this;if(e===void 0){e=false}return XK(this._parse).filter((function(t){return e?s0(t)>1:true})).map((function(e){var n=zie(e,t._parse[e]);if(!n){return null}var r={type:"formula",expr:n,as:u0(e)};return r})).filter((function(e){return e!==null}))};return t}(pte);var Bie=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.addDimensions=function(e){this.transform.groupby=HK(this.transform.groupby.concat(e),(function(e){return e}))};t.prototype.dependentFields=function(){var e=new Set;if(this.transform.groupby){this.transform.groupby.forEach(e.add,e)}this.transform.joinaggregate.map((function(e){return e.field})).filter((function(e){return e!==undefined})).forEach(e.add,e);return e};t.prototype.producedFields=function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))};t.prototype.getDefaultName=function(e){var t;return(t=e.as)!==null&&t!==void 0?t:t8(e)};t.prototype.hash=function(){return"JoinAggregateTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=[];var t=[];var n=[];for(var r=0,i=this.transform.joinaggregate;r<i.length;r++){var a=i[r];t.push(a.op);n.push(this.getDefaultName(a));e.push(a.field===undefined?null:a.field)}var o=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},o!==undefined?{groupby:o}:{})};return t}(pte);function Uie(e){return e.stack.stackBy.reduce((function(e,t){var n=t.fieldDef;var r=t8(n);if(r){e.push(r)}return e}),[])}function qie(e){return ri(e)&&e.every((function(e){return ai(e)}))&&e.length>1}var Wie=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r._stack=n;return r}t.prototype.clone=function(){return new t(null,NK(this._stack))};t.makeFromTransform=function(e,n){var r=n.stack,i=n.groupby,a=n.as,o=n.offset,u=o===void 0?"zero":o;var s=[];var l=[];if(n.sort!==undefined){for(var f=0,c=n.sort;f<c.length;f++){var d=c[f];s.push(d.field);l.push(l0(d.order,"ascending"))}}var h={field:s,order:l};var p;if(qie(a)){p=a}else if(ai(a)){p=[a,a+"_end"]}else{p=[n.stack+"_start",n.stack+"_end"]}return new t(e,{stackField:r,groupby:i,offset:u,sort:h,facetby:[],as:p})};t.makeFromEncoding=function(e,n){var r=n.stack;var i=n.encoding;if(!r){return null}var a=r.groupbyChannel,o=r.fieldChannel,u=r.offset,s=r.impute;var l;if(a){var f=i[a];l=g8(f)}var c=Uie(n);var d=n.encoding.order;var h;if(ri(d)||q6(d)){h=B8(d)}else{h=c.reduce((function(e,t){e.field.push(t);e.order.push(o==="y"?"descending":"ascending");return e}),{field:[],order:[]})}return new t(e,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:h,offset:u,impute:s,as:[n.vgField(o,{suffix:"start",forAs:true}),n.vgField(o,{suffix:"end",forAs:true})]})};Object.defineProperty(t.prototype,"stack",{get:function(){return this._stack},enumerable:true,configurable:true});t.prototype.addDimensions=function(e){var t;(t=this._stack.facetby).push.apply(t,e)};t.prototype.dependentFields=function(){var e=new Set;e.add(this._stack.stackField);this.getGroupbyFields().forEach(e.add,e);this._stack.facetby.forEach(e.add,e);this._stack.sort.field.forEach(e.add,e);return e};t.prototype.producedFields=function(){return new Set(this._stack.as)};t.prototype.hash=function(){return"Stack "+PK(this._stack)};t.prototype.getGroupbyFields=function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;if(t){if(t.bin){if(n){return[t8(t,{binSuffix:"mid"})]}return[t8(t,{}),t8(t,{binSuffix:"end"})]}return[t8(t)]}return r!==null&&r!==void 0?r:[]};t.prototype.assemble=function(){var e=[];var t=this._stack,n=t.facetby,r=t.dimensionFieldDef,i=t.stackField,a=t.stackby,o=t.sort,u=t.offset,s=t.impute,l=t.as;if(s&&r){var f=r.band,c=f===void 0?.5:f,d=r.bin;if(d){e.push({type:"formula",expr:c+"*"+t8(r,{expr:"datum"})+("+"+(1-c)+"*")+t8(r,{expr:"datum",binSuffix:"end"}),as:t8(r,{binSuffix:"mid",forAs:true})})}e.push({type:"impute",field:i,groupby:h(a,n),key:t8(r,{binSuffix:"mid"}),method:"value",value:0})}e.push({type:"stack",groupby:h(this.getGroupbyFields(),n),field:i,sort:o,as:l,offset:u});return e};return t}(pte);var Hie=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.addDimensions=function(e){this.transform.groupby=HK(this.transform.groupby.concat(e),(function(e){return e}))};t.prototype.dependentFields=function(){var e,t;var n=new Set;((e=this.transform.groupby)!==null&&e!==void 0?e:[]).forEach(n.add,n);((t=this.transform.sort)!==null&&t!==void 0?t:[]).forEach((function(e){return n.add(e.field)}));this.transform.window.map((function(e){return e.field})).filter((function(e){return e!==undefined})).forEach(n.add,n);return n};t.prototype.producedFields=function(){return new Set(this.transform.window.map(this.getDefaultName))};t.prototype.getDefaultName=function(e){var t;return(t=e.as)!==null&&t!==void 0?t:t8(e)};t.prototype.hash=function(){return"WindowTransform "+PK(this.transform)};t.prototype.assemble=function(){var e;var t=[];var n=[];var r=[];var i=[];for(var a=0,o=this.transform.window;a<o.length;a++){var u=o[a];n.push(u.op);r.push(this.getDefaultName(u));i.push(u.param===undefined?null:u.param);t.push(u.field===undefined?null:u.field)}var s=this.transform.frame;var l=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every((function(e){return s1(e)}))){return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},l!==undefined?{groupby:l}:{})}var f=[];var c=[];if(this.transform.sort!==undefined){for(var d=0,h=this.transform.sort;d<h.length;d++){var p=h[d];f.push(p.field);c.push((e=p.order)!==null&&e!==void 0?e:"ascending")}}var v={field:f,order:c};var g=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:t,sort:v},g!==undefined?{ignorePeers:g}:{}),l!==undefined?{groupby:l}:{}),s!==undefined?{frame:s}:{})};return t}(pte);var $ie=function(e){Ze(t,e);function t(t){return e.call(this,t)||this}t.prototype.clone=function(){return new t(null)};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set([U9])};t.prototype.hash=function(){return"Identifier"};t.prototype.assemble=function(){return{type:"identifier",as:U9}};return t}(pte);var Gie=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;if(e instanceof Iie){if(Aie(t)){return this.flags}if(t.numChildren()>1){this.setContinue();return this.flags}if(t instanceof Iie){this.setMutated();t.merge(e)}else{if(YK(t.producedFields(),e.dependentFields())){this.setContinue();return this.flags}this.setMutated();e.swapWithParent()}}this.setContinue();return this.flags};return t}(Die);var Vie=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.mergeNodes=function(e,t){var n=t.shift();for(var r=0,i=t;r<i.length;r++){var a=i[r];e.removeChild(a);a.parent=n;a.remove()}};t.prototype.run=function(e){var t=e.children.map((function(e){return e.hash()}));var n={};for(var r=0;r<t.length;r++){if(n[t[r]]===undefined){n[t[r]]=[e.children[r]]}else{n[t[r]].push(e.children[r])}}for(var i=0,a=XK(n);i<a.length;i++){var o=a[i];if(n[o].length>1){this.setMutated();this.mergeNodes(e,n[o])}}for(var u=0,s=e.children;u<s.length;u++){var l=s[u];this.run(l)}return this.mutatedFlag};return t}(Cie);var Yie=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){if(e instanceof vte||e.numChildren()>0||e instanceof Nie){return this.flags}else{this.setMutated();e.remove()}return this.flags};return t}(Die);var Xie=function(e){Ze(t,e);function t(){var t=e.apply(this,arguments)||this;t.fields=new Set;t.prev=null;return t}t.prototype.run=function(e){this.setContinue();if(e instanceof gte){var t=e.producedFields();if(GK(t,this.fields)){this.setMutated();this.prev.remove()}else{this.fields=new Set(h(this.fields,t))}this.prev=e}return this.flags};t.prototype.reset=function(){this.fields.clear()};return t}(Die);var Jie=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){this.setContinue();var t=e.parent;var n=t.children.filter((function(e){return e instanceof gte}));var r=n.pop();for(var i=0,a=n;i<a.length;i++){var o=a[i];this.setMutated();r.merge(o)}return this.flags};return t}(Die);function Zie(e){function t(n){if(!(n instanceof Nie)){var r=n.clone();if(r instanceof vte){var i=oae+r.getSource();r.setSource(i);e.model.component.data.outputNodes[i]=r}else if(r instanceof Fie||r instanceof Wie||r instanceof Hie||r instanceof Bie){r.addDimensions(e.fields)}for(var a=0,o=n.children.flatMap(t);a<o.length;a++){var u=o[a];u.parent=r}return[r]}return n.children.flatMap(t)}return t}function Qie(e){if(e instanceof Nie){if(e.numChildren()===1&&!(e.children[0]instanceof vte)){var t=e.children[0];if(t instanceof Fie||t instanceof Wie||t instanceof Hie||t instanceof Bie){t.addDimensions(e.fields)}t.swapWithParent();Qie(e)}else{var n=e.model.component.data.main;Kie(n);var r=Zie(e);var i=e.children.map(r).flat();for(var a=0,o=i;a<o.length;a++){var u=o[a];u.parent=n}}}else{e.children.map(Qie)}}function Kie(e){if(e instanceof vte&&e.type===fee){if(e.numChildren()===1){var t=e.children[0];if(!(t instanceof Nie)){t.swapWithParent();Kie(e)}}}}var eae=function(e){Ze(t,e);function t(){return e.call(this)||this}t.prototype.run=function(e){if(e instanceof vte&&!e.isRequired()){this.setMutated();e.remove()}for(var t=0,n=e.children;t<n.length;t++){var r=n[t];this.run(r)}return this.mutatedFlag};return t}(Cie);var tae=function(e){Ze(t,e);function t(t){var n=e.call(this)||this;n.requiresSelectionId=t&&fne(t);return n}t.prototype.run=function(e){if(e instanceof $ie){if(!(this.requiresSelectionId&&(Aie(e.parent)||e.parent instanceof Fie||e.parent instanceof Iie))){this.setMutated();e.remove()}}for(var t=0,n=e.children;t<n.length;t++){var r=n[t];this.run(r)}return this.mutatedFlag};return t}(Cie);var nae=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;var n=h(t.children);var r=t.children.filter((function(e){return e instanceof Iie}));if(t.numChildren()>1&&r.length>=1){var i={};var a=new Set;for(var o=0,u=r;o<u.length;o++){var s=u[o];var l=s.parse;for(var f=0,c=XK(l);f<c.length;f++){var d=c[f];if(!(d in i)){i[d]=l[d]}else if(i[d]!==l[d]){a.add(d)}}}for(var p=0,v=a;p<v.length;p++){var g=v[p];delete i[g]}if(XK(i).length!==0){this.setMutated();var m=new Iie(t,i);for(var y=0,b=n;y<b.length;y++){var x=b[y];if(x instanceof Iie){for(var _=0,w=XK(i);_<w.length;_++){var k=w[_];delete x.parse[k]}}t.removeChild(x);x.parent=m;if(x instanceof Iie&&XK(x.parse).length===0){x.remove()}}}}this.setContinue();return this.flags};return t}(Die);var rae=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;var n=t.children.filter((function(e){return e instanceof Fie}));var r={};for(var i=0,a=n;i<a.length;i++){var o=a[i];var u=PK(o.groupBy);if(!(u in r)){r[u]=[]}r[u].push(o)}for(var s=0,l=XK(r);s<l.length;s++){var f=l[s];var c=r[f];if(c.length>1){var d=c.pop();for(var h=0,p=c;h<p.length;h++){var o=p[h];if(d.merge(o)){t.removeChild(o);o.parent=d;o.remove();this.setMutated()}}}}this.setContinue();return this.flags};return t}(Die);var iae=function(e){Ze(t,e);function t(t){var n=e.call(this)||this;n.model=t;return n}t.prototype.run=function(e){var t=e.parent;var n=!(Aie(t)||t instanceof pne||t instanceof Iie||t instanceof $ie);var r=[];var i=[];for(var a=0,o=t.children;a<o.length;a++){var u=o[a];if(u instanceof _ie){if(n&&!YK(t.producedFields(),u.dependentFields())){r.push(u)}else{i.push(u)}}}if(r.length>0){var s=r.pop();for(var l=0,f=r;l<f.length;l++){var c=f[l];s.merge(c,this.model.renameSignal.bind(this.model))}this.setMutated();if(t instanceof _ie){t.merge(s,this.model.renameSignal.bind(this.model))}else{s.swapWithParent()}}if(i.length>1){var d=i.pop();for(var h=0,p=i;h<p.length;h++){var v=p[h];d.merge(v,this.model.renameSignal.bind(this.model))}this.setMutated()}this.setContinue();return this.flags};return t}(Die);var aae=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.run=function(e){var t=e.parent;var n=h(t.children);var r=BK(n,(function(e){return e instanceof vte}));if(!r||t.numChildren()<=1){this.setContinue();return this.flags}var i=[];var a;for(var o=0,u=n;o<u.length;o++){var s=u[o];if(s instanceof vte){var l=s;while(l.numChildren()===1){var f=l.children[0];if(f instanceof vte){l=f}else{break}}i.push.apply(i,l.children);if(a){t.removeChild(s);s.parent=a.parent;a.parent.removeChild(a);a.parent=l;this.setMutated()}else{a=l}}else{i.push(s)}}if(i.length){this.setMutated();for(var c=0,d=i;c<d.length;c++){var s=d[c];s.parent.removeChild(s);s.parent=a}}this.setContinue();return this.flags};return t}(Die);var oae="scale_";var uae=5;function sae(e){var t=[];function n(e){if(e.numChildren()===0){t.push(e)}else{for(var r=0,i=e.children;r<i.length;r++){var a=i[r];n(a)}}}for(var r=0,i=e;r<i.length;r++){var a=i[r];n(a)}return t}function lae(e){return e}function fae(e,t){var n=t.map((function(t){if(e instanceof Die){var n=e.optimizeNextFromLeaves(t);e.reset();return n}else{return e.run(t)}}));return n.some(lae)}function cae(e,t){var n=e.sources;var r=new Set;r.add(fae(new eae,n));r.add(fae(new tae(t),n));n=n.filter((function(e){return e.numChildren()>0}));r.add(fae(new Yie,sae(n)));n=n.filter((function(e){return e.numChildren()>0}));r.add(fae(new Gie,sae(n)));r.add(fae(new iae(t),sae(n)));r.add(fae(new Xie,sae(n)));r.add(fae(new nae,sae(n)));r.add(fae(new rae,sae(n)));r.add(fae(new Jie,sae(n)));r.add(fae(new Vie,n));r.add(fae(new aae,sae(n)));e.sources=n;return r.has(true)}function dae(e,t){kie(e.sources);var n=0;var r=0;for(var i=0;i<uae;i++){if(!cae(e,t)){break}n++}e.sources.map(Qie);for(var i=0;i<uae;i++){if(!cae(e,t)){break}r++}kie(e.sources);if(Math.max(n,r)===uae){d5("Maximum optimization runs("+uae+") reached.")}}var hae=function(){function e(e){Object.defineProperty(this,"signal",{enumerable:true,get:e})}e.fromName=function(t,n){return new e((function(){return t(n)}))};return e}();function pae(e){if(poe(e)){vae(e)}else{gae(e)}}function vae(e){var t=e.component.scales;for(var n=0,r=XK(t);n<r.length;n++){var i=r[n];var a=yae(e,i);var o=t[i];o.setWithExplicit("domains",a);kae(e,i);if(e.component.data.isFaceted){var u=e;while(!voe(u)&&u.parent){u=u.parent}var s=u.component.resolve.scale[i];if(s==="shared"){for(var l=0,f=a.value;l<f.length;l++){var c=f[l];if(J5(c)){c.data=oae+c.data.replace(oae,"")}}}}}}function gae(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];pae(r)}var i=e.component.scales;for(var a=0,o=XK(i);a<o.length;a++){var u=o[a];var s=void 0;var l=null;for(var f=0,c=e.children;f<c.length;f++){var r=c[f];var d=r.component.scales[u];if(d){if(s===undefined){s=d.getWithExplicit("domains")}else{s=Ore(s,d.getWithExplicit("domains"),"domains","scale",Aae)}var h=d.get("selectionExtent");if(l&&h&&l.selection!==h.selection){d5("The same selection must be used to override scale domains in a layered view.")}l=h}}i[u].setWithExplicit("domains",s);if(l){i[u].set("selectionExtent",l,true)}}}function mae(e,t,n,r){if(e==="unaggregated"){var i=Oae(t,n),a=i.valid,o=i.reason;if(!a){d5(o);return undefined}}else if(e===undefined&&r.useUnaggregatedDomain){var u=Oae(t,n).valid;if(u){return"unaggregated"}}return e}function yae(e,t){var n=e.getScaleComponent(t).get("type");var r=e.encoding;var i=mae(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);if(i!==e.scaleDomain(t)){e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})}if(t==="x"&&m8(r.x2)){if(m8(r.x)){return Ore(_ae(n,i,e,"x"),_ae(n,i,e,"x2"),"domain","scale",Aae)}else{return _ae(n,i,e,"x2")}}else if(t==="y"&&m8(r.y2)){if(m8(r.y)){return Ore(_ae(n,i,e,"y"),_ae(n,i,e,"y2"),"domain","scale",Aae)}else{return _ae(n,i,e,"y2")}}return _ae(n,i,e,t)}function bae(e,t,n){return e.map((function(e){var r=D8(e,{timeUnit:n,type:t});return{signal:"{data: "+r+"}"}}))}function xae(e,t,n){var r;var i=(r=W5(n))===null||r===void 0?void 0:r.unit;if(t==="temporal"||i){return bae(e,t,i)}return[e]}function _ae(e,t,n,r){var i=n.encoding;var a=m8(i[r]);var o=a.type;var u=a["timeUnit"];if(G4(t)){var s=_ae(e,undefined,n,r);var l=xae(t.unionWith,o,u);return _re(h(s.value,l))}else if(G5(t)){return _re([t])}else if(t&&t!=="unaggregated"&&!$4(t)){return _re(xae(t,o,u))}var f=n.stack;if(f&&r===f.fieldChannel){if(f.offset==="normalize"){return wre([[0,1]])}var c=n.requestDataName(fee);return wre([{data:c,field:n.vgField(r,{suffix:"start"})},{data:c,field:n.vgField(r,{suffix:"end"})}])}var d=j2(r)&&q6(a)?Eae(n,r,e):undefined;if(H6(a)){var p=xae([a.datum],o,u);return wre(p)}var v=a;if(t==="unaggregated"){var g=n.requestDataName(fee);var m=a.field;return wre([{data:g,field:t8({field:m,aggregate:"min"})},{data:g,field:t8({field:m,aggregate:"max"})}])}else if(L2(v.bin)){if(I4(e)){if(e==="bin-ordinal"){return wre([])}return wre([{data:ZK(d)?n.requestDataName(fee):n.requestDataName(cee),field:n.vgField(r,M8(v,r)?{binSuffix:"range"}:{}),sort:d===true||!ii(d)?{field:n.vgField(r,{}),op:"min"}:d}])}else{var y=v.bin;if(L2(y)){var b=yie(n,v.field,y);return wre([new hae((function(){var e=n.getSignalName(b);return"["+e+".start, "+e+".stop]"}))])}else{return wre([{data:n.requestDataName(fee),field:n.vgField(r,{})}])}}}else if(v.timeUnit&&IK(["time","utc"],e)&&P6(r,v,poe(n)?n.encoding[v2(r)]:undefined,n.stack,n.markDef,n.config)){var x=n.requestDataName(fee);return wre([{data:x,field:n.vgField(r)},{data:x,field:n.vgField(r,{suffix:"end"})}])}else if(d){return wre([{data:ZK(d)?n.requestDataName(fee):n.requestDataName(cee),field:n.vgField(r),sort:d}])}else{return wre([{data:n.requestDataName(fee),field:n.vgField(r)}])}}function wae(e,t){var n=e.op,r=e.field,i=e.order;return Object.assign(Object.assign({op:n!==null&&n!==void 0?n:t?"sum":k6},r?{field:a0(r)}:{}),i?{order:i}:{})}function kae(e,t){var n;var r=e.component.scales[t];var i=e.specifiedScales[t].domain;var a=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin;var o=$4(i)&&i;var u=B2(a)&&U2(a.extent)&&a.extent;if(o||u){r.set("selectionExtent",o!==null&&o!==void 0?o:u,true)}}function Eae(e,t,n){if(!I4(n)){return undefined}var r=e.fieldDef(t);var i=r.sort;if(D6(i)){return{op:"min",field:Xne(r,t),order:"ascending"}}var a=e.stack;var o=a?h(a.groupbyField?[a.groupbyField]:[],a.stackBy.map((function(e){return e.fieldDef.field}))):undefined;if(S6(i)){var u=a&&!IK(o,i.field);return wae(i,u)}else if(A6(i)){var s=i.encoding,l=i.order;var f=e.fieldDef(s);var c=f.aggregate,d=f.field;var u=a&&!IK(o,d);if(o1(c)||u1(c)){return wae({field:t8(f),order:l},u)}else if(s1(c)||!c){return wae({op:c,field:d,order:l},u)}}else if(i==="descending"){return{op:"min",field:e.vgField(t),order:"descending"}}else if(IK(["ascending",undefined],i)){return true}return undefined}function Oae(e,t){var n=e.aggregate,r=e.type;if(!n){return{valid:false,reason:u5.unaggregateDomainHasNoEffectForRawField(e)}}if(ai(n)&&!p1[n]){return{valid:false,reason:u5.unaggregateDomainWithNonSharedDomainOp(n)}}if(r==="quantitative"){if(t==="log"){return{valid:false,reason:u5.unaggregatedDomainWithLogScale(e)}}}return{valid:true}}function Aae(e,t,n,r){if(e.explicit&&t.explicit){d5(u5.mergeConflictingDomainProperty(n,r,e.value,t.value))}return{explicit:e.explicit,value:h(e.value,t.value)}}function Sae(e){var t=HK(e.map((function(e){if(J5(e)){var t=Xe(e,["sort"]);return t}return e})),PK);var n=HK(e.map((function(e){if(J5(e)){var t=e.sort;if(t!==undefined&&!ZK(t)){if("op"in t&&t.op==="count"){delete t.field}if(t.order==="ascending"){delete t.order}}return t}return undefined})).filter((function(e){return e!==undefined})),PK);if(t.length===0){return undefined}else if(t.length===1){var r=e[0];if(J5(r)&&n.length>0){var i=n[0];if(n.length>1){d5(u5.MORE_THAN_ONE_SORT);i=true}else{if(ii(i)&&"field"in i){var a=i.field;if(r.field===a){i=i.order?{order:i.order}:true}}}return Object.assign(Object.assign({},r),{sort:i})}return r}var o=HK(n.map((function(e){if(ZK(e)||!("op"in e)||e.op in a1){return e}d5(u5.domainSortDropped(e));return true})),PK);var u;if(o.length===1){u=o[0]}else if(o.length>1){d5(u5.MORE_THAN_ONE_SORT);u=true}var s=HK(e.map((function(e){if(J5(e)){return e.data}return null})),(function(e){return e}));if(s.length===1&&s[0]!==null){var l=Object.assign({data:s[0],fields:t.map((function(e){return e.field}))},u?{sort:u}:{});return l}return Object.assign({fields:t},u?{sort:u}:{})}function Dae(e){if(J5(e)&&ai(e.field)){return e.field}else if(Y5(e)){var t;for(var n=0,r=e.fields;n<r.length;n++){var i=r[n];if(J5(i)&&ai(i.field)){if(!t){t=i.field}else if(t!==i.field){d5("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.");return t}}}d5("Detected faceted independent scales that union domain of identical fields from different source detected. We will assume that this is the same field from a different fork of the same data source. However, if this is not case, the result view size maybe incorrect.");return t}else if(X5(e)){d5("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");var a=e.fields[0];return ai(a)?a:undefined}return undefined}function Cae(e,t){var n=e.component.scales[t];var r=n.get("domains").map((function(t){if(J5(t)){t.data=e.lookupDataSource(t.data)}return t}));return Sae(r)}function Mae(e){if(moe(e)||goe(e)){return e.children.reduce((function(e,t){return e.concat(Mae(t))}),jae(e))}else{return jae(e)}}function jae(e){return XK(e.component.scales).reduce((function(t,n){var r=e.component.scales[n];if(r.merged){return t}var i=r.combine();var a=i.name,o=i.type,u=i.selectionExtent,s=i.domains,l=i.range,f=i.reverse,c=Xe(i,["name","type","selectionExtent","domains","range","reverse"]);var d=Fae(i.range,a,n);var h;if(u){h=Gte(e,u)}var p=Cae(e,n);t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:d}),f!==undefined?{reverse:f}:{}),c));return t}),[])}function Fae(e,t,n){if(w2(n)){if(V5(e)){return{step:{signal:t+"_step"}}}}return e}var Nae=function(e){Ze(t,e);function t(t,n){var r=e.call(this,{},{name:t})||this;r.merged=false;r.setWithExplicit("type",n);return r}t.prototype.domainDefinitelyIncludesZero=function(){if(this.get("zero")!==false){return true}return BK(this.get("domains"),(function(e){return ri(e)&&e.length===2&&e[0]<=0&&e[1]>=0}))};return t}(xre);var Tae=["range","scheme"];function zae(e){return e==="x"?"width":e==="y"?"height":undefined}function Rae(e){var t=e.component.scales;for(var n=0,r=M2;n<r.length;n++){var i=r[n];var a=t[i];if(!a){continue}var o=Lae(i,e);a.setWithExplicit("range",o)}}function Pae(e,t){var n=e.fieldDef(t);if(n&&n.bin&&L2(n.bin)){var r=yie(e,n.field,n.bin);var i=zae(t);var a=e.getName(i);return new hae((function(){var t=e.getSignalName(r);var n="("+t+".stop - "+t+".start) / "+t+".step";return e.getSignalName(a)+" / ("+n+")"}))}return undefined}function Lae(e,t){var n=t.specifiedScales[e];var r=t.size;var i=t.getScaleComponent(e);var a=i.get("type");for(var o=0,u=Tae;o<u.length;o++){var s=u[o];if(n[s]!==undefined){var l=Z4(a,s);var f=Q4(e,s);if(!l){d5(u5.scalePropertyNotWorkWithScaleType(a,s,e))}else if(f){d5(f)}else{switch(s){case"range":if(ri(n.range)&&w2(e)){return _re(n.range.map((function(e){if(e==="width"||e==="height"){var n=t.getName(e);var r=t.getSignalName.bind(t);return hae.fromName(r,n)}return e})))}return _re(n.range);case"scheme":return _re(Iae(n[s]))}}}}if(e===y1||e===b1){var c=e===y1?"width":"height";var d=r[c];if(X9(d)){if(I4(a)){return _re({step:d.step})}else{d5(u5.stepDropped(c))}}}return wre(Bae(e,t))}function Iae(e){if(H4(e)){return Object.assign({scheme:e.name},zK(e,["name"]))}return{scheme:e}}function Bae(e,t){var n=t.size,r=t.config,i=t.mark,a=t.encoding;var o=t.getSignalName.bind(t);var u=m8(a[e]).type;var s=t.getScaleComponent(e);var l=s.get("type");var f=t.specifiedScales[e],c=f.domain,d=f.domainMid;switch(e){case y1:case b1:{if(IK(["point","band"],l)){if(e===y1&&!n.width){var h=r7(r.view,"width");if(X9(h)){return h}}else if(e===b1&&!n.height){var p=r7(r.view,"height");if(X9(p)){return p}}}var v=zae(e);var g=t.getName(v);if(e===b1&&B4(l)){return[hae.fromName(o,g),0]}else{return[0,hae.fromName(o,g)]}}case T1:{var m=t.component.scales[e].get("zero");var y=Wae(i,m,r);var b=$ae(i,n,t,r);if(q4(l)){return qae(y,b,Uae(l,r,c,e))}else{return[y,b]}}case E1:return[0,Math.PI*2];case z1:return[0,360];case w1:{return[0,new hae((function(){var e=t.getSignalName("width");var n=t.getSignalName("height");return"min("+e+","+n+")/2"}))]}case I1:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case B1:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case N1:return"symbol";case M1:case j1:case F1:if(l==="ordinal"){return u==="nominal"?"category":"ordinal"}else{if(d!==undefined){return"diverging"}else{return i==="rect"||i==="geoshape"?"heatmap":"ramp"}}case R1:case P1:case L1:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}function Uae(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":if(n!==undefined&&ri(n)){return n.length+1}else{d5(u5.domainRequiredForThresholdScale(r));return 3}}}function qae(e,t,n){var r=function(){var r=G5(t)?t.signal:t;var i=G5(e)?e.signal:e;var a="("+r+" - "+i+") / ("+n+" - 1)";return"sequence("+i+", "+r+" + "+a+", "+a+")"};if(G5(t)){return new hae(r)}else{return{signal:r()}}}function Wae(e,t,n){if(t){if(G5(t)){return{signal:t.signal+" ? 0 : "+Wae(e,false,n)}}else{return 0}}switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(u5.incompatibleChannel("size",e))}var Hae=.95;function $ae(e,t,n,r){var i={x:Pae(n,"x"),y:Pae(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==undefined){return r.scale.maxBandSize}var a=Gae(t,i,r.view);if(la(a)){return a-1}else{return new hae((function(){return a.signal+" - 1"}))}}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize){return r.scale.maxSize}var o=Gae(t,i,r.view);if(la(o)){return Math.pow(Hae*o,2)}else{return new hae((function(){return"pow("+Hae+" * "+o.signal+", 2)"}))}}}throw new Error(u5.incompatibleChannel("size",e))}function Gae(e,t,n){var r=X9(e.width)?e.width.step:n7(n,"width");var i=X9(e.height)?e.height.step:n7(n,"height");if(t.x||t.y){return new hae((function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:i];return"min("+e.join(", ")+")"}))}return Math.min(r,i)}function Vae(e,t){if(poe(e)){Yae(e,t)}else{Zae(e,t)}}function Yae(e,t){var n=e.component.scales;var r=e.config,i=e.encoding,a=e.markDef,o=e.specifiedScales;for(var u=0,s=XK(n);u<s.length;u++){var l=s[u];var f=o[l];var c=n[l];var d=e.getScaleComponent(l);var h=m8(i[l]);var p=f[t];var v=d.get("type");var g=Z4(v,t);var m=Q4(l,t);if(p!==undefined){if(!g){d5(u5.scalePropertyNotWorkWithScaleType(v,t,l))}else if(m){d5(m)}}if(g&&m===undefined){if(p!==undefined){c.copyKeyFromObject(t,f)}else{var y=Xae(t,e,l,h,d.get("type"),d.get("padding"),d.get("paddingInner"),f.domain,a,r);if(y!==undefined){c.set(t,y,false)}}}}}function Xae(e,t,n,r,i,a,o,u,s,l){var f=l.scale;var c=r.type;switch(e){case"bins":return q6(r)?Qae(t,r):undefined;case"interpolate":return Kae(n,c);case"nice":return eoe(i,n,r);case"padding":return toe(n,i,f,r,s,l.bar);case"paddingInner":return noe(a,n,s.type,f);case"paddingOuter":return roe(a,n,i,s.type,o,f);case"reverse":{var d=q6(r)?r.sort:undefined;return ioe(i,d,n,f)}case"zero":return aoe(n,r,u,s,i)}return f[e]}function Jae(e){if(poe(e)){Rae(e)}else{Zae(e,"range")}}function Zae(e,t){var n=e.component.scales;for(var r=0,i=e.children;r<i.length;r++){var a=i[r];if(t==="range"){Jae(a)}else{Vae(a,t)}}for(var o=0,u=XK(n);o<u.length;o++){var s=u[o];var l=void 0;for(var f=0,c=e.children;f<c.length;f++){var a=c[f];var d=a.component.scales[s];if(d){var h=d.getWithExplicit(t);l=Ore(l,h,t,"scale",kre((function(e,n){switch(t){case"range":if(e.step&&n.step){return e.step-n.step}return 0}return 0})))}}n[s].setWithExplicit(t,l)}}function Qae(e,t){var n=t.bin;if(L2(n)){var r=yie(e,t.field,n);return new hae((function(){return e.getSignalName(r)}))}else if(I2(n)&&B2(n)&&n.step!==undefined){return{step:n.step}}return undefined}function Kae(e,t){if(IK([M1,j1,F1],e)&&t!=="nominal"){return"hcl"}return undefined}function eoe(e,t,n){var r;if(((r=g8(n))===null||r===void 0?void 0:r.bin)||IK([w4.TIME,w4.UTC],e)){return undefined}return IK([y1,b1],t)?true:undefined}function toe(e,t,n,r,i,a){if(IK([y1,b1],e)){if(U4(t)){if(n.continuousPadding!==undefined){return n.continuousPadding}var o=i.type,u=i.orient;if(o==="bar"&&!(q6(r)&&(r.bin||r.timeUnit))){if(u==="vertical"&&e==="x"||u==="horizontal"&&e==="y"){return a.continuousBandSize}}}if(t===w4.POINT){return n.pointPadding}}return undefined}function noe(e,t,n,r){if(e!==undefined){return undefined}if(IK([y1,b1],t)){var i=r.bandPaddingInner,a=r.barBandPaddingInner,o=r.rectBandPaddingInner;return l0(i,n==="bar"?a:o)}return undefined}function roe(e,t,n,r,i,a){if(e!==undefined){return undefined}if(IK([y1,b1],t)){if(n===w4.BAND){var o=a.bandPaddingOuter;return l0(o,G5(i)?{signal:i.signal+"/2"}:i/2)}}return undefined}function ioe(e,t,n,r){if(n==="x"&&r.xReverse!==undefined){if(B4(e)&&t==="descending"){if(G5(r.xReverse)){return{signal:"!"+r.xReverse.signal}}else{return!r.xReverse}}return r.xReverse}if(B4(e)&&t==="descending"){return true}return undefined}function aoe(e,t,n,r,i){var a=!!n&&n!=="unaggregated";if(a){if(B4(i)){if(ri(n)){var o=n[0];var u=n[n.length-1];if(o<=0&&u>=0){return true}}return false}}if(e==="size"&&t.type==="quantitative"&&!q4(i)){return true}if(!(q6(t)&&t.bin)&&IK([y1,b1,E1,w1],e)){var s=r.orient,l=r.type;if(IK(["bar","area","line","trail"],l)){if(s==="horizontal"&&e==="y"||s==="vertical"&&e==="x"){return false}}return true}return false}function ooe(e,t,n,r){var i=uoe(t,n,r);var a=e.type;if(!j2(t)){return null}if(a!==undefined){if(!e6(t,a)){d5(u5.scaleTypeNotWorkWithChannel(t,a,i));return i}if(q6(n)&&!K4(a,n.type)){d5(u5.scaleTypeNotWorkWithFieldDef(a,i));return i}return a}return i}function uoe(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(n2(e)||R2(e)==="discrete"){if(e==="shape"&&t.type==="ordinal"){d5(u5.discreteChannelCannotEncode(e,"ordinal"))}return"ordinal"}if(IK(["x","y"],e)){if(IK(["rect","bar","image","rule"],n)){return"band"}}else if(n==="arc"&&IK(["theta","radius"],e)){return"band"}if(t.band!==undefined||Z6(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)){return"band"}return"point";case"temporal":if(n2(e)){return"time"}else if(R2(e)==="discrete"){d5(u5.discreteChannelCannotEncode(e,"temporal"));return"ordinal"}else if(q6(t)&&t.timeUnit&&W5(t.timeUnit).utc){return"utc"}return"time";case"quantitative":if(n2(e)){if(q6(t)&&L2(t.bin)){return"bin-ordinal"}return"linear"}else if(R2(e)==="discrete"){d5(u5.discreteChannelCannotEncode(e,"quantitative"));return"ordinal"}return"linear";case"geojson":return undefined}throw new Error(u5.invalidFieldType(t.type))}function soe(e,t){var n=(t===void 0?{}:t).ignoreRange;loe(e);pae(e);for(var r=0,i=X4;r<i.length;r++){var a=i[r];Vae(e,a)}if(!n){Jae(e)}}function loe(e){if(poe(e)){e.component.scales=foe(e)}else{e.component.scales=doe(e)}}function foe(e){var t=e.encoding,n=e.mark;return M2.reduce((function(r,i){var a=m8(t[i]);if(a&&n===R0&&i===N1&&a.type===x4){return r}var o=a&&a["scale"];if(a&&o!==null&&o!==false){o=o!==null&&o!==void 0?o:{};var u=ooe(o,i,a,n);r[i]=new Nae(e.scaleName(i+"",true),{value:u,explicit:o.type===u})}return r}),{})}var coe=kre((function(e,t){return S4(e)-S4(t)}));function doe(e){var t;var n=e.component.scales={};var r={};var i=e.component.resolve;for(var a=0,o=e.children;a<o.length;a++){var u=o[a];loe(u);for(var s=0,l=XK(u.component.scales);s<l.length;s++){var f=l[s];i.scale[f]=(t=i.scale[f])!==null&&t!==void 0?t:yre(f,e);if(i.scale[f]==="shared"){var c=r[f];var d=u.component.scales[f].getWithExplicit("type");if(c){if(O4(c.value,d.value)){r[f]=Ore(c,d,"type","scale",coe)}else{i.scale[f]="independent";delete r[f]}}else{r[f]=d}}}}for(var h=0,p=XK(r);h<p.length;h++){var f=p[h];var v=e.scaleName(f,true);var g=r[f];n[f]=new Nae(v,g);for(var m=0,y=e.children;m<y.length;m++){var u=y[m];var b=u.component.scales[f];if(b){u.renameScale(b.get("name"),v);b.merged=true}}}return n}var hoe=function(){function e(){this.nameMap={}}e.prototype.rename=function(e,t){this.nameMap[e]=t};e.prototype.has=function(e){return this.nameMap[e]!==undefined};e.prototype.get=function(e){while(this.nameMap[e]&&e!==this.nameMap[e]){e=this.nameMap[e]}return e};return e}();function poe(e){return(e===null||e===void 0?void 0:e.type)==="unit"}function voe(e){return(e===null||e===void 0?void 0:e.type)==="facet"}function goe(e){return(e===null||e===void 0?void 0:e.type)==="concat"}function moe(e){return(e===null||e===void 0?void 0:e.type)==="layer"}var yoe=function(){function e(e,t,n,r,i,a,o){var u=this;var s,l;this.type=t;this.parent=n;this.config=i;this.view=o;this.children=[];this.correctDataNames=function(e){if(e.from&&e.from.data){e.from.data=u.lookupDataSource(e.from.data)}if(e.from&&e.from.facet&&e.from.facet.data){e.from.facet.data=u.lookupDataSource(e.from.facet.data)}return e};this.parent=n;this.config=i;this.name=(s=e.name)!==null&&s!==void 0?s:r;this.title=F8(e.title)?{text:e.title}:e.title;this.scaleNameMap=n?n.scaleNameMap:new hoe;this.projectionNameMap=n?n.projectionNameMap:new hoe;this.signalNameMap=n?n.signalNameMap:new hoe;this.data=e.data;this.description=e.description;this.transforms=Nee((l=e.transform)!==null&&l!==void 0?l:[]);this.layout=t==="layer"||t==="unit"?{}:e7(e,t,i);this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:j6(e)||n&&n.component.data.isFaceted&&e.data===undefined},layoutSize:new xre,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?NK(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}Object.defineProperty(e.prototype,"width",{get:function(){return this.getSizeSignalRef("width")},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this.getSizeSignalRef("height")},enumerable:true,configurable:true});e.prototype.parse=function(){this.parseScale();this.parseLayoutSize();this.renameTopLevelLayoutSizeSignal();this.parseSelections();this.parseProjection();this.parseData();this.parseAxesAndHeaders();this.parseLegends();this.parseMarkGroup()};e.prototype.parseScale=function(){soe(this)};e.prototype.parseProjection=function(){fie(this)};e.prototype.renameTopLevelLayoutSizeSignal=function(){if(this.getName("width")!=="width"){this.renameSignal(this.getName("width"),"width")}if(this.getName("height")!=="height"){this.renameSignal(this.getName("height"),"height")}};e.prototype.parseLegends=function(){Yre(this)};e.prototype.assembleGroupStyle=function(){var e,t;if(this.type==="unit"||this.type==="layer"){return(t=(e=this.view)===null||e===void 0?void 0:e.style)!==null&&t!==void 0?t:"cell"}return undefined};e.prototype.assembleEncodeFromView=function(e){var t=Xe(e,["style"]);var n={};for(var r=0,i=XK(t);r<i.length;r++){var a=i[r];var o=t[a];if(o!==undefined){n[a]=N8(o)}}return n};e.prototype.assembleGroupEncodeEntry=function(e){var t=undefined;if(this.view){t=this.assembleEncodeFromView(this.view)}if(!e){if(this.type==="unit"||this.type==="layer"){return Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},t!==null&&t!==void 0?t:{})}}return t};e.prototype.assembleLayout=function(){if(!this.layout){return undefined}var e=this.layout,t=e.spacing,n=Xe(e,["spacing"]);var r=this,i=r.component,a=r.config;var o=fre(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})};e.prototype.assembleDefaultLayout=function(){return{}};e.prototype.assembleHeaderMarks=function(){var e=this.component.layoutHeaders;var t=[];for(var n=0,r=i2;n<r.length;n++){var i=r[n];if(e[i].title){t.push(tre(this,i))}}for(var a=0,o=Kne;a<o.length;a++){var i=o[a];t=t.concat(ire(this,i))}return t};e.prototype.assembleAxes=function(){return One(this.component.axes,this.config)};e.prototype.assembleLegends=function(){return rie(this)};e.prototype.assembleProjections=function(){return aie(this)};e.prototype.assembleTitle=function(){var e,t,n;var r=(e=this.title)!==null&&e!==void 0?e:{},i=r.encoding,a=Xe(r,["encoding"]);var o=Object.assign(Object.assign(Object.assign({},j8(this.config.title).nonMark),a),i?{encode:{update:i}}:{});if(o.text){if(IK(["unit","layer"],this.type)){if(IK(["middle",undefined],o.anchor)){o.frame=(t=o.frame)!==null&&t!==void 0?t:"group"}}else{o.anchor=(n=o.anchor)!==null&&n!==void 0?n:"start"}return XK(o).length>0?o:undefined}return undefined};e.prototype.assembleGroup=function(e){if(e===void 0){e=[]}var t={};e=e.concat(this.assembleSignals());if(e.length>0){t.signals=e}var n=this.assembleLayout();if(n){t.layout=n}t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||voe(this.parent)?Mae(this):[];if(r.length>0){t.scales=r}var i=this.assembleAxes();if(i.length>0){t.axes=i}var a=this.assembleLegends();if(a.length>0){t.legends=a}return t};e.prototype.getName=function(e){return QK((this.name?this.name+"_":"")+e)};e.prototype.requestDataName=function(e){var t;var n=this.getName(e);var r=this.component.data.outputNodeRefCounts;r[n]=((t=r[n])!==null&&t!==void 0?t:0)+1;return n};e.prototype.getSizeSignalRef=function(e){if(voe(this.parent)){var t=gre(e);var n=E2(t);var r=this.component.scales[n];if(r&&!r.merged){var i=r.get("type");var a=r.get("range");if(I4(i)&&V5(a)){var o=r.get("name");var u=Cae(this,n);var s=Dae(u);if(s){var l=t8({aggregate:"distinct",field:s},{expr:"datum"});return{signal:vre(o,r,l)}}else{d5("Unknown field for "+n+". Cannot calculate view size.");return null}}}}return{signal:this.signalNameMap.get(this.getName(e))}};e.prototype.lookupDataSource=function(e){var t=this.component.data.outputNodes[e];if(!t){return e}return t.getSource()};e.prototype.getSignalName=function(e){return this.signalNameMap.get(e)};e.prototype.renameSignal=function(e,t){this.signalNameMap.rename(e,t)};e.prototype.renameScale=function(e,t){this.scaleNameMap.rename(e,t)};e.prototype.renameProjection=function(e,t){this.projectionNameMap.rename(e,t)};e.prototype.scaleName=function(e,t){if(t){return this.getName(e)}if(f2(e)&&j2(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))){return this.scaleNameMap.get(this.getName(e))}return undefined};e.prototype.projectionName=function(e){if(e){return this.getName("projection")}if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))){return this.projectionNameMap.get(this.getName("projection"))}return undefined};e.prototype.getScaleComponent=function(e){if(!this.component.scales){throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().")}var t=this.component.scales[e];if(t&&!t.merged){return t}return this.parent?this.parent.getScaleComponent(e):undefined};e.prototype.getSelectionComponent=function(e,t){var n=this.component.selection[e];if(!n&&this.parent){n=this.parent.getSelectionComponent(e,t)}if(!n){throw new Error(u5.selectionNotFound(t))}return n};return e}();var boe=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.vgField=function(e,t){if(t===void 0){t={}}var n=this.fieldDef(e);if(!n){return undefined}return t8(n,t)};t.prototype.reduceFieldDef=function(e,t){return Z8(this.getMapping(),(function(t,n,r){var i=g8(n);if(i){return e(t,i,r)}return t}),t)};t.prototype.forEachFieldDef=function(e,t){J8(this.getMapping(),(function(t,n){var r=g8(t);if(r){e(r,n)}}),t)};return t}(yoe);var xoe=function(e){Ze(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=NK(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:"value",(o=u[1])!==null&&o!==void 0?o:"density"];return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(h([this.transform.density],(e=this.transform.groupby)!==null&&e!==void 0?e:[]))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"DensityTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.density,n=Xe(e,["density"]);var r=Object.assign({type:"kde",field:t},n);return r};return t}(pte);var _oe=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.filter=n;return r}t.prototype.clone=function(){return new t(null,Object.assign({},this.filter))};t.make=function(e,n){var r=n.config,i=n.mark,a=n.markDef;var o=R8("invalid",a,r);if(o!=="filter"){return null}var u=n.reduceFieldDef((function(e,t,r){var a=j2(r)&&n.getScaleComponent(r);if(a){var o=a.get("type");if(B4(o)&&t.aggregate!=="count"&&!L0(i)){e[t.field]=t}}return e}),{});if(!XK(u).length){return null}return new t(e,u)};t.prototype.dependentFields=function(){return new Set(XK(this.filter))};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"FilterInvalid "+PK(this.filter)};t.prototype.assemble=function(){var e=this;var t=XK(this.filter).reduce((function(t,n){var r=e.filter[n];var i=t8(r,{expr:"datum"});if(r!==null){if(r.type==="temporal"){t.push("(isDate("+i+") || (isValid("+i+") && isFinite(+"+i+")))")}else if(r.type==="quantitative"){t.push("isValid("+i+")");t.push("isFinite(+"+i+")")}}return t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null};return t}(pte);var woe=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;r.transform=NK(n);var i=r.transform,a=i.flatten,o=i.as,u=o===void 0?[]:o;r.transform.as=a.map((function(e,t){var n;return(n=u[t])!==null&&n!==void 0?n:e}));return r}t.prototype.clone=function(){return new t(this.parent,NK(this.transform))};t.prototype.dependentFields=function(){return new Set(this.transform.flatten)};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"FlattenTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.flatten,n=e.as;var r={type:"flatten",fields:t,as:n};return r};return t}(pte);var koe=function(e){Ze(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=NK(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:"key",(o=u[1])!==null&&o!==void 0?o:"value"];return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.dependentFields=function(){return new Set(this.transform.fold)};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"FoldTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.fold,n=e.as;var r={type:"fold",fields:t,as:n};return r};return t}(pte);var Eoe=function(e){Ze(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.fields=n;a.geojson=r;a.signal=i;return a}t.prototype.clone=function(){return new t(null,NK(this.fields),this.geojson,this.signal)};t.parseAll=function(e,n){if(n.component.projection&&!n.component.projection.isFit){return e}var r=0;for(var i=0,a=[[S1,A1],[C1,D1]];i<a.length;i++){var o=a[i];var u=o.map((function(e){var t=m8(n.encoding[e]);return q6(t)?t.field:H6(t)?{expr:""+t.datum}:X6(t)?{expr:""+t["value"]}:undefined}));if(u[0]||u[1]){e=new t(e,u,null,n.getName("geojson_"+r++))}}if(n.channelHasField(N1)){var s=n.typedFieldDef(N1);if(s.type===x4){e=new t(e,null,s.field,n.getName("geojson_"+r++))}}return e};t.prototype.dependentFields=function(){var e;var t=((e=this.fields)!==null&&e!==void 0?e:[]).filter(ai);return new Set(h(this.geojson?[this.geojson]:[],t))};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"GeoJSON "+this.geojson+" "+this.signal+" "+PK(this.fields)};t.prototype.assemble=function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})};return t}(pte);var Ooe=function(e){Ze(t,e);function t(t,n,r,i){var a=e.call(this,t)||this;a.projection=n;a.fields=r;a.as=i;return a}t.prototype.clone=function(){return new t(null,this.projection,NK(this.fields),NK(this.as))};t.parseAll=function(e,n){if(!n.projectionName()){return e}for(var r=0,i=[[S1,A1],[C1,D1]];r<i.length;r++){var a=i[r];var o=a.map((function(e){var t=m8(n.encoding[e]);return q6(t)?t.field:H6(t)?{expr:""+t.datum}:X6(t)?{expr:""+t["value"]}:undefined}));var u=a[0]===C1?"2":"";if(o[0]||o[1]){e=new t(e,n.projectionName(),o,[n.getName("x"+u),n.getName("y"+u)])}}return e};t.prototype.dependentFields=function(){return new Set(this.fields.filter(ai))};t.prototype.producedFields=function(){return new Set(this.as)};t.prototype.hash=function(){return"Geopoint "+this.projection+" "+PK(this.fields)+" "+PK(this.as)};t.prototype.assemble=function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}};return t}(pte);var Aoe=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(h([this.transform.impute,this.transform.key],(e=this.transform.groupby)!==null&&e!==void 0?e:[]))};t.prototype.producedFields=function(){return new Set([this.transform.impute])};t.prototype.processSequence=function(e){var t=e.start,n=t===void 0?0:t,r=e.stop,i=e.step;var a=h([n,r],i?[i]:[]).join(",");return{signal:"sequence("+a+")"}};t.makeFromTransform=function(e,n){return new t(e,n)};t.makeFromEncoding=function(e,n){var r=n.encoding;var i=r.x;var a=r.y;if(q6(i)&&q6(a)){var o=i.impute?i:a.impute?a:undefined;if(o===undefined){return undefined}var u=i.impute?a:a.impute?i:undefined;var s=o.impute,l=s.method,f=s.value,c=s.frame,d=s.keyvals;var h=Q8(n.mark,r);return new t(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},l?{method:l}:{}),f!==undefined?{value:f}:{}),c?{frame:c}:{}),d!==undefined?{keyvals:d}:{}),h.length?{groupby:h}:{}))}return null};t.prototype.hash=function(){return"Impute "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.impute,n=e.key,r=e.keyvals,i=e.method,a=e.groupby,o=e.value,u=e.frame,s=u===void 0?[null,null]:u;var l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:hee(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){var f=Object.assign({type:"window",as:["imputed_"+t+"_value"],ops:[i],fields:[t],frame:s,ignorePeers:false},a?{groupby:a}:{});var c={type:"formula",expr:"datum."+t+" === null ? datum.imputed_"+t+"_value : datum."+t,as:t};return[l,f,c]}else{return[l]}};return t}(pte);var Soe=function(e){Ze(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this,t,n)||this;i.explicit=t;i.implicit=n;i.parseNothing=r;return i}t.prototype.clone=function(){var t=e.prototype.clone.call(this);t.parseNothing=this.parseNothing;return t};return t}(xre);var Doe=function(e){Ze(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=NK(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:n.on,(o=u[1])!==null&&o!==void 0?o:n.loess];return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(h([this.transform.loess,this.transform.on],(e=this.transform.groupby)!==null&&e!==void 0?e:[]))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"LoessTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.loess,n=e.on,r=Xe(e,["loess","on"]);var i=Object.assign({type:"loess",x:n,y:t},r);return i};return t}(pte);var Coe=function(e){Ze(t,e);function t(t,n,r){var i=e.call(this,t)||this;i.transform=n;i.secondary=r;return i}t.prototype.clone=function(){return new t(null,NK(this.transform),this.secondary)};t.make=function(e,n,r,i){var a=n.component.data.sources;var o=r.from;var u=null;if(vee(o)){var s=Zoe(o.data,a);if(!s){s=new wie(o.data);a.push(s)}var l=n.getName("lookup_"+i);u=new vte(s,l,"lookup",n.component.data.outputNodeRefCounts);n.component.data.outputNodes[l]=u}else if(gee(o)){var f=o.selection;r=Object.assign({as:f},r);u=n.getSelectionComponent(QK(f),f).materialized;if(!u){throw new Error(u5.noSameUnitLookup(f))}}return new t(e,r,u.getSource())};t.prototype.dependentFields=function(){return new Set([this.transform.lookup])};t.prototype.producedFields=function(){return new Set(this.transform.as?$i(this.transform.as):this.transform.from.fields)};t.prototype.hash=function(){return"Lookup "+PK({transform:this.transform,secondary:this.secondary})};t.prototype.assemble=function(){var e;if(this.transform.from.fields){e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:$i(this.transform.as)}:{})}else{var t=this.transform.as;if(!ai(t)){d5(u5.NO_FIELDS_NEEDS_AS);t="_lookup"}e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})};return t}(pte);var Moe=function(e){Ze(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=NK(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:"prob",(o=u[1])!==null&&o!==void 0?o:"value"];return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(h([this.transform.quantile],(e=this.transform.groupby)!==null&&e!==void 0?e:[]))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"QuantileTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.quantile,n=Xe(e,["quantile"]);var r=Object.assign({type:"quantile",field:t},n);return r};return t}(pte);var joe=function(e){Ze(t,e);function t(t,n){var r=this;var i,a,o;r=e.call(this,t)||this;r.transform=n;r.transform=NK(n);var u=(i=r.transform.as)!==null&&i!==void 0?i:[undefined,undefined];r.transform.as=[(a=u[0])!==null&&a!==void 0?a:n.on,(o=u[1])!==null&&o!==void 0?o:n.regression];return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.dependentFields=function(){var e;return new Set(h([this.transform.regression,this.transform.on],(e=this.transform.groupby)!==null&&e!==void 0?e:[]))};t.prototype.producedFields=function(){return new Set(this.transform.as)};t.prototype.hash=function(){return"RegressionTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.regression,n=e.on,r=Xe(e,["regression","on"]);var i=Object.assign({type:"regression",x:n,y:t},r);return i};return t}(pte);var Foe=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.addDimensions=function(e){var t;this.transform.groupby=HK(((t=this.transform.groupby)!==null&&t!==void 0?t:[]).concat(e),(function(e){return e}))};t.prototype.producedFields=function(){return undefined};t.prototype.dependentFields=function(){var e;return new Set(h([this.transform.pivot,this.transform.value],(e=this.transform.groupby)!==null&&e!==void 0?e:[]))};t.prototype.hash=function(){return"PivotTransform "+PK(this.transform)};t.prototype.assemble=function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,i=e.limit,a=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==undefined?{limit:i}:{}),a!==undefined?{op:a}:{}),r!==undefined?{groupby:r}:{})};return t}(pte);var Noe=function(e){Ze(t,e);function t(t,n){var r=e.call(this,t)||this;r.transform=n;return r}t.prototype.clone=function(){return new t(null,NK(this.transform))};t.prototype.dependentFields=function(){return new Set};t.prototype.producedFields=function(){return new Set};t.prototype.hash=function(){return"SampleTransform "+PK(this.transform)};t.prototype.assemble=function(){return{type:"sample",size:this.transform.sample}};return t}(pte);function Toe(e){var t=0;function n(r,i){var a,o,u;var s;if(r instanceof wie){if(!r.isGenerator&&!ree(r.data)){e.push(i);var l={name:null,source:i.name,transform:[]};i=l}}if(r instanceof Iie){if(r.parent instanceof wie&&!i.source){i.format=Object.assign(Object.assign({},(s=i.format)!==null&&s!==void 0?s:{}),{parse:r.assembleFormatParse()});(a=i.transform).push.apply(a,r.assembleTransforms(true))}else{(o=i.transform).push.apply(o,r.assembleTransforms())}}if(r instanceof Nie){if(!i.name){i.name="data_"+t++}if(!i.source||i.transform.length>0){e.push(i);r.data=i.name}else{r.data=i.source}for(var f=0,c=r.assemble();f<c.length;f++){var d=c[f];e.push(d)}return}if(r instanceof Eie||r instanceof Oie||r instanceof _oe||r instanceof pne||r instanceof Yne||r instanceof Ooe||r instanceof Eoe||r instanceof Fie||r instanceof Coe||r instanceof Hie||r instanceof Bie||r instanceof koe||r instanceof woe||r instanceof xoe||r instanceof Doe||r instanceof Moe||r instanceof joe||r instanceof $ie||r instanceof Noe||r instanceof Foe){i.transform.push(r.assemble())}if(r instanceof _ie||r instanceof gte||r instanceof Aoe||r instanceof Wie){(u=i.transform).push.apply(u,r.assemble())}if(r instanceof vte){if(i.source&&i.transform.length===0){r.setSource(i.source)}else if(r.parent instanceof vte){r.setSource(i.name)}else{if(!i.name){i.name="data_"+t++}r.setSource(i.name);if(r.numChildren()===1){e.push(i);var l={name:null,source:i.name,transform:[]};i=l}}}switch(r.numChildren()){case 0:if(r instanceof vte&&(!i.source||i.transform.length>0)){e.push(i)}break;case 1:n(r.children[0],i);break;default:{if(!i.name){i.name="data_"+t++}var h=i.name;if(!i.source||i.transform.length>0){e.push(i)}else{h=i.source}for(var p=0,v=r.children;p<v.length;p++){var g=v[p];var l={name:null,source:h,transform:[]};n(g,l)}break}}}return n}function zoe(e){var t=[];var n=Toe(t);for(var r=0,i=e.children;r<i.length;r++){var a=i[r];n(a,{source:e.name,name:null,transform:[]})}return t}function Roe(e,t){var n,r;var i=[];var a=Toe(i);var o=0;for(var u=0,s=e.sources;u<s.length;u++){var l=s[u];if(!l.hasName()){l.dataName="source_"+o++}var f=l.assemble();a(l,f)}for(var c=0,d=i;c<d.length;c++){var h=d[c];if(h.transform.length===0){delete h.transform}}var p=0;for(var v=0,g=i.entries();v<g.length;v++){var m=g[v],y=m[0],h=m[1];if(((n=h.transform)!==null&&n!==void 0?n:[]).length===0&&!h.source){i.splice(p++,0,i.splice(y,1)[0])}}for(var b=0,x=i;b<x.length;b++){var h=x[b];for(var _=0,w=(r=h.transform)!==null&&r!==void 0?r:[];_<w.length;_++){var k=w[_];if(k.type==="lookup"){k.from=e.outputNodes[k.from].getSource()}}}for(var E=0,O=i;E<O.length;E++){var h=O[E];if(h.name in t){h.values=t[h.name]}}return i}function Poe(e){if(e==="top"||e==="left"){return"header"}return"footer"}function Loe(e){for(var t=0,n=i2;t<n.length;t++){var r=n[t];Ioe(e,r)}Uoe(e,"x");Uoe(e,"y")}function Ioe(e,t){var n;var r;var i=e.facet,a=e.config,o=e.child,u=e.component;if(e.channelHasField(t)){var s=i[t];var l=Zne("title",null,a,t);var f=c8(s,a,{allowDisabling:true,includeDefault:l===undefined||!!l});if(o.component.layoutHeaders[t].title){f=ri(f)?f.join(", "):f;f+=" / "+o.component.layoutHeaders[t].title;o.component.layoutHeaders[t].title=null}var c=Zne("labelOrient",s,a,t);var d=(r=s.header)!==null&&r!==void 0?r:{};var h=l0(d.labels,a.header.labels,true);var p=IK(["bottom","right"],c)?"footer":"header";u.layoutHeaders[t]=(n={title:f,facetFieldDef:s},n[p]=t==="facet"?[]:[Boe(e,t,h)],n)}}function Boe(e,t,n){var r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):undefined,axes:[]}}function Uoe(e,t){var n;var r=e.child;if(r.component.axes[t]){var i=e.component,a=i.layoutHeaders,o=i.resolve;o.axis[t]=bre(o,t);if(o.axis[t]==="shared"){var u=t==="x"?"column":"row";var s=a[u];for(var l=0,f=r.component.axes[t];l<f.length;l++){var c=f[l];var d=Poe(c.get("orient"));s[d]=(n=s[d])!==null&&n!==void 0?n:[Boe(e,u,false)];var h=kne(c,"main",e.config,{header:true});if(h){s[d][0].axes.push(h)}c.mainExtracted=true}}}}function qoe(e){Hoe(e);$oe(e,"width");$oe(e,"height")}function Woe(e){Hoe(e);var t=e.layout.columns===1?"width":"childWidth";var n=e.layout.columns===undefined?"height":"childHeight";$oe(e,t);$oe(e,n)}function Hoe(e){for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.parseLayoutSize()}}function $oe(e,t){var n=gre(t);var r=E2(n);var i=e.component.resolve;var a=e.component.layoutSize;var o;for(var u=0,s=e.children;u<s.length;u++){var l=s[u];var f=l.component.layoutSize.getWithExplicit(n);var c=i.scale[r];if(c==="independent"&&f.value==="step"){o=undefined;break}if(o){if(c==="independent"&&o.value!==f.value){o=undefined;break}o=Ore(o,f,n,"")}else{o=f}}if(o){for(var d=0,h=e.children;d<h.length;d++){var l=h[d];e.renameSignal(l.getName(n),e.getName(t));l.component.layoutSize.set(n,"merged",false)}a.setWithExplicit(t,o)}else{a.setWithExplicit(t,{explicit:false,value:undefined})}}function Goe(e){var t=e.size,n=e.component;for(var r=0,i=_2;r<i.length;r++){var a=i[r];var o=g2(a);if(t[o]){var u=t[o];n.layoutSize.set(o,X9(u)?"step":u,true)}else{var s=Voe(e,o);n.layoutSize.set(o,s,false)}}}function Voe(e,t){var n=t==="width"?"x":"y";var r=e.config;var i=e.getScaleComponent(n);if(i){var a=i.get("type");var o=i.get("range");if(I4(a)){var u=r7(r.view,t);if(V5(o)||X9(u)){return"step"}else{return u}}else{return t7(r.view,t)}}else if(e.hasProjection||e.mark==="arc"){return t7(r.view,t)}else{var u=r7(r.view,t);return X9(u)?u.step:u}}function Yoe(e,t,n){return t8(t,Object.assign({suffix:"by_"+t8(e)},n!==null&&n!==void 0?n:{}))}var Xoe=function(e){Ze(t,e);function t(t,n,r,i){var a=e.call(this,t,"facet",n,r,i,t.resolve)||this;a.child=Kue(t.spec,a,a.getName("child"),undefined,i);a.children=[a.child];a.facet=a.initFacet(t.facet);return a}t.prototype.initFacet=function(e){if(!C6(e)){return{facet:y8(e,"facet")}}return Z8(e,(function(e,t,n){if(!IK([v1,g1],n)){d5(u5.incompatibleChannel(n,"facet"));return e}if(t.field===undefined){d5(u5.emptyFieldDef(t,n));return e}e[n]=y8(t,n);return e}),{})};t.prototype.channelHasField=function(e){return!!this.facet[e]};t.prototype.fieldDef=function(e){return this.facet[e]};t.prototype.parseData=function(){this.component.data=eue(this);this.child.parseData()};t.prototype.parseLayoutSize=function(){Hoe(this)};t.prototype.parseSelections=function(){this.child.parseSelections();this.component.selection=this.child.component.selection};t.prototype.parseMarkGroup=function(){this.child.parseMarkGroup()};t.prototype.parseAxesAndHeaders=function(){this.child.parseAxesAndHeaders();Loe(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.child.assembleSelectionTopLevelSignals(e)};t.prototype.assembleSignals=function(){this.child.assembleSignals();return[]};t.prototype.assembleSelectionData=function(e){return this.child.assembleSelectionData(e)};t.prototype.getHeaderLayoutMixins=function(){var e,t,n;var r={};for(var i=0,a=i2;i<a.length;i++){var o=a[i];for(var u=0,s=ere;u<s.length;u++){var l=s[u];var f=this.component.layoutHeaders[o];var c=f[l];var d=f.facetFieldDef;if(d){var h=Zne("titleOrient",d,this.config,o);if(IK(["right","bottom"],h)){var p=Jne(o,h);r.titleAnchor=(e=r.titleAnchor)!==null&&e!==void 0?e:{};r.titleAnchor[p]="end"}}if(c===null||c===void 0?void 0:c[0]){var v=o==="row"?"height":"width";var g=l==="header"?"headerBand":"footerBand";if(o!=="facet"&&!this.child.component.layoutSize.get(v)){r[g]=(t=r[g])!==null&&t!==void 0?t:{};r[g][o]=.5}if(f.title){r.offset=(n=r.offset)!==null&&n!==void 0?n:{};r.offset[o==="row"?"rowTitle":"columnTitle"]=10}}}}return r};t.prototype.assembleDefaultLayout=function(){var e=this.facet,t=e.column,n=e.row;var r=t?this.columnDistinctSignal():n?1:undefined;var i="all";if(!n&&this.component.resolve.scale.x==="independent"){i="none"}else if(!t&&this.component.resolve.scale.y==="independent"){i="none"}return Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})};t.prototype.assembleLayoutSignals=function(){return this.child.assembleLayoutSignals()};t.prototype.columnDistinctSignal=function(){if(this.parent&&this.parent instanceof t){return undefined}else{var e=this.getName("column_domain");return{signal:"length(data('"+e+"'))"}}};t.prototype.assembleGroup=function(n){if(this.parent&&this.parent instanceof t){return Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:t8(this.facet.column,{prefix:"distinct"})}}}}:{}),e.prototype.assembleGroup.call(this,n))}return e.prototype.assembleGroup.call(this,n)};t.prototype.getCardinalityAggregateForChild=function(){var e=[];var n=[];var r=[];if(this.child instanceof t){if(this.child.channelHasField("column")){var i=t8(this.child.facet.column);e.push(i);n.push("distinct");r.push("distinct_"+i)}}else{for(var a=0,o=["x","y"];a<o.length;a++){var u=o[a];var s=this.child.component.scales[u];if(s&&!s.merged){var l=s.get("type");var f=s.get("range");if(I4(l)&&V5(f)){var c=Cae(this.child,u);var d=Dae(c);if(d){e.push(d);n.push("distinct");r.push("distinct_"+d)}else{d5("Unknown field for "+u+". Cannot calculate view size.")}}}}}return{fields:e,ops:n,as:r}};t.prototype.assembleFacet=function(){var e=this.component.data.facetRoot,t=e.name,n=e.data;var r=this.facet,i=r.row,a=r.column;var o=this.getCardinalityAggregateForChild(),u=o.fields,s=o.ops,l=o.as;var f=[];for(var c=0,d=i2;c<d.length;c++){var h=d[c];var p=this.facet[h];if(p){f.push(t8(p));var v=p.bin,g=p.sort;if(L2(v)){f.push(t8(p,{binSuffix:"end"}))}if(S6(g)){var m=g.field,y=g.op,b=y===void 0?k6:y;var x=Yoe(p,g);if(i&&a){u.push(x);s.push("max");l.push(x)}else{u.push(m);s.push(b);l.push(x)}}else if(ri(g)){var x=Xne(p,h);u.push(x);s.push("max");l.push(x)}}}var _=!!i&&!!a;return Object.assign({name:t,data:n,groupby:f},_||u.length>0?{aggregate:Object.assign(Object.assign({},_?{cross:_}:{}),u.length?{fields:u,ops:s,as:l}:{})}:{})};t.prototype.facetSortFields=function(e){var t=this.facet;var n=t[e];if(n){if(S6(n.sort)){return[Yoe(n,n.sort,{expr:"datum"})]}else if(ri(n.sort)){return[Xne(n,e,{expr:"datum"})]}return[t8(n,{expr:"datum"})]}return[]};t.prototype.facetSortOrder=function(e){var t=this.facet;var n=t[e];if(n){var r=n.sort;var i=(S6(r)?r.order:!ri(r)&&r)||"ascending";return[i]}return[]};t.prototype.assembleLabelTitle=function(){var e=this,t=e.facet,n=e.config;if(t.facet){return ore(t.facet,"facet",n)}var r={row:["top","bottom"],column:["left","right"]};for(var i=0,a=Kne;i<a.length;i++){var o=a[i];if(t[o]){var u=Zne("labelOrient",t[o],n,o);if(IK(r[o],u)){return ore(t[o],o,n)}}}return undefined};t.prototype.assembleMarks=function(){var e=this;var t=this.child;var n=this.component.data.facetRoot;var r=zoe(n);var i=t.assembleGroupEncodeEntry(false);var a=this.assembleLabelTitle()||t.assembleTitle();var o=t.assembleGroupStyle();var u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:i2.map((function(t){return e.facetSortFields(t)})).flat(),order:i2.map((function(t){return e.facetSortOrder(t)})).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(Ute(this,[])));return[u]};t.prototype.getMapping=function(){return this.facet};return t}(boe);function Joe(e,t){var n=t.row,r=t.column;if(n&&r){var i=null;for(var a=0,o=[n,r];a<o.length;a++){var u=o[a];if(S6(u.sort)){var s=u.sort,l=s.field,f=s.op,c=f===void 0?k6:f;e=i=new Bie(e,{joinaggregate:[{op:c,field:l,as:Yoe(u,u.sort,{forAs:true})}],groupby:[t8(u)]})}}return i}return null}function Zoe(e,t){var n,r,i,a,o,u,s,l,f,c;for(var d=0,h=t;d<h.length;d++){var p=h[d];var v=p.data;if(e.name&&p.hasName()&&e.name!==p.dataName){continue}if(((n=e["format"])===null||n===void 0?void 0:n.mesh)&&((r=v.format)===null||r===void 0?void 0:r.feature)){continue}if((((i=e["format"])===null||i===void 0?void 0:i.feature)||((a=v.format)===null||a===void 0?void 0:a.feature))&&((o=e["format"])===null||o===void 0?void 0:o.feature)!==((u=v.format)===null||u===void 0?void 0:u.feature)){continue}if((((s=e["format"])===null||s===void 0?void 0:s.mesh)||((l=v.format)===null||l===void 0?void 0:l.mesh))&&((f=e["format"])===null||f===void 0?void 0:f.mesh)!==((c=v.format)===null||c===void 0?void 0:c.mesh)){continue}if(iee(e)&&iee(v)){if(FK(e.values,v.values)){return p}}else if(ree(e)&&ree(v)){if(e.url===v.url){return p}}else if(aee(e)){if(e.name===p.dataName){return p}}}return null}function Qoe(e,t){if(e.data||!e.parent){if(e.data===null){var n=new wie([]);t.push(n);return n}var r=Zoe(e.data,t);if(r){if(!oee(e.data)){r.data.format=qK({},e.data.format,r.data.format)}if(!r.hasName()&&e.data.name){r.dataName=e.data.name}return r}else{var i=new wie(e.data);t.push(i);return i}}else{return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}}function Koe(e,t,n){var r;var i,a;var o=0;for(var u=0,s=t.transforms;u<s.length;u++){var l=s[u];var f=undefined;var c=void 0;if(Aee(l)){c=e=new Yne(e,l);f="derived"}else if(dee(l)){var d=Rie(l);c=e=(i=Iie.makeWithAncestors(e,{},d,n))!==null&&i!==void 0?i:e;e=new pne(e,t,l.filter)}else if(See(l)){c=e=_ie.makeFromTransform(e,l,t);f="number"}else if(Cee(l)){f="date";var h=n.getWithExplicit(l.field);if(h.value===undefined){e=new Iie(e,(r={},r[l.field]=f,r));n.set(l.field,f,false)}c=e=gte.makeFromTransform(e,l)}else if(Mee(l)){c=e=Fie.makeFromTransform(e,l);f="number";if(fne(t)){e=new $ie(e)}}else if(pee(l)){c=e=Coe.make(e,t,l,o++);f="derived"}else if(kee(l)){c=e=new Hie(e,l);f="number"}else if(Eee(l)){c=e=new Bie(e,l);f="number"}else if(jee(l)){c=e=Wie.makeFromTransform(e,l);f="derived"}else if(Fee(l)){c=e=new koe(e,l);f="derived"}else if(Oee(l)){c=e=new woe(e,l);f="derived"}else if(mee(l)){c=e=new Foe(e,l);f="derived"}else if(wee(l)){e=new Noe(e,l)}else if(Dee(l)){c=e=Aoe.makeFromTransform(e,l);f="derived"}else if(yee(l)){c=e=new xoe(e,l);f="derived"}else if(bee(l)){c=e=new Moe(e,l);f="derived"}else if(xee(l)){c=e=new joe(e,l);f="derived"}else if(_ee(l)){c=e=new Doe(e,l);f="derived"}else{d5(u5.invalidTransformIgnored(l));continue}if(c&&f!==undefined){for(var p=0,v=(a=c.producedFields())!==null&&a!==void 0?a:[];p<v.length;p++){var g=v[p];n.set(g,f,false)}}}return e}function eue(e){var t,n,r,i,a,o,u,s,l,f;var c=Qoe(e,e.component.data.sources);var d=e.component.data,h=d.outputNodes,p=d.outputNodeRefCounts;var v=e.parent?e.parent.component.data.ancestorParse.clone():new Soe;var g=e.data;if(oee(g)){if(uee(g)){c=new Oie(c,g.sequence)}else if(lee(g)){c=new Eie(c,g.graticule)}v.parseNothing=true}else if(((t=g===null||g===void 0?void 0:g.format)===null||t===void 0?void 0:t.parse)===null){v.parseNothing=true}c=(n=Iie.makeExplicit(c,e,v))!==null&&n!==void 0?n:c;c=new $ie(c);var m=e.parent&&moe(e.parent);if(poe(e)||voe(e)){if(m){c=(r=_ie.makeFromEncoding(c,e))!==null&&r!==void 0?r:c}}if(e.transforms.length>0){c=Koe(c,e,v)}var y=Lie(e);var b=Pie(e);c=(i=Iie.makeWithAncestors(c,{},Object.assign(Object.assign({},y),b),v))!==null&&i!==void 0?i:c;if(poe(e)){c=Eoe.parseAll(c,e);c=Ooe.parseAll(c,e)}if(poe(e)||voe(e)){if(!m){c=(a=_ie.makeFromEncoding(c,e))!==null&&a!==void 0?a:c}c=(o=gte.makeFromEncoding(c,e))!==null&&o!==void 0?o:c;c=Yne.parseAllForSortIndex(c,e)}var x=e.getName(cee);var _=new vte(c,x,cee,p);h[x]=_;c=_;if(poe(e)){var w=Fie.makeFromEncoding(c,e);if(w){c=w;if(fne(e)){c=new $ie(c)}}c=(u=Aoe.makeFromEncoding(c,e))!==null&&u!==void 0?u:c;c=(s=Wie.makeFromEncoding(c,e))!==null&&s!==void 0?s:c}if(poe(e)){c=(l=_oe.make(c,e))!==null&&l!==void 0?l:c}var k=e.getName(fee);var E=new vte(c,k,fee,p);h[k]=E;c=E;if(poe(e)){yne(e,E)}var O=null;if(voe(e)){var A=e.getName("facet");c=(f=Joe(c,e.facet))!==null&&f!==void 0?f:c;O=new Nie(c,e,A,E.getSource());h[A]=O;c=O}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:p,raw:_,main:E,facetRoot:O,ancestorParse:v})}var tue=function(e){Ze(t,e);function t(t,n,r,i){var a=this;var o,u,s,l;a=e.call(this,t,"concat",n,r,i,t.resolve)||this;if(((u=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||u===void 0?void 0:u.x)==="shared"||((l=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||l===void 0?void 0:l.y)==="shared"){d5(u5.CONCAT_CANNOT_SHARE_AXIS)}a.children=a.getChildren(t).map((function(e,t){return Kue(e,a,a.getName("concat_"+t),undefined,i)}));return a}t.prototype.parseData=function(){this.component.data=eue(this);for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseData()}};t.prototype.parseSelections=function(){this.component.selection={};for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseSelections();for(var r=0,i=XK(n.component.selection);r<i.length;r++){var a=i[r];this.component.selection[a]=n.component.selection[a]}}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxesAndHeaders=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseAxesAndHeaders()}};t.prototype.getChildren=function(e){if(V9(e)){return e.vconcat}else if(Y9(e)){return e.hconcat}return e.concat};t.prototype.parseLayoutSize=function(){Woe(this)};t.prototype.parseAxisGroup=function(){return null};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)};t.prototype.assembleSignals=function(){this.children.forEach((function(e){return e.assembleSignals()}));return[]};t.prototype.assembleLayoutSignals=function(){var e=dre(this);for(var t=0,n=this.children;t<n.length;t++){var r=n[t];e.push.apply(e,r.assembleLayoutSignals())}return e};t.prototype.assembleSelectionData=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)};t.prototype.assembleMarks=function(){return this.children.map((function(e){var t=e.assembleTitle();var n=e.assembleGroupStyle();var r=e.assembleGroupEncodeEntry(false);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))};t.prototype.assembleDefaultLayout=function(){var e=this.layout.columns;return Object.assign(Object.assign({},e!=null?{columns:e}:{}),{bounds:"full",align:"each"})};return t}(yoe);function nue(e){return e===false||e===null}var rue=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},x0),{labelExpr:1,encode:1});var iue=XK(rue);var aue=function(e){Ze(t,e);function t(t,n,r){if(t===void 0){t={}}if(n===void 0){n={}}if(r===void 0){r=false}var i=e.call(this)||this;i.explicit=t;i.implicit=n;i.mainExtracted=r;return i}t.prototype.clone=function(){return new t(NK(this.explicit),NK(this.implicit),this.mainExtracted)};t.prototype.hasAxisPart=function(e){if(e==="axis"){return true}if(e==="grid"||e==="title"){return!!this.get(e)}return!nue(this.get(e))};return t}(xre);function oue(e,t,n){var r;var i=e.encoding,a=e.config;var o=(r=m8(i[t]))!==null&&r!==void 0?r:m8(i[v2(t)]);var u=e.axis(t)||{};var s=u.format,l=u.formatType;var f=m6({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:l,config:a,isUTCScale:e.getScaleComponent(t).get("type")===w4.UTC,omitTimeFormatConfig:true,omitNumberFormatAndEmptyTimeFormat:true});var c=Object.assign(Object.assign({},f?{text:f}:{}),n);c=Object.assign(Object.assign({},c),n);return XK(c).length===0?undefined:c}function uue(e){return _2.reduce((function(t,n){if(e.component.scales[n]){t[n]=[pue(n,e)]}return t}),{})}var sue={bottom:"top",top:"bottom",left:"right",right:"left"};function lue(e){var t;var n=e.component,r=n.axes,i=n.resolve;var a={top:0,bottom:0,right:0,left:0};for(var o=0,u=e.children;o<u.length;o++){var s=u[o];s.parseAxesAndHeaders();for(var l=0,f=XK(s.component.axes);l<f.length;l++){var c=f[l];i.axis[c]=bre(e.component.resolve,c);if(i.axis[c]==="shared"){r[c]=fue(r[c],s.component.axes[c]);if(!r[c]){i.axis[c]="independent";delete r[c]}}}}for(var d=0,h=[y1,b1];d<h.length;d++){var c=h[d];for(var p=0,v=e.children;p<v.length;p++){var s=v[p];if(!s.component.axes[c]){continue}if(i.axis[c]==="independent"){r[c]=((t=r[c])!==null&&t!==void 0?t:[]).concat(s.component.axes[c]);for(var g=0,m=s.component.axes[c];g<m.length;g++){var y=m[g];var b=y.getWithExplicit("orient"),x=b.value,_=b.explicit;if(a[x]>0&&!_){var w=sue[x];if(a[x]>a[w]){y.set("orient",w,false)}}a[x]++}}delete s.component.axes[c]}if(i.axis[c]==="independent"&&r[c]&&r[c].length>1){for(var k=0,E=r[c];k<E.length;k++){var O=E[k];if(!!O.get("grid")&&!O.explicit.grid){O.implicit.grid=false}}}}}function fue(e,t){if(e){if(e.length!==t.length){return undefined}var n=e.length;for(var r=0;r<n;r++){var i=e[r];var a=t[r];if(!!i!==!!a){return undefined}else if(i&&a){var o=i.getWithExplicit("orient");var u=a.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value){return undefined}else{e[r]=cue(i,a)}}}}else{return t.map((function(e){return e.clone()}))}return e}function cue(e,t){var n=function(n){var r=Ore(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(function(e,t){switch(n){case"title":return W8(e,t);case"gridScale":return{explicit:e.explicit,value:l0(e.value,t.value)}}return Ere(e,t,n,"axis")}));e.setWithExplicit(n,r)};for(var r=0,i=iue;r<i.length;r++){var a=i[r];n(a)}return e}function due(e,t,n,r,i){if(t==="disable"){return n!==undefined}n=n||{};switch(t){case"titleAngle":case"labelAngle":return e===p0(n[t]);case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===$ne(r,i)){return true}}return e===n[t]}var hue=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function pue(e,t){var n,r,i;var a=t.axis(e);var o=new aue;var u=m8(t.encoding[e]);var s=t.mark,l=t.config;var f=(a===null||a===void 0?void 0:a.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||Wne(e);var c=t.getScaleComponent(e).get("type");var d=jne(e,c,f,t.config);if(a!==undefined&&!a||Nne("disable",l,a===null||a===void 0?void 0:a.style,d).configValue){o.set("disable",true,a!==undefined&&!a);return o}a=a||{};var h=Pne(t,a,e,u,d);var p={fieldOrDatumDef:u,axis:a,channel:e,model:t,scaleType:c,orient:f,labelAngle:h,mark:s,config:l};for(var v=0,g=iue;v<g.length;v++){var m=g[v];var y=m in Tne?Tne[m](p):w0(m)?a[m]:undefined;var b=y!==undefined;var x=due(y,m,a,t,e);if(b&&x){o.set(m,y,x)}else{var _=w0(m)&&m!=="values"?Nne(m,t.config,a.style,d):{},w=_.configValue,k=w===void 0?undefined:w,E=_.configFrom,O=E===void 0?undefined:E;var A=k!==undefined;if(b&&!A){o.set(m,y,x)}else if(!(O==="vgAxisConfig")||hue.has(m)&&A||m0(k)||G5(k)){o.set(m,k,false)}}}var S=(i=a.encoding)!==null&&i!==void 0?i:{};var D=y0.reduce((function(n,r){var i;if(!o.hasAxisPart(r)){return n}var a=mre((i=S[r])!==null&&i!==void 0?i:{},t);var u=r==="labels"?oue(t,e,a):a;if(u!==undefined&&XK(u).length>0){n[r]={update:u}}return n}),{});if(XK(D).length>0){o.set("encode",D,!!a.encoding||a.labelAngle!==undefined)}return o}function vue(e){var t=e.encoding,n=e.size;for(var r=0,i=_2;r<i.length;r++){var a=i[r];var o=g2(a);if(X9(n[o])){if($6(t[a])){delete n[o];d5(u5.stepDropped(o))}}}return n}function gue(e,t,n,r){var i=r.graticule;var a=U0(e)?Object.assign({},e):{type:e};var o=R8("orient",a,n);a.orient=xue(a.type,t,o);if(o!==undefined&&o!==a.orient){d5(u5.orientOverridden(a.orient,o))}if(a.type==="bar"&&a.orient){var u=R8("cornerRadiusEnd",a,n);if(u!==undefined){var s=a.orient==="horizontal"&&t.x2||a.orient==="vertical"&&t.y2?["cornerRadius"]:J0[a.orient];for(var l=0,f=s;l<f.length;l++){var c=f[l];a[c]=u}if(a.cornerRadiusEnd!==undefined){delete a.cornerRadiusEnd}}}var d=R8("opacity",a,n);if(d===undefined){a.opacity=yue(a.type,t)}var h=a.filled;if(h===undefined){a.filled=i?false:bue(a,n)}var p=R8("cursor",a,n);if(p===undefined){a.cursor=mue(a,t,n)}return a}function mue(e,t,n){if(t.href||e.href||R8("href",e,n)){return"pointer"}return e.cursor}function yue(e,t){if(IK([D0,F0,T0,z0],e)){if(!$8(t)){return.7}}return undefined}function bue(e,t){var n=P8("filled",e,t);var r=e.type;return l0(n,r!==D0&&r!==S0&&r!==M0)}function xue(e,t,n){switch(e){case D0:case T0:case z0:case j0:case C0:case A0:return undefined}var r=t.x,i=t.y,a=t.x2,o=t.y2;switch(e){case O0:if(q6(r)&&(I2(r.bin)||q6(i)&&i.aggregate&&!r.aggregate)){return"vertical"}if(q6(i)&&(I2(i.bin)||q6(r)&&r.aggregate&&!i.aggregate)){return"horizontal"}if(o||a){if(n){return n}if(!a){if(q6(r)&&r.type===g4&&!L2(r.bin)||G6(r)){return"horizontal"}}if(!o){if(q6(i)&&i.type===g4&&!L2(i.bin)||G6(i)){return"vertical"}}}case M0:if(a&&!(q6(r)&&I2(r.bin))&&o&&!(q6(i)&&I2(i.bin))){return undefined}case E0:if(o){if(q6(i)&&I2(i.bin)){return"horizontal"}else{return"vertical"}}else if(a){if(q6(r)&&I2(r.bin)){return"vertical"}else{return"horizontal"}}else if(e===M0){if(r&&!i){return"vertical"}else if(i&&!r){return"horizontal"}}case S0:case F0:{var u=$6(r);var s=$6(i);if(u&&!s){return e!=="tick"?"horizontal":"vertical"}else if(!u&&s){return e!=="tick"?"vertical":"horizontal"}else if(u&&s){var l=r;var f=i;var c=l.type===y4;var d=f.type===y4;if(c&&!d){return e!=="tick"?"vertical":"horizontal"}else if(!c&&d){return e!=="tick"?"horizontal":"vertical"}if(!l.aggregate&&f.aggregate){return e!=="tick"?"vertical":"horizontal"}else if(l.aggregate&&!f.aggregate){return e!=="tick"?"horizontal":"vertical"}if(n){return n}return"vertical"}else{if(n){return n}return undefined}}}return"vertical"}var _ue={vgMark:"arc",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),qee("x",e,{defaultPos:"mid"})),qee("y",e,{defaultPos:"mid"})),Kee(e,"radius","arc")),Kee(e,"theta","arc"))}};var wue={vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Yee("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),Yee("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),lte(e))}};var kue={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Kee(e,"x","bar")),Kee(e,"y","bar"))}};var Eue={vgMark:"shape",encodeEntry:function(e){return Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding;var n=t.shape;var r=Object.assign({type:"geoshape",projection:e.projectionName()},n&&q6(n)&&n.type===x4?{field:t8(n,{expr:"datum"})}:{});return[r]}};var Oue={vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Kee(e,"x","image")),Kee(e,"y","image")),Pee(e,"url"))}};var Aue={vgMark:"line",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),qee("x",e,{defaultPos:"mid"})),qee("y",e,{defaultPos:"mid"})),zee("size",e,{vgChannel:"strokeWidth"})),lte(e))}};var Sue={vgMark:"trail",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),qee("x",e,{defaultPos:"mid"})),qee("y",e,{defaultPos:"mid"})),zee("size",e)),lte(e))}};function Due(e,t){var n=e.config;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),qee("x",e,{defaultPos:"mid"})),qee("y",e,{defaultPos:"mid"})),zee("size",e)),zee("angle",e)),Cue(e,n,t))}function Cue(e,t,n){if(n){return{shape:{value:n}}}return zee("shape",e)}var Mue={vgMark:"symbol",encodeEntry:function(e){return Due(e)}};var jue={vgMark:"symbol",encodeEntry:function(e){return Due(e,"circle")}};var Fue={vgMark:"symbol",encodeEntry:function(e){return Due(e,"square")}};var Nue={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Kee(e,"x","rect")),Kee(e,"y","rect"))}};var Tue={vgMark:"rule",encodeEntry:function(e){var t=e.markDef;var n=t.orient;if(!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude){return{}}return Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Yee("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),Yee("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),zee("size",e,{vgChannel:"strokeWidth"}))}};var zue={vgMark:"text",encodeEntry:function(e){var t=e.config,n=e.encoding;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),qee("x",e,{defaultPos:"mid"})),qee("y",e,{defaultPos:"mid"})),Pee(e)),zee("size",e,{vgChannel:"fontSize"})),zee("angle",e)),cte("align",Rue(e.markDef,n,t))),cte("baseline",Pue(e.markDef,n,t))),qee("radius",e,{defaultPos:null,isMidPoint:true})),qee("theta",e,{defaultPos:null,isMidPoint:true}))}};function Rue(e,t,n){var r=R8("align",e,n);if(r===undefined){return"center"}return undefined}function Pue(e,t,n){var r=R8("baseline",e,n);if(r===undefined){return"middle"}return undefined}var Lue={vgMark:"rect",encodeEntry:function(e){var t;var n=e.config,r=e.markDef;var i=r.orient;var a=i==="horizontal"?"width":"height";var o=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ate(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),qee("x",e,{defaultPos:"mid",vgChannel:"xc"})),qee("y",e,{defaultPos:"mid",vgChannel:"yc"})),zee("size",e,{defaultValue:Iue(e),vgChannel:a})),(t={},t[o]=N8(R8("thickness",r,n)),t))}};function Iue(e){var t;var n=e.config,r=e.markDef;var i=r.orient;var a=i==="horizontal"?"width":"height";var o=e.getScaleComponent(i==="horizontal"?"x":"y");var u=(t=R8("size",r,n,{vgChannel:a}))!==null&&t!==void 0?t:n.tick.bandSize;if(u!==undefined){return u}else{var s=o?o.get("range"):undefined;if(s&&V5(s)&&la(s.step)){return s.step*3/4}var l=n7(n.view,a);return l*3/4}}var Bue={arc:_ue,area:wue,bar:kue,circle:jue,geoshape:Eue,image:Oue,line:Aue,point:Mue,rect:Nue,rule:Tue,square:Fue,text:zue,tick:Lue,trail:Sue};function Uue(e){if(IK([S0,E0,N0],e.mark)){return Wue(e)}else if(IK([O0],e.mark)){return $ue(e)}else{return Vue(e)}}var que="faceted_path_";function Wue(e){var t=Q8(e.mark,e.encoding);var n=Vue(e,{fromPrefix:t.length>0?que:""});if(t.length>0){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:que+e.requestDataName(fee),data:e.requestDataName(fee),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]}else{return n}}var Hue="stack_group_";function $ue(e){var t=K5.some((function(t){return R8(t,e.markDef,e.config)}));if(e.stack&&!e.fieldDef("size")&&t){var n=Vue(e,{fromPrefix:Hue})[0];var r=e.scaleName(e.stack.fieldChannel);var i=function(t){if(t===void 0){t={}}return e.vgField(e.stack.fieldChannel,t)};var a=function(e,t){var n=[i({prefix:"min",suffix:"start",expr:t}),i({prefix:"max",suffix:"start",expr:t}),i({prefix:"min",suffix:"end",expr:t}),i({prefix:"max",suffix:"end",expr:t})];return e+"("+n.map((function(e){return"scale('"+r+"',"+e+")"})).join(",")+")"};var o=void 0;var u=void 0;if(e.stack.fieldChannel==="x"){o=Object.assign(Object.assign({},TK(n.encode.update,h(["y","yc","y2","height"],K5))),{x:{signal:a("min","datum")},x2:{signal:a("max","datum")},clip:{value:true}});u={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}};n.encode.update=Object.assign(Object.assign({},zK(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})}else{o=Object.assign(Object.assign({},TK(n.encode.update,["x","xc","x2","width"])),{y:{signal:a("min","datum")},y2:{signal:a("max","datum")},clip:{value:true}});u={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}};n.encode.update=Object.assign(Object.assign({},zK(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}})}for(var s=0,l=K5;s<l.length;s++){var f=l[s];var c=P8(f,e.markDef,e.config);if(n.encode.update[f]){o[f]=n.encode.update[f];delete n.encode.update[f]}else if(c){o[f]={value:c}}if(c){n.encode.update[f]={value:0}}}var d=e.fieldDef(e.stack.groupbyChannel);var p=t8(d)?[t8(d)]:[];if((d===null||d===void 0?void 0:d.bin)||(d===null||d===void 0?void 0:d.timeUnit)){p.push(t8(d,{binSuffix:"end"}))}var v=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"];o=v.reduce((function(t,r){var i,a;if(n.encode.update[r]){return Object.assign(Object.assign({},t),(i={},i[r]=n.encode.update[r],i))}else{var o=P8(r,e.markDef,e.config);if(o!==undefined){return Object.assign(Object.assign({},t),(a={},a[r]={value:o},a))}else{return t}}}),o);if(o.stroke){o.strokeForeground={value:true};o.strokeOffset={value:0}}return[{type:"group",from:{facet:{data:e.requestDataName(fee),name:Hue+e.requestDataName(fee),groupby:p,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:u},marks:[n]}]}]}else{return Vue(e)}}function Gue(e){var t=e.encoding,n=e.stack,r=e.mark,i=e.markDef,a=e.config;var o=t.order;if(!ri(o)&&X6(o)&&LK(o.value)||!o&&LK(R8("order",i,a))){return undefined}else if((ri(o)||q6(o))&&!n){return B8(o,{expr:"datum"})}else if(L0(r)){var u=i.orient==="horizontal"?"y":"x";var s=t[u];if(q6(s)){var l=s.sort;if(ri(l)){return{field:t8(s,{prefix:u,suffix:"sort_index",expr:"datum"})}}else if(S6(l)){return{field:t8({aggregate:$8(e.encoding)?l.op:undefined,field:l.field},{expr:"datum"})}}else if(A6(l)){var f=e.fieldDef(l.encoding);return{field:t8(f,{expr:"datum"}),order:l.order}}else{return{field:t8(s,{binSuffix:e.stack&&e.stack.impute?"mid":undefined,expr:"datum"})}}}return undefined}return undefined}function Vue(e,t){if(t===void 0){t={fromPrefix:""}}var n=e.mark;var r=l0(e.markDef.clip,Yue(e),Xue(e));var i=z8(e.markDef);var a=e.encoding.key;var o=Gue(e);var u=Jue(e);var s=Bue[n].postEncodingTransform?Bue[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Bue[n].vgMark},r?{clip:true}:{}),i?{style:i}:{}),a?{key:a.field}:{}),o?{sort:o}:{}),u?u:{}),{from:{data:t.fromPrefix+e.requestDataName(fee)},encode:{update:Bue[n].encodeEntry(e)}}),s?{transform:s}:{})]}function Yue(e){var t=e.getScaleComponent("x");var n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?true:undefined}function Xue(e){var t=e.component.projection;return t&&!t.isFit?true:undefined}function Jue(e){if(!e.component.selection)return null;var t=XK(e.component.selection).length;var n=t;var r=e.parent;while(r&&n===0){n=XK(r.component.selection).length;r=r.parent}return n?{interactive:t>0}:null}var Zue=function(e){Ze(t,e);function t(t,n,r,i,a){if(i===void 0){i={}}var o=this;var u,s;o=e.call(this,t,"unit",n,r,a,undefined,J9(t)?t.view:undefined)||this;o.specifiedScales={};o.specifiedAxes={};o.specifiedLegends={};o.specifiedProjection={};o.selection={};o.children=[];var l=U0(t.mark)?t.mark.type:t.mark;o.markDef=gue(t.mark,(u=t.encoding)!==null&&u!==void 0?u:{},a,{graticule:t.data&&lee(t.data)});var f=o.encoding=Y8((s=t.encoding)!==null&&s!==void 0?s:{},o.markDef);o.size=vue({encoding:f,size:J9(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i});o.stack=M7(l,f);o.specifiedScales=o.initScales(l,f);o.specifiedAxes=o.initAxes(f);o.specifiedLegends=o.initLegend(f);o.specifiedProjection=t.projection;o.selection=t.selection;return o}Object.defineProperty(t.prototype,"hasProjection",{get:function(){var e=this.encoding;var t=this.mark===R0;var n=e&&e2.some((function(t){return V6(e[t])}));return t||n},enumerable:true,configurable:true});t.prototype.scaleDomain=function(e){var t=this.specifiedScales[e];return t?t.domain:undefined};t.prototype.axis=function(e){return this.specifiedAxes[e]};t.prototype.legend=function(e){return this.specifiedLegends[e]};t.prototype.initScales=function(e,t){return M2.reduce((function(e,n){var r;var i=m8(t[n]);if(i){e[n]=(r=i.scale)!==null&&r!==void 0?r:{}}return e}),{})};t.prototype.initAxes=function(e){return[y1,b1].reduce((function(t,n){var r=e[n];if(V6(r)||n===y1&&V6(e.x2)||n===b1&&V6(e.y2)){var i=V6(r)?r.axis:undefined;t[n]=i?Object.assign({},i):i}return t}),{})};t.prototype.initLegend=function(e){return A2.reduce((function(t,n){var r=m8(e[n]);if(r&&D2(n)){var i=r.legend;t[n]=i?Object.assign({},i):i}return t}),{})};t.prototype.parseData=function(){this.component.data=eue(this)};t.prototype.parseLayoutSize=function(){Goe(this)};t.prototype.parseSelections=function(){this.component.selection=vne(this,this.selection)};t.prototype.parseMarkGroup=function(){this.component.mark=Uue(this)};t.prototype.parseAxesAndHeaders=function(){this.component.axes=uue(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return qte(this,e)};t.prototype.assembleSignals=function(){return h(Ene(this),Bte(this,[]))};t.prototype.assembleSelectionData=function(e){return Wte(this,e)};t.prototype.assembleLayout=function(){return null};t.prototype.assembleLayoutSignals=function(){return dre(this)};t.prototype.assembleMarks=function(){var e;var t=(e=this.component.mark)!==null&&e!==void 0?e:[];if(!this.parent||!moe(this.parent)){t=Hte(this,t)}return t.map(this.correctDataNames)};t.prototype.getMapping=function(){return this.encoding};Object.defineProperty(t.prototype,"mark",{get:function(){return this.markDef.type},enumerable:true,configurable:true});t.prototype.channelHasField=function(e){return H8(this.encoding,e)};t.prototype.fieldDef=function(e){var t=this.encoding[e];return g8(t)};t.prototype.typedFieldDef=function(e){var t=this.fieldDef(e);if(Y6(t)){return t}return null};return t}(boe);var Que=function(e){Ze(t,e);function t(n,r,i,a,o){var u=e.call(this,n,"layer",r,i,o,n.resolve,n.view)||this;var s=Object.assign(Object.assign(Object.assign({},a),n.width?{width:n.width}:{}),n.height?{height:n.height}:{});u.children=n.layer.map((function(e,n){if(x7(e)){return new t(e,u,u.getName("layer_"+n),s,o)}else if(n1(e)){return new Zue(e,u,u.getName("layer_"+n),s,o)}throw new Error(u5.invalidSpec(e))}));return u}t.prototype.parseData=function(){this.component.data=eue(this);for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseData()}};t.prototype.parseLayoutSize=function(){qoe(this)};t.prototype.parseSelections=function(){this.component.selection={};for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseSelections();for(var r=0,i=XK(n.component.selection);r<i.length;r++){var a=i[r];this.component.selection[a]=n.component.selection[a]}}};t.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){var n=t[e];n.parseMarkGroup()}};t.prototype.parseAxesAndHeaders=function(){lue(this)};t.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)};t.prototype.assembleSignals=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleSignals())}),Ene(this))};t.prototype.assembleLayoutSignals=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLayoutSignals())}),dre(this))};t.prototype.assembleSelectionData=function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)};t.prototype.assembleTitle=function(){var t=e.prototype.assembleTitle.call(this);if(t){return t}for(var n=0,r=this.children;n<r.length;n++){var i=r[n];t=i.assembleTitle();if(t){return t}}return undefined};t.prototype.assembleLayout=function(){return null};t.prototype.assembleMarks=function(){return $te(this,this.children.flatMap((function(e){return e.assembleMarks()})))};t.prototype.assembleLegends=function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLegends())}),rie(this))};return t}(yoe);function Kue(e,t,n,r,i){if(j6(e)){return new Xoe(e,t,n,i)}else if(x7(e)){return new Que(e,t,n,r,i)}else if(n1(e)){return new Zue(e,t,n,r,i)}else if($9(e)){return new tue(e,t,n,i)}throw new Error(u5.invalidSpec(e))}function ese(e,t){if(t===void 0){t={}}if(t.logger){f5(t.logger)}if(t.fieldTitle){l8(t.fieldTitle)}if(t.formatTypes){p6(t.formatTypes)}try{var n=h7(ki(t.config,e.config));var r=Y7(e,n);var i=Kue(r,null,"",undefined,n);i.parse();dae(i.component.data,i);var a=nse(i,tse(e,r.autosize,n,i),e.datasets,e.usermeta);return{spec:a,normalized:r}}finally{if(t.logger){c5()}if(t.fieldTitle){f8()}}}function tse(e,t,n,r){var i=r.component.layoutSize.get("width");var a=r.component.layoutSize.get("height");if(t===undefined){t={type:"pad"}}else if(ai(t)){t={type:t}}if(i&&a&&K7(t.type)){if(i==="step"&&a==="step"){d5(u5.droppingFit());t.type="pad"}else if(i==="step"||a==="step"){var o=i==="step"?"width":"height";d5(u5.droppingFit(E2(o)));var u=o==="width"?"height":"width";t.type=eee(u)}}return Object.assign(Object.assign(Object.assign({},XK(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),nee(n)),nee(e))}function nse(e,t,n,r){if(n===void 0){n={}}var i=e.config?m7(e.config):undefined;var a=[].concat(e.assembleSelectionData([]),Roe(e.component.data,n));var o=e.assembleProjections();var u=e.assembleTitle();var s=e.assembleGroupStyle();var l=e.assembleGroupEncodeEntry(true);var f=e.assembleLayoutSignals();f=f.filter((function(e){if((e.name==="width"||e.name==="height")&&e.value!==undefined){t[e.name]=+e.value;return false}return true}));return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),u?{title:u}:{}),s?{style:s}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup(h(f,e.assembleSelectionTopLevelSignals([])))),i?{config:i}:{}),r?{usermeta:r}:{})}var rse=function(e){Ze(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.mapUnit=function(e,t){var n=t.config;if(e.encoding){var r=e.encoding,i=e.transform;var a=G8(r,n),o=a.bins,u=a.timeUnits,s=a.aggregate,l=a.groupby,f=a.encoding;var c=h(i?i:[],o,u,s.length===0?[]:[{aggregate:s,groupby:l}]);return Object.assign(Object.assign(Object.assign({},e),c.length>0?{transform:c}:{}),{encoding:f})}else{return e}};return t}(k7);var ise=new rse;function ase(e,t){return ise.map(e,{config:t})}var ose=kK.version;var use=Object.freeze({__proto__:null,normalize:Y7,version:ose,compile:ese,extractTransforms:ase});var sse=_e((function(e,t){Object.defineProperty(t,"__esModule",{value:true});function n(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g;var n=t.exec(e).slice(1,3),r=n[0],i=n[1];return{library:r,version:i}}t.default=n}));var lse=xe(sse);var fse="vega-themes";var cse="2.8.3";var dse="Themes for stylized Vega and Vega-Lite visualizations.";var hse=["vega","vega-lite","themes","style"];var pse="BSD-3-Clause";var vse={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"};var gse=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}];var mse="build/vega-themes.js";var yse="build/src/index.js";var bse="build/vega-themes.min.js";var xse="build/vega-themes.min.js";var _se="build/src/index.d.ts";var wse={type:"git",url:"https://github.com/vega/vega-themes.git"};var kse={prepare:"beemo create-config --silent",clean:"rm -rf build examples/build",prettierbase:"beemo prettier 'examples/*.{html,scss,css}'",eslintbase:"beemo eslint 'src/**/*.ts'",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",prebuild:"mkdir -p build",build:"tsc && rollup -c",postbuild:"terser build/vega-themes.js -cm > build/vega-themes.min.js","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Typescript,Rollup 'yarn serve' 'tsc -w' 'rollup -c -w'"};var Ese={"@rollup/plugin-json":"^4.0.2","browser-sync":"^2.26.7",concurrently:"^5.1.0","gh-pages":"^2.2.0",rollup:"^2.1.0",terser:"^4.6.7",typescript:"^3.8.3",vega:"^5.10.0","vega-lite":"^4.8.1","vega-lite-dev-config":"^0.5.0"};var Ose={vega:"*","vega-lite":"*"};var Ase={module:"vega-lite-dev-config",drivers:["prettier","eslint"]};var Sse={name:fse,version:cse,description:dse,keywords:hse,license:pse,author:vse,contributors:gse,main:mse,module:yse,unpkg:bse,jsdelivr:xse,typings:_se,repository:wse,scripts:kse,devDependencies:Ese,peerDependencies:Ose,beemo:Ase};var Dse="#fff";var Cse="#888";var Mse={background:"#333",title:{color:Dse},style:{"guide-label":{fill:Dse},"guide-title":{fill:Dse}},axis:{domainColor:Dse,gridColor:Cse,tickColor:Dse}};var jse="#4572a7";var Fse={background:"#fff",arc:{fill:jse},area:{fill:jse},line:{stroke:jse,strokeWidth:2},path:{stroke:jse},rect:{fill:jse},shape:{stroke:jse},symbol:{fill:jse,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:true,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:false,tickExtra:true},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}};var Nse="#30a2da";var Tse="#cbcbcb";var zse="#999";var Rse="#333";var Pse="#f0f0f0";var Lse="#333";var Ise={arc:{fill:Nse},area:{fill:Nse},axis:{domainColor:Tse,grid:true,gridColor:Tse,gridWidth:1,labelColor:zse,labelFontSize:10,titleColor:Rse,tickColor:Tse,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:false},background:Pse,group:{fill:Pse},legend:{labelColor:Lse,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Lse,titleFontSize:14,titlePadding:10},line:{stroke:Nse,strokeWidth:2},path:{stroke:Nse,strokeWidth:.5},rect:{fill:Nse},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:true,shape:"circle"},shape:{stroke:Nse},bar:{binSpacing:2,fill:Nse,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}};var Bse="#000";var Use={group:{fill:"#e5e5e5"},arc:{fill:Bse},area:{fill:Bse},line:{stroke:Bse},path:{stroke:Bse},rect:{fill:Bse},shape:{stroke:Bse},symbol:{fill:Bse,size:40},axis:{domain:false,grid:true,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}};var qse=22;var Wse="normal";var Hse="Benton Gothic, sans-serif";var $se=11.5;var Gse="normal";var Vse="#82c6df";var Yse="Benton Gothic Bold, sans-serif";var Xse="normal";var Jse=13;var Zse={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]};var Qse={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Yse,fontSize:qse,fontWeight:Wse},arc:{fill:Vse},area:{fill:Vse},line:{stroke:Vse,strokeWidth:2},path:{stroke:Vse},rect:{fill:Vse},shape:{stroke:Vse},symbol:{fill:Vse,size:30},axis:{labelFont:Hse,labelFontSize:$se,labelFontWeight:Gse,titleFont:Yse,titleFontSize:Jse,titleFontWeight:Xse},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Hse,labelFontSize:$se,symbolType:"square",titleFont:Yse,titleFontSize:Jse,titleFontWeight:Xse},range:{category:Zse["category-6"],diverging:Zse["fireandice-6"],heatmap:Zse["fire-7"],ordinal:Zse["fire-7"],ramp:Zse["fire-7"]}};var Kse="#ab5787";var ele="#979797";var tle={background:"#f9f9f9",arc:{fill:Kse},area:{fill:Kse},line:{stroke:Kse},path:{stroke:Kse},rect:{fill:Kse},shape:{stroke:Kse},symbol:{fill:Kse,size:30},axis:{domainColor:ele,domainWidth:.5,gridWidth:.2,labelColor:ele,tickColor:ele,tickWidth:.2,titleColor:ele},axisBand:{grid:false},axisX:{grid:true,tickSize:10},axisY:{domain:false,grid:true,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}};var nle="#3e5c69";var rle={background:"#fff",arc:{fill:nle},area:{fill:nle},line:{stroke:nle},path:{stroke:nle},rect:{fill:nle},shape:{stroke:nle},symbol:{fill:nle},axis:{domainWidth:.5,grid:true,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:false},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}};var ile="#1696d2";var ale="#000000";var ole="#FFFFFF";var ule="Lato";var sle="Lato";var lle="Lato";var fle="#DEDDDD";var cle=18;var dle={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]};var hle={background:ole,title:{anchor:"start",fontSize:cle,font:ule},axisX:{domain:true,domainColor:ale,domainWidth:1,grid:false,labelFontSize:12,labelFont:sle,labelAngle:0,tickColor:ale,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:ule},axisY:{domain:false,domainWidth:1,grid:true,gridColor:fle,gridWidth:1,labelFontSize:12,labelFont:sle,labelPadding:8,ticks:false,titleFontSize:12,titlePadding:10,titleFont:ule,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:sle,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:ule,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:dle["six-groups-cat-1"],diverging:dle["diverging-colors"],heatmap:dle["diverging-colors"],ordinal:dle["six-groups-seq"],ramp:dle["shades-blue"]},area:{fill:ile},rect:{fill:ile},line:{color:ile,stroke:ile,strokeWidth:5},trail:{color:ile,stroke:ile,strokeWidth:0,size:1},path:{stroke:ile,strokeWidth:.5},point:{filled:true},text:{font:lle,color:ile,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ile,stroke:null}},arc:{fill:ile},shape:{stroke:ile},symbol:{fill:ile,size:30}};var ple="#3366CC";var vle="#ccc";var gle="Arial, sans-serif";var mle={arc:{fill:ple},area:{fill:ple},path:{stroke:ple},rect:{fill:ple},shape:{stroke:ple},symbol:{stroke:ple},circle:{fill:ple},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:gle,fontSize:12},"guide-title":{font:gle,fontSize:12},"group-title":{font:gle,fontSize:12}},title:{font:gle,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:vle,tickColor:vle,domain:false,grid:true},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}};var yle=Sse.version;var ble=Object.freeze({__proto__:null,version:yle,dark:Mse,excel:Fse,fivethirtyeight:Ise,ggplot2:Use,latimes:Qse,quartz:tle,vox:rle,urbaninstitute:hle,googlecharts:mle});var xle="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";var _le="vg-tooltip-element";var wle={offsetX:10,offsetY:10,id:_le,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:false,sanitize:kle,maxDepth:2};function kle(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function Ele(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e)){throw new Error("Invalid HTML ID")}return xle.toString().replace(_le,e)}var Ole=undefined&&undefined.__rest||function(e,t){var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0)n[r]=e[r];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++){if(t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i]))n[r[i]]=e[r[i]]}return n};function Ale(e,t,n){if(ri(e)){return"["+e.map((function(e){return t(ai(e)?e:Dle(e,n))})).join(", ")+"]"}if(ii(e)){var r="";var i=e,a=i.title,o=Ole(i,["title"]);if(a){r+="<h2>"+t(a)+"</h2>"}var u=Object.keys(o);if(u.length>0){r+="<table>";for(var s=0,l=u;s<l.length;s++){var f=l[s];var c=o[f];if(c===undefined){continue}if(ii(c)){c=Dle(c,n)}r+='<tr><td class="key">'+t(f)+':</td><td class="value">'+t(c)+"</td></tr>"}r+="</table>"}return r||"{}"}return t(e)}function Sle(e){var t=[];return function(n,r){if(typeof r!=="object"||r===null){return r}var i=t.indexOf(this)+1;t.length=i;if(t.length>e){return"[Object]"}if(t.indexOf(r)>=0){return"[Circular]"}t.push(r);return r}}function Dle(e,t){return JSON.stringify(e,Sle(t))}function Cle(e,t,n,r){var i=e.clientX+n;if(i+t.width>window.innerWidth){i=+e.clientX-n-t.width}var a=e.clientY+r;if(a+t.height>window.innerHeight){a=+e.clientY-r-t.height}return{x:i,y:a}}var Mle=function(){function e(e){this.options=Object.assign(Object.assign({},wle),e);var t=this.options.id;this.call=this.tooltipHandler.bind(this);if(!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var n=document.createElement("style");n.setAttribute("id",this.options.styleId);n.innerHTML=Ele(t);var r=document.head;if(r.childNodes.length>0){r.insertBefore(n,r.childNodes[0])}else{r.appendChild(n)}}this.el=document.getElementById(t);if(!this.el){this.el=document.createElement("div");this.el.setAttribute("id",t);this.el.classList.add("vg-tooltip");document.body.appendChild(this.el)}}e.prototype.tooltipHandler=function(e,t,n,r){if(r==null||r===""){this.el.classList.remove("visible",this.options.theme+"-theme");return}this.el.innerHTML=Ale(r,this.options.sanitize,this.options.maxDepth);this.el.classList.add("visible",this.options.theme+"-theme");var i=Cle(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),a=i.x,o=i.y;this.el.setAttribute("style","top: "+o+"px; left: "+a+"px")};return e}();function jle(e,t,n){var r=e.open(t);var i=1e4;var a=250;var o=~~(i/a);function u(t){if(t.source===r){o=0;e.removeEventListener("message",u,false)}}e.addEventListener("message",u,false);function s(){if(o<=0){return}r.postMessage(n,"*");setTimeout(s,a);o-=1}setTimeout(s,a)}var Fle='.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}}function Nle(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}for(var r=0,i=t;r<i.length;r++){var a=i[r];Tle(e,a)}return e}function Tle(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Ei(e,i,t[i],true)}}var zle;var Rle=eK;var Ple=use;var Lle=typeof window!=="undefined"?window:undefined;if(Ple===undefined&&((zle=Lle===null||Lle===void 0?void 0:Lle["vl"])===null||zle===void 0?void 0:zle.compile)){Ple=Lle["vl"]}var Ile={export:{svg:true,png:true},source:true,compiled:true,editor:true};var Ble={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"};var Ule={vega:"Vega","vega-lite":"Vega-Lite"};var qle={vega:Rle.version,"vega-lite":Ple?Ple.version:"not available"};var Wle={vega:function(e){return e},"vega-lite":function(e,t){return Ple.compile(e,{config:t}).spec}};var Hle='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>';function $le(e){return typeof e==="function"}function Gle(e,t,n,r){var i="<html><head>"+t+'</head><body><pre><code class="json">';var a="</code></pre>"+n+"</body></html>";var o=window.open("");o.document.write(i+e+a);o.document.title=Ule[r]+" JSON Source"}function Vle(e,t){var n;if(e.$schema){var r=lse(e.$schema);if(t&&t!==r.library){console.warn("The given visualization spec is written in "+Ule[r.library]+", but mode argument sets "+((n=Ule[t])!==null&&n!==void 0?n:t)+".")}var i=r.library;if(!Zr(qle[i],"^"+r.version.slice(1))){console.warn("The input spec uses "+Ule[i]+" "+r.version+", but the current version of "+Ule[i]+" is v"+qle[i]+".")}return i}if("mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e){return"vega-lite"}if("marks"in e||"signals"in e||"scales"in e||"axes"in e){return"vega"}return t!==null&&t!==void 0?t:"vega"}function Yle(e){return!!(e&&"load"in e)}function Xle(e,t,n){if(n===void 0){n={}}var r,i,a;return Je(this,void 0,void 0,(function(){var o,u,s,l,f,c,d,h;return __generator(this,(function(p){switch(p.label){case 0:o=Yle(n.loader)?n.loader:Rle.loader(n.loader);if(!ai(t))return[3,2];f=(l=JSON).parse;return[4,o.load(t)];case 1:s=f.apply(l,[p.sent()]);return[3,3];case 2:s=t;p.label=3;case 3:u=s;return[4,Jle((r=u.usermeta&&u.usermeta["embedOptions"])!==null&&r!==void 0?r:{},o)];case 4:c=p.sent();return[4,Jle(n,o)];case 5:d=p.sent();h=Object.assign(Object.assign({},Nle(d,c)),{config:ki((i=d.config)!==null&&i!==void 0?i:{},(a=c.config)!==null&&a!==void 0?a:{})});return[4,Zle(e,u,h,o)];case 6:return[2,p.sent()]}}))}))}function Jle(e,t){var n;return Je(this,void 0,void 0,(function(){var r,i,a,o,u,s,l,f;return __generator(this,(function(c){switch(c.label){case 0:if(!ai(e.config))return[3,2];o=(a=JSON).parse;return[4,t.load(e.config)];case 1:i=o.apply(a,[c.sent()]);return[3,3];case 2:i=(n=e.config)!==null&&n!==void 0?n:{};c.label=3;case 3:r=i;if(!ai(e.patch))return[3,5];f=(l=JSON).parse;return[4,t.load(e.patch)];case 4:s=f.apply(l,[c.sent()]);return[3,6];case 5:s=e.patch;c.label=6;case 6:u=s;return[2,Object.assign(Object.assign(Object.assign({},e),u?{patch:u}:{}),r?{config:r}:{})]}}))}))}function Zle(e,t,n,r){if(n===void 0){n={}}var i,a,o,u,s,l;return Je(this,void 0,void 0,(function(){function f(){if(j){document.removeEventListener("click",j)}O.finalize()}var c,d,h,p,v,g,m,y,b,x,_,w,k,E,O,A,S,D,C,M,j,F,N,T,z,R,P,L,I,B,U,q,W;return __generator(this,(function(H){switch(H.label){case 0:c=n.theme?ki(ble[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config;d=ua(n.actions)?n.actions:Nle({},Ile,(a=n.actions)!==null&&a!==void 0?a:{});h=Object.assign(Object.assign({},Ble),n.i18n);p=(o=n.renderer)!==null&&o!==void 0?o:"canvas";v=(u=n.logLevel)!==null&&u!==void 0?u:Rle.Warn;g=(s=n.downloadFileName)!==null&&s!==void 0?s:"visualization";if(n.defaultStyle!==false){m="vega-embed-style";if(!document.getElementById(m)){y=document.createElement("style");y.id=m;y.innerText=n.defaultStyle===undefined||n.defaultStyle===true?Fle.toString():n.defaultStyle;document.head.appendChild(y)}}b=Vle(t,n.mode);x=Wle[b](t,c);if(b==="vega-lite"){if(x.$schema){_=lse(x.$schema);if(!Zr(qle.vega,"^"+_.version.slice(1))){console.warn("The compiled spec uses Vega "+_.version+", but current version is v"+qle.vega+".")}}}w=typeof e==="string"?document.querySelector(e):e;if(!w){throw Error(e+" does not exist")}w.classList.add("vega-embed");if(d){w.classList.add("has-actions")}w.innerHTML="";k=n.patch;if(k){if(k instanceof Function){x=k(x)}else{x=pt(x,k,true,false).newDocument}}if(n.formatLocale){Rle.formatLocale(n.formatLocale)}if(n.timeFormatLocale){Rle.timeFormatLocale(n.timeFormatLocale)}E=Rle.parse(x,b==="vega-lite"?{}:c);O=new Rle.View(E,{loader:r,logLevel:v,renderer:p});if(n.tooltip!==false){A=void 0;if($le(n.tooltip)){A=n.tooltip}else{A=new Mle(n.tooltip===true?{}:n.tooltip).call}O.tooltip(A)}S=n.hover;if(S===undefined){S=b==="vega"}if(S){D=typeof S==="boolean"?{}:S,C=D.hoverSet,M=D.updateSet;O.hover(C,M)}if(n){if(n.width!=null){O.width(n.width)}if(n.height!=null){O.height(n.height)}if(n.padding!=null){O.padding(n.padding)}}return[4,O.initialize(e).runAsync()];case 1:H.sent();if(d!==false){F=w;if(n.defaultStyle!==false){N=document.createElement("details");N.title=h.CLICK_TO_VIEW_ACTIONS;w.append(N);F=N;T=document.createElement("summary");T.innerHTML=Hle;N.append(T);j=function(e){if(!N.contains(e.target)){N.removeAttribute("open")}};document.addEventListener("click",j)}z=document.createElement("div");F.append(z);z.classList.add("vega-actions");if(d===true||d.export!==false){R=function(e){if(d===true||d.export===true||d.export[e]){var t=h[e.toUpperCase()+"_ACTION"];var r=document.createElement("a");r.text=t;r.href="#";r.target="_blank";r.download=g+"."+e;r.addEventListener("mousedown",(function(t){return Je(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:t.preventDefault();return[4,O.toImageURL(e,n.scaleFactor)];case 1:r=i.sent();this.href=r;return[2]}}))}))}));z.append(r)}};for(P=0,L=["svg","png"];P<L.length;P++){I=L[P];R(I)}}if(d===true||d.source!==false){B=document.createElement("a");B.text=h.SOURCE_ACTION;B.href="#";B.addEventListener("mousedown",(function(e){var r,i;Gle(Nt(t),(r=n.sourceHeader)!==null&&r!==void 0?r:"",(i=n.sourceFooter)!==null&&i!==void 0?i:"",b);e.preventDefault()}));z.append(B)}if(b==="vega-lite"&&(d===true||d.compiled!==false)){U=document.createElement("a");U.text=h.COMPILED_ACTION;U.href="#";U.addEventListener("mousedown",(function(e){var t,r;Gle(Nt(x),(t=n.sourceHeader)!==null&&t!==void 0?t:"",(r=n.sourceFooter)!==null&&r!==void 0?r:"","vega");e.preventDefault()}));z.append(U)}if(d===true||d.editor!==false){q=(l=n.editorUrl)!==null&&l!==void 0?l:"https://vega.github.io/editor/";W=document.createElement("a");W.text=h.EDITOR_ACTION;W.href="#";W.addEventListener("mousedown",(function(e){jle(window,q,{config:c,mode:b,renderer:p,spec:Nt(t)});e.preventDefault()}));z.append(W)}}return[2,{view:O,spec:t,vgSpec:x,finalize:f}]}}))}))}var Qle="vega-visualization{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;width:100%}vega-visualization>div{width:100%}";var Kle=e("vega_visualization",function(){function e(e){t(this,e)}e.prototype.componentDidLoad=function(){this.update()};e.prototype.update=function(){if(!this.spec)return;var e=this.el.querySelector("div");Xle(e,this.spec,{actions:false}).catch((function(e){return console.error(e)}))};e.prototype.render=function(){return r(i,{style:{paddingRight:this.spacing+"px"}},r("div",null))};Object.defineProperty(e.prototype,"el",{get:function(){return a(this)},enumerable:true,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{spec:["update"]}},enumerable:true,configurable:true});return e}());Kle.style=Qle;var efe=":host{background-color:#fff;border-radius:0.5rem;-webkit-box-shadow:0px 0px 4px 2px rgba(0, 0, 0, 0.2);box-shadow:0px 0px 4px 2px rgba(0, 0, 0, 0.2);-webkit-box-sizing:border-box;box-sizing:border-box;display:block;padding:0.5rem;width:100%}:host>div{overflow:hidden}";var tfe=e("visualization_container",function(){function e(e){t(this,e)}e.prototype.render=function(){return r("div",null,r("slot",null))};return e}());tfe.style=efe}}}));